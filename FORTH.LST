Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 1
forth.asm



      1				     ; 253 слова head
      2				     ; 103 слова используют $col
      3				     ; 9 слова использует $con
      4				     ; 29 слова	использует $use
      5				     ; 1 слово forth
      6
      7				     masm
      8				     .8086
      9	0000			     .MODEL SMALL
     10	      =0000		     LINK=0
     11					 ; Макроопределения
     12					 ; Описание примитивов и слов высокого уровня
     13					 HEAD  MACRO length,name,lchar,labl,code
     14					 LINK$=$
     15					     DB	 length	 ; NFA 7 бит равен 1.
     16							 ; 6 - признак immediate. 5- слово не описано
     17					     IFNB <name>
     18					     DB	 NAME
     19					     ENDIF
     20					     DB	 lchar	 ; последний символ слова + 128	(7 бит = 1).
     21					     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
     22					 LINK=LINK$
     23					 labl LABEL FAR	 ; CFA
     24					     IFNB <code> ;
     25					     DW	code
     26					     ELSE
     27					     DW	 $+2
     28					     ENDIF
     29					     ENDM
     30
     31	      =0000		     debug equ 0
     32
     33					 NEXT MACRO   ;	переход	к исполнению следующего	слова
     34
     35					     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
     36					     MOV  BX, AX     ; BX равен	CFA  следующего	слова
     37					     if	debug
     38						 ;mov ax, si
     39						 call printWORD
     40						 call pause
     41					     endif
     42					     JMP WORD PTR [BX] ;
     43					     ENDM
     44
     45
     46	0000				ARRAY	SEGMENT
     47	0000  0000 0000			$TIME	DW  0,0			    ; TIMER COUNTER
     48	0004  0000			$DATE	DW  0			    ; DATE
     49
     50					;  Сегмент стека и словарь пользователя	размещен в конце текста
     51					;  интерпретатора. Для версии, записываемой в ПЗУ, их нужно
     52					;  разместить здесь.
     53
     54	0006  03*(0000 0200*(0000)+	DSKBUF	DW  3 DUP(0,512	DUP(0),0)   ; Экранные буферы на 1024 байта
     55	      0000)
     56	0C12  0000			ENDBUF	DW  0	     ; 6 1034 (40Ah) 2062(80Eh)	адреса буферов
     57
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 2
forth.asm



     58	0C14  5C*(0000)			XTIB	DW  92 DUP(0)		    ; Входной буфер
     59	0CCC  0000 0000			XR0	DW  0,0			    ; Стек возвратов  растет в область
     60									    ; меньших адресов.	ADD BP - убрать	данные
     61	0CD0  66*(0000)			XUP	DW  102	DUP(0)		    ; USER-область на нее указывает DI
     62
     63	0D9C  27F9r			$STI	DW  TASK-7  ;		    ; Стартовая	таблица	PFA слова TASK
     64	0D9E  0CD0r			$US	DW  XUP	    ;		    ; адрес user области
     65					;    переменные
     66	0DA0  0080r			$STK	DW  XS0	    ;+6		     ; SO
     67	0DA2  0CCCr			$RS	DW  XR0	    ;+8		     ; RO стек возвратов
     68	0DA4  0C14r				DW  XTIB    ;+10	     ; входной буфер
     69	0DA6  001F				DW  1Fh	    ;+12	     ; WIDTH 31	буква
     70	0DA8  0000				DW  0	    ;+14	     ; WARNING
     71	0DAA  287Br				DW  XDP	    ;+16	     ; словарь FENCE (забор)
     72	0DAC  287Br				DW  XDP	    ;+18	     ; DP
     73	0DAE  27F7r				DW  XVOC    ;+20	     ; словарь VOCL в слове Forth
     74	0DB0  0006r			$BUF	DW  DSKBUF  ;+22	     ; экранный	буфер FIRST
     75	0DB2  0C12r				DW  ENDBUF  ;+24 или 30Q     ; LIMIT
     76
     77					ASSUME	CS:ARRAY, DS:ARRAY, ES:ARRAY, SS:STCK
     78
     79	0DB4				$INI	  PROC	  FAR
     80	0DB4  EB 08				  JMP  ENT
     81					; ** PRIMITIVES	**
     82
     83						  HEAD	  83h,'IN',311Q,INIT		      ;INI
1    84	      =ARRAY:0DB6		 LINK$=$
1    85	0DB6  83			     DB	 83h  ;	NFA 7 бит равен	1.
1    86							 ; 6 - признак immediate. 5- слово не описано
1    87	0DB7  49 4E			     DB	 'IN'
1    88	0DB9  C9			     DB	 311Q	; последний символ слова + 128 (7 бит =	1).
1    89	0DBA  0000			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1    90	      =ARRAY:0DB6		 LINK=LINK$
1    91	0DBC				 INIT LABEL FAR	 ; CFA
1    92	0DBC  0DBEr			     DW	 $+2
     93	0DBE  B9 0000s			ENT:	  MOV	CX, ARRAY
     94	0DC1  8E D9				  MOV	DS, CX		; Установка DX
     95	0DC3  8E C1				  MOV	ES, CX
     96	0DC5  A1 0D9Cr				  MOV	AX, $STI	; Восстановление словаря (PFA слова TASK)
     97	0DC8  BE 27F5r				  LEA	SI, FORTH+6	; Адрес	места нахождения в PFA forth
     98	0DCB  89 04				  MOV	[SI], AX	;
     99	0DCD  8B 36 0DB0r			  MOV	SI, $BUF
    100	0DD1  B9 06CB				  MOV	CX, 1739	; Установка счетчика 1730
    101	0DD4  C7 04 0000		XXX:	  MOV	WORD PTR [SI],0	; Обнуление массивов
    102	0DD8  83 C6 02				  ADD	SI, 2
    103	0DDB  E2 F7				  LOOP	XXX
    104
    105					; INIT 'OFFSET,	USE, PREV
    106	0DDD  8B 1E 0D9Er			  MOV	BX, $US		 ; xup
    107	0DE1  8B 0E 0DB0r			  MOV	CX, $BUF	 ; TO 'USE'
    108	0DE5  89 4F 3A				  MOV	[BX]+72Q,CX	 ; USE ? адрес блока
    109	0DE8  89 4F 3C				  MOV	[BX]+74Q,CX	 ; PREV	? адрес	блока
    110	0DEB  B9 000A				  MOV	CX, 10		 ; Установка счетчика USER (14Q	надо на	2 меньше уже)
    111	0DEE  8B 3E 0D9Er			  MOV	DI, $US		 ; Запись адреса области USER
    112	0DF2  83 C7 06				  ADD	DI, 6		 ; почему 6....	? User переменные начинаются с 6 адреса
    113	0DF5  BE 0DA0r				  LEA	SI, $STK	 ; Запись начального адреса
    114						  ; заполняем начальные	значения переменых
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 3
forth.asm



    115	0DF8  F3> A5			REP	  MOVS	WORD PTR ES:[DI], WORD PTR DS:[SI]
    116	0DFA  8B 2E 0DA2r			  MOV	BP, $RS		 ; Установка начального	значения
    117									 ; указателя стека возвратов
    118									 ; пересекается	с областью TIB
    119	0DFE  8B 3E 0D9Er			  MOV	DI, $US
    120	0E02  C7 45 1A 0007			  MOV	WORD PTR [DI+32Q],7  ; Установка цвета вывода текста
    121	0E07  C7 45 22 0000			  MOV	WORD PTR [DI+42Q],0  ; Сброс флага печати
    122	0E0C  BE 0E14r				  LEA	SI, GO$
    123						  NEXT
1   124
1   125	0E0F  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   126	0E10  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   127	0E12  FF 27			     JMP WORD PTR [BX] ;
    128						  ; здесь инструкции языка форт. указатель на них в SI
    129	0E14  1459r 1751r 27EFr	  +	GO$:	  DW SPSTO,DECIMA,FORTH,DEFIN, ONE,LOA,	quit; загрузка первого экрана
    130	      17D3r 1907r 2267r	  +
    131	      203Br
    132	0E22			     $INI      ENDP
    133
    134				     ; ждем нажатия клавиши, по	Q выход	из программы
    135	0E22			     pause proc
    136	0E22  33 C0			     xor ax, ax
    137	0E24  CD 16			     int 16h ; AL = ASCII символ (если AL=0, AH	содержит расширенный код ASCII )
    138						     ; AH = сканкод  или расширенный код ASCII
    139	0E26  80 FC 10			     cmp ah, 10H ; клавиша Q (quit)
    140	0E29  75 04			     jnz @1
    141	0E2B  B4 4C			     mov ah,4Ch
    142	0E2D  CD 21			     int 21h
    143	0E2F  C3			 @1: ret
    144	0E30			     pause endp
    145
    146				     ; AX- значение для	печати в 16 виде
    147				     ; di - адрес строки для вывода
    148	0E30			     toHex PROC
    149	0E30  B1 04			 mov cl,4	     ; number of ASCII
    150	0E32  D1 C0 D1 C0 D1 C0	D1+  P1: rol ax,4	    ; 1	Nibble (start with highest byte)
    151	      C0
    152	0E3A  8A D8			 mov bl,al
    153	0E3C  80 E3 0F			 and bl,0Fh	     ; only low-Nibble
    154	0E3F  80 C3 30			 add bl,30h	     ; convert to ASCII
    155	0E42  80 FB 39			 cmp bl,39h	     ; above 9?
    156	0E45  76 03			 jna short P2
    157	0E47  80 C3 07			 add bl,7	     ; "A" to "F"
    158	0E4A  88 1D		     P2: mov [di],bl	     ; store ASCII in buffer
    159	0E4C  47			 inc di		     ; increase	target address
    160	0E4D  FE C9			 dec cl		     ; decrease	loop counter
    161	0E4F  75 E1			 jnz P1		     ; jump if cl is not equal 0 (zeroflag is not set)
    162	0E51  C3			 ret
    163	0E52			     toHex endP
    164
    165				     ; di- адрес буфера
    166				     ; cx - число символов
    167				     ; заполнение пробелом
    168	0E52			     blankBuffer proc
    169	0E52  57			 push di
    170	0E53				 @@:
    171	0E53  C6 05 20			 mov byte ptr [di], 32
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 4
forth.asm



    172	0E56  47			 inc di
    173	0E57  E2 FA			 loop @@
    174	0E59  5F			 pop di
    175	0E5A  C3			 ret
    176	0E5B			     blankBuffer endp
    177
    178				     ; вывод адреса и имени слова
    179				     ; AX- значение адреса
    180	0E5B			     printWORD proc
    181					 ;local	label m, m1
    182	0E5B  57			 push di
    183	0E5C  56			 push si
    184	0E5D  53			 push bx
    185	0E5E  50			 push ax
    186	0E5F  BF 0E90r			 mov di,OFFSET ASCII ; get the offset address
    187	0E62  B9 0014			 mov cx, 20
    188	0E65  E8 FFEA			 call blankBuffer
    189	0E68  E8 FFC5			 call toHex
    190	0E6B  47			 inc di	 ; вывод текста	после адреса
    191	0E6C  5B			 pop bx	; адрес	слова CFA?
    192					 ;mov al, byte ptr [bx-3] ; последний символ слова
    193	0E6D  83 EB 03			 SUB bx, 3   ;
    194	0E70				 mm:	      ;	ищем поле длины
    195	0E70  4B			 dec bx
    196	0E71  80 3F 00			 CMP  BYTE PTR [bx],  0
    197	0E74  79 FA			 JNS  mm     ; JUMP IF POSITIVE
    198	0E76  8B 0F			 mov cx, [bx] ;	длина слова + всякие  служ. поля
    199	0E78  83 E1 3F			 and cx, 003Fh
    200	0E7B				 mmm1:
    201	0E7B  43			 inc bx
    202	0E7C  8A 07			 mov al, byte ptr [bx]
    203	0E7E  24 7F			 and al, 7Fh ;	 последний символ увеличен на 80h
    204	0E80  88 05			 mov [di],al
    205	0E82  47			 inc di
    206	0E83  E2 F6			 loop mmm1
    207					 ;-----------------------
    208					 ; Print string
    209					 ;-----------------------
    210	0E85  BA 0E90r			 mov dx,OFFSET ASCII ; DOS 1+ WRITE STRING TO STANDARD OUTPUT
    211	0E88  B4 09			 mov ah,9	     ; DS:DX->'$'-terminated string
    212	0E8A  CD 21			 int 21h	     ; maybe redirected	under DOS 2+ for output	to file
    213							     ; (using pipe character">") or output to printer
    214	0E8C  5B			 pop bx
    215	0E8D  5E			 pop si
    216	0E8E  5F			 pop di
    217	0E8F  C3			 ret
    218	0E90  30 30 30 30 20 20	20+	 ASCII DB "0000		       ",0Dh,0Ah,"$" ; buffer for ASCII	string
    219	      20 20 20 20 20 20	20+
    220	      20 20 20 20 20 20	0D+
    221	      0A 24
    222	0EA7			     printWORD endP
    223
    224					; BX - WP находится адрес исполняемого слова
    225					; SI - IP-регистр    должен сохраняться
    226					; DI - указатель области USER
    227					; BP - указатель стека возвратов
    228					; SP - указатель стека параметров
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 5
forth.asm



    229
    230						  HEAD	  87h,'EXECUT',305Q,EXEC	      ;
1   231	      =ARRAY:0EA7		 LINK$=$
1   232	0EA7  87			     DB	 87h  ;	NFA 7 бит равен	1.
1   233							 ; 6 - признак immediate. 5- слово не описано
1   234	0EA8  45 58 45 43 55 54		     DB	 'EXECUT'
1   235	0EAE  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1   236	0EAF  0DB6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   237	      =ARRAY:0EA7		 LINK=LINK$
1   238	0EB1				 EXEC LABEL FAR	 ; CFA
1   239	0EB1  0EB3r			     DW	 $+2
    240					 ; в стеке адрес поля CFA (НЕ PFA)
    241	0EB3  5B				  POP	BX
    242	0EB4  FF 27				  JMP  WORD PTR	[ BX ]
    243
    244						  HEAD	  83h,'LI',324Q,LIT		      ;	LIT
1   245	      =ARRAY:0EB6		 LINK$=$
1   246	0EB6  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   247							 ; 6 - признак immediate. 5- слово не описано
1   248	0EB7  4C 49			     DB	 'LI'
1   249	0EB9  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1   250	0EBA  0EA7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   251	      =ARRAY:0EB6		 LINK=LINK$
1   252	0EBC				 LIT LABEL FAR	; CFA
1   253	0EBC  0EBEr			     DW	 $+2
    254	0EBE  AD				  LODSW
    255	0EBF  50				  PUSH	AX
    256						  NEXT
1   257
1   258	0EC0  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   259	0EC1  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   260	0EC3  FF 27			     JMP WORD PTR [BX] ;
    261
    262						  HEAD	  86h,'TERMO',316Q,TERMON	      ;	TERMON
1   263	      =ARRAY:0EC5		 LINK$=$
1   264	0EC5  86			     DB	 86h  ;	NFA 7 бит равен	1.
1   265							 ; 6 - признак immediate. 5- слово не описано
1   266	0EC6  54 45 52 4D 4F		     DB	 'TERMO'
1   267	0ECB  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1   268	0ECC  0EB6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   269	      =ARRAY:0EC5		 LINK=LINK$
1   270	0ECE				 TERMON	LABEL FAR  ; CFA
1   271	0ECE  0ED0r			     DW	 $+2
    272					 ; NumLock, ScrollLock,	CapsLock, Ins. Состояние этих клавиш записывается
    273					 ; в область данных BIOS в два байта с адресами	0000h:0417h и 0000h:0418h
    274	0ED0  58				  POP	AX
    275	0ED1  06				  PUSH	ES
    276	0ED2  B9 0000				  MOV	CX, 0
    277	0ED5  8E C1				  MOV	ES, CX
    278	0ED7  26: A3 0417			  MOV	ES:417H,AX
    279	0EDB  07				  POP	ES
    280						  NEXT
1   281
1   282	0EDC  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   283	0EDD  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   284	0EDF  FF 27			     JMP WORD PTR [BX] ;
    285
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 6
forth.asm



    286						  HEAD	  87h,'?BRANC',310Q,ZBRAN	      ;	?BRANCH
1   287	      =ARRAY:0EE1		 LINK$=$
1   288	0EE1  87			     DB	 87h  ;	NFA 7 бит равен	1.
1   289							 ; 6 - признак immediate. 5- слово не описано
1   290	0EE2  3F 42 52 41 4E 43		     DB	 '?BRANC'
1   291	0EE8  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1   292	0EE9  0EC5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   293	      =ARRAY:0EE1		 LINK=LINK$
1   294	0EEB				 ZBRAN LABEL FAR  ; CFA
1   295	0EEB  0EEDr			     DW	 $+2
    296					 ; переход, если 0 в стеке (FALSE)
    297	0EED  58				  POP	AX
    298	0EEE  3D 0000				  CMP	AX, 0
    299	0EF1  74 13				  JE	CNT
    300	0EF3  83 C6 02				  ADD	SI, 2 ;	без перехода пропускаем	следующее слово	(адрес перехода)
    301						  NEXT
1   302
1   303	0EF6  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   304	0EF7  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   305	0EF9  FF 27			     JMP WORD PTR [BX] ;
    306
    307						  HEAD	  86h,'BRANC',310Q,BRAN		      ;	BRANCH
1   308	      =ARRAY:0EFB		 LINK$=$
1   309	0EFB  86			     DB	 86h  ;	NFA 7 бит равен	1.
1   310							 ; 6 - признак immediate. 5- слово не описано
1   311	0EFC  42 52 41 4E 43		     DB	 'BRANC'
1   312	0F01  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1   313	0F02  0EE1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   314	      =ARRAY:0EFB		 LINK=LINK$
1   315	0F04				 BRAN LABEL FAR	 ; CFA
1   316	0F04  0F06r			     DW	 $+2
    317					 ; безусловный переход
    318	0F06  03 34			CNT:	  ADD	SI,  [SI]  ; si	содержит число инструкций,
    319								 ; которые необходимо пропустить
    320						  NEXT
1   321
1   322	0F08  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   323	0F09  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   324	0F0B  FF 27			     JMP WORD PTR [BX] ;
    325
    326						  HEAD	  84h,'(DO',251Q,XDO		      ;	(DO)
1   327	      =ARRAY:0F0D		 LINK$=$
1   328	0F0D  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   329							 ; 6 - признак immediate. 5- слово не описано
1   330	0F0E  28 44 4F			     DB	 '(DO'
1   331	0F11  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1   332	0F12  0EFBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   333	      =ARRAY:0F0D		 LINK=LINK$
1   334	0F14				 XDO LABEL FAR	; CFA
1   335	0F14  0F16r			     DW	 $+2
    336	0F16  58				  POP	AX  ; в	стек возвратов начальное значение цикла
    337	0F17  83 ED 02				  SUB	BP, 2
    338	0F1A  8F 46 00				  POP	[BP] ; конечное	значение цикла
    339	0F1D  83 ED 02				  SUB	BP, 2
    340	0F20  89 46 00				  MOV	WORD PTR  [BP],AX ; в стек возвратов начальное значение	цикла
    341						  NEXT
1   342
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 7
forth.asm



1   343	0F23  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   344	0F24  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   345	0F26  FF 27			     JMP WORD PTR [BX] ;
    346
    347						  HEAD	  86h,'(LOOP',251Q,XLOOP	      ;	(LOOP)
1   348	      =ARRAY:0F28		 LINK$=$
1   349	0F28  86			     DB	 86h  ;	NFA 7 бит равен	1.
1   350							 ; 6 - признак immediate. 5- слово не описано
1   351	0F29  28 4C 4F 4F 50		     DB	 '(LOOP'
1   352	0F2E  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1   353	0F2F  0F0Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   354	      =ARRAY:0F28		 LINK=LINK$
1   355	0F31				 XLOOP LABEL FAR  ; CFA
1   356	0F31  0F33r			     DW	 $+2
    357					; Приращение индекса цикла LOOP	и может	быть  ветвление
    358	0F33  FF 46 00				  INC	WORD PTR  [BP] ; начальное значение увеличиваем
    359	0F36  8B 46 00			LOP:	  MOV	AX,  [BP]    ; индекс
    360	0F39  3B 46 02				  CMP	AX,  [BP+2]  ; предел цикла
    361	0F3C  7C C8				  JL	CNT
    362	0F3E  83 C5 04			LV:	  ADD	BP,  4 ; удаляем параметры цикла
    363	0F41  83 C6 02				  ADD	SI,  2 ; переход к следующеу слову
    364						  NEXT
1   365
1   366	0F44  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   367	0F45  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   368	0F47  FF 27			     JMP WORD PTR [BX] ;
    369
    370						  HEAD	  87h,'(+LOOP',251Q,XPLOO	      ;	(+LOOP)
1   371	      =ARRAY:0F49		 LINK$=$
1   372	0F49  87			     DB	 87h  ;	NFA 7 бит равен	1.
1   373							 ; 6 - признак immediate. 5- слово не описано
1   374	0F4A  28 2B 4C 4F 4F 50		     DB	 '(+LOOP'
1   375	0F50  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1   376	0F51  0F28r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   377	      =ARRAY:0F49		 LINK=LINK$
1   378	0F53				 XPLOO LABEL FAR  ; CFA
1   379	0F53  0F55r			     DW	 $+2
    380	0F55  58				  POP	AX
    381	0F56  01 46 00				  ADD	[BP],	AX
    382	0F59  3D 0000				  CMP	AX, 0
    383	0F5C  7C 02				  JL	$LESS
    384	0F5E  EB D6				  JMP	LOP
    385	0F60  8B 4E 00			  $LESS:  MOV	CX, [BP]   ; Работа с отрицательными приращениями
    386	0F63  39 4E 02				  CMP	[BP]+2,	CX
    387	0F66  7E D6				  JLE	LV
    388	0F68  EB 9C				  JMP	CNT
    389
    390						  HEAD	  86h,'(FIND',251Q,PFIND	      ;	PFIND
1   391	      =ARRAY:0F6A		 LINK$=$
1   392	0F6A  86			     DB	 86h  ;	NFA 7 бит равен	1.
1   393							 ; 6 - признак immediate. 5- слово не описано
1   394	0F6B  28 46 49 4E 44		     DB	 '(FIND'
1   395	0F70  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1   396	0F71  0F49r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   397	      =ARRAY:0F6A		 LINK=LINK$
1   398	0F73				 PFIND LABEL FAR  ; CFA
1   399	0F73  0F75r			     DW	 $+2
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 8
forth.asm



    400					     ; оператор	поиска
    401					; Адрес	строки	NFA => PFA длина TRUE/FALSE (!реально СFA !)
    402	0F75  58				  POP	AX	 ; NFA последнего слова	в context словаре
    403	0F76  59				  POP	CX	 ; строка для поиска. первый байт длина	образца
    404	0F77  55				  PUSH	BP	 ; сохранение содержимого регистров
    405	0F78  56				  PUSH	SI	 ; --
    406	0F79  57				  PUSH	DI	 ; --
    407	0F7A  8B F1				  MOV	SI, CX	 ; адрес образца
    408	0F7C  2B ED				  SUB	BP, BP	 ;
    409	0F7E  8B F8				  MOV	DI, AX	 ; NFA	последнего слова в словаре
    410	0F80  8B 14				  MOV	DX,WORD	PTR [SI] ; длина строки	поиска и первый	символ
    411	0F82  81 E2 7F7F			  AND	DX, 77577Q ; 7F7f - сброс старших битов. кажется лишним
    412	0F86  FC				  CLD			 ; DF=0	(вперед)
    413	0F87  8B 0D			FAST:	  MOV	CX,WORD	PTR [DI] ;
    414	0F89  81 E1 7F3F			  AND	CX, 77477Q ; сброс 7-ых	и 6 бита в первом байте
    415	0F8D  3B D1				  CMP	DX, CX	 ; сравним длину и первый символ
    416	0F8F  74 14				  JE	SLOW	 ; если	равны, может то, что ищем
    417	0F91  83 3D 00			MATCH:	  CMP	WORD PTR [DI], 0 ; ищем	конец nfa
    418	0F94  78 03				  JS	$SIG	     ; BPL
    419	0F96  47				  INC	DI	     ; следующий символ	в слове
    420	0F97  EB F8				  JMP	MATCH
    421	0F99  83 C7 02			$SIG:	  ADD	DI, 2	     ; переход к полю LFA
    422	0F9C  83 3D 00				  CMP	WORD PTR [DI],0	 ; список слов закончился
    423	0F9F  74 34				  JE	FAIL		 ; LFA =0, поиск не удачен
    424	0FA1  8B 3D				  MOV	DI,WORD	PTR [DI] ; переход к другому слову в словаре
    425	0FA3  EB E2				  JMP	FAST
    426	0FA5  8B 2D			SLOW:	  MOV	BP,WORD	PTR [DI] ; длина и первый символ найденого слова
    427	0FA7  8B DE				  MOV	BX, SI		 ; адрес образца
    428	0FA9  EB 0D				  JMP	SLOW1
    429	0FAB  43			$LOOP:	  INC	BX		 ; перебор символов
    430	0FAC  8B 07				  MOV	AX,WORD	PTR [BX]
    431	0FAE  8B 0D				  MOV	CX,WORD	PTR [DI]
    432	0FB0  81 E1 7FFF			  AND	CX, 77777Q   ; 7FFFh
    433	0FB4  3B C1				  CMP	AX, CX
    434	0FB6  75 D9				  JNE	MATCH	     ; не совпало, переход на начало
    435	0FB8  47			SLOW1:	  INC	DI
    436	0FB9  F7 45 FF 8000			  TEST	WORD PTR -1[DI],100000Q	; 8000h
    437	0FBE  74 EB				  JE	$LOOP
    438	0FC0  8B D5				  MOV	DX, BP	     ; длина слова
    439	0FC2  83 C7 05				  ADD	DI, 5	     ; PFA найденого слова
    440	0FC5  8B C7				  MOV	AX, DI
    441	0FC7  5F				  POP	DI	     ; восстановление содержимого регистров
    442	0FC8  5E				  POP	SI
    443	0FC9  5D				  POP	BP
    444	0FCA  2D 0002				  SUB	AX, 2	     ; CFA
    445	0FCD  50				  PUSH	AX
    446	0FCE  81 E2 00FF			  AND	DX, 377Q	; FFh выделяем байт длины и ФЛАГОВ
    447	0FD2  52				  PUSH	DX		; в стек
    448	0FD3  EB 3F				  JMP	TRUE		; Установка флага "Найдено"
    449	0FD5  5F			FAIL:	  POP	DI
    450	0FD6  5E				  POP	SI
    451	0FD7  5D				  POP	BP
    452	0FD8  EB 32				  JMP	FALSE
    453
    454						  HEAD	  85h,'DIGI',324Q,DIGIT		      ;	DIGIT
1   455	      =ARRAY:0FDA		 LINK$=$
1   456	0FDA  85			     DB	 85h  ;	NFA 7 бит равен	1.
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 9
forth.asm



1   457							 ; 6 - признак immediate. 5- слово не описано
1   458	0FDB  44 49 47 49		     DB	 'DIGI'
1   459	0FDF  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1   460	0FE0  0F6Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   461	      =ARRAY:0FDA		 LINK=LINK$
1   462	0FE2				 DIGIT LABEL FAR  ; CFA
1   463	0FE2  0FE4r			     DW	 $+2
    464					; ASCII-DIGIT BASE=>DIGIT-VALUE	TRUE (FALSE)
    465	0FE4  58				  POP	AX	; AX=BASE
    466	0FE5  59				  POP	CX
    467	0FE6  83 E9 30				  SUB	CX, 60Q	; VALID	DIGIT =	ASCII-60
    468	0FE9  7C 21				  JL	FALSE
    469	0FEB  83 F9 09				  CMP	CX, 9	; Если >9
    470	0FEE  7E 08				  JLE	M09
    471	0FF0  83 E9 07				  SUB	CX, 7
    472	0FF3  83 F9 0A				  CMP	CX, 10
    473	0FF6  7C 14				  JL	FALSE
    474	0FF8  3B C8			M09:	  CMP	CX, AX	; Если не меньше BASE, то ошибка
    475	0FFA  7D 10				  JGE	FALSE
    476	0FFC  51				  PUSH	CX	; Запись цифры в стек
    477	0FFD  EB 15				  JMP	TRUE	; "Успешный" выход
    478
    479					;	  **  Стандартные слова	 **
    480					;	  **  Условные операторы  **
    481
    482						  HEAD	  82h,'0',275Q,ZEQU		      ;	0=
1   483	      =ARRAY:0FFF		 LINK$=$
1   484	0FFF  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   485							 ; 6 - признак immediate. 5- слово не описано
1   486	1000  30			     DB	 '0'
1   487	1001  BD			     DB	 275Q	; последний символ слова + 128 (7 бит =	1).
1   488	1002  0FDAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   489	      =ARRAY:0FFF		 LINK=LINK$
1   490	1004				 ZEQU LABEL FAR	 ; CFA
1   491	1004  1006r			     DW	 $+2
    492	1006  58				  POP	AX
    493	1007  3D 0000				  CMP	AX,  0
    494	100A  74 08				  JE	TRUE
    495	100C  2B C0			FALSE:	  SUB	AX,  AX
    496	100E  50			PUT:	  PUSH	AX
    497						  NEXT
1   498
1   499	100F  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   500	1010  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   501	1012  FF 27			     JMP WORD PTR [BX] ;
    502	1014  B8 0001			TRUE:	  MOV	AX,  1
    503	1017  EB F5				  JMP	PUT
    504
    505						  HEAD	  82h,'0',276Q,ZGRET		      ;	0>
1   506	      =ARRAY:1019		 LINK$=$
1   507	1019  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   508							 ; 6 - признак immediate. 5- слово не описано
1   509	101A  30			     DB	 '0'
1   510	101B  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1   511	101C  0FFFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   512	      =ARRAY:1019		 LINK=LINK$
1   513	101E				 ZGRET LABEL FAR  ; CFA
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 10
forth.asm



1   514	101E  1020r			     DW	 $+2
    515	1020  58				  POP	AX
    516	1021  3D 0000				  CMP	AX, 0
    517	1024  7F EE				  JG	TRUE
    518	1026  EB E4				  JMP	FALSE
    519
    520						  HEAD	  82h,'0',274Q,ZLESS		      ;	0<
1   521	      =ARRAY:1028		 LINK$=$
1   522	1028  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   523							 ; 6 - признак immediate. 5- слово не описано
1   524	1029  30			     DB	 '0'
1   525	102A  BC			     DB	 274Q	; последний символ слова + 128 (7 бит =	1).
1   526	102B  1019r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   527	      =ARRAY:1028		 LINK=LINK$
1   528	102D				 ZLESS LABEL FAR  ; CFA
1   529	102D  102Fr			     DW	 $+2
    530	102F  58				  POP	AX
    531	1030  3D 0000				  CMP	AX, 0
    532	1033  78 DF				  JS	TRUE	     ; Если минус
    533	1035  EB D5				  JMP	FALSE
    534
    535						  HEAD	  81h,,275Q,EQUAL		      ;	=
1   536	      =ARRAY:1037		 LINK$=$
1   537	1037  81			     DB	 81h  ;	NFA 7 бит равен	1.
1   538							 ; 6 - признак immediate. 5- слово не описано
1   539	1038  BD			     DB	 275Q	; последний символ слова + 128 (7 бит =	1).
1   540	1039  1028r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   541	      =ARRAY:1037		 LINK=LINK$
1   542	103B				 EQUAL LABEL FAR  ; CFA
1   543	103B  103Dr			     DW	 $+2
    544	103D  58				  POP	AX
    545	103E  59				  POP	CX
    546	103F  3B C8				  CMP	CX, AX
    547	1041  74 D1				  JE	TRUE
    548	1043  EB C7				  JMP	FALSE
    549
    550						  HEAD	  82h,'U',274Q,ULESS		      ;	U<
1   551	      =ARRAY:1045		 LINK$=$
1   552	1045  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   553							 ; 6 - признак immediate. 5- слово не описано
1   554	1046  55			     DB	 'U'
1   555	1047  BC			     DB	 274Q	; последний символ слова + 128 (7 бит =	1).
1   556	1048  1037r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   557	      =ARRAY:1045		 LINK=LINK$
1   558	104A				 ULESS LABEL FAR  ; CFA
1   559	104A  104Cr			     DW	 $+2
    560	104C  58				  POP	AX
    561	104D  59				  POP	CX
    562	104E  3B C8				  CMP	CX, AX
    563	1050  72 C2				  JB	TRUE	       ; для чисел без знака
    564	1052  EB B8				  JMP	FALSE
    565
    566						  HEAD	  81h,,274Q,LESS		      ;	<
1   567	      =ARRAY:1054		 LINK$=$
1   568	1054  81			     DB	 81h  ;	NFA 7 бит равен	1.
1   569							 ; 6 - признак immediate. 5- слово не описано
1   570	1055  BC			     DB	 274Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 11
forth.asm



1   571	1056  1045r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   572	      =ARRAY:1054		 LINK=LINK$
1   573	1058				 LESS LABEL FAR	 ; CFA
1   574	1058  105Ar			     DW	 $+2
    575	105A  58				  POP	AX
    576	105B  59				  POP	CX
    577	105C  3B C1				  CMP	AX, CX
    578	105E  7F B4				  JG	TRUE
    579	1060  EB AA				  JMP	FALSE
    580
    581						  HEAD	  81h,,276Q,GREAT		      ;	>
1   582	      =ARRAY:1062		 LINK$=$
1   583	1062  81			     DB	 81h  ;	NFA 7 бит равен	1.
1   584							 ; 6 - признак immediate. 5- слово не описано
1   585	1063  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1   586	1064  1054r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   587	      =ARRAY:1062		 LINK=LINK$
1   588	1066				 GREAT LABEL FAR  ; CFA
1   589	1066  1068r			     DW	 $+2
    590	1068  58				  POP	AX
    591	1069  59				  POP	CX
    592	106A  3B C1				  CMP	AX, CX
    593	106C  7C A6				      JL    TRUE
    594	106E  EB 9C				  JMP	FALSE
    595
    596						 HEAD	  84h,'EVE', 'N'+80h, $EVEN	      ;	EVEN
1   597	      =ARRAY:1070		 LINK$=$
1   598	1070  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   599							 ; 6 - признак immediate. 5- слово не описано
1   600	1071  45 56 45			     DB	 'EVE'
1   601	1074  CE			     DB	 'N'+80h   ; последний символ слова + 128 (7 бит = 1).
1   602	1075  1062r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   603	      =ARRAY:1070		 LINK=LINK$
1   604	1077				 $EVEN LABEL FAR  ; CFA
1   605	1077  1079r			     DW	 $+2
    606					 ; проверка на четность
    607	1079  58				 pop ax
    608	107A  A9 0001				 test ax, 1
    609	107D  74 95				 jz true
    610	107F  EB 8B				 jmp false
    611
    612					;	  ******************
    613
    614						  HEAD	  84h,'ENC',314Q,ENCL		      ;	ENCLOSE
1   615	      =ARRAY:1081		 LINK$=$
1   616	1081  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   617							 ; 6 - признак immediate. 5- слово не описано
1   618	1082  45 4E 43			     DB	 'ENC'
1   619	1085  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1   620	1086  1070r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   621	      =ARRAY:1081		 LINK=LINK$
1   622	1088				 ENCL LABEL FAR	 ; CFA
1   623	1088  108Ar			     DW	 $+2
    624					 ; addr1 c -- addr1 n1 n2 n3
    625	108A  58				  POP	AX	   ; разделитель
    626	108B  59				  POP	CX	   ; начальный адрес
    627	108C  8B D9				  MOV	BX, CX
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 12
forth.asm



    628	108E  38 07			A:	  CMP	BYTE PTR  [BX],	AL ; обход разделителей	в начале
    629	1090  75 03				  JNE	NOTEQ
    630	1092  43			AAA1:	  INC	BX
    631	1093  EB F9				  JMP	A
    632	1095  80 3F 0D			NOTEQ:	  CMP	BYTE PTR  [BX],	15Q ; обход перевода строки
    633	1098  74 F8				  JE	AAA1
    634	109A  80 3F 0A				  CMP	BYTE PTR  [BX],	12Q
    635	109D  74 F3				  JE	AAA1		     ; обход перевода строки
    636	109F  8B D3				  MOV	DX, BX		     ; начало лексемы
    637	10A1  52				  PUSH	DX
    638	10A2  80 3F 00			AA:	  CMP	BYTE PTR  [BX],	 0
    639	10A5  74 15				  JE	ZZZ		     ; если нуль
    640	10A7  38 07				  CMP	BYTE PTR  [BX],	AL   ; не нуль,	ищем конец лексемы
    641	10A9  74 03				  JE	EQW
    642	10AB  43				  INC	BX
    643	10AC  EB F4				  JMP	AA
    644	10AE  8B C3			EQW:	  MOV	AX, BX
    645	10B0  2B DA				  SUB	BX, DX
    646	10B2  53				  PUSH	BX
    647	10B3  2B C1				  SUB	AX, CX
    648	10B5  40				  INC	AX
    649	10B6  50				  PUSH	AX
    650						  NEXT		     ; выход из	слова
1   651
1   652	10B7  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   653	10B8  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   654	10BA  FF 27			     JMP WORD PTR [BX] ;
    655
    656	10BC  3B DA			ZZZ:	  CMP	BX, DX
    657	10BE  75 EE				  JNE	EQW
    658	10C0  43				  INC	BX
    659	10C1  EB EB				  JMP	EQW
    660
    661					 ;	   ** Дисплей **
    662
    663						  HEAD	  84h,'PAG',305Q,$PAGE		      ;	PAGE
1   664	      =ARRAY:10C3		 LINK$=$
1   665	10C3  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   666							 ; 6 - признак immediate. 5- слово не описано
1   667	10C4  50 41 47			     DB	 'PAG'
1   668	10C7  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1   669	10C8  1081r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   670	      =ARRAY:10C3		 LINK=LINK$
1   671	10CA				 $PAGE LABEL FAR  ; CFA
1   672	10CA  10CCr			     DW	 $+2
    673					 ; Установка активной страницы ( PAGE --)
    674	10CC  58				  POP	AX
    675					 ; вход:  AL = номер страницы (большинство программ использует страницу	0)
    676	10CD  B4 05				  MOV	AH, 5
    677	10CF  CD 10				  INT	10h
    678						  NEXT
1   679
1   680	10D1  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   681	10D2  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   682	10D4  FF 27			     JMP WORD PTR [BX] ;
    683
    684						  HEAD	  83h,'PI',330Q,PIX		      ;	PIX
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 13
forth.asm



1   685	      =ARRAY:10D6		 LINK$=$
1   686	10D6  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   687							 ; 6 - признак immediate. 5- слово не описано
1   688	10D7  50 49			     DB	 'PI'
1   689	10D9  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1   690	10DA  10C3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   691	      =ARRAY:10D6		 LINK=LINK$
1   692	10DC				 PIX LABEL FAR	; CFA
1   693	10DC  10DEr			     DW	 $+2
    694					 ; COLCOD ROW COLUMN -->  -    запись графической точки
    695	10DE  59				  POP	CX		    ; колонка
    696	10DF  5B				  POP	BX		    ; строка
    697	10E0  58				  POP	AX		    ; код цветности
    698	10E1  52				  PUSH	DX		    ; сохранение DX
    699	10E2  8B D3				  MOV	DX, BX		    ; BH = номер видео страницы	??? где
    700	10E4  2A F6				  SUB	DH, DH
    701	10E6  50				  push	 ax
    702	10E7  B4 0F				  MOV	AH, 0Fh		    ; Чтение текущей страницы
    703	10E9  CD 10				  INT	10h		    ; в	BH
    704	10EB  58				  pop	 ax		    ; код цветности
    705	10EC  B4 0C				  MOV	AH, 0Ch		    ;
    706	10EE  CD 10				  INT	10h		    ; запись графической точки
    707	10F0  5A				  POP	DX		    ; восстановление DX
    708						  NEXT
1   709
1   710	10F1  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   711	10F2  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   712	10F4  FF 27			     JMP WORD PTR [BX] ;
    713
    714						  HEAD	  84h,'MOD','A'+80h,MODA		 ; MODA
1   715	      =ARRAY:10F6		 LINK$=$
1   716	10F6  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   717							 ; 6 - признак immediate. 5- слово не описано
1   718	10F7  4D 4F 44			     DB	 'MOD'
1   719	10FA  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1   720	10FB  10D6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   721	      =ARRAY:10F6		 LINK=LINK$
1   722	10FD				 MODA LABEL FAR	 ; CFA
1   723	10FD  10FFr			     DW	 $+2
    724					 ; установка режима. ( М --> - )
    725	10FF  58				  POP	AX
    726	1100  2A E4				  SUB	AH, AH	     ; 00H уст.	видео режим. Очистить экран
    727								     ;	установить поля	BIOS, установить режим.
    728	1102  CD 10				  INT	 10h
    729						  NEXT
1   730
1   731	1104  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   732	1105  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   733	1107  FF 27			     JMP WORD PTR [BX] ;
    734
    735						  HEAD	  83h,'EM',311Q,EMI$		      ;	EMI
1   736	      =ARRAY:1109		 LINK$=$
1   737	1109  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   738							 ; 6 - признак immediate. 5- слово не описано
1   739	110A  45 4D			     DB	 'EM'
1   740	110C  C9			     DB	 311Q	; последний символ слова + 128 (7 бит =	1).
1   741	110D  10F6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 14
forth.asm



1   742	      =ARRAY:1109		 LINK=LINK$
1   743	110F				 EMI$ LABEL FAR	 ; CFA
1   744	110F  1111r			     DW	 $+2
    745	1111  59				  POP	CX		; Число	символов
    746	1112  58				  POP	AX		; Символ
    747	1113  51				  PUSH	CX		; Сохранение содержимого CX
    748	1114  50				  PUSH	AX		; Сохранение содержимого AХ
    749	1115  8B 5D 1A				  MOV	BX, [DI+32Q]	; Установка атрибута
    750	1118  B4 0F				  MOV	AH, 0Fh		; Чтение текущей страницы
    751	111A  CD 10				  INT	10h		; в BH
    752	111C  58				  POP	AX		; Восстановление содержимого AX
    753	111D  B4 09				  MOV	AH, 9		; Запись строки	символов
    754	111F  CD 10				  INT	10h
    755	1121  B4 03				  MOV	AH, 3		; Чтение положения курсора
    756	1123  CD 10				  INT	10h
    757	1125  59				  POP	CX
    758	1126  02 D1				  ADD	DL, CL		; DH,DL	= строка, колонка (считая от 0)
    759	1128  B4 02				  MOV	AH, 2		; Установка положения курсора
    760	112A  CD 10			$EM:	  INT	10h
    761	112C  83 7D 22 00			  CMP	WORD PTR [DI+42Q], 0  ;	сброс флага печати
    762	1130  75 19				  JNE	PRINT
    763	1132				OK:	  NEXT
1   764
1   765	1132  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   766	1133  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   767	1135  FF 27			     JMP WORD PTR [BX] ;
    768
    769						  HEAD	  84h,'EMI',324Q,EMIT,$EMIT	      ;	EMIT
1   770	      =ARRAY:1137		 LINK$=$
1   771	1137  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   772							 ; 6 - признак immediate. 5- слово не описано
1   773	1138  45 4D 49			     DB	 'EMI'
1   774	113B  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1   775	113C  1109r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   776	      =ARRAY:1137		 LINK=LINK$
1   777	113E				 EMIT LABEL FAR	 ; CFA
1   778	113E  1140r			     DW	$EMIT
    779					 ; вывод текста	без атрибутов (по умолчанию)
    780	1140				$EMIT	  LABEL	  FAR
    781	1140  58				  POP	AX
    782	1141  50			ENT$:	  PUSH	AX
    783	1142  B4 0F				  MOV	AH, 15	     ; Чтение текущей страницы
    784	1144  CD 10				  INT	10h
    785	1146  58				  POP	AX
    786	1147  B4 0E				  MOV	AH, 14	     ;
    787	1149  EB DF				  JMP	$EM
    788
    789	114B  BA 0000			PRINT:	  MOV	DX, 0	; Установка номера принтера
    790	114E  2A E4				  SUB	AH, AH
    791	1150  CD 17				  INT	17h
    792	1152  F6 C4 29				  TEST	 AH, 29h
    793	1155  74 DB				  JE	OK
    794	1157  8A C4			ERR4:	  MOV	AL, AH
    795	1159  04 30				  ADD	AL, 60Q
    796	115B  B4 0E				  MOV	AH, 14
    797	115D  CD 10				  INT	10h
    798	115F  BA 1168r				  MOV	DX, OFFSET ERMES4
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 15
forth.asm



    799	1162  B4 09				  MOV	AH, 9H
    800	1164  CD 21				  INT	21H
    801	1166  EB 4D				  JMP	TYPE$
    802	1168  20 50 52 49 4E 54	45+	ERMES4	  DB   " PRINTER ERROR $" ;
    803	      52 20 45 52 52 4F	52+
    804	      20 24
    805
    806						  HEAD	  82h,'R',303Q,RC		      ;	RC
1   807	      =ARRAY:1178		 LINK$=$
1   808	1178  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   809							 ; 6 - признак immediate. 5- слово не описано
1   810	1179  52			     DB	 'R'
1   811	117A  C3			     DB	 303Q	; последний символ слова + 128 (7 бит =	1).
1   812	117B  1137r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   813	      =ARRAY:1178		 LINK=LINK$
1   814	117D				 RC LABEL FAR  ; CFA
1   815	117D  117Fr			     DW	 $+2
    816	117F  B8 000D				  MOV	AX, 13
    817	1182  EB BD				  JMP	ENT$
    818
    819						  HEAD	  82h,'I',314Q,IL		      ;	BELL
1   820	      =ARRAY:1184		 LINK$=$
1   821	1184  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   822							 ; 6 - признак immediate. 5- слово не описано
1   823	1185  49			     DB	 'I'
1   824	1186  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1   825	1187  1178r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   826	      =ARRAY:1184		 LINK=LINK$
1   827	1189				 IL LABEL FAR  ; CFA
1   828	1189  118Br			     DW	 $+2
    829	118B  B8 0007				  MOV	AX, 7
    830	118E  EB B1				  JMP	ENT$
    831
    832						  HEAD	  84h,'PRI',316Q,PRIN		  ; PRINT-FLAG
1   833	      =ARRAY:1190		 LINK$=$
1   834	1190  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   835							 ; 6 - признак immediate. 5- слово не описано
1   836	1191  50 52 49			     DB	 'PRI'
1   837	1194  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1   838	1195  1184r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   839	      =ARRAY:1190		 LINK=LINK$
1   840	1197				 PRIN LABEL FAR	 ; CFA
1   841	1197  1199r			     DW	 $+2
    842	1199  FF 45 22				  INC	WORD PTR  [DI+42Q]
    843	119C  BA 0000				  MOV	DX,  0	     ; Установка номера	принтера
    844	119F  B4 01				  MOV	AH,  1	     ; Инициализация принтера
    845	11A1  CD 17				  INT	17H
    846	11A3  F6 C4 29				  TEST	AH,  29h
    847	11A6  75 AF				  JNE	ERR4
    848						  NEXT
1   849
1   850	11A8  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   851	11A9  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   852	11AB  FF 27			     JMP WORD PTR [BX] ;
    853
    854						  HEAD	  83h,'TT',331Q,TTY		 ; TERMI-FLAG
1   855	      =ARRAY:11AD		 LINK$=$
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 16
forth.asm



1   856	11AD  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   857							 ; 6 - признак immediate. 5- слово не описано
1   858	11AE  54 54			     DB	 'TT'
1   859	11B0  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1   860	11B1  1190r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   861	      =ARRAY:11AD		 LINK=LINK$
1   862	11B3				 TTY LABEL FAR	; CFA
1   863	11B3  11B5r			     DW	 $+2
    864	11B5  C7 45 22 0000		TYPE$:	  MOV	WORD PTR [DI+42Q],0
    865						  NEXT
1   866
1   867	11BA  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   868	11BB  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   869	11BD  FF 27			     JMP WORD PTR [BX] ;
    870
    871						  HEAD	  83h,'SC',314Q,SCL		      ;	SCL
1   872	      =ARRAY:11BF		 LINK$=$
1   873	11BF  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   874							 ; 6 - признак immediate. 5- слово не описано
1   875	11C0  53 43			     DB	 'SC'
1   876	11C2  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1   877	11C3  11ADr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   878	      =ARRAY:11BF		 LINK=LINK$
1   879	11C5				 SCL LABEL FAR	; CFA
1   880	11C5  11C7r			     DW	 $+2
    881					; SCREEN CLEAR
    882	11C7  B9 0800				  MOV	CX, 2048     ; Загрузка	счетчика
    883	11CA  B4 0F				  MOV	AH, 15
    884	11CC  CD 10				  INT	10h	      ;	Установка текущей страницы
    885	11CE  2B D2				  SUB	DX, DX	     ;	DH,DL =	строка,	колонка	(считая	от 0)
    886	11D0  B4 02				  MOV	AH, 2	     ; Курсор в	исходное положение
    887	11D2  CD 10				  INT	10h
    888	11D4  B3 07				  MOV	BL, 7	     ; атрибут
    889					 ; 09H писать символ/атрибут в текущей позиции курсора
    890	11D6  B8 0920			CLEAR:	  MOV	AX, 0920H    ; Очистка экрана AL = записываемый	символ
    891	11D9  CD 10				  INT	10h
    892						  NEXT
1   893
1   894	11DB  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   895	11DC  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   896	11DE  FF 27			     JMP WORD PTR [BX] ;
    897
    898						  HEAD	  83h,'FI',330Q,FIX		      ;	FIX
1   899	      =ARRAY:11E0		 LINK$=$
1   900	11E0  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   901							 ; 6 - признак immediate. 5- слово не описано
1   902	11E1  46 49			     DB	 'FI'
1   903	11E3  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1   904	11E4  11BFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   905	      =ARRAY:11E0		 LINK=LINK$
1   906	11E6				 FIX LABEL FAR	; CFA
1   907	11E6  11E8r			     DW	 $+2
    908					; Позиционирование курсора: COL	ROW FIX
    909	11E8  B4 0F				  MOV	AH, 0Fh
    910	11EA  CD 10				  INT	10h	 ; Запись текущего номера страницы в BX
    911	11EC  5A				  POP	DX
    912	11ED  8A F2				  MOV	DH, DL	 ; строка
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 17
forth.asm



    913	11EF  58				  POP	AX
    914
    915	11F0  8A D0				  MOV	DL, AL	 ; столбец
    916	11F2  B4 02				  MOV	AH, 2	 ; уст.	позицию	курсора. установка
    917								 ; на строку 25	делает курсор невидимым.
    918	11F4  CD 10				  INT	10h	 ; Фиксация положения курсора
    919						  NEXT
1   920
1   921	11F6  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   922	11F7  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   923	11F9  FF 27			     JMP WORD PTR [BX] ;
    924
    925						  HEAD	  84h,'DSP',314Q,DSPL		      ;	DSPL
1   926	      =ARRAY:11FB		 LINK$=$
1   927	11FB  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   928							 ; 6 - признак immediate. 5- слово не описано
1   929	11FC  44 53 50			     DB	 'DSP'
1   930	11FF  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1   931	1200  11E0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   932	      =ARRAY:11FB		 LINK=LINK$
1   933	1202				 DSPL LABEL FAR	 ; CFA
1   934	1202  1204r			     DW	 $+2
    935					; LOAD GRAFBUFFER (b adr DSPL)
    936					 ; записывает байт в графическую память
    937	1204  5B				  POP	BX  ; адрес
    938	1205  58				  POP	AX  ; байт
    939	1206  06				  PUSH	ES  ; сохранение регистра сегмента
    940	1207  B9 B000				  MOV	CX, 0B000H ; GRAFBUF
    941	120A  8E C1				  MOV	ES, CX
    942	120C  26: 88 07				  MOV	BYTE PTR ES:[BX], AL
    943	120F  07				  POP	ES
    944						  NEXT
1   945
1   946	1210  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   947	1211  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   948	1213  FF 27			     JMP WORD PTR [BX] ;
    949
    950					;	  ** Терминал **
    951
    952						  HEAD	  83h,'KE',331Q,KEY		      ;	KEY
1   953	      =ARRAY:1215		 LINK$=$
1   954	1215  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   955							 ; 6 - признак immediate. 5- слово не описано
1   956	1216  4B 45			     DB	 'KE'
1   957	1218  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1   958	1219  11FBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   959	      =ARRAY:1215		 LINK=LINK$
1   960	121B				 KEY LABEL FAR	; CFA
1   961	121B  121Dr			     DW	 $+2
    962					     ; читать (ожидать)	следующую нажатую клавишу
    963					     ; выход: AL = ASCII символ	(если AL=0, AH содержит	расширенный код	ASCII )
    964					     ; AH = сканкод  или расширенный код ASCII
    965	121D  2A E4				  SUB	AH, AH
    966	121F  CD 16				  INT	16h
    967	1221  2A E4				  SUB	AH, AH
    968	1223  50				  PUSH	AX
    969						  NEXT
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 18
forth.asm



1   970
1   971	1224  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   972	1225  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   973	1227  FF 27			     JMP WORD PTR [BX] ;
    974
    975						  HEAD	  86h,'EXPEC',324Q,EXPE		      ;	EXPECT
1   976	      =ARRAY:1229		 LINK$=$
1   977	1229  86			     DB	 86h  ;	NFA 7 бит равен	1.
1   978							 ; 6 - признак immediate. 5- слово не описано
1   979	122A  45 58 50 45 43		     DB	 'EXPEC'
1   980	122F  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1   981	1230  1215r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   982	      =ARRAY:1229		 LINK=LINK$
1   983	1232				 EXPE LABEL FAR	 ; CFA
1   984	1232  1234r			     DW	 $+2
    985					     ; adr n ->
    986	1234  B4 0A				  MOV	AH, 0AH		     ;	ввод строки в буфер
    987	1236  59				  POP	CX		     ; Число символов
    988	1237  5B				  POP	BX		     ; Адрес буфера SS
    989	1238  88 0F				  MOV	BYTE PTR [BX],	CL   ; Засылка ожидаемого числа
    990	123A  8B D3				  MOV	DX, BX
    991	123C  CD 21				  INT	21h
    992
    993	123E  8A 47 01				  MOV	AL, BYTE PTR [BX+1]  ; фактически введено символов
    994	1241  2A E4				  SUB	AH, AH		     ;
    995	1243  03 D8				  ADD	BX, AX		     ; адрес конца строки
    996	1245  C7 47 02 0000			  MOV	WORD PTR [BX+2],0    ; +2, т.к.	в начале строки	мах длина
    997									     ; и число введенных символов
    998						  NEXT
1   999
1  1000	124A  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1001	124B  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1002	124D  FF 27			     JMP WORD PTR [BX] ;
   1003
   1004						  HEAD	  85h,'?TER',244Q,?TER$		      ;	?TER$
1  1005	      =ARRAY:124F		 LINK$=$
1  1006	124F  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  1007							 ; 6 - признак immediate. 5- слово не описано
1  1008	1250  3F 54 45 52		     DB	 '?TER'
1  1009	1254  A4			     DB	 244Q	; последний символ слова + 128 (7 бит =	1).
1  1010	1255  1229r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1011	      =ARRAY:124F		 LINK=LINK$
1  1012	1257				 ?TER$ LABEL FAR  ; CFA
1  1013	1257  1259r			     DW	 $+2
   1014	1259  06				  PUSH	ES
   1015	125A  2B C9				  SUB	CX, CX
   1016	125C  8E C1				  MOV	ES, CX
   1017	125E  26: 80 0E	0417 20			  OR	BYTE PTR ES:[417H],  40Q
   1018	1264  B4 01			TER:	  MOV	AH, 1	 ; проверить готовность	символа	(и показать его, если так)
   1019								 ; выход: ZF = 1 если символ не	готов.
   1020								 ; ZF =	0 если символ готов.
   1021								 ; AX =	как для	подфункции 00H (но символ здесь	не
   1022								 ; удаляется из	очереди).
   1023	1266  CD 16				  INT	16h
   1024	1268  74 FA				  JE	TER
   1025	126A  2A E4				  SUB	AH, AH	 ; читать (ожидать) следующую нажатую клавишу
   1026	126C  CD 16				  INT	16h
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 19
forth.asm



   1027	126E  26: 80 26	0417 DF			  AND	BYTE PTR ES:[417H],337Q	 ; Сброс 'NUM LOCK'
   1028	1274  07				  POP	ES		; Восстановление ES
   1029	1275  50				  PUSH	AX		; Запись символа
   1030						  NEXT
1  1031
1  1032	1276  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1033	1277  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1034	1279  FF 27			     JMP WORD PTR [BX] ;
   1035
   1036					; ** Ввод/Вывод	**
   1037
   1038						  HEAD	  84h,'POR',324Q,PORT		      ;	PORT
1  1039	      =ARRAY:127B		 LINK$=$
1  1040	127B  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1041							 ; 6 - признак immediate. 5- слово не описано
1  1042	127C  50 4F 52			     DB	 'POR'
1  1043	127F  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  1044	1280  124Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1045	      =ARRAY:127B		 LINK=LINK$
1  1046	1282				 PORT LABEL FAR	 ; CFA
1  1047	1282  1284r			     DW	 $+2
   1048	1284  5A				  POP	DX
   1049	1285  58				  POP	AX
   1050	1286  EE				  OUT	DX, AL
   1051						  NEXT
1  1052
1  1053	1287  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1054	1288  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1055	128A  FF 27			     JMP WORD PTR [BX] ;
   1056
   1057						  HEAD	  84h,'REA',304Q,READ		      ;	READ
1  1058	      =ARRAY:128C		 LINK$=$
1  1059	128C  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1060							 ; 6 - признак immediate. 5- слово не описано
1  1061	128D  52 45 41			     DB	 'REA'
1  1062	1290  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  1063	1291  127Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1064	      =ARRAY:128C		 LINK=LINK$
1  1065	1293				 READ LABEL FAR	 ; CFA
1  1066	1293  1295r			     DW	 $+2
   1067	1295  5A				  POP	DX
   1068	1296  EC				  IN	AL, DX
   1069	1297  2A E4				  SUB	AH, AH
   1070	1299  50				  PUSH	AX
   1071						  NEXT
1  1072
1  1073	129A  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1074	129B  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1075	129D  FF 27			     JMP WORD PTR [BX] ;
   1076
   1077					;	  ** Арифметика	**
   1078
   1079						  HEAD	  82h,'1',253Q,ONEP		      ;	1+
1  1080	      =ARRAY:129F		 LINK$=$
1  1081	129F  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1082							 ; 6 - признак immediate. 5- слово не описано
1  1083	12A0  31			     DB	 '1'
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 20
forth.asm



1  1084	12A1  AB			     DB	 253Q	; последний символ слова + 128 (7 бит =	1).
1  1085	12A2  128Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1086	      =ARRAY:129F		 LINK=LINK$
1  1087	12A4				 ONEP LABEL FAR	 ; CFA
1  1088	12A4  12A6r			     DW	 $+2
   1089	12A6  58				  POP	AX
   1090	12A7  40				  INC	AX
   1091	12A8  50				  PUSH	AX
   1092						  NEXT
1  1093
1  1094	12A9  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1095	12AA  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1096	12AC  FF 27			     JMP WORD PTR [BX] ;
   1097
   1098						  HEAD	  82h,'2',253Q,TWOP		      ;	2+
1  1099	      =ARRAY:12AE		 LINK$=$
1  1100	12AE  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1101							 ; 6 - признак immediate. 5- слово не описано
1  1102	12AF  32			     DB	 '2'
1  1103	12B0  AB			     DB	 253Q	; последний символ слова + 128 (7 бит =	1).
1  1104	12B1  129Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1105	      =ARRAY:12AE		 LINK=LINK$
1  1106	12B3				 TWOP LABEL FAR	 ; CFA
1  1107	12B3  12B5r			     DW	 $+2
   1108	12B5  58				  POP	AX
   1109	12B6  05 0002				  ADD	AX, 2
   1110	12B9  50				  PUSH	AX
   1111						  NEXT
1  1112
1  1113	12BA  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1114	12BB  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1115	12BD  FF 27			     JMP WORD PTR [BX] ;
   1116
   1117						  HEAD	  82h,'1',255Q,ONEM		      ;	1-
1  1118	      =ARRAY:12BF		 LINK$=$
1  1119	12BF  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1120							 ; 6 - признак immediate. 5- слово не описано
1  1121	12C0  31			     DB	 '1'
1  1122	12C1  AD			     DB	 255Q	; последний символ слова + 128 (7 бит =	1).
1  1123	12C2  12AEr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1124	      =ARRAY:12BF		 LINK=LINK$
1  1125	12C4				 ONEM LABEL FAR	 ; CFA
1  1126	12C4  12C6r			     DW	 $+2
   1127	12C6  58				  POP	AX
   1128	12C7  48				  DEC	AX
   1129	12C8  50				  PUSH	AX
   1130						  NEXT
1  1131
1  1132	12C9  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1133	12CA  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1134	12CC  FF 27			     JMP WORD PTR [BX] ;
   1135
   1136						  HEAD	  82h,'2',252Q,MUL2		      ;	2*
1  1137	      =ARRAY:12CE		 LINK$=$
1  1138	12CE  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1139							 ; 6 - признак immediate. 5- слово не описано
1  1140	12CF  32			     DB	 '2'
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 21
forth.asm



1  1141	12D0  AA			     DB	 252Q	; последний символ слова + 128 (7 бит =	1).
1  1142	12D1  12BFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1143	      =ARRAY:12CE		 LINK=LINK$
1  1144	12D3				 MUL2 LABEL FAR	 ; CFA
1  1145	12D3  12D5r			     DW	 $+2
   1146	12D5  58				  POP	AX
   1147	12D6  D1 E0				  SAL	AX,  1
   1148	12D8  50				  PUSH	AX
   1149						  NEXT
1  1150
1  1151	12D9  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1152	12DA  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1153	12DC  FF 27			     JMP WORD PTR [BX] ;
   1154
   1155						  HEAD	  82h,'2',257Q,DIV2		      ;	2/
1  1156	      =ARRAY:12DE		 LINK$=$
1  1157	12DE  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1158							 ; 6 - признак immediate. 5- слово не описано
1  1159	12DF  32			     DB	 '2'
1  1160	12E0  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  1161	12E1  12CEr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1162	      =ARRAY:12DE		 LINK=LINK$
1  1163	12E3				 DIV2 LABEL FAR	 ; CFA
1  1164	12E3  12E5r			     DW	 $+2
   1165	12E5  58				  POP	AX
   1166	12E6  D1 F8				  SAR	AX, 1
   1167	12E8  50				  PUSH	AX
   1168						  NEXT
1  1169
1  1170	12E9  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1171	12EA  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1172	12EC  FF 27			     JMP WORD PTR [BX] ;
   1173
   1174						  HEAD	  82h, 'U', 252Q,USTAR		      ;	U*
1  1175	      =ARRAY:12EE		 LINK$=$
1  1176	12EE  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1177							 ; 6 - признак immediate. 5- слово не описано
1  1178	12EF  55			     DB	 'U'
1  1179	12F0  AA			     DB	 252Q	; последний символ слова + 128 (7 бит =	1).
1  1180	12F1  12DEr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1181	      =ARRAY:12EE		 LINK=LINK$
1  1182	12F3				 USTAR LABEL FAR  ; CFA
1  1183	12F3  12F5r			     DW	 $+2
   1184	12F5  58				  POP	AX
   1185	12F6  59				  POP	CX
   1186	12F7  F7 E1				  MUL	CX
   1187	12F9  50				  PUSH	AX
   1188	12FA  52				  PUSH	DX
   1189						  NEXT
1  1190
1  1191	12FB  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1192	12FC  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1193	12FE  FF 27			     JMP WORD PTR [BX] ;
   1194
   1195						  HEAD	  82h,'U',257Q,USLAS		      ;	U/
1  1196	      =ARRAY:1300		 LINK$=$
1  1197	1300  82			     DB	 82h  ;	NFA 7 бит равен	1.
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 22
forth.asm



1  1198							 ; 6 - признак immediate. 5- слово не описано
1  1199	1301  55			     DB	 'U'
1  1200	1302  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  1201	1303  12EEr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1202	      =ARRAY:1300		 LINK=LINK$
1  1203	1305				 USLAS LABEL FAR  ; CFA
1  1204	1305  1307r			     DW	 $+2
   1205	1307  59				  POP	CX	    ; Делитель
   1206	1308  5A				  POP	DX
   1207	1309  58				  POP	AX
   1208	130A  F7 F1				  DIV	CX
   1209	130C  52				  PUSH	DX	    ; Остаток
   1210	130D  50				  PUSH	AX	    ; Засылка  результата
   1211						  NEXT
1  1212
1  1213	130E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1214	130F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1215	1311  FF 27			     JMP WORD PTR [BX] ;
   1216
   1217						  HEAD	  82h,'M',252Q,MSTAR		      ;	M*
1  1218	      =ARRAY:1313		 LINK$=$
1  1219	1313  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1220							 ; 6 - признак immediate. 5- слово не описано
1  1221	1314  4D			     DB	 'M'
1  1222	1315  AA			     DB	 252Q	; последний символ слова + 128 (7 бит =	1).
1  1223	1316  1300r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1224	      =ARRAY:1313		 LINK=LINK$
1  1225	1318				 MSTAR LABEL FAR  ; CFA
1  1226	1318  131Ar			     DW	 $+2
   1227	131A  58				  POP	AX
   1228	131B  59				  POP	CX
   1229	131C  F7 E9				  IMUL	CX
   1230	131E  50				  PUSH	AX
   1231	131F  52				  PUSH	DX
   1232						  NEXT
1  1233
1  1234	1320  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1235	1321  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1236	1323  FF 27			     JMP WORD PTR [BX] ;
   1237
   1238						  HEAD	   86h,'DMINU',323Q,DMINU	      ;	DMINUS
1  1239	      =ARRAY:1325		 LINK$=$
1  1240	1325  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  1241							 ; 6 - признак immediate. 5- слово не описано
1  1242	1326  44 4D 49 4E 55		     DB	 'DMINU'
1  1243	132B  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  1244	132C  1313r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1245	      =ARRAY:1325		 LINK=LINK$
1  1246	132E				 DMINU LABEL FAR  ; CFA
1  1247	132E  1330r			     DW	 $+2
   1248					; Изменение знака числа	двойной	длины
   1249	1330  58				  POP  AX
   1250	1331  F7 D8			DMIN:	  NEG  AX
   1251	1333  59				  POP  CX
   1252	1334  F7 D9				  NEG  CX
   1253	1336  1D 0000				  SBB  AX, 0	   ; sub with borrow
   1254	1339  51				  PUSH CX
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 23
forth.asm



   1255	133A  50				  PUSH AX
   1256	133B				G$:	  NEXT
1  1257
1  1258	133B  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1259	133C  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1260	133E  FF 27			     JMP WORD PTR [BX] ;
   1261
   1262						 HEAD	  84h,'DAB',323Q,DABS		      ;	DABS
1  1263	      =ARRAY:1340		 LINK$=$
1  1264	1340  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1265							 ; 6 - признак immediate. 5- слово не описано
1  1266	1341  44 41 42			     DB	 'DAB'
1  1267	1344  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  1268	1345  1325r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1269	      =ARRAY:1340		 LINK=LINK$
1  1270	1347				 DABS LABEL FAR	 ; CFA
1  1271	1347  1349r			     DW	 $+2
   1272	1349  58				 POP   AX
   1273	134A  3D 0000				 CMP   AX, 0
   1274	134D  78 E2				 JS    DMIN
   1275	134F  50				 PUSH  AX
   1276						 NEXT
1  1277
1  1278	1350  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1279	1351  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1280	1353  FF 27			     JMP WORD PTR [BX] ;
   1281
   1282						 HEAD	  82h,'M',257Q,MSLAS		      ;	M/
1  1283	      =ARRAY:1355		 LINK$=$
1  1284	1355  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1285							 ; 6 - признак immediate. 5- слово не описано
1  1286	1356  4D			     DB	 'M'
1  1287	1357  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  1288	1358  1340r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1289	      =ARRAY:1355		 LINK=LINK$
1  1290	135A				 MSLAS LABEL FAR  ; CFA
1  1291	135A  135Cr			     DW	 $+2
   1292	135C  59				 POP   CX	   ; Делимое
   1293	135D  5A				 POP   DX
   1294	135E  58				 POP   AX
   1295	135F  F7 F9				 IDIV  CX
   1296	1361  52				 PUSH  DX
   1297	1362  50				 PUSH  AX
   1298						 NEXT
1  1299
1  1300	1363  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1301	1364  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1302	1366  FF 27			     JMP WORD PTR [BX] ;
   1303
   1304						 HEAD	  81h,,253Q,PLUS		      ;	+
1  1305	      =ARRAY:1368		 LINK$=$
1  1306	1368  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  1307							 ; 6 - признак immediate. 5- слово не описано
1  1308	1369  AB			     DB	 253Q	; последний символ слова + 128 (7 бит =	1).
1  1309	136A  1355r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1310	      =ARRAY:1368		 LINK=LINK$
1  1311	136C				 PLUS LABEL FAR	 ; CFA
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 24
forth.asm



1  1312	136C  136Er			     DW	 $+2
   1313	136E  58				 POP  AX
   1314	136F  59				 POP  CX
   1315	1370  03 C1				 ADD  AX, CX
   1316	1372  50				 PUSH AX
   1317						 NEXT
1  1318
1  1319	1373  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1320	1374  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1321	1376  FF 27			     JMP WORD PTR [BX] ;
   1322
   1323						 HEAD	  81h,,255Q,SUBB		       ; -
1  1324	      =ARRAY:1378		 LINK$=$
1  1325	1378  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  1326							 ; 6 - признак immediate. 5- слово не описано
1  1327	1379  AD			     DB	 255Q	; последний символ слова + 128 (7 бит =	1).
1  1328	137A  1368r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1329	      =ARRAY:1378		 LINK=LINK$
1  1330	137C				 SUBB LABEL FAR	 ; CFA
1  1331	137C  137Er			     DW	 $+2
   1332					 ; n1 n2 -> n1-n2
   1333	137E  59				 POP  CX
   1334	137F  58				 POP  AX
   1335	1380  2B C1				 SUB  AX, CX
   1336	1382  50				 PUSH AX
   1337						 NEXT
1  1338
1  1339	1383  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1340	1384  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1341	1386  FF 27			     JMP WORD PTR [BX] ;
   1342
   1343						 HEAD	  82h,'D',253Q,DPLUS		      ;	D+
1  1344	      =ARRAY:1388		 LINK$=$
1  1345	1388  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1346							 ; 6 - признак immediate. 5- слово не описано
1  1347	1389  44			     DB	 'D'
1  1348	138A  AB			     DB	 253Q	; последний символ слова + 128 (7 бит =	1).
1  1349	138B  1378r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1350	      =ARRAY:1388		 LINK=LINK$
1  1351	138D				 DPLUS LABEL FAR  ; CFA
1  1352	138D  138Fr			     DW	 $+2
   1353	138F  58				 POP  AX
   1354	1390  59				 POP  CX
   1355	1391  8B DC				 MOV  BX, SP
   1356	1393  36: 01 4F	02			 ADD  SS:[BX+2],  CX
   1357	1397  36: 11 07				 ADC  SS:[BX],	  AX
   1358						 NEXT
1  1359
1  1360	139A  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1361	139B  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1362	139D  FF 27			     JMP WORD PTR [BX] ;
   1363
   1364						 HEAD	  85h,'MINU',323Q,MINUS		      ;	MINUS
1  1365	      =ARRAY:139F		 LINK$=$
1  1366	139F  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  1367							 ; 6 - признак immediate. 5- слово не описано
1  1368	13A0  4D 49 4E 55		     DB	 'MINU'
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 25
forth.asm



1  1369	13A4  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  1370	13A5  1388r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1371	      =ARRAY:139F		 LINK=LINK$
1  1372	13A7				 MINUS LABEL FAR  ; CFA
1  1373	13A7  13A9r			     DW	 $+2
   1374	13A9  58				 POP  AX
   1375	13AA  F7 D8				 NEG  AX
   1376	13AC  50				 PUSH AX
   1377						 NEXT
1  1378
1  1379	13AD  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1380	13AE  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1381	13B0  FF 27			     JMP WORD PTR [BX] ;
   1382
   1383						 HEAD	  84h,'SWA',302Q,SWAB		      ;	SWAB
1  1384	      =ARRAY:13B2		 LINK$=$
1  1385	13B2  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1386							 ; 6 - признак immediate. 5- слово не описано
1  1387	13B3  53 57 41			     DB	 'SWA'
1  1388	13B6  C2			     DB	 302Q	; последний символ слова + 128 (7 бит =	1).
1  1389	13B7  139Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1390	      =ARRAY:13B2		 LINK=LINK$
1  1391	13B9				 SWAB LABEL FAR	 ; CFA
1  1392	13B9  13BBr			     DW	 $+2
   1393					     ; обмен байтами слова в стеке
   1394	13BB  58				 POP  AX
   1395	13BC  86 C4				 XCHG AL, AH
   1396	13BE  50				 PUSH AX
   1397						 NEXT
1  1398
1  1399	13BF  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1400	13C0  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1401	13C2  FF 27			     JMP WORD PTR [BX] ;
   1402
   1403						 HEAD	  83h,'AB',323Q,$ABS		       ; ABS
1  1404	      =ARRAY:13C4		 LINK$=$
1  1405	13C4  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1406							 ; 6 - признак immediate. 5- слово не описано
1  1407	13C5  41 42			     DB	 'AB'
1  1408	13C7  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  1409	13C8  13B2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1410	      =ARRAY:13C4		 LINK=LINK$
1  1411	13CA				 $ABS LABEL FAR	 ; CFA
1  1412	13CA  13CCr			     DW	 $+2
   1413	13CC  58				 POP  AX
   1414	13CD  3D 0000				 CMP  AX, 0
   1415	13D0  79 02				 JNS  AB
   1416	13D2  F7 D8				 NEG  AX
   1417	13D4  50			AB:	 PUSH AX
   1418						 NEXT
1  1419
1  1420	13D5  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1421	13D6  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1422	13D8  FF 27			     JMP WORD PTR [BX] ;
   1423
   1424						 HEAD	  83h,'AN',304Q,$AND		      ;	AND
1  1425	      =ARRAY:13DA		 LINK$=$
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 26
forth.asm



1  1426	13DA  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1427							 ; 6 - признак immediate. 5- слово не описано
1  1428	13DB  41 4E			     DB	 'AN'
1  1429	13DD  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  1430	13DE  13C4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1431	      =ARRAY:13DA		 LINK=LINK$
1  1432	13E0				 $AND LABEL FAR	 ; CFA
1  1433	13E0  13E2r			     DW	 $+2
   1434	13E2  58				 POP  AX
   1435	13E3  59				 POP  CX
   1436	13E4  23 C1				 AND  AX,  CX
   1437	13E6  50			ENDA:	 PUSH AX
   1438						 NEXT
1  1439
1  1440	13E7  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1441	13E8  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1442	13EA  FF 27			     JMP WORD PTR [BX] ;
   1443
   1444						 HEAD	  82h,'O',322Q,$OR		      ;	OR
1  1445	      =ARRAY:13EC		 LINK$=$
1  1446	13EC  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1447							 ; 6 - признак immediate. 5- слово не описано
1  1448	13ED  4F			     DB	 'O'
1  1449	13EE  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  1450	13EF  13DAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1451	      =ARRAY:13EC		 LINK=LINK$
1  1452	13F1				 $OR LABEL FAR	; CFA
1  1453	13F1  13F3r			     DW	 $+2
   1454	13F3  58				 POP  AX
   1455	13F4  59				 POP  CX
   1456	13F5  0B C1				 OR   AX, CX
   1457	13F7  EB ED				 JMP  ENDA
   1458
   1459						 HEAD	  83h,'XO',322Q,$XOR		      ;	XOR
1  1460	      =ARRAY:13F9		 LINK$=$
1  1461	13F9  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1462							 ; 6 - признак immediate. 5- слово не описано
1  1463	13FA  58 4F			     DB	 'XO'
1  1464	13FC  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  1465	13FD  13ECr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1466	      =ARRAY:13F9		 LINK=LINK$
1  1467	13FF				 $XOR LABEL FAR	 ; CFA
1  1468	13FF  1401r			     DW	 $+2
   1469	1401  58				 POP  AX
   1470	1402  59				 POP  CX
   1471	1403  33 C1				 XOR  AX, CX
   1472	1405  EB DF				 JMP  ENDA
   1473
   1474						 HEAD	  84h,'S-#',304Q,STOD		      ;	S->D ; sds S->
1  1475	      =ARRAY:1407		 LINK$=$
1  1476	1407  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1477							 ; 6 - признак immediate. 5- слово не описано
1  1478	1408  53 2D 23			     DB	 'S-#'
1  1479	140B  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  1480	140C  13F9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1481	      =ARRAY:1407		 LINK=LINK$
1  1482	140E				 STOD LABEL FAR	 ; CFA
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 27
forth.asm



1  1483	140E  1410r			     DW	 $+2
   1484	1410  58				 POP  AX
   1485	1411  50				 PUSH AX
   1486	1412  8B CA				 MOV  CX, DX	       ; Сохранение содержимого	DX
   1487	1414  99				 CWD		       ; sign bit AX to	DX
   1488	1415  52				 PUSH  DX
   1489	1416  8B D1				 MOV  DX, CX	       ; Восстановление	DX
   1490						 NEXT
1  1491
1  1492	1418  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1493	1419  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1494	141B  FF 27			     JMP WORD PTR [BX] ;
   1495
   1496						 HEAD	  83h,'MI',316Q,MIN		      ;	MIN
1  1497	      =ARRAY:141D		 LINK$=$
1  1498	141D  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1499							 ; 6 - признак immediate. 5- слово не описано
1  1500	141E  4D 49			     DB	 'MI'
1  1501	1420  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  1502	1421  1407r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1503	      =ARRAY:141D		 LINK=LINK$
1  1504	1423				 MIN LABEL FAR	; CFA
1  1505	1423  1425r			     DW	 $+2
   1506	1425  58				 POP  AX
   1507	1426  59				 POP  CX
   1508	1427  3B C8				 CMP  CX,  AX
   1509	1429  7C 06				 JL  DEEP	     ;
   1510	142B  50			TOP:	 PUSH AX
   1511						 NEXT
1  1512
1  1513	142C  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1514	142D  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1515	142F  FF 27			     JMP WORD PTR [BX] ;
   1516	1431  51			DEEP:	 PUSH CX
   1517						 NEXT
1  1518
1  1519	1432  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1520	1433  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1521	1435  FF 27			     JMP WORD PTR [BX] ;
   1522
   1523						 HEAD	  83h,'MA',330Q,MAX		      ;	MAX
1  1524	      =ARRAY:1437		 LINK$=$
1  1525	1437  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1526							 ; 6 - признак immediate. 5- слово не описано
1  1527	1438  4D 41			     DB	 'MA'
1  1528	143A  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  1529	143B  141Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1530	      =ARRAY:1437		 LINK=LINK$
1  1531	143D				 MAX LABEL FAR	; CFA
1  1532	143D  143Fr			     DW	 $+2
   1533	143F  58				 POP  AX
   1534	1440  59				 POP  CX
   1535	1441  3B C8				 CMP  CX, AX
   1536	1443  7D EC				 JGE  DEEP
   1537	1445  EB E4				 JMP  TOP
   1538
   1539						 HEAD	  83h,'SP',300Q,SPAT		      ;	SP@
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 28
forth.asm



1  1540	      =ARRAY:1447		 LINK$=$
1  1541	1447  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1542							 ; 6 - признак immediate. 5- слово не описано
1  1543	1448  53 50			     DB	 'SP'
1  1544	144A  C0			     DB	 300Q	; последний символ слова + 128 (7 бит =	1).
1  1545	144B  1437r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1546	      =ARRAY:1447		 LINK=LINK$
1  1547	144D				 SPAT LABEL FAR	 ; CFA
1  1548	144D  144Fr			     DW	 $+2
   1549					     ; значение	текущего указателя регистра SP в стек
   1550	144F  8B C4				 MOV  AX, SP
   1551	1451  EB 93				 JMP  ENDA
   1552
   1553						 HEAD	  83h,'SP',241Q,SPSTO		      ;	SP!
1  1554	      =ARRAY:1453		 LINK$=$
1  1555	1453  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1556							 ; 6 - признак immediate. 5- слово не описано
1  1557	1454  53 50			     DB	 'SP'
1  1558	1456  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  1559	1457  1447r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1560	      =ARRAY:1453		 LINK=LINK$
1  1561	1459				 SPSTO LABEL FAR  ; CFA
1  1562	1459  145Br			     DW	 $+2
   1563	145B  8B 65 06				 MOV  SP, [DI+6]			     ; 80h
   1564						 NEXT
1  1565
1  1566	145E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1567	145F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1568	1461  FF 27			     JMP WORD PTR [BX] ;
   1569
   1570						 HEAD	  83h,'RP',241Q,RPSTO		      ;	RP!
1  1571	      =ARRAY:1463		 LINK$=$
1  1572	1463  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1573							 ; 6 - признак immediate. 5- слово не описано
1  1574	1464  52 50			     DB	 'RP'
1  1575	1466  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  1576	1467  1453r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1577	      =ARRAY:1463		 LINK=LINK$
1  1578	1469				 RPSTO LABEL FAR  ; CFA
1  1579	1469  146Br			     DW	 $+2
   1580	146B  8B 2E 0DA2r			 MOV  BP, $RS				     ; ccch
   1581						 NEXT
1  1582
1  1583	146F  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1584	1470  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1585	1472  FF 27			     JMP WORD PTR [BX] ;
   1586
   1587						 HEAD	  82h,';',323Q,SEMI		      ;	;S
1  1588	      =ARRAY:1474		 LINK$=$
1  1589	1474  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1590							 ; 6 - признак immediate. 5- слово не описано
1  1591	1475  3B			     DB	 ';'
1  1592	1476  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  1593	1477  1463r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1594	      =ARRAY:1474		 LINK=LINK$
1  1595	1479				 SEMI LABEL FAR	 ; CFA
1  1596	1479  147Br			     DW	 $+2
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 29
forth.asm



   1597					     ; переход на слово	по адресу в стеке возврата СЛОЖНО
   1598					     ; слово,которым заканчивается слова на форте
   1599	147B  8B 76 00				 MOV  SI, [BP] ; в RS хранится адрес прошлого слова SI
   1600	147E  83 C5 02				 ADD  BP, 2 ; удаляем из RS
   1601						 NEXT ;	 возврат на предыдущее слово
1  1602
1  1603	1481  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1604	1482  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1605	1484  FF 27			     JMP WORD PTR [BX] ;
   1606
   1607					;	 ** Стек возвратов **
   1608
   1609						 HEAD	  85h, 'LEAV',305Q,LEAV		       ; LEAVE
1  1610	      =ARRAY:1486		 LINK$=$
1  1611	1486  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  1612							 ; 6 - признак immediate. 5- слово не описано
1  1613	1487  4C 45 41 56		     DB	 'LEAV'
1  1614	148B  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  1615	148C  1474r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1616	      =ARRAY:1486		 LINK=LINK$
1  1617	148E				 LEAV LABEL FAR	 ; CFA
1  1618	148E  1490r			     DW	 $+2
   1619					     ; надо смотреть дальше с хранением	адресов
   1620					     ; приравнивает значения индекса и предела
   1621	1490  8B 46 00				     MOV  AX, [BP]
   1622	1493  89 46 02				 MOV  [BP+2], AX
   1623						 NEXT
1  1624
1  1625	1496  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1626	1497  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1627	1499  FF 27			     JMP WORD PTR [BX] ;
   1628
   1629						 HEAD	  82h, 62,322Q,TOR		      ;	>R sds
1  1630	      =ARRAY:149B		 LINK$=$
1  1631	149B  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1632							 ; 6 - признак immediate. 5- слово не описано
1  1633	149C  3E			     DB	 62
1  1634	149D  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  1635	149E  1486r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1636	      =ARRAY:149B		 LINK=LINK$
1  1637	14A0				 TOR LABEL FAR	; CFA
1  1638	14A0  14A2r			     DW	 $+2
   1639					     ; пишем в стек возвратов
   1640					     ; слово из	стека данных
   1641	14A2  83 ED 02				 SUB  BP, 2 ; заняли ячейку
   1642	14A5  8F 46 00				 POP  [BP]   ; записали	значение
   1643						 NEXT
1  1644
1  1645	14A8  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1646	14A9  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1647	14AB  FF 27			     JMP WORD PTR [BX] ;
   1648
   1649						     HEAD     82h, 'R',276Q,FROMR		   ; R>
1  1650	      =ARRAY:14AD		 LINK$=$
1  1651	14AD  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1652							 ; 6 - признак immediate. 5- слово не описано
1  1653	14AE  52			     DB	 'R'
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 30
forth.asm



1  1654	14AF  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1  1655	14B0  149Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1656	      =ARRAY:14AD		 LINK=LINK$
1  1657	14B2				 FROMR LABEL FAR  ; CFA
1  1658	14B2  14B4r			     DW	 $+2
   1659					     ; в стек данных слово по адресу из	стека возвратов
   1660	14B4  FF 76 00				     PUSH [BP] ; в стек	записали
   1661	14B7  83 C5 02				 ADD  BP, 2 ; убрали
   1662						 NEXT
1  1663
1  1664	14BA  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1665	14BB  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1666	14BD  FF 27			     JMP WORD PTR [BX] ;
   1667
   1668						 HEAD	  81h,,311Q,I			      ;	I R R@
1  1669	      =ARRAY:14BF		 LINK$=$
1  1670	14BF  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  1671							 ; 6 - признак immediate. 5- слово не описано
1  1672	14C0  C9			     DB	 311Q	; последний символ слова + 128 (7 бит =	1).
1  1673	14C1  14ADr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1674	      =ARRAY:14BF		 LINK=LINK$
1  1675	14C3				 I LABEL FAR  ;	CFA
1  1676	14C3  14C5r			     DW	 $+2
   1677					     ; Копирует	верхнее	число из стека возвратов
   1678					     ; и записывая в стек параметров
   1679	14C5  FF 76 00		       RR$:	 PUSH [BP]
   1680	14C8			       Z$:	 NEXT
1  1681
1  1682	14C8  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1683	14C9  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1684	14CB  FF 27			     JMP WORD PTR [BX] ;
   1685
   1686						 HEAD	  81h,,322Q,R			      ;	R
1  1687	      =ARRAY:14CD		 LINK$=$
1  1688	14CD  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  1689							 ; 6 - признак immediate. 5- слово не описано
1  1690	14CE  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  1691	14CF  14BFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1692	      =ARRAY:14CD		 LINK=LINK$
1  1693	14D1				 R LABEL FAR  ;	CFA
1  1694	14D1  14D3r			     DW	 $+2
   1695	14D3  EB F0				 JMP  RR$
   1696
   1697						 HEAD	  82h,'I',247Q,SRP		      ;	I'
1  1698	      =ARRAY:14D5		 LINK$=$
1  1699	14D5  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1700							 ; 6 - признак immediate. 5- слово не описано
1  1701	14D6  49			     DB	 'I'
1  1702	14D7  A7			     DB	 247Q	; последний символ слова + 128 (7 бит =	1).
1  1703	14D8  14CDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1704	      =ARRAY:14D5		 LINK=LINK$
1  1705	14DA				 SRP LABEL FAR	; CFA
1  1706	14DA  14DCr			     DW	 $+2
   1707					     ; Копирует	второе сверху число из стека возвратов
   1708					     ; и записывает его	в стек параметров
   1709	14DC  FF 76 02				 PUSH [BP+2]
   1710	14DF  EB E7				 JMP  Z$
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 31
forth.asm



   1711
   1712						 HEAD	  83h,'LE',326Q,LEV		      ;	LEV
1  1713	      =ARRAY:14E1		 LINK$=$
1  1714	14E1  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1715							 ; 6 - признак immediate. 5- слово не описано
1  1716	14E2  4C 45			     DB	 'LE'
1  1717	14E4  D6			     DB	 326Q	; последний символ слова + 128 (7 бит =	1).
1  1718	14E5  14D5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1719	      =ARRAY:14E1		 LINK=LINK$
1  1720	14E7				 LEV LABEL FAR	; CFA
1  1721	14E7  14E9r			     DW	 $+2
   1722					     ; эквивалент R> DROP :) только быстрее
   1723	14E9  83 C5 02				 ADD  BP, 2
   1724						 NEXT
1  1725
1  1726	14EC  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1727	14ED  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1728	14EF  FF 27			     JMP WORD PTR [BX] ;
   1729
   1730						 ;** Операции со стеком	параметров **
   1731
   1732						 HEAD	  84h,'PIC',313Q,PICK		      ;	PICK
1  1733	      =ARRAY:14F1		 LINK$=$
1  1734	14F1  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1735							 ; 6 - признак immediate. 5- слово не описано
1  1736	14F2  50 49 43			     DB	 'PIC'
1  1737	14F5  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  1738	14F6  14E1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1739	      =ARRAY:14F1		 LINK=LINK$
1  1740	14F8				 PICK LABEL FAR	 ; CFA
1  1741	14F8  14FAr			     DW	 $+2
   1742	14FA  5B				 POP  BX
   1743	14FB  83 FB 00				 CMP  BX,  0
   1744	14FE  7E 08				 JLE  $GO
   1745	1500  4B				 DEC  BX
   1746	1501  D1 E3				 SAL  BX, 1
   1747	1503  03 DC				 ADD  BX, SP
   1748	1505  36: FF 37				 PUSH SS:[BX]
   1749	1508				$GO:	 NEXT
1  1750
1  1751	1508  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1752	1509  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1753	150B  FF 27			     JMP WORD PTR [BX] ;
   1754
   1755						 HEAD	  84h,'OVE',322Q,OVER		      ;	OVER
1  1756	      =ARRAY:150D		 LINK$=$
1  1757	150D  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1758							 ; 6 - признак immediate. 5- слово не описано
1  1759	150E  4F 56 45			     DB	 'OVE'
1  1760	1511  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  1761	1512  14F1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1762	      =ARRAY:150D		 LINK=LINK$
1  1763	1514				 OVER LABEL FAR	 ; CFA
1  1764	1514  1516r			     DW	 $+2
   1765	1516  8B DC				 MOV  BX, SP
   1766	1518  36: FF 77	02			     PUSH SS:[BX+2]
   1767						 NEXT
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 32
forth.asm



1  1768
1  1769	151C  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1770	151D  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1771	151F  FF 27			     JMP WORD PTR [BX] ;
   1772
   1773						 HEAD	  84h,'SWA',320Q,SWAP		      ;	SWAP
1  1774	      =ARRAY:1521		 LINK$=$
1  1775	1521  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1776							 ; 6 - признак immediate. 5- слово не описано
1  1777	1522  53 57 41			     DB	 'SWA'
1  1778	1525  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  1779	1526  150Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1780	      =ARRAY:1521		 LINK=LINK$
1  1781	1528				 SWAP LABEL FAR	 ; CFA
1  1782	1528  152Ar			     DW	 $+2
   1783	152A  59				 POP  CX
   1784	152B  58				 POP  AX
   1785	152C  51				 PUSH CX
   1786	152D  50				 PUSH AX
   1787						 NEXT
1  1788
1  1789	152E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1790	152F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1791	1531  FF 27			     JMP WORD PTR [BX] ;
   1792
   1793						 HEAD	  85h,'2SWA',320Q,DSWAP		      ;	2SWAP
1  1794	      =ARRAY:1533		 LINK$=$
1  1795	1533  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  1796							 ; 6 - признак immediate. 5- слово не описано
1  1797	1534  32 53 57 41		     DB	 '2SWA'
1  1798	1538  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  1799	1539  1521r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1800	      =ARRAY:1533		 LINK=LINK$
1  1801	153B				 DSWAP LABEL FAR  ; CFA
1  1802	153B  153Dr			     DW	 $+2
   1803	153D  58				 POP  AX
   1804	153E  59				 POP  CX
   1805	153F  8B DC				 MOV  BX,  SP
   1806	1541  36: 8B 57	02			 MOV  DX,WORD PTR SS:[BX+2]
   1807	1545  52				 PUSH DX
   1808	1546  36: 8B 17				 MOV  DX,WORD PTR SS:[BX]
   1809	1549  52				 PUSH DX
   1810	154A  36: 89 07				 MOV  WORD  PTR	SS:[BX],AX
   1811	154D  36: 89 4F	02			 MOV  WORD  PTR	SS:[BX+2],CX
   1812						 NEXT
1  1813
1  1814	1551  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1815	1552  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1816	1554  FF 27			     JMP WORD PTR [BX] ;
   1817
   1818						 HEAD	  83h,'DU',320Q,DUBL		      ;	DUP
1  1819	      =ARRAY:1556		 LINK$=$
1  1820	1556  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1821							 ; 6 - признак immediate. 5- слово не описано
1  1822	1557  44 55			     DB	 'DU'
1  1823	1559  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  1824	155A  1533r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 33
forth.asm



1  1825	      =ARRAY:1556		 LINK=LINK$
1  1826	155C				 DUBL LABEL FAR	 ; CFA
1  1827	155C  155Er			     DW	 $+2
   1828	155E  58				 POP  AX
   1829	155F  50			DU:	 PUSH AX
   1830	1560  50			C$:	 PUSH AX
   1831						 NEXT
1  1832
1  1833	1561  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1834	1562  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1835	1564  FF 27			     JMP WORD PTR [BX] ;
   1836
   1837						 HEAD	  84h,'-DU',320Q,DDUP		      ;	-DUP
1  1838	      =ARRAY:1566		 LINK$=$
1  1839	1566  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1840							 ; 6 - признак immediate. 5- слово не описано
1  1841	1567  2D 44 55			     DB	 '-DU'
1  1842	156A  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  1843	156B  1556r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1844	      =ARRAY:1566		 LINK=LINK$
1  1845	156D				 DDUP LABEL FAR	 ; CFA
1  1846	156D  156Fr			     DW	 $+2
   1847					     ; DUP если	в стеке	не 0
   1848	156F  58				 POP  AX
   1849	1570  3D 0000				 CMP  AX,  0
   1850	1573  75 EA				 JNE  DU
   1851	1575  EB E9				 JMP  C$
   1852
   1853						 HEAD	  84h,'2DU',320Q,DUP2		      ;	2DUP
1  1854	      =ARRAY:1577		 LINK$=$
1  1855	1577  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1856							 ; 6 - признак immediate. 5- слово не описано
1  1857	1578  32 44 55			     DB	 '2DU'
1  1858	157B  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  1859	157C  1566r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1860	      =ARRAY:1577		 LINK=LINK$
1  1861	157E				 DUP2 LABEL FAR	 ; CFA
1  1862	157E  1580r			     DW	 $+2
   1863	1580  58				 POP  AX
   1864	1581  59				 POP  CX
   1865	1582  51				 PUSH CX
   1866	1583  50				 PUSH AX
   1867	1584  51				 PUSH CX
   1868	1585  50				 PUSH AX
   1869						 NEXT
1  1870
1  1871	1586  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1872	1587  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1873	1589  FF 27			     JMP WORD PTR [BX] ;
   1874
   1875						 HEAD	  83h,'RO',324Q,ROT		      ;	ROT
1  1876	      =ARRAY:158B		 LINK$=$
1  1877	158B  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1878							 ; 6 - признак immediate. 5- слово не описано
1  1879	158C  52 4F			     DB	 'RO'
1  1880	158E  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  1881	158F  1577r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 34
forth.asm



1  1882	      =ARRAY:158B		 LINK=LINK$
1  1883	1591				 ROT LABEL FAR	; CFA
1  1884	1591  1593r			     DW	 $+2
   1885	1593  58				 POP  AX
   1886	1594  59				 POP  CX
   1887	1595  5B				 POP  BX
   1888	1596  51				 PUSH CX
   1889	1597  50				 PUSH AX
   1890	1598  53				 PUSH BX
   1891						 NEXT
1  1892
1  1893	1599  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1894	159A  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1895	159C  FF 27			     JMP WORD PTR [BX] ;
   1896
   1897						 HEAD	  85h,'2DRO',320Q,DDROP		      ;	2DROP
1  1898	      =ARRAY:159E		 LINK$=$
1  1899	159E  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  1900							 ; 6 - признак immediate. 5- слово не описано
1  1901	159F  32 44 52 4F		     DB	 '2DRO'
1  1902	15A3  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  1903	15A4  158Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1904	      =ARRAY:159E		 LINK=LINK$
1  1905	15A6				 DDROP LABEL FAR  ; CFA
1  1906	15A6  15A8r			     DW	 $+2
   1907	15A8  83 C4 04			DRO:	 ADD  SP, 4
   1908						 NEXT
1  1909
1  1910	15AB  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1911	15AC  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1912	15AE  FF 27			     JMP WORD PTR [BX] ;
   1913
   1914						 HEAD	  84h,'DRO',320Q,DROP		      ;	DROP
1  1915	      =ARRAY:15B0		 LINK$=$
1  1916	15B0  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1917							 ; 6 - признак immediate. 5- слово не описано
1  1918	15B1  44 52 4F			     DB	 'DRO'
1  1919	15B4  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  1920	15B5  159Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1921	      =ARRAY:15B0		 LINK=LINK$
1  1922	15B7				 DROP LABEL FAR	 ; CFA
1  1923	15B7  15B9r			     DW	 $+2
   1924	15B9  83 C4 02			DRP:	 ADD  SP, 2
   1925						 NEXT
1  1926
1  1927	15BC  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1928	15BD  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1929	15BF  FF 27			     JMP WORD PTR [BX] ;
   1930
   1931					;	 ** Работа с памятью **
   1932
   1933						 HEAD	  85h,'CMOV',305Q,CMOV		     ; CMOVE
1  1934	      =ARRAY:15C1		 LINK$=$
1  1935	15C1  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  1936							 ; 6 - признак immediate. 5- слово не описано
1  1937	15C2  43 4D 4F 56		     DB	 'CMOV'
1  1938	15C6  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 35
forth.asm



1  1939	15C7  15B0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1940	      =ARRAY:15C1		 LINK=LINK$
1  1941	15C9				 CMOV LABEL FAR	 ; CFA
1  1942	15C9  15CBr			     DW	 $+2
   1943					     ; src dst cnt -> перенос области памяти
   1944	15CB  59				 POP  CX	 ; Счетчик
   1945	15CC  83 F9 00				 CMP  CX,  0
   1946	15CF  7E D7				 JLE  DRO	 ; выход, c сбросом двух параметров в стеке
   1947	15D1  8B C7				 MOV  AX,  DI	  ; Сохранение содержимого DI,SI
   1948	15D3  8B DE				 MOV  BX,  SI
   1949	15D5  5F				 POP  DI	  ; Куда
   1950	15D6  5E				 POP  SI	  ; Откуда
   1951	15D7  F3> A4			REP	 MOVS  BYTE PTR	ES:[DI], BYTE PTR DS:[SI]
   1952	15D9  8B F8				 MOV  DI, AX	  ; Восстановление DI,SI
   1953	15DB  8B F3				 MOV  SI, BX
   1954						 NEXT
1  1955
1  1956	15DD  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1957	15DE  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1958	15E0  FF 27			     JMP WORD PTR [BX] ;
   1959
   1960						 HEAD	  84h,'FIL',314Q,FILL		      ;	FILL
1  1961	      =ARRAY:15E2		 LINK$=$
1  1962	15E2  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1963							 ; 6 - признак immediate. 5- слово не описано
1  1964	15E3  46 49 4C			     DB	 'FIL'
1  1965	15E6  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  1966	15E7  15C1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1967	      =ARRAY:15E2		 LINK=LINK$
1  1968	15E9				 FILL LABEL FAR	 ; CFA
1  1969	15E9  15EBr			     DW	 $+2
   1970					 ; addr	cnt chr	-> заполнение области памяти
   1971	15EB  58				 POP  AX      ;	Символ
   1972	15EC  59			FLL:	 POP  CX      ;	Счетчик	символов
   1973	15ED  83 F9 00				 CMP  CX, 0
   1974	15F0  7E C7				 JLE  DRP     ;
   1975	15F2  5B				 POP  BX
   1976	15F3  88 07			$REPE:	 MOV  BYTE PTR [BX],  AL
   1977	15F5  43				 INC  BX
   1978	15F6  E2 FB				 LOOP $REPE
   1979						 NEXT
1  1980
1  1981	15F8  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1982	15F9  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1983	15FB  FF 27			     JMP WORD PTR [BX] ;
   1984
   1985						 HEAD	  85h,'ERAS',305Q,ERASE		      ;	ERASE
1  1986	      =ARRAY:15FD		 LINK$=$
1  1987	15FD  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  1988							 ; 6 - признак immediate. 5- слово не описано
1  1989	15FE  45 52 41 53		     DB	 'ERAS'
1  1990	1602  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  1991	1603  15E2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1992	      =ARRAY:15FD		 LINK=LINK$
1  1993	1605				 ERASE LABEL FAR  ; CFA
1  1994	1605  1607r			     DW	 $+2
   1995					     ; заполнение нулем
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 36
forth.asm



   1996	1607  2B C0				 SUB  AX, AX
   1997	1609  EB E1				 JMP  FLL
   1998
   1999						 HEAD	  86h,'BLANK',323Q,BLANK	      ;	BLANKS
1  2000	      =ARRAY:160B		 LINK$=$
1  2001	160B  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  2002							 ; 6 - признак immediate. 5- слово не описано
1  2003	160C  42 4C 41 4E 4B		     DB	 'BLANK'
1  2004	1611  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  2005	1612  15FDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2006	      =ARRAY:160B		 LINK=LINK$
1  2007	1614				 BLANK LABEL FAR  ; CFA
1  2008	1614  1616r			     DW	 $+2
   2009					     ; заполнение  пробелом
   2010	1616  B8 0020				 MOV  AX, 32
   2011	1619  EB D1				 JMP  FLL
   2012
   2013						 HEAD	  84h,'HOL',304Q,HOLD		      ;	HOLD
1  2014	      =ARRAY:161B		 LINK$=$
1  2015	161B  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2016							 ; 6 - признак immediate. 5- слово не описано
1  2017	161C  48 4F 4C			     DB	 'HOL'
1  2018	161F  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  2019	1620  160Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2020	      =ARRAY:161B		 LINK=LINK$
1  2021	1622				 HOLD LABEL FAR	 ; CFA
1  2022	1622  1624r			     DW	 $+2
   2023					     ; Вводит в	текущую	ячейку выходного буфера	символ,
   2024					     ; код которого в стеке. Должен использоваться между <# и #>
   2025					     ; уменьшает на 1 значение указателя HLD.
   2026	1624  FF 4D 38				 DEC  WORD PTR	[DI+70Q]
   2027	1627  58				 POP  AX
   2028	1628  8B 5D 38				 MOV  BX,  [DI+70Q]
   2029	162B  88 07				 MOV  BYTE PTR [BX], AL
   2030						 NEXT
1  2031
1  2032	162D  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2033	162E  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2034	1630  FF 27			     JMP WORD PTR [BX] ;
   2035
   2036						 HEAD	  82h,'+',241Q,PSTOR		      ;	+!
1  2037	      =ARRAY:1632		 LINK$=$
1  2038	1632  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2039							 ; 6 - признак immediate. 5- слово не описано
1  2040	1633  2B			     DB	 '+'
1  2041	1634  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  2042	1635  161Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2043	      =ARRAY:1632		 LINK=LINK$
1  2044	1637				 PSTOR LABEL FAR  ; CFA
1  2045	1637  1639r			     DW	 $+2
   2046	1639  5B				 POP  BX
   2047	163A  59				 POP  CX
   2048	163B  01 0F				 ADD  [BX], CX
   2049						 NEXT
1  2050
1  2051	163D  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2052	163E  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 37
forth.asm



1  2053	1640  FF 27			     JMP WORD PTR [BX] ;
   2054
   2055						 HEAD	  84h,'TOG',314Q,TOGL		      ;	TOGGLE
1  2056	      =ARRAY:1642		 LINK$=$
1  2057	1642  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2058							 ; 6 - признак immediate. 5- слово не описано
1  2059	1643  54 4F 47			     DB	 'TOG'
1  2060	1646  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  2061	1647  1632r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2062	      =ARRAY:1642		 LINK=LINK$
1  2063	1649				 TOGL LABEL FAR	 ; CFA
1  2064	1649  164Br			     DW	 $+2
   2065					; адр-байта маска -> XOR в байт	памяти
   2066	164B  59				 POP  CX	 ; Маска
   2067	164C  5B				 POP  BX
   2068	164D  30 0F				 XOR  BYTE PTR [BX],CL
   2069						 NEXT
1  2070
1  2071	164F  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2072	1650  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2073	1652  FF 27			     JMP WORD PTR [BX] ;
   2074
   2075						 HEAD	  81h,,300Q,AT			      ;	@
1  2076	      =ARRAY:1654		 LINK$=$
1  2077	1654  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2078							 ; 6 - признак immediate. 5- слово не описано
1  2079	1655  C0			     DB	 300Q	; последний символ слова + 128 (7 бит =	1).
1  2080	1656  1642r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2081	      =ARRAY:1654		 LINK=LINK$
1  2082	1658				 AT LABEL FAR  ; CFA
1  2083	1658  165Ar			     DW	 $+2
   2084					     ; addr -> n
   2085	165A  5B				 POP  BX
   2086	165B  FF 37				 PUSH [BX]
   2087						 NEXT
1  2088
1  2089	165D  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2090	165E  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2091	1660  FF 27			     JMP WORD PTR [BX] ;
   2092
   2093						 HEAD	  82h,'C',300Q,CAT		      ;	C@
1  2094	      =ARRAY:1662		 LINK$=$
1  2095	1662  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2096							 ; 6 - признак immediate. 5- слово не описано
1  2097	1663  43			     DB	 'C'
1  2098	1664  C0			     DB	 300Q	; последний символ слова + 128 (7 бит =	1).
1  2099	1665  1654r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2100	      =ARRAY:1662		 LINK=LINK$
1  2101	1667				 CAT LABEL FAR	; CFA
1  2102	1667  1669r			     DW	 $+2
   2103					     ; Извлекает байт информации из ячейки,
   2104					     ; адрес которой находится в стеке
   2105	1669  5B				 POP  BX
   2106	166A  8A 07				 MOV  AL, BYTE PTR [BX]
   2107	166C  2A E4				 SUB  AH, AH
   2108	166E  50				 PUSH AX
   2109						 NEXT
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 38
forth.asm



1  2110
1  2111	166F  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2112	1670  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2113	1672  FF 27			     JMP WORD PTR [BX] ;
   2114
   2115						 HEAD	  81h,,241Q,STORE		      ;	!
1  2116	      =ARRAY:1674		 LINK$=$
1  2117	1674  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2118							 ; 6 - признак immediate. 5- слово не описано
1  2119	1675  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  2120	1676  1662r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2121	      =ARRAY:1674		 LINK=LINK$
1  2122	1678				 STORE LABEL FAR  ; CFA
1  2123	1678  167Ar			     DW	 $+2
   2124					     ; n addr ->
   2125	167A  5B				 POP  BX
   2126	167B  58				 POP  AX
   2127	167C  89 07				 MOV  [BX],   AX
   2128						 NEXT
1  2129
1  2130	167E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2131	167F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2132	1681  FF 27			     JMP WORD PTR [BX] ;
   2133
   2134						 HEAD	  82h,'C',241Q,CSTOR		      ;	C!
1  2135	      =ARRAY:1683		 LINK$=$
1  2136	1683  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2137							 ; 6 - признак immediate. 5- слово не описано
1  2138	1684  43			     DB	 'C'
1  2139	1685  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  2140	1686  1674r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2141	      =ARRAY:1683		 LINK=LINK$
1  2142	1688				 CSTOR LABEL FAR  ; CFA
1  2143	1688  168Ar			     DW	 $+2
   2144	168A  5B				 POP  BX
   2145	168B  58				 POP  AX
   2146	168C  88 07				 MOV  BYTE PTR [BX],  AL
   2147						 NEXT
1  2148
1  2149	168E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2150	168F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2151	1691  FF 27			     JMP WORD PTR [BX] ;
   2152
   2153						 HEAD	  83h,'NF','A'+80h,NFA			 ; NFA
1  2154	      =ARRAY:1693		 LINK$=$
1  2155	1693  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2156							 ; 6 - признак immediate. 5- слово не описано
1  2157	1694  4E 46			     DB	 'NF'
1  2158	1696  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  2159	1697  1683r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2160	      =ARRAY:1693		 LINK=LINK$
1  2161	1699				 NFA LABEL FAR	; CFA
1  2162	1699  169Br			     DW	 $+2
   2163					 ; pfa -> nfa
   2164	169B  5B				 POP  BX
   2165	169C  83 EB 05				 SUB  BX, 5
   2166	169F  B9 FFFF				 MOV  CX, -1
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 39
forth.asm



   2167
   2168	16A2  EB 64				 JMP  TRV
   2169
   2170						 HEAD	  83h,'LF','A'+80h,LFA			 ; LFA
1  2171	      =ARRAY:16A4		 LINK$=$
1  2172	16A4  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2173							 ; 6 - признак immediate. 5- слово не описано
1  2174	16A5  4C 46			     DB	 'LF'
1  2175	16A7  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  2176	16A8  1693r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2177	      =ARRAY:16A4		 LINK=LINK$
1  2178	16AA				 LFA LABEL FAR	; CFA
1  2179	16AA  16ACr			     DW	 $+2
   2180	16AC  58				 POP  AX
   2181	16AD  2D 0004				 SUB  AX, 4
   2182	16B0  50				 PUSH AX
   2183						 NEXT
1  2184
1  2185	16B1  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2186	16B2  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2187	16B4  FF 27			     JMP WORD PTR [BX] ;
   2188
   2189						 HEAD	  83h,'CF','A'+80h,CFA			 ; CFA
1  2190	      =ARRAY:16B6		 LINK$=$
1  2191	16B6  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2192							 ; 6 - признак immediate. 5- слово не описано
1  2193	16B7  43 46			     DB	 'CF'
1  2194	16B9  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  2195	16BA  16A4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2196	      =ARRAY:16B6		 LINK=LINK$
1  2197	16BC				 CFA LABEL FAR	; CFA
1  2198	16BC  16BEr			     DW	 $+2
   2199					 ; PFA -> CFA
   2200	16BE  58				 POP  AX
   2201	16BF  2D 0002				 SUB  AX, 2
   2202	16C2  50				 PUSH AX
   2203						 NEXT
1  2204
1  2205	16C3  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2206	16C4  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2207	16C6  FF 27			     JMP WORD PTR [BX] ;
   2208
   2209						 HEAD	  84h,'!CS',320Q,SCSP		      ;	!CSP
1  2210	      =ARRAY:16C8		 LINK$=$
1  2211	16C8  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2212							 ; 6 - признак immediate. 5- слово не описано
1  2213	16C9  21 43 53			     DB	 '!CS'
1  2214	16CC  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2215	16CD  16B6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2216	      =ARRAY:16C8		 LINK=LINK$
1  2217	16CF				 SCSP LABEL FAR	 ; CFA
1  2218	16CF  16D1r			     DW	 $+2
   2219					 ; контролируют	сохранение указателя стека параметров
   2220					 ; в процессе интерпретации слова
   2221	16D1  89 65 34				 MOV  WORD PTR [DI]+64Q,SP
   2222						 NEXT
1  2223
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 40
forth.asm



1  2224	16D4  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2225	16D5  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2226	16D7  FF 27			     JMP WORD PTR [BX] ;
   2227
   2228						 HEAD	  84h,'HER',305Q,HERE		      ;	HERE
1  2229	      =ARRAY:16D9		 LINK$=$
1  2230	16D9  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2231							 ; 6 - признак immediate. 5- слово не описано
1  2232	16DA  48 45 52			     DB	 'HER'
1  2233	16DD  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  2234	16DE  16C8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2235	      =ARRAY:16D9		 LINK=LINK$
1  2236	16E0				 HERE LABEL FAR	 ; CFA
1  2237	16E0  16E2r			     DW	 $+2
   2238	16E2  FF 75 12				 PUSH [DI+22Q]
   2239						 NEXT
1  2240
1  2241	16E5  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2242	16E6  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2243	16E8  FF 27			     JMP WORD PTR [BX] ;
   2244
   2245						 HEAD	  85h,'ALLO',324Q,ALLOT		      ;	ALLOT
1  2246	      =ARRAY:16EA		 LINK$=$
1  2247	16EA  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2248							 ; 6 - признак immediate. 5- слово не описано
1  2249	16EB  41 4C 4C 4F		     DB	 'ALLO'
1  2250	16EF  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  2251	16F0  16D9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2252	      =ARRAY:16EA		 LINK=LINK$
1  2253	16F2				 ALLOT LABEL FAR  ; CFA
1  2254	16F2  16F4r			     DW	 $+2
   2255	16F4  5B				 POP  BX
   2256	16F5  01 5D 12				 ADD  [DI+22Q],BX	 ;
   2257						 NEXT
1  2258
1  2259	16F8  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2260	16F9  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2261	16FB  FF 27			     JMP WORD PTR [BX] ;
   2262
   2263						 HEAD	  84h,'TRA',326Q,TRAV		      ;	TRAVERSE
1  2264	      =ARRAY:16FD		 LINK$=$
1  2265	16FD  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2266							 ; 6 - признак immediate. 5- слово не описано
1  2267	16FE  54 52 41			     DB	 'TRA'
1  2268	1701  D6			     DB	 326Q	; последний символ слова + 128 (7 бит =	1).
1  2269	1702  16EAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2270	      =ARRAY:16FD		 LINK=LINK$
1  2271	1704				 TRAV LABEL FAR	 ; CFA
1  2272	1704  1706r			     DW	 $+2
   2273						 ; Движение вперед/назад вдоль имени переменной	длины
   2274	1706  59				 POP  CX     ; DELTA
   2275	1707  5B				 POP  BX     ; адрес строки
   2276	1708  03 D9			 TRV:	 ADD  BX, CX
   2277	170A  80 3F 00				 CMP  BYTE PTR [BX],  0
   2278	170D  79 F9				 JNS  TRV    ; JUMP IF POSITIVE
   2279	170F  53				 PUSH BX
   2280						 NEXT
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 41
forth.asm



1  2281
1  2282	1710  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2283	1711  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2284	1713  FF 27			     JMP WORD PTR [BX] ;
   2285
   2286						 HEAD	  301Q,,333Q,LBRAC		       ; [
1  2287	      =ARRAY:1715		 LINK$=$
1  2288	1715  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  2289							 ; 6 - признак immediate. 5- слово не описано
1  2290	1716  DB			     DB	 333Q	; последний символ слова + 128 (7 бит =	1).
1  2291	1717  16FDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2292	      =ARRAY:1715		 LINK=LINK$
1  2293	1719				 LBRAC LABEL FAR  ; CFA
1  2294	1719  171Br			     DW	 $+2
   2295						 ; Прекращение компил.,	начало исполн. (обнуление STATE)
   2296	171B  C7 45 2C 0000			 MOV  WORD PTR [DI+54Q],0
   2297						 NEXT
1  2298
1  2299	1720  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2300	1721  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2301	1723  FF 27			     JMP WORD PTR [BX] ;
   2302
   2303						 HEAD	  301Q,,335Q,RBRAC		       ; ]
1  2304	      =ARRAY:1725		 LINK$=$
1  2305	1725  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  2306							 ; 6 - признак immediate. 5- слово не описано
1  2307	1726  DD			     DB	 335Q	; последний символ слова + 128 (7 бит =	1).
1  2308	1727  1715r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2309	      =ARRAY:1725		 LINK=LINK$
1  2310	1729				 RBRAC LABEL FAR  ; CFA
1  2311	1729  172Br			     DW	 $+2
   2312	172B  C7 45 2C 00C0			 MOV  WORD PTR [DI+54Q],300Q   ; Начало	компиляции
   2313						 NEXT
1  2314
1  2315	1730  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2316	1731  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2317	1733  FF 27			     JMP WORD PTR [BX] ;
   2318
   2319						 HEAD	  83h,'HE',330Q,$HEX		      ;	HEX
1  2320	      =ARRAY:1735		 LINK$=$
1  2321	1735  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2322							 ; 6 - признак immediate. 5- слово не описано
1  2323	1736  48 45			     DB	 'HE'
1  2324	1738  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  2325	1739  1725r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2326	      =ARRAY:1735		 LINK=LINK$
1  2327	173B				 $HEX LABEL FAR	 ; CFA
1  2328	173B  173Dr			     DW	 $+2
   2329	173D  C7 45 2E 0010			 MOV  WORD PTR [DI+56Q],16
   2330						 NEXT
1  2331
1  2332	1742  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2333	1743  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2334	1745  FF 27			     JMP WORD PTR [BX] ;
   2335
   2336						 HEAD	  87h,'DECIMA',314Q,DECIMA	       ; DECIMAL
1  2337	      =ARRAY:1747		 LINK$=$
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 42
forth.asm



1  2338	1747  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  2339							 ; 6 - признак immediate. 5- слово не описано
1  2340	1748  44 45 43 49 4D 41		     DB	 'DECIMA'
1  2341	174E  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  2342	174F  1735r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2343	      =ARRAY:1747		 LINK=LINK$
1  2344	1751				 DECIMA	LABEL FAR  ; CFA
1  2345	1751  1753r			     DW	 $+2
   2346	1753  C7 45 2E 000A			 MOV  WORD PTR [DI+56Q],10
   2347						 NEXT
1  2348
1  2349	1758  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2350	1759  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2351	175B  FF 27			     JMP WORD PTR [BX] ;
   2352
   2353						 HEAD	  85h,'OCTA',314Q,OCTAL		      ;	OCTAL
1  2354	      =ARRAY:175D		 LINK$=$
1  2355	175D  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2356							 ; 6 - признак immediate. 5- слово не описано
1  2357	175E  4F 43 54 41		     DB	 'OCTA'
1  2358	1762  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  2359	1763  1747r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2360	      =ARRAY:175D		 LINK=LINK$
1  2361	1765				 OCTAL LABEL FAR  ; CFA
1  2362	1765  1767r			     DW	 $+2
   2363	1767  C7 45 2E 0008			 MOV  WORD PTR [DI+56Q],  8
   2364	176C				Y$:	 NEXT
1  2365
1  2366	176C  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2367	176D  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2368	176F  FF 27			     JMP WORD PTR [BX] ;
   2369
   2370						 HEAD	  86h,'LATES',324Q,LATES	      ;	LATEST
1  2371	      =ARRAY:1771		 LINK$=$
1  2372	1771  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  2373							 ; 6 - признак immediate. 5- слово не описано
1  2374	1772  4C 41 54 45 53		     DB	 'LATES'
1  2375	1777  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  2376	1778  175Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2377	      =ARRAY:1771		 LINK=LINK$
1  2378	177A				 LATES LABEL FAR  ; CFA
1  2379	177A  177Cr			     DW	 $+2
   2380					     ; в стек данных NFA  последнего определенного слова
   2381					     ; в current словаре
   2382	177C  8B 5D 2A				 MOV  BX, [DI+52Q]
   2383	177F  FF 37				 PUSH [BX]
   2384						 NEXT
1  2385
1  2386	1781  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2387	1782  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2388	1784  FF 27			     JMP WORD PTR [BX] ;
   2389
   2390						 HEAD	  86h,'-TRAI',314Q,DTRAI	      ;	-TRAIL
1  2391	      =ARRAY:1786		 LINK$=$
1  2392	1786  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  2393							 ; 6 - признак immediate. 5- слово не описано
1  2394	1787  2D 54 52 41 49		     DB	 '-TRAI'
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 43
forth.asm



1  2395	178C  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  2396	178D  1771r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2397	      =ARRAY:1786		 LINK=LINK$
1  2398	178F				 DTRAI LABEL FAR  ; CFA
1  2399	178F  1791r			     DW	 $+2
   2400	1791  59				 POP  CX
   2401	1792  5B				 POP  BX
   2402	1793  53				 PUSH BX
   2403	1794  03 D9				 ADD  BX, CX
   2404	1796  4B			COMPA:	 DEC  BX
   2405	1797  80 3F 20				 CMP  BYTE PTR [BX],  32  ; BLANK ?
   2406	179A  75 02				 JNE  NO
   2407	179C  E2 F8				 LOOP COMPA
   2408	179E  51			NO:	 PUSH CX
   2409						 NEXT
1  2410
1  2411	179F  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2412	17A0  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2413	17A2  FF 27			     JMP WORD PTR [BX] ;
   2414
   2415						 HEAD	  85h,'UPPE',322Q,UPPER		      ;	UPPER
1  2416	      =ARRAY:17A4		 LINK$=$
1  2417	17A4  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2418							 ; 6 - признак immediate. 5- слово не описано
1  2419	17A5  55 50 50 45		     DB	 'UPPE'
1  2420	17A9  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  2421	17AA  1786r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2422	      =ARRAY:17A4		 LINK=LINK$
1  2423	17AC				 UPPER LABEL FAR  ; CFA
1  2424	17AC  17AEr			     DW	 $+2
   2425	17AE  59				 POP  CX		 ; число символов
   2426	17AF  5B				 POP  BX		 ; строка
   2427	17B0  80 3F 61			$COMP:	 CMP  BYTE PTR [BX],  61h ; a
   2428	17B3  7C 08				 JL   OFLIM
   2429	17B5  80 3F 7A				 CMP  BYTE PTR [BX],  7Ah ; z
   2430	17B8  7F 03				 JG   OFLIM
   2431	17BA  83 27 DF				 AND  WORD PTR [BX], 177737Q ; FFDF
   2432	17BD  43			OFLIM:	 INC  BX
   2433	17BE  E2 F0				 LOOP $COMP
   2434						 NEXT
1  2435
1  2436	17C0  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2437	17C1  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2438	17C3  FF 27			     JMP WORD PTR [BX] ;
   2439
   2440						 HEAD	  213Q,'DEFINITION',323Q,DEFIN	    ; DEFINITIONS
1  2441	      =ARRAY:17C5		 LINK$=$
1  2442	17C5  8B			     DB	 213Q  ; NFA 7 бит равен 1.
1  2443							 ; 6 - признак immediate. 5- слово не описано
1  2444	17C6  44 45 46 49 4E 49	54+	     DB	 'DEFINITION'
   2445	      49 4F 4E
1  2446	17D0  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  2447	17D1  17A4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2448	      =ARRAY:17C5		 LINK=LINK$
1  2449	17D3				 DEFIN LABEL FAR  ; CFA
1  2450	17D3  17D5r			     DW	 $+2
   2451					 ; Контекстный словарь становится текущим, все последующие
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 44
forth.asm



   2452					 ; описания связаны с этим словарем
   2453	17D5  8B 45 28				 MOV  AX, [DI+50Q]	 ; context
   2454	17D8  89 45 2A				 MOV  [DI+52Q],AX	 ; current
   2455						 NEXT
1  2456
1  2457	17DB  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2458	17DC  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2459	17DE  FF 27			     JMP WORD PTR [BX] ;
   2460
   2461						 HEAD	  84h,'+BU',306Q,PBUF		      ;	+BUF
1  2462	      =ARRAY:17E0		 LINK$=$
1  2463	17E0  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2464							 ; 6 - признак immediate. 5- слово не описано
1  2465	17E1  2B 42 55			     DB	 '+BU'
1  2466	17E4  C6			     DB	 306Q	; последний символ слова + 128 (7 бит =	1).
1  2467	17E5  17C5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2468	      =ARRAY:17E0		 LINK=LINK$
1  2469	17E7				 PBUF LABEL FAR	 ; CFA
1  2470	17E7  17E9r			     DW	 $+2
   2471					 ;
   2472	17E9  8B DC				 MOV  BX, SP	     ;
   2473	17EB  36: 81 07	0404			 ADD  SS:[BX],1028   ; адрес следующего	буфера
   2474	17F0  36: 8B 07				 MOV  AX, SS:[BX]
   2475	17F3  39 45 18				 CMP  [DI+30Q],AX    ; LIMIT
   2476	17F6  75 06				 JNE  PB	     ; уперлись	в адрес	лимита,	значит буфер - последний
   2477	17F8  8B 4D 16				 MOV  CX, [DI+26Q]   ; FIRST
   2478	17FB  36: 89 0F				 MOV  SS:[BX],CX     ; переходим на первый буфер
   2479	17FE  36: FF 37			PB:	 PUSH SS:[BX]	     ; полученный адрес	буфера в стек
   2480	1801  8B 4D 3C				 MOV  CX, [DI+74Q]   ; prev
   2481	1804  36: 29 4F	FE			 SUB  SS:[BX-2],CX   ; стек растет вниз. BX-2 сейчас  вершина стека
   2482								     ; если 0, значит адрес совпадает с	адресом	prev
   2483						 NEXT
1  2484
1  2485	1808  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2486	1809  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2487	180B  FF 27			     JMP WORD PTR [BX] ;
   2488
   2489						 HEAD	  86h,'UPDAT',305Q,UPDAT	      ;	UPDATE
1  2490	      =ARRAY:180D		 LINK$=$
1  2491	180D  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  2492							 ; 6 - признак immediate. 5- слово не описано
1  2493	180E  55 50 44 41 54		     DB	 'UPDAT'
1  2494	1813  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  2495	1814  17E0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2496	      =ARRAY:180D		 LINK=LINK$
1  2497	1816				 UPDAT LABEL FAR  ; CFA
1  2498	1816  1818r			     DW	 $+2
   2499	1818  8B 5D 3C				 MOV  BX, [DI+74Q]	       ; prev buffer
   2500	181B  0B DB				 OR BX,	BX		     ; если 0, буфер пустой
   2501	181D  74 04				 jz $upd
   2502	181F  81 0F 8000			 OR  WORD PTR [BX],   100000Q  ; ставим	бит
   2503	1823				 $upd:	 NEXT
1  2504
1  2505	1823  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2506	1824  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2507	1826  FF 27			     JMP WORD PTR [BX] ;
   2508
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 45
forth.asm



   2509						 HEAD	  81h,,330Q,X			      ;	X
1  2510	      =ARRAY:1828		 LINK$=$
1  2511	1828  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2512							 ; 6 - признак immediate. 5- слово не описано
1  2513	1829  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  2514	182A  180Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2515	      =ARRAY:1828		 LINK=LINK$
1  2516	182C				 X LABEL FAR  ;	CFA
1  2517	182C  182Er			     DW	 $+2
   2518					 ; сброс бита сохранения буфера
   2519	182E  5B				 POP  BX
   2520	182F  81 27 7FFF			 AND WORD PTR [BX],   77777Q   ;
   2521	1833  FF 37				 PUSH [BX]
   2522						 NEXT
1  2523
1  2524	1835  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2525	1836  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2526	1838  FF 27			     JMP WORD PTR [BX] ;
   2527
   2528					;	 ** Управляющие	слова **
   2529
   2530						 HEAD	  301Q,,272Q,COLON,$COL		       ; :
1  2531	      =ARRAY:183A		 LINK$=$
1  2532	183A  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  2533							 ; 6 - признак immediate. 5- слово не описано
1  2534	183B  BA			     DB	 272Q	; последний символ слова + 128 (7 бит =	1).
1  2535	183C  1828r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2536	      =ARRAY:183A		 LINK=LINK$
1  2537	183E				 COLON LABEL FAR  ; CFA
1  2538	183E  1852r			     DW	$COL
   2539					     ; слово для создания новых	слов из	Форта
   2540	1840  1B1Ar 16CFr 1A0Br	  +		 DW QEXEC,SCSP,CURR,AT,CONT,STORE,CREAT
   2541	      1658r 19FDr 1678r	  +
   2542	      1ECDr
   2543	184E  1729r 1BA4r			 DW RBRAC,PSCOD	; после	этого слова SI указывает на следующий код,
   2544								; адрес, которого попадет в CFA	создаваемого слова
   2545	1852				$COL	 LABEL	 FAR ; код для исполнения слов на форте	из этого исходника
   2546							     ; функция интерпретатора
   2547	1852  83 C5 FE				 ADD  BP, -2 ; резервируем место в стеке возвратов
   2548	1855  83 C3 02				 ADD  BX, 2  ; BX указывает на CFA здесь это $COL
   2549							     ; BX+2 будет указывать на адрес QEXEC
   2550	1858  89 76 00				 MOV  [BP], SI ; сохраняем текущий указатель IP
   2551	185B  8B F3				 MOV  SI, BX ; исполняем слово QEXEC
   2552						 NEXT
1  2553
1  2554	185D  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2555	185E  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2556	1860  FF 27			     JMP WORD PTR [BX] ;
   2557
   2558						 HEAD	  301Q,,273Q,SMI,$COL		       ; ;
1  2559	      =ARRAY:1862		 LINK$=$
1  2560	1862  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  2561							 ; 6 - признак immediate. 5- слово не описано
1  2562	1863  BB			     DB	 273Q	; последний символ слова + 128 (7 бит =	1).
1  2563	1864  183Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2564	      =ARRAY:1862		 LINK=LINK$
1  2565	1866				 SMI LABEL FAR	; CFA
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 46
forth.asm



1  2566	1866  1852r			     DW	$COL
   2567					     ; слово для завершения новых слов из Форта
   2568	1868  1B43r 1B77r 1479r	  +		 DW QCSP,COMP,SEMI,SMUG,LBRAC,SEMI
   2569	      1B90r 1719r 1479r
   2570
   2571						 HEAD	  88h,'CONSTAN',324Q,CON,$COL	      ;	CONSTANT
1  2572	      =ARRAY:1874		 LINK$=$
1  2573	1874  88			     DB	 88h  ;	NFA 7 бит равен	1.
1  2574							 ; 6 - признак immediate. 5- слово не описано
1  2575	1875  43 4F 4E 53 54 41	4E	     DB	 'CONSTAN'
1  2576	187C  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  2577	187D  1862r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2578	      =ARRAY:1874		 LINK=LINK$
1  2579	187F				 CON LABEL FAR	; CFA
1  2580	187F  1852r			     DW	$COL
   2581	1881  1ECDr 1B90r 1AA3r	  +		 DW CREAT,SMUG,COMMA,PSCOD		      ;
   2582	      1BA4r
   2583	1889				$CON	 LABEL	 FAR
   2584	1889  83 C3 02				 ADD  BX, 2 ; аналогично переменной
   2585	188C  FF 37				 PUSH [BX]  ; вместо адреса пишем значение по этому адресу PFA
   2586						 NEXT
1  2587
1  2588	188E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2589	188F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2590	1891  FF 27			     JMP WORD PTR [BX] ;
   2591
   2592						 HEAD	  88h, 'VARIABL',305Q,VAR,$COL	      ;	VARIABLE
1  2593	      =ARRAY:1893		 LINK$=$
1  2594	1893  88			     DB	 88h  ;	NFA 7 бит равен	1.
1  2595							 ; 6 - признак immediate. 5- слово не описано
1  2596	1894  56 41 52 49 41 42	4C	     DB	 'VARIABL'
1  2597	189B  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  2598	189C  1874r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2599	      =ARRAY:1893		 LINK=LINK$
1  2600	189E				 VAR LABEL FAR	; CFA
1  2601	189E  1852r			     DW	$COL
   2602	18A0  187Fr 1BA4r			 DW CON,PSCOD
   2603	18A4				$VAR	 LABEL	 FAR
   2604	18A4  83 C3 02				 ADD  BX, 2  ; BX указывает на CFA ($COL)
   2605							     ; BX+2 пропускает поле CFA
   2606	18A7  53				 PUSH BX     ; в BX находится адрес переменной PFA (CON)
   2607						 NEXT
1  2608
1  2609	18A8  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2610	18A9  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2611	18AB  FF 27			     JMP WORD PTR [BX] ;
   2612
   2613						 HEAD	  84h,'USE',322Q,USER, $COL	      ;	USER
1  2614	      =ARRAY:18AD		 LINK$=$
1  2615	18AD  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2616							 ; 6 - признак immediate. 5- слово не описано
1  2617	18AE  55 53 45			     DB	 'USE'
1  2618	18B1  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  2619	18B2  1893r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2620	      =ARRAY:18AD		 LINK=LINK$
1  2621	18B4				 USER LABEL FAR	 ; CFA
1  2622	18B4  1852r			     DW	$COL
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 47
forth.asm



   2623	18B6  187Fr 1BA4r			 DW CON,PSCOD
   2624	18BA				$USE	 LABEL	 FAR
   2625	18BA  83 C3 02				 ADD  BX, 2
   2626	18BD  8B 07				 MOV  AX, [BX] ; берем смещение	из PFA
   2627	18BF  03 C7				 ADD  AX, DI  ;	вычисляем смещение
   2628	18C1  50				 PUSH AX ; полученный адрес в стек
   2629						 NEXT
1  2630
1  2631	18C2  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2632	18C3  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2633	18C5  FF 27			     JMP WORD PTR [BX] ;
   2634
   2635						 HEAD	  85h,'DOES',276Q,DOES,$COL	      ;	DOES>
1  2636	      =ARRAY:18C7		 LINK$=$
1  2637	18C7  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2638							 ; 6 - признак immediate. 5- слово не описано
1  2639	18C8  44 4F 45 53		     DB	 'DOES'
1  2640	18CC  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1  2641	18CD  18ADr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2642	      =ARRAY:18C7		 LINK=LINK$
1  2643	18CF				 DOES LABEL FAR	 ; CFA
1  2644	18CF  1852r			     DW	$COL
   2645					 ; запись PFA словаря в	стек при исполнении
   2646	18D1  14B2r 177Ar 1AD6r	  +		 DW  FROMR,LATES,PFA,STORE,PSCOD
   2647	      1678r 1BA4r
   2648	18DB				$DOE	 LABEL	 FAR
   2649	18DB  83 ED 02				 SUB  BP,  2 ; резервируем место
   2650	18DE  89 76 00				 MOV  [BP], SI ; сохраняем SI адрес следующего слова
   2651	18E1  83 C3 02				 ADD  BX, 2  ; указатель на PFA	исполняемого слова FORTH
   2652	18E4  8B 37				 MOV  SI, [BX] ; адрес слова DOVOC
   2653	18E6  83 C3 02				 ADD  BX, 2    ; адрес параметра для DOVOC (120201Q)
   2654	18E9  53				 PUSH BX       ; в стек
   2655						 NEXT
1  2656
1  2657	18EA  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2658	18EB  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2659	18ED  FF 27			     JMP WORD PTR [BX] ;
   2660
   2661						 HEAD	  83h,'BY','E'+80h,BYE			; BYE
1  2662	      =ARRAY:18EF		 LINK$=$
1  2663	18EF  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2664							 ; 6 - признак immediate. 5- слово не описано
1  2665	18F0  42 59			     DB	 'BY'
1  2666	18F2  C5			     DB	 'E'+80h   ; последний символ слова + 128 (7 бит = 1).
1  2667	18F3  18C7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2668	      =ARRAY:18EF		 LINK=LINK$
1  2669	18F5				 BYE LABEL FAR	; CFA
1  2670	18F5  18F7r			     DW	 $+2
   2671	18F7  B4 4C				 mov ah, 4ch
   2672	18F9  CD 21				 int 21h
   2673
   2674					;	 ** Константы **
   2675
   2676						 HEAD	  81h,,260Q,ZERO,$CON		      ;	0
1  2677	      =ARRAY:18FB		 LINK$=$
1  2678	18FB  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2679							 ; 6 - признак immediate. 5- слово не описано
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 48
forth.asm



1  2680	18FC  B0			     DB	 260Q	; последний символ слова + 128 (7 бит =	1).
1  2681	18FD  18EFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2682	      =ARRAY:18FB		 LINK=LINK$
1  2683	18FF				 ZERO LABEL FAR	 ; CFA
1  2684	18FF  1889r			     DW	$CON
   2685	1901  0000				 DW 0
   2686
   2687						 HEAD	  81h,,261Q,ONE,$CON		      ;	1
1  2688	      =ARRAY:1903		 LINK$=$
1  2689	1903  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2690							 ; 6 - признак immediate. 5- слово не описано
1  2691	1904  B1			     DB	 261Q	; последний символ слова + 128 (7 бит =	1).
1  2692	1905  18FBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2693	      =ARRAY:1903		 LINK=LINK$
1  2694	1907				 ONE LABEL FAR	; CFA
1  2695	1907  1889r			     DW	$CON
   2696	1909  0001				 DW 1
   2697
   2698						 HEAD	  81h,,262Q,TWO,$CON		      ;	2
1  2699	      =ARRAY:190B		 LINK$=$
1  2700	190B  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2701							 ; 6 - признак immediate. 5- слово не описано
1  2702	190C  B2			     DB	 262Q	; последний символ слова + 128 (7 бит =	1).
1  2703	190D  1903r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2704	      =ARRAY:190B		 LINK=LINK$
1  2705	190F				 TWO LABEL FAR	; CFA
1  2706	190F  1889r			     DW	$CON
   2707	1911  0002				 DW 2
   2708
   2709						 HEAD	  81h,,263Q,THREE,$CON		      ;	3
1  2710	      =ARRAY:1913		 LINK$=$
1  2711	1913  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2712							 ; 6 - признак immediate. 5- слово не описано
1  2713	1914  B3			     DB	 263Q	; последний символ слова + 128 (7 бит =	1).
1  2714	1915  190Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2715	      =ARRAY:1913		 LINK=LINK$
1  2716	1917				 THREE LABEL FAR  ; CFA
1  2717	1917  1889r			     DW	$CON
   2718	1919  0003				 DW 3
   2719
   2720						 HEAD	  81h,,270Q,EIGHT, $CON		      ;	8
1  2721	      =ARRAY:191B		 LINK$=$
1  2722	191B  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2723							 ; 6 - признак immediate. 5- слово не описано
1  2724	191C  B8			     DB	 270Q	; последний символ слова + 128 (7 бит =	1).
1  2725	191D  1913r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2726	      =ARRAY:191B		 LINK=LINK$
1  2727	191F				 EIGHT LABEL FAR  ; CFA
1  2728	191F  1889r			     DW	$CON
   2729	1921  0008				 DW 8
   2730
   2731						 HEAD	  82h,'B',314Q,BLAN,$CON	      ;	BL
1  2732	      =ARRAY:1923		 LINK$=$
1  2733	1923  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2734							 ; 6 - признак immediate. 5- слово не описано
1  2735	1924  42			     DB	 'B'
1  2736	1925  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 49
forth.asm



1  2737	1926  191Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2738	      =ARRAY:1923		 LINK=LINK$
1  2739	1928				 BLAN LABEL FAR	 ; CFA
1  2740	1928  1889r			     DW	$CON
   2741	192A  0020				 DW 32
   2742
   2743						 HEAD	  82h,'C',314Q,$CL,$CON		      ;	C/L
1  2744	      =ARRAY:192C		 LINK$=$
1  2745	192C  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2746							 ; 6 - признак immediate. 5- слово не описано
1  2747	192D  43			     DB	 'C'
1  2748	192E  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  2749	192F  1923r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2750	      =ARRAY:192C		 LINK=LINK$
1  2751	1931				 $CL LABEL FAR	; CFA
1  2752	1931  1889r			     DW	$CON
   2753	1933  0040				 DW 64	 ;CHAR#	PER LINE
   2754
   2755						 HEAD	  82h,'1',313Q,BBUF,$CON	      ;	BBUF
1  2756	      =ARRAY:1935		 LINK$=$
1  2757	1935  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2758							 ; 6 - признак immediate. 5- слово не описано
1  2759	1936  31			     DB	 '1'
1  2760	1937  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  2761	1938  192Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2762	      =ARRAY:1935		 LINK=LINK$
1  2763	193A				 BBUF LABEL FAR	 ; CFA
1  2764	193A  1889r			     DW	$CON
   2765	193C  0400				 DW 1024
   2766
   2767						 ;** USER-переменные **
   2768
   2769						 HEAD	  82h,'S',260Q,SZERO,$USE	      ;	SO
1  2770	      =ARRAY:193E		 LINK$=$
1  2771	193E  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2772							 ; 6 - признак immediate. 5- слово не описано
1  2773	193F  53			     DB	 'S'
1  2774	1940  B0			     DB	 260Q	; последний символ слова + 128 (7 бит =	1).
1  2775	1941  1935r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2776	      =ARRAY:193E		 LINK=LINK$
1  2777	1943				 SZERO LABEL FAR  ; CFA
1  2778	1943  18BAr			     DW	$USE
   2779	1945  0006				 DW 6 ;	Указатель начала стека параметров
   2780
   2781						 HEAD	  82h,'R',260Q,RZERO,$USE	      ;	RO
1  2782	      =ARRAY:1947		 LINK$=$
1  2783	1947  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2784							 ; 6 - признак immediate. 5- слово не описано
1  2785	1948  52			     DB	 'R'
1  2786	1949  B0			     DB	 260Q	; последний символ слова + 128 (7 бит =	1).
1  2787	194A  193Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2788	      =ARRAY:1947		 LINK=LINK$
1  2789	194C				 RZERO LABEL FAR  ; CFA
1  2790	194C  18BAr			     DW	$USE
   2791	194E  0008				 DW 8  ; Указатель начала стека	возврата
   2792
   2793						 HEAD	  83h, 'TI',302Q,TIB,$USE	      ;	TIB
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 50
forth.asm



1  2794	      =ARRAY:1950		 LINK$=$
1  2795	1950  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2796							 ; 6 - признак immediate. 5- слово не описано
1  2797	1951  54 49			     DB	 'TI'
1  2798	1953  C2			     DB	 302Q	; последний символ слова + 128 (7 бит =	1).
1  2799	1954  1947r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2800	      =ARRAY:1950		 LINK=LINK$
1  2801	1956				 TIB LABEL FAR	; CFA
1  2802	1956  18BAr			     DW	$USE
   2803	1958  000A				 DW 12Q	 ;Входной буфер	терминала 10
   2804
   2805						 HEAD	  85h,'WIDT',310Q,$WIDTH,$USE	      ;	WIDTH
1  2806	      =ARRAY:195A		 LINK$=$
1  2807	195A  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2808							 ; 6 - признак immediate. 5- слово не описано
1  2809	195B  57 49 44 54		     DB	 'WIDT'
1  2810	195F  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1  2811	1960  1950r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2812	      =ARRAY:195A		 LINK=LINK$
1  2813	1962				 $WIDTH	LABEL FAR  ; CFA
1  2814	1962  18BAr			     DW	$USE
   2815	1964  000C				 DW 14Q	; Определяет максимальную длину	имени в	словаре
   2816
   2817						 HEAD	  87h,'WARNIN',307Q,$WARN,$USE	      ;	WARNING
1  2818	      =ARRAY:1966		 LINK$=$
1  2819	1966  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  2820							 ; 6 - признак immediate. 5- слово не описано
1  2821	1967  57 41 52 4E 49 4E		     DB	 'WARNIN'
1  2822	196D  C7			     DB	 307Q	; последний символ слова + 128 (7 бит =	1).
1  2823	196E  195Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2824	      =ARRAY:1966		 LINK=LINK$
1  2825	1970				 $WARN LABEL FAR  ; CFA
1  2826	1970  18BAr			     DW	$USE
   2827	1972  000E				 DW 16Q	 ;  при	0 только код ошибки выводится
   2828
   2829						 HEAD	  85h,'FENC',305Q,FENCE,$USE	      ;	FENCE
1  2830	      =ARRAY:1974		 LINK$=$
1  2831	1974  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2832							 ; 6 - признак immediate. 5- слово не описано
1  2833	1975  46 45 4E 43		     DB	 'FENC'
1  2834	1979  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  2835	197A  1966r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2836	      =ARRAY:1974		 LINK=LINK$
1  2837	197C				 FENCE LABEL FAR  ; CFA
1  2838	197C  18BAr			     DW	$USE
   2839	197E  0010				 DW 20Q	; FENCE	указывает верхний край базового	словаря
   2840						 ; FENCE  (ограда) служит  для	защиты	базового словаря
   2841						 ; от стирания с помощью оператора FORGET,  указывает адрес,
   2842						 ; предшествующий первой  свободной  ячейке  в словаре сразу
   2843						 ; после загрузки системы Форт,	т.е. при этом FENCE @ равно HERE-2
   2844
   2845						 HEAD	  82h,'D',320Q,$DP,$USE		      ;	DP
1  2846	      =ARRAY:1980		 LINK$=$
1  2847	1980  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2848							 ; 6 - признак immediate. 5- слово не описано
1  2849	1981  44			     DB	 'D'
1  2850	1982  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 51
forth.asm



1  2851	1983  1974r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2852	      =ARRAY:1980		 LINK=LINK$
1  2853	1985				 $DP LABEL FAR	; CFA
1  2854	1985  18BAr			     DW	$USE
   2855	1987  0012				 DW 22Q	; указывает на первую свободную	ячейку словаря (DP @ = HERE)
   2856
   2857						 HEAD	  84h,'VOC',314Q,VOCL,$USE	      ;	VOCL
1  2858	      =ARRAY:1989		 LINK$=$
1  2859	1989  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2860							 ; 6 - признак immediate. 5- слово не описано
1  2861	198A  56 4F 43			     DB	 'VOC'
1  2862	198D  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  2863	198E  1980r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2864	      =ARRAY:1989		 LINK=LINK$
1  2865	1990				 VOCL LABEL FAR	 ; CFA
1  2866	1990  18BAr			     DW	$USE
   2867						 ; хранится адрес XVOC
   2868	1992  0014				 DW 24Q	; переменная  связи контекстных	словарей.
   2869
   2870						 HEAD	  85h,'FIRS',324Q,FIRST,$USE	      ;	FIRST
1  2871	      =ARRAY:1994		 LINK$=$
1  2872	1994  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2873							 ; 6 - признак immediate. 5- слово не описано
1  2874	1995  46 49 52 53		     DB	 'FIRS'
1  2875	1999  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  2876	199A  1989r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2877	      =ARRAY:1994		 LINK=LINK$
1  2878	199C				 FIRST LABEL FAR  ; CFA
1  2879	199C  18BAr			     DW	$USE
   2880	199E  0016				 DW 26Q	; адрес	первого	байта экранных буферов
   2881
   2882						 HEAD	  85h,'LIMI',324Q,LIMIT,$USE	      ;	LIMIT
1  2883	      =ARRAY:19A0		 LINK$=$
1  2884	19A0  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2885							 ; 6 - признак immediate. 5- слово не описано
1  2886	19A1  4C 49 4D 49		     DB	 'LIMI'
1  2887	19A5  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  2888	19A6  1994r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2889	      =ARRAY:19A0		 LINK=LINK$
1  2890	19A8				 LIMIT LABEL FAR  ; CFA
1  2891	19A8  18BAr			     DW	$USE
   2892	19AA  0018				 DW 30Q	; указатель конца экранных буферов и некоторые другие
   2893
   2894						 HEAD	  83h,'AT',322Q,ATR,$USE	      ;	ATR
1  2895	      =ARRAY:19AC		 LINK$=$
1  2896	19AC  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2897							 ; 6 - признак immediate. 5- слово не описано
1  2898	19AD  41 54			     DB	 'AT'
1  2899	19AF  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  2900	19B0  19A0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2901	      =ARRAY:19AC		 LINK=LINK$
1  2902	19B2				 ATR LABEL FAR	; CFA
1  2903	19B2  18BAr			     DW	$USE
   2904	19B4  001A				 DW 32Q		 ;Атрибут
   2905
   2906						 HEAD	  82h,'P',307Q,PG,$USE		      ;	PG
1  2907	      =ARRAY:19B6		 LINK$=$
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 52
forth.asm



1  2908	19B6  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2909							 ; 6 - признак immediate. 5- слово не описано
1  2910	19B7  50			     DB	 'P'
1  2911	19B8  C7			     DB	 307Q	; последний символ слова + 128 (7 бит =	1).
1  2912	19B9  19ACr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2913	      =ARRAY:19B6		 LINK=LINK$
1  2914	19BB				 PG LABEL FAR  ; CFA
1  2915	19BB  18BAr			     DW	$USE
   2916	19BD  001C				 DW 34Q		 ; Текущая страница
   2917
   2918						 HEAD	  83h,'BL',313Q,BLK,$USE	      ;	BLK
1  2919	      =ARRAY:19BF		 LINK$=$
1  2920	19BF  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2921							 ; 6 - признак immediate. 5- слово не описано
1  2922	19C0  42 4C			     DB	 'BL'
1  2923	19C2  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  2924	19C3  19B6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2925	      =ARRAY:19BF		 LINK=LINK$
1  2926	19C5				 BLK LABEL FAR	; CFA
1  2927	19C5  18BAr			     DW	$USE
   2928	19C7  001E				 DW 36Q	; 0  для  входного  буфера  и  номеру экрана
   2929							; в противном  случае
   2930
   2931						 HEAD	  82h,'I',316Q,$IN,$USE		      ;	IN
1  2932	      =ARRAY:19C9		 LINK$=$
1  2933	19C9  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2934							 ; 6 - признак immediate. 5- слово не описано
1  2935	19CA  49			     DB	 'I'
1  2936	19CB  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  2937	19CC  19BFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2938	      =ARRAY:19C9		 LINK=LINK$
1  2939	19CE				 $IN LABEL FAR	; CFA
1  2940	19CE  18BAr			     DW	$USE
   2941	19D0  0020				 DW 40Q	; внутренний   указатель   входного   буфера
   2942
   2943						 HEAD	  83h,'PN',324Q,PNT,$USE	      ;	PNT
1  2944	      =ARRAY:19D2		 LINK$=$
1  2945	19D2  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2946							 ; 6 - признак immediate. 5- слово не описано
1  2947	19D3  50 4E			     DB	 'PN'
1  2948	19D5  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  2949	19D6  19C9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2950	      =ARRAY:19D2		 LINK=LINK$
1  2951	19D8				 PNT LABEL FAR	; CFA
1  2952	19D8  18BAr			     DW	$USE
   2953	19DA  0022				 DW 42Q		 ;Флаг-печати
   2954
   2955						 HEAD	  83h,'SC',322Q,SCR,$USE	      ;	SCR
1  2956	      =ARRAY:19DC		 LINK$=$
1  2957	19DC  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2958							 ; 6 - признак immediate. 5- слово не описано
1  2959	19DD  53 43			     DB	 'SC'
1  2960	19DF  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  2961	19E0  19D2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2962	      =ARRAY:19DC		 LINK=LINK$
1  2963	19E2				 SCR LABEL FAR	; CFA
1  2964	19E2  18BAr			     DW	$USE
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 53
forth.asm



   2965	19E4  0024				 DW 44Q	; для хранения текущего	значения номера	экрана
   2966							 ; только в list
   2967
   2968						 HEAD	  86h,'OFFSE',324Q,OFSET,$USE	     ; OFFSET
1  2969	      =ARRAY:19E6		 LINK$=$
1  2970	19E6  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  2971							 ; 6 - признак immediate. 5- слово не описано
1  2972	19E7  4F 46 46 53 45		     DB	 'OFFSE'
1  2973	19EC  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  2974	19ED  19DCr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2975	      =ARRAY:19E6		 LINK=LINK$
1  2976	19EF				 OFSET LABEL FAR  ; CFA
1  2977	19EF  18BAr			     DW	$USE
   2978	19F1  0026				 DW 46Q	; Диагностические сообщения обычно размещаются
   2979						     ; на экранах 4 и 5. Если это не так, задачу можно решить,
   2980						     ; поменяв значение	OFFSET или исправив число, стоящее
   2981						     ; перед OFFSET в описании MESSAGE
   2982
   2983						 HEAD	  87h,'CONTEX',324Q,CONT,$USE	      ;	CONTEXT
1  2984	      =ARRAY:19F3		 LINK$=$
1  2985	19F3  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  2986							 ; 6 - признак immediate. 5- слово не описано
1  2987	19F4  43 4F 4E 54 45 58		     DB	 'CONTEX'
1  2988	19FA  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  2989	19FB  19E6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2990	      =ARRAY:19F3		 LINK=LINK$
1  2991	19FD				 CONT LABEL FAR	 ; CFA
1  2992	19FD  18BAr			     DW	$USE
   2993					 ; Пребывание в	том  или ином  словаре	контролируется системной переменной
   2994					 ; CONTEXT,  в которой хранится	 ссылка	 на  адрес  последнего	слова,
   2995					 ; описанного  в  данном (контекстном) словаре.
   2996	19FF  0028				 DW 50Q	; Указатель, с какого словаря следует начинать просмотр
   2997							; при интерпретации
   2998
   2999						 HEAD	 87h, 'CURREN',324Q,CURR,$USE	     ; CURRENT
1  3000	      =ARRAY:1A01		 LINK$=$
1  3001	1A01  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  3002							 ; 6 - признак immediate. 5- слово не описано
1  3003	1A02  43 55 52 52 45 4E		     DB	 'CURREN'
1  3004	1A08  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3005	1A09  19F3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3006	      =ARRAY:1A01		 LINK=LINK$
1  3007	1A0B				 CURR LABEL FAR	 ; CFA
1  3008	1A0B  18BAr			     DW	$USE
   3009	1A0D  002A				 DW 52Q	 ; хранящая ссылку в слове Словаря на последнее	слово,
   3010							 ; описанное в текущем Словаре.	очевидно, что
   3011							 ; текущий Словарь может не совпадать с	контекстным
   3012
   3013						 HEAD	  85h,'STAT',305Q,STATE,$USE	      ;	STATE
1  3014	      =ARRAY:1A0F		 LINK$=$
1  3015	1A0F  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3016							 ; 6 - признак immediate. 5- слово не описано
1  3017	1A10  53 54 41 54		     DB	 'STAT'
1  3018	1A14  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3019	1A15  1A01r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3020	      =ARRAY:1A0F		 LINK=LINK$
1  3021	1A17				 STATE LABEL FAR  ; CFA
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 54
forth.asm



1  3022	1A17  18BAr			     DW	$USE
   3023	1A19  002C				 DW 54Q	 ; 0=> Исполнение
   3024
   3025						 HEAD	  84h,'BAS',305Q,BASE,$USE	      ;	BASE
1  3026	      =ARRAY:1A1B		 LINK$=$
1  3027	1A1B  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3028							 ; 6 - признак immediate. 5- слово не описано
1  3029	1A1C  42 41 53			     DB	 'BAS'
1  3030	1A1F  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3031	1A20  1A0Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3032	      =ARRAY:1A1B		 LINK=LINK$
1  3033	1A22				 BASE LABEL FAR	 ; CFA
1  3034	1A22  18BAr			     DW	$USE
   3035	1A24  002E				 DW 56Q	 ; система исчисления
   3036
   3037						 HEAD	  83h,'DP',314Q,DPL,$USE	      ;	DPL
1  3038	      =ARRAY:1A26		 LINK$=$
1  3039	1A26  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3040							 ; 6 - признак immediate. 5- слово не описано
1  3041	1A27  44 50			     DB	 'DP'
1  3042	1A29  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3043	1A2A  1A1Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3044	      =ARRAY:1A26		 LINK=LINK$
1  3045	1A2C				 DPL LABEL FAR	; CFA
1  3046	1A2C  18BAr			     DW	$USE
   3047	1A2E  0030				 DW 60Q	; DPL определяет положение десятичной запятой (во входном
   3048							; представлении	это точка), для	чисел одинарной	длины DPL=-1.
   3049
   3050						 HEAD	  83h,'CS',320Q,CSP,$USE	      ;	CSP
1  3051	      =ARRAY:1A30		 LINK$=$
1  3052	1A30  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3053							 ; 6 - признак immediate. 5- слово не описано
1  3054	1A31  43 53			     DB	 'CS'
1  3055	1A33  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  3056	1A34  1A26r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3057	      =ARRAY:1A30		 LINK=LINK$
1  3058	1A36				 CSP LABEL FAR	; CFA
1  3059	1A36  18BAr			     DW	$USE
   3060	1A38  0034				 DW 64Q
   3061
   3062						 HEAD	  82h,'R',243Q,RNUM,$USE	      ;	R#
1  3063	      =ARRAY:1A3A		 LINK$=$
1  3064	1A3A  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3065							 ; 6 - признак immediate. 5- слово не описано
1  3066	1A3B  52			     DB	 'R'
1  3067	1A3C  A3			     DB	 243Q	; последний символ слова + 128 (7 бит =	1).
1  3068	1A3D  1A30r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3069	      =ARRAY:1A3A		 LINK=LINK$
1  3070	1A3F				 RNUM LABEL FAR	 ; CFA
1  3071	1A3F  18BAr			     DW	$USE
   3072	1A41  0036				 DW 66Q	; указатель  положения	курсора	 на  экране
   3073
   3074						 HEAD	  83h,'HL',304Q,HLD,$USE	      ;	HLD
1  3075	      =ARRAY:1A43		 LINK$=$
1  3076	1A43  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3077							 ; 6 - признак immediate. 5- слово не описано
1  3078	1A44  48 4C			     DB	 'HL'
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 55
forth.asm



1  3079	1A46  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  3080	1A47  1A3Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3081	      =ARRAY:1A43		 LINK=LINK$
1  3082	1A49				 HLD LABEL FAR	; CFA
1  3083	1A49  18BAr			     DW	$USE
   3084	1A4B  0038				 DW 70Q	; которая является указателем позиции
   3085							; в выходном буфере (обычно PAD)
   3086
   3087						 HEAD	  83h,'US',305Q,USE,$USE	      ;	USE
1  3088	      =ARRAY:1A4D		 LINK$=$
1  3089	1A4D  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3090							 ; 6 - признак immediate. 5- слово не описано
1  3091	1A4E  55 53			     DB	 'US'
1  3092	1A50  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3093	1A51  1A43r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3094	      =ARRAY:1A4D		 LINK=LINK$
1  3095	1A53				 USE LABEL FAR	; CFA
1  3096	1A53  18BAr			     DW	$USE
   3097	1A55  003A				 DW 72Q	;
   3098
   3099						 HEAD	  84h,'PRE',326Q,PREV,$USE	      ;	PREV
1  3100	      =ARRAY:1A57		 LINK$=$
1  3101	1A57  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3102							 ; 6 - признак immediate. 5- слово не описано
1  3103	1A58  50 52 45			     DB	 'PRE'
1  3104	1A5B  D6			     DB	 326Q	; последний символ слова + 128 (7 бит =	1).
1  3105	1A5C  1A4Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3106	      =ARRAY:1A57		 LINK=LINK$
1  3107	1A5E				 PREV LABEL FAR	 ; CFA
1  3108	1A5E  18BAr			     DW	$USE
   3109	1A60  003C				 DW 74Q	; адрес	экранного блока
   3110
   3111						 HEAD	  83h,'$E',330Q,$EX,$USE	      ;	EXP
1  3112	      =ARRAY:1A62		 LINK$=$
1  3113	1A62  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3114							 ; 6 - признак immediate. 5- слово не описано
1  3115	1A63  24 45			     DB	 '$E'
1  3116	1A65  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  3117	1A66  1A57r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3118	      =ARRAY:1A62		 LINK=LINK$
1  3119	1A68				 $EX LABEL FAR	; CFA
1  3120	1A68  18BAr			     DW	$USE
   3121	1A6A  003E				 DW 76Q	 ; целочисленное значение  порядка  числа,
   3122							 ; который  следует  за	признаком Е
   3123
   3124						 HEAD	  83h,'ER',302Q,ERB,$USE	      ;	ERB
1  3125	      =ARRAY:1A6C		 LINK$=$
1  3126	1A6C  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3127							 ; 6 - признак immediate. 5- слово не описано
1  3128	1A6D  45 52			     DB	 'ER'
1  3129	1A6F  C2			     DB	 302Q	; последний символ слова + 128 (7 бит =	1).
1  3130	1A70  1A62r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3131	      =ARRAY:1A6C		 LINK=LINK$
1  3132	1A72				 ERB LABEL FAR	; CFA
1  3133	1A72  18BAr			     DW	$USE
   3134	1A74  0040				 DW 100Q ; 64d 40h
   3135						 ; Если	ERB=0,	ERROR  работает	 обычным  образом,  в противном	случае
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 56
forth.asm



   3136						 ; переменная ERB обнуляется,  а уход из  программы  в	Форт  через  QUIT
   3137						 ; блокируется.
   3138
   3139					     ;** Слова высокого	уровня **
   3140
   3141						 HEAD	  85h,'?TER',315Q,?TERM,$COL	      ;	?TERM
1  3142	      =ARRAY:1A76		 LINK$=$
1  3143	1A76  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3144							 ; 6 - признак immediate. 5- слово не описано
1  3145	1A77  3F 54 45 52		     DB	 '?TER'
1  3146	1A7B  CD			     DB	 315Q	; последний символ слова + 128 (7 бит =	1).
1  3147	1A7C  1A6Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3148	      =ARRAY:1A76		 LINK=LINK$
1  3149	1A7E				 ?TERM LABEL FAR  ; CFA
1  3150	1A7E  1852r			     DW	$COL
   3151					 ; вывод в стек	кода символа из	буфера клавиатуры без ожидания нажатия
   3152	1A80  1257r 0EBCr 00FF	  +		 DW ?TER$,LIT,377Q,$AND,SEMI
   3153	      13E0r 1479r
   3154
   3155						 HEAD	  82h,'C',322Q,CR,$COL		      ;	CR
1  3156	      =ARRAY:1A8A		 LINK$=$
1  3157	1A8A  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3158							 ; 6 - признак immediate. 5- слово не описано
1  3159	1A8B  43			     DB	 'C'
1  3160	1A8C  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  3161	1A8D  1A76r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3162	      =ARRAY:1A8A		 LINK=LINK$
1  3163	1A8F				 CR LABEL FAR  ; CFA
1  3164	1A8F  1852r			     DW	$COL
   3165					 ; вывод символов 0D 0A
   3166	1A91  0EBCr 000D 113Er	  +		 DW LIT,15Q,EMIT,LIT,12Q,EMIT,SEMI
   3167	      0EBCr 000A 113Er	  +
   3168	      1479r
   3169
   3170						 HEAD	  81h,,254Q,COMMA,$COL		      ;	,
1  3171	      =ARRAY:1A9F		 LINK$=$
1  3172	1A9F  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3173							 ; 6 - признак immediate. 5- слово не описано
1  3174	1AA0  AC			     DB	 254Q	; последний символ слова + 128 (7 бит =	1).
1  3175	1AA1  1A8Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3176	      =ARRAY:1A9F		 LINK=LINK$
1  3177	1AA3				 COMMA LABEL FAR  ; CFA
1  3178	1AA3  1852r			     DW	$COL
   3179					 ; в  свободную	ячейку словаря помещяем	число из стека и
   3180					 ;  занимаем эту ячейку	(смещаем указатель here)
   3181	1AA5  16E0r 1678r 190Fr	  +		 DW HERE,STORE,TWO,ALLOT,SEMI
   3182	      16F2r 1479r
   3183
   3184						 HEAD	  82h,'C',254Q,CCOM,$COL	      ;	C,
1  3185	      =ARRAY:1AAF		 LINK$=$
1  3186	1AAF  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3187							 ; 6 - признак immediate. 5- слово не описано
1  3188	1AB0  43			     DB	 'C'
1  3189	1AB1  AC			     DB	 254Q	; последний символ слова + 128 (7 бит =	1).
1  3190	1AB2  1A9Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3191	      =ARRAY:1AAF		 LINK=LINK$
1  3192	1AB4				 CCOM LABEL FAR	 ; CFA
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 57
forth.asm



1  3193	1AB4  1852r			     DW	$COL
   3194	1AB6  16E0r 1688r 1907r	  +		 DW HERE,CSTOR,ONE,ALLOT,SEMI
   3195	      16F2r 1479r
   3196
   3197						 HEAD	   85h,'SPAC',305Q,SPACE,$COL	      ;	SPACE
1  3198	      =ARRAY:1AC0		 LINK$=$
1  3199	1AC0  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3200							 ; 6 - признак immediate. 5- слово не описано
1  3201	1AC1  53 50 41 43		     DB	 'SPAC'
1  3202	1AC5  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3203	1AC6  1AAFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3204	      =ARRAY:1AC0		 LINK=LINK$
1  3205	1AC8				 SPACE LABEL FAR  ; CFA
1  3206	1AC8  1852r			     DW	$COL
   3207	1ACA  1928r 113Er 1479r			 DW BLAN,EMIT,SEMI
   3208
   3209						  HEAD	  83h,'PF','A'+80h,PFA,$COL	      ;	PFA
1  3210	      =ARRAY:1AD0		 LINK$=$
1  3211	1AD0  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3212							 ; 6 - признак immediate. 5- слово не описано
1  3213	1AD1  50 46			     DB	 'PF'
1  3214	1AD3  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  3215	1AD4  1AC0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3216	      =ARRAY:1AD0		 LINK=LINK$
1  3217	1AD6				 PFA LABEL FAR	; CFA
1  3218	1AD6  1852r			     DW	$COL
   3219					 ; NFA -> PFA
   3220	1AD8  1907r 1704r 0EBCr	  +		  DW  ONE,TRAV,LIT,5,PLUS,SEMI
   3221	      0005 136Cr 1479r
   3222
   3223						  HEAD	  83h,'?E',322Q,QERR,$COL	      ;	?ER
1  3224	      =ARRAY:1AE4		 LINK$=$
1  3225	1AE4  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3226							 ; 6 - признак immediate. 5- слово не описано
1  3227	1AE5  3F 45			     DB	 '?E'
1  3228	1AE7  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  3229	1AE8  1AD0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3230	      =ARRAY:1AE4		 LINK=LINK$
1  3231	1AEA				 QERR LABEL FAR	 ; CFA
1  3232	1AEA  1852r			     DW	$COL
   3233					 ; f errorcode -> если f=0, то без ошибок
   3234	1AEC  1528r 0EEBr 0006	  +		  DW  SWAP,ZBRAN,TTT-$,ERROR,SEMI
   3235	      1E88r 1479r
   3236	1AF6  15B7r 1479r		TTT:	  DW  DROP,SEMI
   3237
   3238						  HEAD	  85h,'?COM',320Q,QCOMP,$COL	      ;	?COMP
1  3239	      =ARRAY:1AFA		 LINK$=$
1  3240	1AFA  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3241							 ; 6 - признак immediate. 5- слово не описано
1  3242	1AFB  3F 43 4F 4D		     DB	 '?COM'
1  3243	1AFF  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  3244	1B00  1AE4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3245	      =ARRAY:1AFA		 LINK=LINK$
1  3246	1B02				 QCOMP LABEL FAR  ; CFA
1  3247	1B02  1852r			     DW	$COL
   3248					     ; проверка	режима работы. система в режиме	компиляции?
   3249	1B04  1A17r 1658r 1004r	  +		  DW  STATE,AT,ZEQU,LIT,21Q,QERR,SEMI	     ; 17
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 58
forth.asm



   3250	      0EBCr 0011 1AEAr	  +
   3251	      1479r
   3252
   3253						  HEAD	  85h,'?EXE',303Q,QEXEC,$COL	      ;	?EXEC
1  3254	      =ARRAY:1B12		 LINK$=$
1  3255	1B12  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3256							 ; 6 - признак immediate. 5- слово не описано
1  3257	1B13  3F 45 58 45		     DB	 '?EXE'
1  3258	1B17  C3			     DB	 303Q	; последний символ слова + 128 (7 бит =	1).
1  3259	1B18  1AFAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3260	      =ARRAY:1B12		 LINK=LINK$
1  3261	1B1A				 QEXEC LABEL FAR  ; CFA
1  3262	1B1A  1852r			     DW	$COL
   3263					     ; проверка	режима исполнения    0=> Исполнение
   3264	1B1C  1A17r 1658r 0EBCr	  +		  DW  STATE,AT,LIT,22Q,QERR,SEMI	     ;
   3265	      0012 1AEAr 1479r
   3266
   3267						  HEAD	  85h,'?PAI',322Q,QPAIR,$COL	      ;	?PAIR
1  3268	      =ARRAY:1B28		 LINK$=$
1  3269	1B28  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3270							 ; 6 - признак immediate. 5- слово не описано
1  3271	1B29  3F 50 41 49		     DB	 '?PAI'
1  3272	1B2D  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  3273	1B2E  1B12r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3274	      =ARRAY:1B28		 LINK=LINK$
1  3275	1B30				 QPAIR LABEL FAR  ; CFA
1  3276	1B30  1852r			     DW	$COL
   3277	1B32  137Cr 0EBCr 0013	  +		  DW  SUBB,LIT,23Q,QERR,SEMI
   3278	      1AEAr 1479r
   3279
   3280						  HEAD	  84h,'?CS',320Q,QCSP,$COL	      ;	?CSP
1  3281	      =ARRAY:1B3C		 LINK$=$
1  3282	1B3C  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3283							 ; 6 - признак immediate. 5- слово не описано
1  3284	1B3D  3F 43 53			     DB	 '?CS'
1  3285	1B40  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  3286	1B41  1B28r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3287	      =ARRAY:1B3C		 LINK=LINK$
1  3288	1B43				 QCSP LABEL FAR	 ; CFA
1  3289	1B43  1852r			     DW	$COL
   3290					     ; контролируют сохранение указателя
   3291					     ; стека параметров	в процессе интерпретации слова
   3292					     ; текущее и сохраненное значение стека должны быть	равны
   3293	1B45  144Dr 1A36r 1658r	  +		  DW  SPAT,CSP,AT,SUBB,LIT,24Q,QERR,SEMI
   3294	      137Cr 0EBCr 0014	  +
   3295	      1AEAr 1479r
   3296
   3297						  HEAD	  85h,'?LOA',304Q,QLOAD,$COL	      ;	?LOAD
1  3298	      =ARRAY:1B55		 LINK$=$
1  3299	1B55  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3300							 ; 6 - признак immediate. 5- слово не описано
1  3301	1B56  3F 4C 4F 41		     DB	 '?LOA'
1  3302	1B5A  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  3303	1B5B  1B3Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3304	      =ARRAY:1B55		 LINK=LINK$
1  3305	1B5D				 QLOAD LABEL FAR  ; CFA
1  3306	1B5D  1852r			     DW	$COL
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 59
forth.asm



   3307	1B5F  19C5r 1658r 1004r	  +		  DW  BLK,AT,ZEQU,LIT,26Q,QERR,SEMI
   3308	      0EBCr 0016 1AEAr	  +
   3309	      1479r
   3310
   3311						  HEAD	  87h,'COMPIL',305Q,COMP,$COL	      ;	COMPILE
1  3312	      =ARRAY:1B6D		 LINK$=$
1  3313	1B6D  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  3314							 ; 6 - признак immediate. 5- слово не описано
1  3315	1B6E  43 4F 4D 50 49 4C		     DB	 'COMPIL'
1  3316	1B74  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3317	1B75  1B55r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3318	      =ARRAY:1B6D		 LINK=LINK$
1  3319	1B77				 COMP LABEL FAR	 ; CFA
1  3320	1B77  1852r			     DW	$COL
   3321					 ; Компиляция исполнительного адреса, следующего за оператором
   3322	1B79  1B02r 14C3r 14B2r	  +		  DW  QCOMP,I,FROMR,TWOP,TOR,AT,COMMA,SEMI
   3323	      12B3r 14A0r 1658r	  +
   3324	      1AA3r 1479r
   3325
   3326						  HEAD	  84h,'SMU',307Q,SMUG,$COL	      ;	SMUDGE
1  3327	      =ARRAY:1B89		 LINK$=$
1  3328	1B89  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3329							 ; 6 - признак immediate. 5- слово не описано
1  3330	1B8A  53 4D 55			     DB	 'SMU'
1  3331	1B8D  C7			     DB	 307Q	; последний символ слова + 128 (7 бит =	1).
1  3332	1B8E  1B6Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3333	      =ARRAY:1B89		 LINK=LINK$
1  3334	1B90				 SMUG LABEL FAR	 ; CFA
1  3335	1B90  1852r			     DW	$COL
   3336					     ; сбрасывает 5-й бит первого байта	 описания  и  тем  самым
   3337					     ; делает	данное	 слово	полноправным  членом  текущего	словаря
   3338	1B92  177Ar 1928r 1649r	  +		  DW  LATES,BLAN,TOGL,SEMI
   3339	      1479r
   3340
   3341						  HEAD	  87h,'(;CODE',251Q,PSCOD,$COL	      ;	(;CODE)
1  3342	      =ARRAY:1B9A		 LINK$=$
1  3343	1B9A  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  3344							 ; 6 - признак immediate. 5- слово не описано
1  3345	1B9B  28 3B 43 4F 44 45		     DB	 '(;CODE'
1  3346	1BA1  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1  3347	1BA2  1B89r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3348	      =ARRAY:1B9A		 LINK=LINK$
1  3349	1BA4				 PSCOD LABEL FAR  ; CFA
1  3350	1BA4  1852r			     DW	$COL
   3351					     ; адрес из	стека возвратов	(там находится адрес начала кода на ассемблере)
   3352					     ; пишем в CFA последнего определенного слова
   3353	1BA6  14B2r 177Ar 1AD6r	  +		  DW  FROMR,LATES,PFA,CFA,STORE,SEMI
   3354	      16BCr 1678r 1479r
   3355
   3356						  HEAD	  87h,'#BUILD',323Q,BUILD,$COL	      ;	<BUILDS	;
1  3357	      =ARRAY:1BB2		 LINK$=$
1  3358	1BB2  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  3359							 ; 6 - признак immediate. 5- слово не описано
1  3360	1BB3  23 42 55 49 4C 44		     DB	 '#BUILD'
1  3361	1BB9  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  3362	1BBA  1B9Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3363	      =ARRAY:1BB2		 LINK=LINK$
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 60
forth.asm



1  3364	1BBC				 BUILD LABEL FAR  ; CFA
1  3365	1BBC  1852r			     DW	$COL
   3366					     ; формирует в словаре описание константы равной 0 с именем	XXX
   3367	1BBE  18FFr 187Fr 1479r			  DW  ZERO,CON,SEMI
   3368
   3369						  HEAD	  85h,'COUN',324Q,COUNT,$COL	      ;	COUNT
1  3370	      =ARRAY:1BC4		 LINK$=$
1  3371	1BC4  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3372							 ; 6 - признак immediate. 5- слово не описано
1  3373	1BC5  43 4F 55 4E		     DB	 'COUN'
1  3374	1BC9  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3375	1BCA  1BB2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3376	      =ARRAY:1BC4		 LINK=LINK$
1  3377	1BCC				 COUNT LABEL FAR  ; CFA
1  3378	1BCC  1852r			     DW	$COL
   3379					     ; адрес HERE+1 (это адрес первого байта слова)
   3380					     ; и число символов	в  слове  (HERE	 C@)
   3381	1BCE  155Cr 12A4r 1528r	  +		  DW  DUBL,ONEP,SWAP,CAT,SEMI
   3382	      1667r 1479r
   3383
   3384						  HEAD	  84h,'TYP',305Q,$TYPE,$COL	      ;	TYPE
1  3385	      =ARRAY:1BD8		 LINK$=$
1  3386	1BD8  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3387							 ; 6 - признак immediate. 5- слово не описано
1  3388	1BD9  54 59 50			     DB	 'TYP'
1  3389	1BDC  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3390	1BDD  1BC4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3391	      =ARRAY:1BD8		 LINK=LINK$
1  3392	1BDF				 $TYPE LABEL FAR  ; CFA
1  3393	1BDF  1852r			     DW	$COL
   3394					 ; адр u -> вывод строки на экран
   3395	1BE1  156Dr 0EEBr 001C	  +		  DW  DDUP,ZBRAN,TC1-$,ZERO,XDO
   3396	      18FFr 0F14r
   3397	1BEB  155Cr 14C3r 136Cr	  +	TC0:	  DW  DUBL,I,PLUS,CAT,LIT,177Q,$AND
   3398	      1667r 0EBCr 007F	  +
   3399	      13E0r
   3400	1BF9  1907r 110Fr 0F31r	  +		  DW  ONE,EMI$,XLOOP,TC0-$
   3401	      FFEC
   3402	1C01  15B7r 1479r		TC1:	  DW  DROP,SEMI
   3403
   3404						  HEAD	  84h,'(."',251Q,PDOTQ,$COL	      ;	(.")
1  3405	      =ARRAY:1C05		 LINK$=$
1  3406	1C05  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3407							 ; 6 - признак immediate. 5- слово не описано
1  3408	1C06  28 2E 22			     DB	 '(."'
1  3409	1C09  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1  3410	1C0A  1BD8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3411	      =ARRAY:1C05		 LINK=LINK$
1  3412	1C0C				 PDOTQ LABEL FAR  ; CFA
1  3413	1C0C  1852r			     DW	$COL
   3414	1C0E  14C3r 1BCCr 155Cr	  +		  DW  I,COUNT,DUBL,ONEP
   3415	      12A4r
   3416	1C16  14B2r 136Cr 14A0r	  +		  DW  FROMR,PLUS,TOR,$TYPE,SEMI
   3417	      1BDFr 1479r
   3418
   3419						  HEAD	  302Q,'.',242Q,D0TQ,$COL	       ; ."
1  3420	      =ARRAY:1C20		 LINK$=$
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 61
forth.asm



1  3421	1C20  C2			     DB	 302Q  ; NFA 7 бит равен 1.
1  3422							 ; 6 - признак immediate. 5- слово не описано
1  3423	1C21  2E			     DB	 '.'
1  3424	1C22  A2			     DB	 242Q	; последний символ слова + 128 (7 бит =	1).
1  3425	1C23  1C05r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3426	      =ARRAY:1C20		 LINK=LINK$
1  3427	1C25				 D0TQ LABEL FAR	 ; CFA
1  3428	1C25  1852r			     DW	$COL
   3429	1C27  0EBCr 0022 1A17r	  +		  DW  LIT,34,STATE,AT,ZBRAN,XT-$
   3430	      1658r 0EEBr 0012
   3431	1C33  1B77r 1C0Cr 1CA6r	  +		  DW  COMP,PDOTQ,$WORD,HERE,CAT,ONEP
   3432	      16E0r 1667r 12A4r
   3433	1C3F  16F2r 1479r			  DW  ALLOT, SEMI
   3434	1C43  1CA6r 16E0r 1BCCr	  +	XT:	  DW  $WORD,HERE,COUNT,$TYPE,SEMI
   3435	      1BDFr 1479r
   3436
   3437						  HEAD	  85h,'QUER',331Q,QUERY,$COL	      ;	QUERY
1  3438	      =ARRAY:1C4D		 LINK$=$
1  3439	1C4D  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3440							 ; 6 - признак immediate. 5- слово не описано
1  3441	1C4E  51 55 45 52		     DB	 'QUER'
1  3442	1C52  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  3443	1C53  1C20r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3444	      =ARRAY:1C4D		 LINK=LINK$
1  3445	1C55				 QUERY LABEL FAR  ; CFA
1  3446	1C55  1852r			     DW	$COL
   3447					 ; входной буфер,  адрес которого хранится в системной переменной
   3448					 ; по имени TIB	(Terminal Input	Buffer).  Ввод	в  этот	 буфер
   3449					 ; осуществляется оператором QUERY
   3450	1C57  1956r 1658r 16BCr	  +		  DW  TIB,AT,CFA,LIT,120Q,EXPE
   3451	      0EBCr 0050 1232r
   3452	1C63  18FFr 19CEr 1678r	  +		  DW  ZERO,$IN,STORE,CR,SEMI
   3453	      1A8Fr 1479r
   3454
   3455						  HEAD	  301Q,,200Q,NULL,$COL		       ; NULL
1  3456	      =ARRAY:1C6D		 LINK$=$
1  3457	1C6D  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  3458							 ; 6 - признак immediate. 5- слово не описано
1  3459	1C6E  80			     DB	 200Q	; последний символ слова + 128 (7 бит =	1).
1  3460	1C6F  1C4Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3461	      =ARRAY:1C6D		 LINK=LINK$
1  3462	1C71				 NULL LABEL FAR	 ; CFA
1  3463	1C71  1852r			     DW	$COL
   3464					 ;
   3465	1C73  19C5r 1658r 0EEBr	  +		  DW  BLK,AT,ZBRAN,NUL-$
   3466	      0010
   3467	1C7B  1907r 19C5r 1637r	  +		  DW  ONE,BLK,PSTOR,ZERO,$IN,STORE,QEXEC
   3468	      18FFr 19CEr 1678r	  +
   3469	      1B1Ar
   3470	1C89  14E7r 1479r		NUL:	  DW  LEV,SEMI
   3471
   3472						  HEAD	  83h,'PA',304Q,PAD,$COL	      ;	PAD
1  3473	      =ARRAY:1C8D		 LINK$=$
1  3474	1C8D  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3475							 ; 6 - признак immediate. 5- слово не описано
1  3476	1C8E  50 41			     DB	 'PA'
1  3477	1C90  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 62
forth.asm



1  3478	1C91  1C6Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3479	      =ARRAY:1C8D		 LINK=LINK$
1  3480	1C93				 PAD LABEL FAR	; CFA
1  3481	1C93  1852r			     DW	$COL
   3482					     ; Многие операции	 выдачи	  результатов	и   сообщений	на   экран
   3483					     ; производятся   через   специальный   буфер,   адрес   которого  смещен
   3484					     ; относительно HERE.  В базовом словаре имеется  оператор	PAD,  который
   3485					     ; выдает в	стек адрес начала этого	буфера:
   3486	1C95  16E0r 0EBCr 0044	  +		  DW  HERE,LIT,104Q,PLUS,SEMI
   3487	      136Cr 1479r
   3488
   3489						  HEAD	  84h,'WOR',304Q,$WORD,$COL	      ;	WORD
1  3490	      =ARRAY:1C9F		 LINK$=$
1  3491	1C9F  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3492							 ; 6 - признак immediate. 5- слово не описано
1  3493	1CA0  57 4F 52			     DB	 'WOR'
1  3494	1CA3  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  3495	1CA4  1C8Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3496	      =ARRAY:1C9F		 LINK=LINK$
1  3497	1CA6				 $WORD LABEL FAR  ; CFA
1  3498	1CA6  1852r			     DW	$COL
   3499					     ; разделитель -> число_символов строка по адресу here
   3500	1CA8  19C5r 1658r 156Dr	  +		  DW  BLK,AT,DDUP,ZBRAN,WD1-$; ввод с клавиатуры
   3501	      0EEBr 0008
   3502	1CB2  21B3r 0F04r 0006			  DW  BLOCK,BRAN,WD2-$	     ; адрес буфера из переменной BLK
   3503	1CB8  1956r 1658r		WD1:	  DW  TIB,AT		     ; адрес входного терминала
   3504	1CBC  19CEr 1658r 136Cr	  +	WD2:	  DW  $IN,AT,PLUS,SWAP,ENCL,HERE,BLAN,BLANK,$IN
   3505	      1528r 1088r 16E0r	  +
   3506	      1928r 1614r 19CEr
   3507	1CCE  1637r 14A0r 14C3r	  +		  DW  PSTOR,TOR,I,HERE,CSTOR
   3508	      16E0r 1688r
   3509	1CD8  16E0r 12A4r 14B2r	  +		  DW  HERE,ONEP,FROMR,CMOV,SEMI
   3510	      15C9r 1479r
   3511
   3512						  HEAD	  88h,'(NUMBER',251Q,PNUMB,$COL	      ;	(NUMBER)
1  3513	      =ARRAY:1CE2		 LINK$=$
1  3514	1CE2  88			     DB	 88h  ;	NFA 7 бит равен	1.
1  3515							 ; 6 - признак immediate. 5- слово не описано
1  3516	1CE3  28 4E 55 4D 42 45	52	     DB	 '(NUMBER'
1  3517	1CEA  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1  3518	1CEB  1C9Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3519	      =ARRAY:1CE2		 LINK=LINK$
1  3520	1CED				 PNUMB LABEL FAR  ; CFA
1  3521	1CED  1852r			     DW	$COL
   3522	1CEF  12A4r 14A0r 14C3r	  +	BN:	  DW  ONEP,TOR,I,CAT,BASE,AT,DIGIT,ZBRAN,MMO-$
   3523	      1667r 1A22r 1658r	  +
   3524	      0FE2r 0EEBr 002C
   3525	1D01  1528r 1A22r 1658r	  +		  DW  SWAP,BASE,AT,USTAR,DROP,ROT,BASE,AT,USTAR
   3526	      12F3r 15B7r 1591r	  +
   3527	      1A22r 1658r 12F3r
   3528	1D13  138Dr 1A2Cr 1658r	  +		  DW  DPLUS,DPL,AT,ONEP,ZBRAN,BN1-$,ONE,DPL,PSTOR
   3529	      12A4r 0EEBr 0008	  +
   3530	      1907r 1A2Cr 1637r
   3531	1D25  14B2r 0F04r FFC6		BN1:	  DW  FROMR,BRAN,BN-$
   3532	1D2B  14B2r 1479r		MMO:	  DW  FROMR,SEMI
   3533
   3534						  HEAD	  85h,'-FIN',304Q,DFIND,$COL	      ;	-FIND
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 63
forth.asm



1  3535	      =ARRAY:1D2F		 LINK$=$
1  3536	1D2F  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3537							 ; 6 - признак immediate. 5- слово не описано
1  3538	1D30  2D 46 49 4E		     DB	 '-FIN'
1  3539	1D34  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  3540	1D35  1CE2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3541	      =ARRAY:1D2F		 LINK=LINK$
1  3542	1D37				 DFIND LABEL FAR  ; CFA
1  3543	1D37  1852r			     DW	$COL
   3544					     ; Поиск слова в словаре, которое следует следующим	в тексте программы
   3545	1D39  1928r 1CA6r 16E0r	  +		  DW  BLAN,$WORD,HERE,COUNT,UPPER,HERE
   3546	      1BCCr 17ACr 16E0r
   3547	1D45  19FDr 1658r 1658r			  DW  CONT,AT,AT ; поиска в контекстном	словаре
   3548	1D4B  0F73r 156Dr 1004r	  +		  DW  PFIND,DDUP,ZEQU,ZBRAN,FIN-$,HERE,LATES,PFIND
   3549	      0EEBr 0008 16E0r	  +
   3550	      177Ar 0F73r
   3551	1D5B  1479r			FIN:	  DW  SEMI
   3552
   3553						  HEAD	  86h,'NUMBE',322Q,NUMB,$COL	      ;	NUMBER
1  3554	      =ARRAY:1D5D		 LINK$=$
1  3555	1D5D  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  3556							 ; 6 - признак immediate. 5- слово не описано
1  3557	1D5E  4E 55 4D 42 45		     DB	 'NUMBE'
1  3558	1D63  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  3559	1D64  1D2Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3560	      =ARRAY:1D5D		 LINK=LINK$
1  3561	1D66				 NUMB LABEL FAR	 ; CFA
1  3562	1D66  1852r			     DW	$COL
   3563	1D68  18FFr 1A68r 1678r	  +		  DW  ZERO,$EX,STORE,BASE,AT,ZERO,ROT
   3564	      1A22r 1658r 18FFr	  +
   3565	      1591r
   3566	1D76  12A4r 155Cr 1667r	  +		  DW  ONEP,DUBL,CAT,DUBL,LIT,53Q,EQUAL
   3567	      155Cr 0EBCr 002B	  +
   3568	      103Br
   3569	1D84  0EEBr 000A 1751r	  +		  DW  ZBRAN,NH1-$,DECIMA,DROP,BRAN,NH4-$
   3570	      15B7r 0F04r 002E
   3571	1D90  155Cr 0EBCr 002D	  +	NH1:	  DW  DUBL,LIT,55Q,EQUAL,ZBRAN,NH2-$,DROP,DECIMA
   3572	      103Br 0EEBr 0012	  +
   3573	      15B7r 1751r
   3574	1DA0  1528r 15B7r 1907r	  +		  DW  SWAP,DROP,ONE,SWAP,BRAN,NH4-$
   3575	      1528r 0F04r 0012
   3576	1DAC  0EBCr 0027 103Br	  +	NH2:	  DW  LIT,47Q,EQUAL,ZBRAN,NH3-$,OCTAL,ONEP
   3577	      0EEBr 0006 1765r	  +
   3578	      12A4r
   3579	1DBA  12C4r			NH3:	  DW  ONEM
   3580	1DBC  0EBCr FFFF 1A2Cr	  +	NH4:	  DW  LIT,-1,DPL,STORE,ZERO,ZERO,ROT,PNUMB,DUBL
   3581	      1678r 18FFr 18FFr	  +
   3582	      1591r 1CEDr 155Cr
   3583	1DCE  1667r 1928r 137Cr	  +		  DW  CAT,BLAN,SUBB,ZBRAN,NH6-$
   3584	      0EEBr 0088
   3585	1DD8  155Cr 1667r 0EBCr	  +		  DW  DUBL,CAT,LIT,56Q,EQUAL,ZBRAN,EXP-$
   3586	      002E 103Br 0EEBr	  +
   3587	      0016
   3588	1DE6  18FFr 1A2Cr 1678r	  +		  DW  ZERO,DPL,STORE,PNUMB,DUBL,CAT,BLAN,SUBB,ZBRAN,NH6-$
   3589	      1CEDr 155Cr 1667r	  +
   3590	      1928r 137Cr 0EEBr	  +
   3591	      0066
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 64
forth.asm



   3592	1DFA  1A2Cr 1658r 1528r	  +	EXP:	  DW  DPL,AT,SWAP,DUBL,CAT,LIT
   3593	      155Cr 1667r 0EBCr
   3594	1E06  0045 103Br 0EEBr	  +		  DW  105Q,EQUAL,ZBRAN,ER1-$,ONEP,DUBL,CAT
   3595	      0068 12A4r 155Cr	  +
   3596	      1667r
   3597	1E14  0EBCr 002D 103Br	  +		  DW  LIT,55Q,EQUAL,ZBRAN,NEMI-$,ONE,BRAN,NH0-$
   3598	      0EEBr 0008 1907r	  +
   3599	      0F04r 0014
   3600	1E24  155Cr 1667r 0EBCr	  +	NEMI:	  DW  DUBL,CAT,LIT,53Q,SUBB,ZBRAN,PLU-$,ONEM
   3601	      002B 137Cr 0EEBr	  +
   3602	      0004 12C4r
   3603	1E34  18FFr			PLU:	  DW  ZERO
   3604	1E36  1528r 18FFr 18FFr	  +	NH0:	  DW  SWAP,ZERO,ZERO,ROT,PNUMB,CAT,BLAN,EQUAL,ZBRAN,ER-$
   3605	      1591r 1CEDr 1667r	  +
   3606	      1928r 103Br 0EEBr	  +
   3607	      0028
   3608	1E4A  15B7r 1528r 0EEBr	  +		  DW  DROP,SWAP,ZBRAN,NH5-$,MINUS
   3609	      0004 13A7r
   3610	1E54  1A68r 1678r 1A2Cr	  +	NH5:	  DW  $EX,STORE,DPL,STORE,ZERO
   3611	      1678r 18FFr
   3612	1E5E  15B7r 1591r 0EEBr	  +	NH6:	  DW  DROP,ROT,ZBRAN,NH7-$,DMINU
   3613	      0004 132Er
   3614	1E68  1591r 1A22r 1678r	  +	NH7:	  DW  ROT,BASE,STORE,SEMI
   3615	      1479r
   3616	1E70  15A6r 15B7r		ER:	  DW  DDROP,DROP
   3617	1E74  15A6r 15A6r 15B7r	  +	ER1:	  DW  DDROP,DDROP,DROP,ZERO,ERROR,SEMI
   3618	      18FFr 1E88r 1479r
   3619
   3620						  HEAD	  85h,'ERRO',322Q,ERROR,$COL	      ;	ERROR
1  3621	      =ARRAY:1E80		 LINK$=$
1  3622	1E80  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3623							 ; 6 - признак immediate. 5- слово не описано
1  3624	1E81  45 52 52 4F		     DB	 'ERRO'
1  3625	1E85  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  3626	1E86  1D5Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3627	      =ARRAY:1E80		 LINK=LINK$
1  3628	1E88				 ERROR LABEL FAR  ; CFA
1  3629	1E88  1852r			     DW	$COL
   3630	1E8A  16E0r 1BCCr 1BDFr	  +		  DW  HERE,COUNT,$TYPE,PDOTQ
   3631	      1C0Cr
   3632	1E92  03 20 3F 20			  DB  3	, ' ? '
   3633	1E96  1A72r 1658r 0EEBr	  +		  DW  ERB,AT,ZBRAN,XER-$
   3634	      000C
   3635	1E9E  18FFr 1A72r 1678r	  +		  DW  ZERO,ERB,STORE,DROP,SEMI
   3636	      15B7r 1479r
   3637	1EA8  222Dr 1459r 203Br		XER:	  DW  MESS,SPSTO,QUIT
   3638
   3639						  HEAD	  83h,'ID',256Q,IDDOT,$COL	      ;	ID.
1  3640	      =ARRAY:1EAE		 LINK$=$
1  3641	1EAE  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3642							 ; 6 - признак immediate. 5- слово не описано
1  3643	1EAF  49 44			     DB	 'ID'
1  3644	1EB1  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  3645	1EB2  1E80r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3646	      =ARRAY:1EAE		 LINK=LINK$
1  3647	1EB4				 IDDOT LABEL FAR  ; CFA
1  3648	1EB4  1852r			     DW	$COL
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 65
forth.asm



   3649					     ; печатает	  имя	слова
   3650	1EB6  1BCCr 0EBCr 001F	  +		  DW  COUNT,LIT,37Q,$AND,$TYPE,SPACE,SEMI
   3651	      13E0r 1BDFr 1AC8r	  +
   3652	      1479r
   3653
   3654						  HEAD	  86h,'CREAT',305Q,CREAT,$COL	      ;	CREATE	- --> адр XXX (I, C)
1  3655	      =ARRAY:1EC4		 LINK$=$
1  3656	1EC4  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  3657							 ; 6 - признак immediate. 5- слово не описано
1  3658	1EC5  43 52 45 41 54		     DB	 'CREAT'
1  3659	1ECA  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3660	1ECB  1EAEr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3661	      =ARRAY:1EC4		 LINK=LINK$
1  3662	1ECD				 CREAT LABEL FAR  ; CFA
1  3663	1ECD  1852r			     DW	$COL
   3664					     ; формирование новых слов - описателей.
   3665					     ; (CREATE XXX DOES>) XXX исполняется на этапе компиляции,
   3666					     ; текст программы,	следующий за DOES>, - на этапе исполнения.
   3667					     ; При исполнении DOES> выдает в стек PFA вновь определенного слова
   3668	1ECF  1D37r 0EEBr 0010	  +		  DW  DFIND,ZBRAN,CRE-$,DROP,TWOP,NFA,IDDOT
   3669	      15B7r 12B3r 1699r	  +
   3670	      1EB4r
   3671	1EDD  0EBCr 0004 222Dr			  DW  LIT,4,MESS
   3672	1EE3  16E0r 155Cr 1667r	  +	CRE:	  DW  HERE,DUBL,CAT,$WIDTH,AT,MIN,ONEP,ALLOT ; here указывает на число символов	слова
   3673	      1962r 1658r 1423r	  +
   3674	      12A4r 16F2r
   3675										     ; сдвигаем	here на	длину слова + сам байт длины
   3676	1EF3  155Cr 0EBCr 00A0	  +		  DW  DUBL,LIT,240Q,TOGL,HERE,ONEM   ; выключаем из поиска
   3677	      1649r 16E0r 12C4r
   3678										     ; 240Q = 10100000
   3679	1EFF  0EBCr 0080 1649r	  +		  DW  LIT,200Q,TOGL,LATES,COMMA,CURR,AT,STORE ;	в последней букве слова	включаем 7  +
   3680	      177Ar 1AA3r 1A0Br	  +  бит
   3681	      1658r 1678r
   3682										 ; ссылка на пред слово	и сохраняем ссылку на вновь
   3683										 ; созданное слово
   3684	1F0F  16E0r 12B3r 1AA3r	  +		  DW  HERE,TWOP,COMMA,SEMI	 ; в словарь адрес here
   3685	      1479r
   3686
   3687						  HEAD	  311Q,'[COMPILE',335Q,BCOM,$COL       ; [COMPILE]
1  3688	      =ARRAY:1F17		 LINK$=$
1  3689	1F17  C9			     DB	 311Q  ; NFA 7 бит равен 1.
1  3690							 ; 6 - признак immediate. 5- слово не описано
1  3691	1F18  5B 43 4F 4D 50 49	4C+	     DB	 '[COMPILE'
   3692	      45
1  3693	1F20  DD			     DB	 335Q	; последний символ слова + 128 (7 бит =	1).
1  3694	1F21  1EC4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3695	      =ARRAY:1F17		 LINK=LINK$
1  3696	1F23				 BCOM LABEL FAR	 ; CFA
1  3697	1F23  1852r			     DW	$COL
   3698					     ; Используется в описании типа двоеточия и	служит для
   3699						     ; компиляции слова	немедленного действия XXX, как если бы оно
   3700					     ; не было таким. Слово XXX	будет исполнено	тогда, когда будет
   3701					     ; исполнено слово,	в котором использована комбинация [COMPILE] XXX
   3702					     ; кладет в	словарь	CFA компилируемого слова
   3703	1F25  1D37r 1004r 18FFr	  +		  DW  DFIND,ZEQU,ZERO,QERR,DROP,COMMA,SEMI
   3704	      1AEAr 15B7r 1AA3r	  +
   3705	      1479r
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 66
forth.asm



   3706
   3707						 HEAD	 307Q,'LITERA',314Q,LITER,$COL	      ;	LITERAL
1  3708	      =ARRAY:1F33		 LINK$=$
1  3709	1F33  C7			     DB	 307Q  ; NFA 7 бит равен 1.
1  3710							 ; 6 - признак immediate. 5- слово не описано
1  3711	1F34  4C 49 54 45 52 41		     DB	 'LITERA'
1  3712	1F3A  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3713	1F3B  1F17r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3714	      =ARRAY:1F33		 LINK=LINK$
1  3715	1F3D				 LITER LABEL FAR  ; CFA
1  3716	1F3D  1852r			     DW	$COL
   3717					 ; компилирует число в словарь
   3718	1F3F  1A17r 1658r 0EEBr	  +		 DW  STATE,AT,ZBRAN,LIL-$	; в режиме исполнения ничего не	делает
   3719	      0008
   3720	1F47  1B77r 0EBCr 1AA3r			 DW  COMP,LIT,COMMA
   3721	1F4D  1479r			 LIL:	 DW  SEMI
   3722
   3723						  HEAD	  310Q,'DLITERA',314Q,DLITE,$COL       ; DLITERAL
1  3724	      =ARRAY:1F4F		 LINK$=$
1  3725	1F4F  C8			     DB	 310Q  ; NFA 7 бит равен 1.
1  3726							 ; 6 - признак immediate. 5- слово не описано
1  3727	1F50  44 4C 49 54 45 52	41	     DB	 'DLITERA'
1  3728	1F57  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3729	1F58  1F33r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3730	      =ARRAY:1F4F		 LINK=LINK$
1  3731	1F5A				 DLITE LABEL FAR  ; CFA
1  3732	1F5A  1852r			     DW	$COL
   3733					 ; компилирует в словарь двойное число
   3734	1F5C  1A17r 1658r 0EEBr	  +		  DW  STATE,AT,ZBRAN,DLI-$
   3735	      0008
   3736	1F64  1528r 1F3Dr 1F3Dr			 DW  SWAP,LITER,LITER
   3737	1F6A  1479r			DLI:	  DW  SEMI
   3738
   3739						  HEAD	  86h,'?STAC',313Q,QSTAC,$COL	      ;	?STACK
1  3740	      =ARRAY:1F6C		 LINK$=$
1  3741	1F6C  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  3742							 ; 6 - признак immediate. 5- слово не описано
1  3743	1F6D  3F 53 54 41 43		     DB	 '?STAC'
1  3744	1F72  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  3745	1F73  1F4Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3746	      =ARRAY:1F6C		 LINK=LINK$
1  3747	1F75				 QSTAC LABEL FAR  ; CFA
1  3748	1F75  1852r			     DW	$COL
   3749					 ; -> f	, true если значение указателя стека в пределах	допусков
   3750	1F77  1943r 1658r 16BCr	  +		  DW  SZERO,AT,CFA,SPAT,ULESS,ONE,QERR
   3751	      144Dr 104Ar 1907r	  +
   3752	      1AEAr
   3753	1F85  0EBCr FF80 144Dr	  +		  DW  LIT,-200Q,SPAT,ULESS,TWO
   3754	      104Ar 190Fr
   3755	1F8F  1AEAr 1479r			  DW  QERR, SEMI
   3756
   3757						  HEAD	  211Q,'INTERPRE',324Q,INTER,$COL      ; INTERPRET
1  3758	      =ARRAY:1F93		 LINK$=$
1  3759	1F93  89			     DB	 211Q  ; NFA 7 бит равен 1.
1  3760							 ; 6 - признак immediate. 5- слово не описано
1  3761	1F94  49 4E 54 45 52 50	52+	     DB	 'INTERPRE'
   3762	      45
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 67
forth.asm



1  3763	1F9C  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3764	1F9D  1F6Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3765	      =ARRAY:1F93		 LINK=LINK$
1  3766	1F9F				 INTER LABEL FAR  ; CFA
1  3767	1F9F  1852r			     DW	$COL
   3768	1FA1  1D37r 0EEBr 0018		IT1:	  DW  DFIND,ZBRAN,IT3-$	; переход если не найдено
   3769	1FA7  1A17r 1658r 1058r	  +		  DW  STATE,AT,LESS, ZBRAN,IT2-$ ; выполнить
   3770	      0EEBr 0008
   3771	1FB1  1AA3r 0F04r 0020			  DW  COMMA,BRAN,IT5-$
   3772	1FB7  0EB1r 0F04r 001A		IT2:	  DW  EXEC,BRAN,IT5-$
   3773	1FBD  16E0r 1D66r 1A2Cr	  +	IT3:	  DW  HERE,NUMB,DPL,AT,ONEP,ZBRAN,IT4-$
   3774	      1658r 12A4r 0EEBr	  +
   3775	      0008
   3776	1FCB  1F5Ar 0F04r 0006			  DW  DLITE,BRAN,IT5-$
   3777	1FD1  15B7r 1F3Dr		IT4:	  DW  DROP,LITER
   3778	1FD5  1F75r 0F04r FFC8		IT5:	  DW  QSTAC,BRAN,IT1-$
   3779
   3780						  HEAD	  211Q,'IMMEDIAT',305Q,IMMED,$COL      ; IMMEDIATE
1  3781	      =ARRAY:1FDB		 LINK$=$
1  3782	1FDB  89			     DB	 211Q  ; NFA 7 бит равен 1.
1  3783							 ; 6 - признак immediate. 5- слово не описано
1  3784	1FDC  49 4D 4D 45 44 49	41+	     DB	 'IMMEDIAT'
   3785	      54
1  3786	1FE4  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3787	1FE5  1F93r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3788	      =ARRAY:1FDB		 LINK=LINK$
1  3789	1FE7				 IMMED LABEL FAR  ; CFA
1  3790	1FE7  1852r			     DW	$COL
   3791	1FE9  177Ar 1931r 1649r	  +		  DW  LATES,$CL,TOGL,SEMI
   3792	      1479r
   3793
   3794						 HEAD	 212Q,'VOCABULAR',331Q,VOCAB,$COL     ;	VOCABULARY
1  3795	      =ARRAY:1FF1		 LINK$=$
1  3796	1FF1  8A			     DB	 212Q  ; NFA 7 бит равен 1.
1  3797							 ; 6 - признак immediate. 5- слово не описано
1  3798	1FF2  56 4F 43 41 42 55	4C+	     DB	 'VOCABULAR'
   3799	      41 52
1  3800	1FFB  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  3801	1FFC  1FDBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3802	      =ARRAY:1FF1		 LINK=LINK$
1  3803	1FFE				 VOCAB LABEL FAR  ; CFA
1  3804	1FFE  1852r			     DW	$COL
   3805					 ; создание нового словаря
   3806	2000  1BBCr 0EBCr A081	  +		 DW  BUILD,LIT,120201Q,COMMA ;
   3807	      1AA3r
   3808	2008  1A0Br 1658r 16BCr	  +		 DW  CURR,AT,CFA,COMMA
   3809	      1AA3r
   3810	2010  16E0r 1990r 1658r	  +		 DW  HERE,VOCL,AT,COMMA,VOCL,STORE,DOES
   3811	      1AA3r 1990r 1678r	  +
   3812	      18CFr
   3813	201E				 DOVOC	 LABEL	  FAR
   3814	201E  12B3r 19FDr 1678r	  +		 DW  TWOP,CONT,STORE,SEMI
   3815	      1479r
   3816
   3817						  HEAD	  301Q,,250Q,PAREN,$COL		       ; (
1  3818	      =ARRAY:2026		 LINK$=$
1  3819	2026  C1			     DB	 301Q  ; NFA 7 бит равен 1.
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 68
forth.asm



1  3820							 ; 6 - признак immediate. 5- слово не описано
1  3821	2027  A8			     DB	 250Q	; последний символ слова + 128 (7 бит =	1).
1  3822	2028  1FF1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3823	      =ARRAY:2026		 LINK=LINK$
1  3824	202A				 PAREN LABEL FAR  ; CFA
1  3825	202A  1852r			     DW	$COL
   3826					     ; пропуск до следующей )
   3827	202C  0EBCr 0029 1CA6r	  +		  DW  LIT,29h,$WORD,SEMI
   3828	      1479r
   3829
   3830						  HEAD	  84h,'QUI',324Q,QUIT,$COL	      ;	QUIT
1  3831	      =ARRAY:2034		 LINK$=$
1  3832	2034  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3833							 ; 6 - признак immediate. 5- слово не описано
1  3834	2035  51 55 49			     DB	 'QUI'
1  3835	2038  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3836	2039  2026r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3837	      =ARRAY:2034		 LINK=LINK$
1  3838	203B				 QUIT LABEL FAR	 ; CFA
1  3839	203B  1852r			     DW	$COL
   3840					 ; Очищает оба стека и возвращает управление терминалу.
   3841					 ; Не выдается никаких сообщений
   3842	203D  18FFr 19C5r 1678r	  +		  DW  ZERO,BLK,STORE,LBRAC
   3843	      1719r
   3844	2045  1469r 1A8Fr 1C55r	  +	QUI:	  DW  RPSTO,CR,QUERY,INTER,STATE,AT
   3845	      1F9Fr 1A17r 1658r
   3846	2051  1004r 0EEBr FFF0	  +		  DW  ZEQU,ZBRAN,QUI-$,PDOTQ
   3847	      1C0Cr
   3848	2059  03 20 4F 4B			  DB  3,' OK'
   3849	205D  0F04r FFE6			  DW  BRAN,QUI-$
   3850
   3851						  HEAD	  85h,'ABOR',324Q,ABORT,$COL	      ;	ABORT
1  3852	      =ARRAY:2061		 LINK$=$
1  3853	2061  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3854							 ; 6 - признак immediate. 5- слово не описано
1  3855	2062  41 42 4F 52		     DB	 'ABOR'
1  3856	2066  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3857	2067  2034r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3858	      =ARRAY:2061		 LINK=LINK$
1  3859	2069				 ABORT LABEL FAR  ; CFA
1  3860	2069  1852r			     DW	$COL
   3861					 ; Прерывает исполнение, делает	словарь	Форт контекстным,
   3862					 ; выполняет QUIT. Распечатывает версию	интерпретатора
   3863	206B  1459r 1751r 1A8Fr	  +		  DW  SPSTO,DECIMA,CR,PDOTQ
   3864	      1C0Cr
   3865	2073  11 46 4F 52 54 48	2D+		  DB  17,'FORTH-PC IS HERE '
   3866	      50 43 20 49 53 20	48+
   3867	      45 52 45 20
   3868	2085  27EFr 17D3r 203Br			  DW  FORTH,DEFIN,QUIT
   3869
   3870						  HEAD	  82h,'S',256Q,SPOT,$COL	      ;	S.
1  3871	      =ARRAY:208B		 LINK$=$
1  3872	208B  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3873							 ; 6 - признак immediate. 5- слово не описано
1  3874	208C  53			     DB	 'S'
1  3875	208D  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  3876	208E  2061r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 69
forth.asm



1  3877	      =ARRAY:208B		 LINK=LINK$
1  3878	2090				 SPOT LABEL FAR	 ; CFA
1  3879	2090  1852r			     DW	$COL
   3880					 ; печать верхнего значения со стека без его изменения
   3881	2092  155Cr 24F5r 1479r			  DW  DUBL,UDOT,SEMI
   3882
   3883						  HEAD	  81h,,252Q,STAR,$COL		      ;	*
1  3884	      =ARRAY:2098		 LINK$=$
1  3885	2098  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3886							 ; 6 - признак immediate. 5- слово не описано
1  3887	2099  AA			     DB	 252Q	; последний символ слова + 128 (7 бит =	1).
1  3888	209A  208Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3889	      =ARRAY:2098		 LINK=LINK$
1  3890	209C				 STAR LABEL FAR	 ; CFA
1  3891	209C  1852r			     DW	$COL
   3892	209E  1318r 15B7r 1479r			  DW  MSTAR,DROP,SEMI
   3893
   3894						  HEAD	  84h,'/MO',304Q,SLMOD,$COL	      ;	/MOD
1  3895	      =ARRAY:20A4		 LINK$=$
1  3896	20A4  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3897							 ; 6 - признак immediate. 5- слово не описано
1  3898	20A5  2F 4D 4F			     DB	 '/MO'
1  3899	20A8  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  3900	20A9  2098r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3901	      =ARRAY:20A4		 LINK=LINK$
1  3902	20AB				 SLMOD LABEL FAR  ; CFA
1  3903	20AB  1852r			     DW	$COL
   3904	20AD  14A0r 140Er 14B2r	  +		  DW  TOR,STOD,FROMR,MSLAS,SEMI
   3905	      135Ar 1479r
   3906
   3907						  HEAD	  81h,,257Q,SLASH,$COL		      ;	/
1  3908	      =ARRAY:20B7		 LINK$=$
1  3909	20B7  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3910							 ; 6 - признак immediate. 5- слово не описано
1  3911	20B8  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  3912	20B9  20A4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3913	      =ARRAY:20B7		 LINK=LINK$
1  3914	20BB				 SLASH LABEL FAR  ; CFA
1  3915	20BB  1852r			     DW	$COL
   3916	20BD  20ABr 1528r 15B7r	  +		  DW  SLMOD,SWAP,DROP,SEMI
   3917	      1479r
   3918
   3919						  HEAD	  83h,'MO',304Q,$MOD,$COL	      ;	MOD
1  3920	      =ARRAY:20C5		 LINK$=$
1  3921	20C5  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3922							 ; 6 - признак immediate. 5- слово не описано
1  3923	20C6  4D 4F			     DB	 'MO'
1  3924	20C8  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  3925	20C9  20B7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3926	      =ARRAY:20C5		 LINK=LINK$
1  3927	20CB				 $MOD LABEL FAR	 ; CFA
1  3928	20CB  1852r			     DW	$COL
   3929	20CD  20ABr 15B7r 1479r			  DW  SLMOD,DROP,SEMI
   3930
   3931						  HEAD	  85h,'*/MO',304Q,SSMOD,$COL	      ;. */MOD
1  3932	      =ARRAY:20D3		 LINK$=$
1  3933	20D3  85			     DB	 85h  ;	NFA 7 бит равен	1.
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 70
forth.asm



1  3934							 ; 6 - признак immediate. 5- слово не описано
1  3935	20D4  2A 2F 4D 4F		     DB	 '*/MO'
1  3936	20D8  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  3937	20D9  20C5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3938	      =ARRAY:20D3		 LINK=LINK$
1  3939	20DB				 SSMOD LABEL FAR  ; CFA
1  3940	20DB  1852r			     DW	$COL
   3941	20DD  14A0r 1318r 14B2r	  +		  DW  TOR,MSTAR,FROMR,MSLAS,SEMI
   3942	      135Ar 1479r
   3943
   3944						  HEAD	  82h,'*',257Q,SSLA,$COL	      ;	*/
1  3945	      =ARRAY:20E7		 LINK$=$
1  3946	20E7  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3947							 ; 6 - признак immediate. 5- слово не описано
1  3948	20E8  2A			     DB	 '*'
1  3949	20E9  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  3950	20EA  20D3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3951	      =ARRAY:20E7		 LINK=LINK$
1  3952	20EC				 SSLA LABEL FAR	 ; CFA
1  3953	20EC  1852r			     DW	$COL
   3954	20EE  20DBr 1528r 15B7r	  +		  DW  SSMOD,SWAP,DROP,SEMI
   3955	      1479r
   3956
   3957						  HEAD	  85h,'M/MO',304Q,MSMOD,$COL	      ;	M/MOD
1  3958	      =ARRAY:20F6		 LINK$=$
1  3959	20F6  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3960							 ; 6 - признак immediate. 5- слово не описано
1  3961	20F7  4D 2F 4D 4F		     DB	 'M/MO'
1  3962	20FB  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  3963	20FC  20E7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3964	      =ARRAY:20F6		 LINK=LINK$
1  3965	20FE				 MSMOD LABEL FAR  ; CFA
1  3966	20FE  1852r			     DW	$COL
   3967	2100  14A0r 18FFr 14C3r	  +		  DW  TOR,ZERO,I,USLAS,FROMR,SWAP,TOR,USLAS
   3968	      1305r 14B2r 1528r	  +
   3969	      14A0r 1305r
   3970	2110  14B2r 1479r		$MO:	  DW  FROMR,SEMI
   3971
   3972						  HEAD	  215Q,'EMPTY-BUFFER',323Q,MTBUF,$COL  ;EMPTY-BUFFERS
1  3973	      =ARRAY:2114		 LINK$=$
1  3974	2114  8D			     DB	 215Q  ; NFA 7 бит равен 1.
1  3975							 ; 6 - признак immediate. 5- слово не описано
1  3976	2115  45 4D 50 54 59 2D	42+	     DB	 'EMPTY-BUFFER'
   3977	      55 46 46 45 52
1  3978	2121  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  3979	2122  20F6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3980	      =ARRAY:2114		 LINK=LINK$
1  3981	2124				 MTBUF LABEL FAR  ; CFA
1  3982	2124  1852r			     DW	$COL
   3983	2126  199Cr 1658r 0EBCr	  +		  DW  FIRST,AT,LIT,0C12h,ERASE,SEMI   ;	3084 было
   3984	      0C12 1605r 1479r
   3985
   3986						  HEAD	  85h,'FLUS',310Q,FLUSH,$COL	      ;	FLUSH
1  3987	      =ARRAY:2132		 LINK$=$
1  3988	2132  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3989							 ; 6 - признак immediate. 5- слово не описано
1  3990	2133  46 4C 55 53		     DB	 'FLUS'
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 71
forth.asm



1  3991	2137  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1  3992	2138  2114r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3993	      =ARRAY:2132		 LINK=LINK$
1  3994	213A				 FLUSH LABEL FAR  ; CFA
1  3995	213A  1852r			     DW	$COL
   3996					 ; запись буферов на диск
   3997	213C  19A8r 1658r 199Cr	  +		  DW  LIMIT,AT,FIRST,AT,XDO
   3998	      1658r 0F14r
   3999	2146  14C3r 1658r 102Dr	  +	FLU:	  DW  I,AT,ZLESS,ZBRAN,FL1-$
   4000	      0EEBr 000E
   4001	2150  14C3r 12B3r 14C3r	  +		  DW  I,TWOP,I,X,ZERO, RW
   4002	      182Cr 18FFr 2759r
   4003	215C  0EBCr 0404 0F53r	  +	FL1:	  DW  LIT,1028,XPLOO,FLU-$,MTBUF,SEMI
   4004	      FFE4 2124r 1479r
   4005
   4006						  HEAD	  86h,'BUFFE',322Q,BUFFE,$COL	      ;	BUFFER
1  4007	      =ARRAY:2168		 LINK$=$
1  4008	2168  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  4009							 ; 6 - признак immediate. 5- слово не описано
1  4010	2169  42 55 46 46 45		     DB	 'BUFFE'
1  4011	216E  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4012	216F  2132r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4013	      =ARRAY:2168		 LINK=LINK$
1  4014	2171				 BUFFE LABEL FAR  ; CFA
1  4015	2171  1852r			     DW	$COL
   4016					 ; u --> адр  Резервирует блок в памяти, приписывает ему
   4017					 ; номер u, но никакого	чтения с носителя не производится
   4018	2173  1A53r 1658r 14A0r	  +		  DW  USE,AT,TOR,I	 ; адрес буфера	в стеках
   4019	      14C3r
   4020	217B  17E7r 0EEBr FFFC		BR1:	  DW  PBUF,ZBRAN,BR1-$	 ; ищем	свободный буфер
   4021	2181  1A53r 1678r			 DW USE,STORE		 ; полученный адрес сохранить в	USE
   4022	2185  14C3r 1658r 102Dr	  +		  DW  I,AT,ZLESS,ZBRAN,BR2-$ ; если buffer изменен,
   4023	      0EEBr 000E
   4024	218F  14C3r 12B3r 14C3r	  +		  DW  I,TWOP,I,X,ZERO, RW    ; то запись его на	диск
   4025	      182Cr 18FFr 2759r
   4026	219B  14C3r 1678r 14C3r	  +	BR2:	  DW  I,STORE,I,PREV,STORE   ; номер буфера записать и адрес сохранить в PREV
   4027	      1A5Er 1678r
   4028	21A5  14B2r 12B3r 1479r			 DW FROMR,TWOP,SEMI	     ; возвращаемое значение
   4029
   4030						  HEAD	  85h,'BLOC',313Q,BLOCK,$COL	      ;	BLOCK
1  4031	      =ARRAY:21AB		 LINK$=$
1  4032	21AB  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4033							 ; 6 - признак immediate. 5- слово не описано
1  4034	21AC  42 4C 4F 43		     DB	 'BLOC'
1  4035	21B0  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  4036	21B1  2168r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4037	      =ARRAY:21AB		 LINK=LINK$
1  4038	21B3				 BLOCK LABEL FAR  ; CFA
1  4039	21B3  1852r			     DW	$COL
   4040					 ;   u --> адр	Записывает в стек адрес	первого	байта в	блоке с
   4041					 ;   номером u.	Если блок не находится в памяти, он переносится	с носителя
   4042	21B5  19EFr 1658r 136Cr	  +		  DW  OFSET,AT,PLUS,TOR
   4043	      14A0r
   4044	21BD  1A5Er 1658r 155Cr	  +		  DW  PREV,AT,DUBL,X,I,SUBB,ZBRAN,BLC-$
   4045	      182Cr 14C3r 137Cr	  +
   4046	      0EEBr 002E
   4047	21CD  17E7r 1004r 0EEBr	  +	BLO:	  DW  PBUF,ZEQU,ZBRAN,BCK-$
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 72
forth.asm



   4048	      0012
   4049	21D5  15B7r 14C3r 2171r	  +		  DW  DROP,I,BUFFE,DUBL,I,ONE,RW,CFA
   4050	      155Cr 14C3r 1907r	  +
   4051	      2759r 16BCr
   4052	21E5  155Cr 182Cr 14C3r	  +	BCK:	  DW  DUBL,X,I,SUBB,ZEQU
   4053	      137Cr 1004r
   4054	21EF  0EEBr FFDC 155Cr	  +		  DW  ZBRAN,BLO-$,DUBL,PREV,STORE
   4055	      1A5Er 1678r
   4056	21F9  14B2r 15B7r 12B3r	  +	BLC:	  DW  FROMR,DROP,TWOP,SEMI
   4057	      1479r
   4058
   4059						  HEAD	  85h,'.LIN',305Q,DLINE,$COL	      ;	.LINE
1  4060	      =ARRAY:2201		 LINK$=$
1  4061	2201  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4062							 ; 6 - признак immediate. 5- слово не описано
1  4063	2202  2E 4C 49 4E		     DB	 '.LIN'
1  4064	2206  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4065	2207  21ABr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4066	      =ARRAY:2201		 LINK=LINK$
1  4067	2209				 DLINE LABEL FAR  ; CFA
1  4068	2209  1852r			     DW	$COL
   4069					 ; печать строки по номеру экрана
   4070	220B  14A0r 1931r 193Ar	  +		  DW  TOR,$CL,BBUF,SSMOD,FROMR,PLUS,BLOCK
   4071	      20DBr 14B2r 136Cr	  +
   4072	      21B3r
   4073	2219  136Cr 1931r 178Fr	  +		  DW  PLUS,$CL,DTRAI,$TYPE,SEMI
   4074	      1BDFr 1479r
   4075
   4076						  HEAD	  87h,'MESSAG',305Q,MESS,$COL	      ;	MESSAGE
1  4077	      =ARRAY:2223		 LINK$=$
1  4078	2223  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  4079							 ; 6 - признак immediate. 5- слово не описано
1  4080	2224  4D 45 53 53 41 47		     DB	 'MESSAG'
1  4081	222A  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4082	222B  2201r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4083	      =ARRAY:2223		 LINK=LINK$
1  4084	222D				 MESS LABEL FAR	 ; CFA
1  4085	222D  1852r			     DW	$COL
   4086	222F  19CEr 1658r 1A3Fr	  +		  DW  $IN,AT,RNUM,STORE	; сохранить значение $in
   4087	      1678r
   4088	2237  1970r 1658r 0EEBr	  +		  DW  $WARN,AT,ZBRAN,MS1-$ ; нужен ли текст сообщения
   4089	      0016
   4090	223F  156Dr 0EEBr 000E			  DW  DDUP,ZBRAN,MES-$
   4091	2245  0EBCr 0004 19EFr	  +		  DW  LIT,4,OFSET,AT,SUBB,DLINE	; текстовые сообщения на 4 экране
   4092	      1658r 137Cr 2209r
   4093	2251  1479r			MES:	  DW  SEMI
   4094	2253  1C0Cr			MS1:	  DW  PDOTQ
   4095	2255  06 4D 53 47 20 23	20		  DB  6,'MSG # '
   4096	225C  24DCr 1479r			  DW $DOT,SEMI
   4097
   4098						  HEAD	  84h,'LOA',304Q,LOA,$COL	     ; LOAD
1  4099	      =ARRAY:2260		 LINK$=$
1  4100	2260  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4101							 ; 6 - признак immediate. 5- слово не описано
1  4102	2261  4C 4F 41			     DB	 'LOA'
1  4103	2264  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4104	2265  2223r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 73
forth.asm



1  4105	      =ARRAY:2260		 LINK=LINK$
1  4106	2267				 LOA LABEL FAR	; CFA
1  4107	2267  1852r			     DW	$COL
   4108					 ; n ->	номер экрана
   4109	2269  19C5r 1658r 19CEr	  +		  DW  BLK,AT,$IN,AT,ZERO,$IN,STORE,ROT,BLK
   4110	      1658r 18FFr 19CEr	  +
   4111	      1678r 1591r 19C5r
   4112	227B  1678r 1F9Fr 19CEr	  +		  DW  STORE,INTER,$IN,STORE,BLK,STORE,SEMI
   4113	      1678r 19C5r 1678r	  +
   4114	      1479r
   4115
   4116						  HEAD	  303Q,'--',276Q,ARROW,$COL	       ; -->
1  4117	      =ARRAY:2289		 LINK$=$
1  4118	2289  C3			     DB	 303Q  ; NFA 7 бит равен 1.
1  4119							 ; 6 - признак immediate. 5- слово не описано
1  4120	228A  2D 2D			     DB	 '--'
1  4121	228C  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1  4122	228D  2260r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4123	      =ARRAY:2289		 LINK=LINK$
1  4124	228F				 ARROW LABEL FAR  ; CFA
1  4125	228F  1852r			     DW	$COL
   4126					 ; згрузка следующего экрана
   4127	2291  1B5Dr 18FFr 19CEr	  +		  DW  QLOAD,ZERO,$IN,STORE,ONE
   4128	      1678r 1907r
   4129	229B  19C5r 1637r 1479r			  DW  BLK,PSTOR,SEMI
   4130
   4131						  HEAD	  301Q,,247Q,TICK,$COL		       ; '
1  4132	      =ARRAY:22A1		 LINK$=$
1  4133	22A1  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  4134							 ; 6 - признак immediate. 5- слово не описано
1  4135	22A2  A7			     DB	 247Q	; последний символ слова + 128 (7 бит =	1).
1  4136	22A3  2289r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4137	      =ARRAY:22A1		 LINK=LINK$
1  4138	22A5				 TICK LABEL FAR	 ; CFA
1  4139	22A5  1852r			     DW	$COL
   4140					 ; Ищет	слово XXX в словаре и записывает в стек	его PFA
   4141	22A7  1D37r 1004r 18FFr	  +		  DW  DFIND,ZEQU,ZERO,QERR,DROP,TWOP,LITER,SEMI
   4142	      1AEAr 15B7r 12B3r	  +
   4143	      1F3Dr 1479r
   4144
   4145						  HEAD	  86h,'FORGE',324Q,FORGE,$COL	      ;	FORGET
1  4146	      =ARRAY:22B7		 LINK$=$
1  4147	22B7  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  4148							 ; 6 - признак immediate. 5- слово не описано
1  4149	22B8  46 4F 52 47 45		     DB	 'FORGE'
1  4150	22BD  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4151	22BE  22A1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4152	      =ARRAY:22B7		 LINK=LINK$
1  4153	22C0				 FORGE LABEL FAR  ; CFA
1  4154	22C0  1852r			     DW	$COL
   4155	22C2  1A0Br 1658r 19FDr	  +		  DW  CURR,AT,CONT,AT,SUBB,LIT,30Q,QERR	    ; 24 ошибка	не описана
   4156	      1658r 137Cr 0EBCr	  +
   4157	      0018 1AEAr
   4158											     ; ошибка если CURRENT = CONTEXT
   4159	22D2  22A5r 155Cr 197Cr	  +		  DW  TICK,DUBL,FENCE,AT,ULESS,LIT,25Q,QERR  ; 21 слово	защищено
   4160	      1658r 104Ar 0EBCr	  +
   4161	      0015 1AEAr
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 74
forth.asm



   4162	22E2  155Cr 1699r 1985r	  +		  DW  DUBL,NFA,$DP,STORE		    ; словарь свободен до указаного слова
   4163	      1678r
   4164	22EA  16AAr 1658r 19FDr	  +		  DW  LFA,AT,CONT,AT,STORE,SEMI		    ; в	переменную context пишем адрес
   4165	      1658r 1678r 1479r
   4166										     ; значение	LFA забываемого	слова
   4167
   4168						  HEAD	  84h,'BAC',313Q,BACK,$COL	      ;	BACK
1  4169	      =ARRAY:22F6		 LINK$=$
1  4170	22F6  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4171							 ; 6 - признак immediate. 5- слово не описано
1  4172	22F7  42 41 43			     DB	 'BAC'
1  4173	22FA  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  4174	22FB  22B7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4175	      =ARRAY:22F6		 LINK=LINK$
1  4176	22FD				 BACK LABEL FAR	 ; CFA
1  4177	22FD  1852r			     DW	$COL
   4178					 ; HERE	- , ; (компилирует в описание слова адрес возврата)
   4179	22FF  16E0r 137Cr 1AA3r	  +		  DW  HERE,SUBB,COMMA,SEMI
   4180	      1479r
   4181
   4182						  HEAD	  305Q,'BEGI',316Q,BEGIN,$COL	       ; BEGIN
1  4183	      =ARRAY:2307		 LINK$=$
1  4184	2307  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  4185							 ; 6 - признак immediate. 5- слово не описано
1  4186	2308  42 45 47 49		     DB	 'BEGI'
1  4187	230C  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  4188	230D  22F6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4189	      =ARRAY:2307		 LINK=LINK$
1  4190	230F				 BEGIN LABEL FAR  ; CFA
1  4191	230F  1852r			     DW	$COL
   4192	2311  1B02r 16E0r 1907r	  +		  DW  QCOMP,HERE,ONE,SEMI
   4193	      1479r
   4194
   4195						  HEAD	  304Q,'THE',316Q,THEN,$COL	       ; THEN
1  4196	      =ARRAY:2319		 LINK$=$
1  4197	2319  C4			     DB	 304Q  ; NFA 7 бит равен 1.
1  4198							 ; 6 - признак immediate. 5- слово не описано
1  4199	231A  54 48 45			     DB	 'THE'
1  4200	231D  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  4201	231E  2307r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4202	      =ARRAY:2319		 LINK=LINK$
1  4203	2320				 THEN LABEL FAR	 ; CFA
1  4204	2320  1852r			     DW	$COL
   4205	2322  1B02r 190Fr 1B30r	  +		  DW  QCOMP,TWO,QPAIR,HERE,OVER,SUBB,SWAP,STORE,SEMI
   4206	      16E0r 1514r 137Cr	  +
   4207	      1528r 1678r 1479r
   4208
   4209						  HEAD	  302Q,'D',317Q,$DO,$COL	       ; DO
1  4210	      =ARRAY:2334		 LINK$=$
1  4211	2334  C2			     DB	 302Q  ; NFA 7 бит равен 1.
1  4212							 ; 6 - признак immediate. 5- слово не описано
1  4213	2335  44			     DB	 'D'
1  4214	2336  CF			     DB	 317Q	; последний символ слова + 128 (7 бит =	1).
1  4215	2337  2319r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4216	      =ARRAY:2334		 LINK=LINK$
1  4217	2339				 $DO LABEL FAR	; CFA
1  4218	2339  1852r			     DW	$COL
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 75
forth.asm



   4219	233B  1B77r 0F14r 16E0r	  +		  DW  COMP,XDO,HERE,THREE,SEMI
   4220	      1917r 1479r
   4221
   4222						  HEAD	  304Q,'LOO',320Q,LOO,$COL	      ;	LOOP
1  4223	      =ARRAY:2345		 LINK$=$
1  4224	2345  C4			     DB	 304Q  ; NFA 7 бит равен 1.
1  4225							 ; 6 - признак immediate. 5- слово не описано
1  4226	2346  4C 4F 4F			     DB	 'LOO'
1  4227	2349  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  4228	234A  2334r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4229	      =ARRAY:2345		 LINK=LINK$
1  4230	234C				 LOO LABEL FAR	; CFA
1  4231	234C  1852r			     DW	$COL
   4232	234E  1917r 1B30r 1B77r	  +		  DW  THREE,QPAIR,COMP,XLOOP,BACK,SEMI
   4233	      0F31r 22FDr 1479r
   4234
   4235						  HEAD	  305Q,'+LOO',320Q,PLOOP,$COL	       ; +LOOP
1  4236	      =ARRAY:235A		 LINK$=$
1  4237	235A  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  4238							 ; 6 - признак immediate. 5- слово не описано
1  4239	235B  2B 4C 4F 4F		     DB	 '+LOO'
1  4240	235F  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  4241	2360  2345r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4242	      =ARRAY:235A		 LINK=LINK$
1  4243	2362				 PLOOP LABEL FAR  ; CFA
1  4244	2362  1852r			     DW	$COL
   4245	2364  1917r 1B30r 1B77r	  +		  DW  THREE,QPAIR,COMP,XPLOO,BACK,SEMI
   4246	      0F53r 22FDr 1479r
   4247
   4248						  HEAD	  305Q,'UNTI',314Q,UNTIL,$COL	       ; UNTIL
1  4249	      =ARRAY:2370		 LINK$=$
1  4250	2370  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  4251							 ; 6 - признак immediate. 5- слово не описано
1  4252	2371  55 4E 54 49		     DB	 'UNTI'
1  4253	2375  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  4254	2376  235Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4255	      =ARRAY:2370		 LINK=LINK$
1  4256	2378				 UNTIL LABEL FAR  ; CFA
1  4257	2378  1852r			     DW	$COL
   4258	237A  1907r 1B30r 1B77r	  +		  DW  ONE,QPAIR,COMP,ZBRAN,BACK,SEMI
   4259	      0EEBr 22FDr 1479r
   4260
   4261						  HEAD	  306Q,'REPEA',324Q,REPEA,$COL	      ;	REPEAT
1  4262	      =ARRAY:2386		 LINK$=$
1  4263	2386  C6			     DB	 306Q  ; NFA 7 бит равен 1.
1  4264							 ; 6 - признак immediate. 5- слово не описано
1  4265	2387  52 45 50 45 41		     DB	 'REPEA'
1  4266	238C  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4267	238D  2370r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4268	      =ARRAY:2386		 LINK=LINK$
1  4269	238F				 REPEA LABEL FAR  ; CFA
1  4270	238F  1852r			     DW	$COL
   4271	2391  1591r 1907r 1B30r	  +		  DW  ROT,ONE,QPAIR,ROT,COMP,BRAN,BACK
   4272	      1591r 1B77r 0F04r	  +
   4273	      22FDr
   4274	239F  2320r 1479r			  DW  THEN,SEMI
   4275
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 76
forth.asm



   4276						  HEAD	  302Q,'I',306Q,$IF,$COL	       ; IF
1  4277	      =ARRAY:23A3		 LINK$=$
1  4278	23A3  C2			     DB	 302Q  ; NFA 7 бит равен 1.
1  4279							 ; 6 - признак immediate. 5- слово не описано
1  4280	23A4  49			     DB	 'I'
1  4281	23A5  C6			     DB	 306Q	; последний символ слова + 128 (7 бит =	1).
1  4282	23A6  2386r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4283	      =ARRAY:23A3		 LINK=LINK$
1  4284	23A8				 $IF LABEL FAR	; CFA
1  4285	23A8  1852r			     DW	$COL
   4286	23AA  1B77r 0EEBr 16E0r	  +		  DW  COMP,ZBRAN,HERE,ZERO,COMMA,TWO,SEMI
   4287	      18FFr 1AA3r 190Fr	  +
   4288	      1479r
   4289
   4290						  HEAD	  304Q,'ELS',305Q,$ELSE,$COL	       ; ELSE
1  4291	      =ARRAY:23B8		 LINK$=$
1  4292	23B8  C4			     DB	 304Q  ; NFA 7 бит равен 1.
1  4293							 ; 6 - признак immediate. 5- слово не описано
1  4294	23B9  45 4C 53			     DB	 'ELS'
1  4295	23BC  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4296	23BD  23A3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4297	      =ARRAY:23B8		 LINK=LINK$
1  4298	23BF				 $ELSE LABEL FAR  ; CFA
1  4299	23BF  1852r			     DW	$COL
   4300	23C1  190Fr 1B30r 1B77r	  +		  DW  TWO,QPAIR,COMP,BRAN,HERE,ZERO,COMMA
   4301	      0F04r 16E0r 18FFr	  +
   4302	      1AA3r
   4303	23CF  1528r 190Fr 2320r	  +		  DW  SWAP,TWO,THEN,TWO,SEMI
   4304	      190Fr 1479r
   4305
   4306						  HEAD	  305Q,'WHIL',305Q,$WHILE,$COL	       ; WHILE
1  4307	      =ARRAY:23D9		 LINK$=$
1  4308	23D9  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  4309							 ; 6 - признак immediate. 5- слово не описано
1  4310	23DA  57 48 49 4C		     DB	 'WHIL'
1  4311	23DE  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4312	23DF  23B8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4313	      =ARRAY:23D9		 LINK=LINK$
1  4314	23E1				 $WHILE	LABEL FAR  ; CFA
1  4315	23E1  1852r			     DW	$COL
   4316	23E3  23A8r 1479r			  DW  $IF,SEMI
   4317
   4318						  HEAD	  86h,'SPACE',323Q,SPACS,$COL	      ;	SPACES
1  4319	      =ARRAY:23E7		 LINK$=$
1  4320	23E7  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  4321							 ; 6 - признак immediate. 5- слово не описано
1  4322	23E8  53 50 41 43 45		     DB	 'SPACE'
1  4323	23ED  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  4324	23EE  23D9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4325	      =ARRAY:23E7		 LINK=LINK$
1  4326	23F0				 SPACS LABEL FAR  ; CFA
1  4327	23F0  1852r			     DW	$COL
   4328	23F2  18FFr 143Dr 156Dr	  +		  DW  ZERO,MAX,DDUP,ZBRAN,SP1-$,ZERO,XDO
   4329	      0EEBr 000C 18FFr	  +
   4330	      0F14r
   4331	2400  1AC8r 0F31r FFFC		SPA:	  DW  SPACE,XLOOP,SPA-$
   4332	2406  1479r			SP1:	  DW  SEMI
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 77
forth.asm



   4333
   4334						  HEAD	  82h,'#',243Q,BDIGS,$COL	      ;	<# ; sds replace
1  4335	      =ARRAY:2408		 LINK$=$
1  4336	2408  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4337							 ; 6 - признак immediate. 5- слово не описано
1  4338	2409  23			     DB	 '#'
1  4339	240A  A3			     DB	 243Q	; последний символ слова + 128 (7 бит =	1).
1  4340	240B  23E7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4341	      =ARRAY:2408		 LINK=LINK$
1  4342	240D				 BDIGS LABEL FAR  ; CFA
1  4343	240D  1852r			     DW	$COL
   4344					 ; Начинает процесс преобразования числа в последовательность кодов ASCII.
   4345					 ; Исходное число в стеке должно быть двойной длины без	знака
   4346	240F  1C93r 1A49r 1678r	  +		  DW  PAD,HLD,STORE,SEMI
   4347	      1479r
   4348
   4349						  HEAD	  82h,'#',276Q,EDIGS,$COL	      ;	#>
1  4350	      =ARRAY:2417		 LINK$=$
1  4351	2417  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4352							 ; 6 - признак immediate. 5- слово не описано
1  4353	2418  23			     DB	 '#'
1  4354	2419  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1  4355	241A  2408r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4356	      =ARRAY:2417		 LINK=LINK$
1  4357	241C				 EDIGS LABEL FAR  ; CFA
1  4358	241C  1852r			     DW	$COL
   4359					 ; Завершает преобразование числа. В стеке остается число
   4360					 ; полученных символов и адрес,	как это	требуется для
   4361					 ; оператора TYPE
   4362	241E  15A6r 1A49r 1658r	  +		  DW  DDROP,HLD,AT,PAD,OVER,SUBB,SEMI
   4363	      1C93r 1514r 137Cr	  +
   4364	      1479r
   4365
   4366						  HEAD	  84h,'SIG',316Q,SIGN,$COL	      ;	SIGN
1  4367	      =ARRAY:242C		 LINK$=$
1  4368	242C  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4369							 ; 6 - признак immediate. 5- слово не описано
1  4370	242D  53 49 47			     DB	 'SIG'
1  4371	2430  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  4372	2431  2417r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4373	      =ARRAY:242C		 LINK=LINK$
1  4374	2433				 SIGN LABEL FAR	 ; CFA
1  4375	2433  1852r			     DW	$COL
   4376					 ; Вводит знак "минус" в выходной буфер
   4377	2435  1591r 102Dr 0EEBr	  +		  DW  ROT,ZLESS,ZBRAN,SIG-$,LIT,55Q,HOLD
   4378	      0008 0EBCr 002D	  +
   4379	      1622r
   4380	2443  1479r			SIG:	  DW  SEMI
   4381
   4382						  HEAD	  81h,,243Q,DIG,$COL		      ;	#
1  4383	      =ARRAY:2445		 LINK$=$
1  4384	2445  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  4385							 ; 6 - признак immediate. 5- слово не описано
1  4386	2446  A3			     DB	 243Q	; последний символ слова + 128 (7 бит =	1).
1  4387	2447  242Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4388	      =ARRAY:2445		 LINK=LINK$
1  4389	2449				 DIG LABEL FAR	; CFA
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 78
forth.asm



1  4390	2449  1852r			     DW	$COL
   4391					 ; Преобразует одну цифру и записывает ее в выходной буфер (PAD),
   4392					 ; выдает цифру	всегда,	если преобразовывать нечего, записывается 0
   4393	244B  1A22r 1658r 20FEr	  +		  DW  BASE,AT,MSMOD,ROT,LIT,11Q,OVER,LESS
   4394	      1591r 0EBCr 0009	  +
   4395	      1514r 1058r
   4396	245B  0EEBr 0008 0EBCr	  +		  DW  ZBRAN,DIGI-$,LIT,7,PLUS
   4397	      0007 136Cr
   4398	2465  0EBCr 0030 136Cr	  +	DIGI:	  DW  LIT,60Q,PLUS,HOLD,SEMI
   4399	      1622r 1479r
   4400
   4401						  HEAD	  82h,'#',323Q,DIGS,$COL	      ;	#S
1  4402	      =ARRAY:246F		 LINK$=$
1  4403	246F  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4404							 ; 6 - признак immediate. 5- слово не описано
1  4405	2470  23			     DB	 '#'
1  4406	2471  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  4407	2472  2445r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4408	      =ARRAY:246F		 LINK=LINK$
1  4409	2474				 DIGS LABEL FAR	 ; CFA
1  4410	2474  1852r			     DW	$COL
   4411					 ; Преобразует число до	тех пор, пока не будет получен 0.
   4412					 ; Одна	цифра выдается в любом случае (0)
   4413	2476  2449r 157Er 13F1r	  +	DIS:	  DW  DIG,DUP2,$OR,ZEQU,ZBRAN,DIS-$,SEMI
   4414	      1004r 0EEBr FFF6	  +
   4415	      1479r
   4416
   4417						  HEAD	  83h,'D.',322Q,DDOTR,$COL	      ;	D.R
1  4418	      =ARRAY:2484		 LINK$=$
1  4419	2484  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4420							 ; 6 - признак immediate. 5- слово не описано
1  4421	2485  44 2E			     DB	 'D.'
1  4422	2487  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4423	2488  246Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4424	      =ARRAY:2484		 LINK=LINK$
1  4425	248A				 DDOTR LABEL FAR  ; CFA
1  4426	248A  1852r			     DW	$COL
   4427					 ; s width -> печать двойного числа со знаком с	выравниваем вправо
   4428	248C  14A0r 1528r 1514r	  +		  DW  TOR,SWAP,OVER,DABS,BDIGS,DIGS,SIGN,EDIGS
   4429	      1347r 240Dr 2474r	  +
   4430	      2433r 241Cr
   4431	249C  14B2r 1514r 137Cr	  +		  DW  FROMR,OVER,SUBB,SPACS,$TYPE,SEMI
   4432	      23F0r 1BDFr 1479r
   4433
   4434						  HEAD	  82h,'.',322Q,DOTR,$COL	      ;	.R
1  4435	      =ARRAY:24A8		 LINK$=$
1  4436	24A8  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4437							 ; 6 - признак immediate. 5- слово не описано
1  4438	24A9  2E			     DB	 '.'
1  4439	24AA  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4440	24AB  2484r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4441	      =ARRAY:24A8		 LINK=LINK$
1  4442	24AD				 DOTR LABEL FAR	 ; CFA
1  4443	24AD  1852r			     DW	$COL
   4444					 ; s width -> печать числа со знаком с выравниваем вправо
   4445	24AF  14A0r 140Er 14B2r	  +		  DW  TOR,STOD,FROMR,DDOTR,SEMI
   4446	      248Ar 1479r
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 79
forth.asm



   4447
   4448						  HEAD	  83h,'U.',322Q,UDOTR,$COL	      ;	U.R
1  4449	      =ARRAY:24B9		 LINK$=$
1  4450	24B9  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4451							 ; 6 - признак immediate. 5- слово не описано
1  4452	24BA  55 2E			     DB	 'U.'
1  4453	24BC  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4454	24BD  24A8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4455	      =ARRAY:24B9		 LINK=LINK$
1  4456	24BF				 UDOTR LABEL FAR  ; CFA
1  4457	24BF  1852r			     DW	$COL
   4458					 ; u width -> печать числа без знака с выравниваем вправо
   4459	24C1  18FFr 1528r 248Ar	  +		  DW  ZERO,SWAP,DDOTR,SEMI
   4460	      1479r
   4461
   4462						  HEAD	  82h,'D',256Q,DDOT,$COL	      ;	D.
1  4463	      =ARRAY:24C9		 LINK$=$
1  4464	24C9  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4465							 ; 6 - признак immediate. 5- слово не описано
1  4466	24CA  44			     DB	 'D'
1  4467	24CB  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  4468	24CC  24B9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4469	      =ARRAY:24C9		 LINK=LINK$
1  4470	24CE				 DDOT LABEL FAR	 ; CFA
1  4471	24CE  1852r			     DW	$COL
   4472					 ; печать двойных чисел
   4473	24D0  18FFr 248Ar 1AC8r	  +		  DW  ZERO,DDOTR,SPACE,SEMI
   4474	      1479r
   4475
   4476						  HEAD	  81h,,256Q,$DOT,$COL		      ;	.
1  4477	      =ARRAY:24D8		 LINK$=$
1  4478	24D8  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  4479							 ; 6 - признак immediate. 5- слово не описано
1  4480	24D9  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  4481	24DA  24C9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4482	      =ARRAY:24D8		 LINK=LINK$
1  4483	24DC				 $DOT LABEL FAR	 ; CFA
1  4484	24DC  1852r			     DW	$COL
   4485	24DE  140Er 24CEr 1479r			  DW  STOD,DDOT,SEMI
   4486
   4487						  HEAD	  81h,,277Q,QUEST,$COL		      ;	?
1  4488	      =ARRAY:24E4		 LINK$=$
1  4489	24E4  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  4490							 ; 6 - признак immediate. 5- слово не описано
1  4491	24E5  BF			     DB	 277Q	; последний символ слова + 128 (7 бит =	1).
1  4492	24E6  24D8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4493	      =ARRAY:24E4		 LINK=LINK$
1  4494	24E8				 QUEST LABEL FAR  ; CFA
1  4495	24E8  1852r			     DW	$COL
   4496					 ; печать содержимого по адресу	в стеке
   4497	24EA  1658r 24DCr 1479r			  DW  AT,$DOT,SEMI
   4498
   4499						  HEAD	  82h,'U',256Q,UDOT,$COL	      ;	U.
1  4500	      =ARRAY:24F0		 LINK$=$
1  4501	24F0  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4502							 ; 6 - признак immediate. 5- слово не описано
1  4503	24F1  55			     DB	 'U'
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 80
forth.asm



1  4504	24F2  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  4505	24F3  24E4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4506	      =ARRAY:24F0		 LINK=LINK$
1  4507	24F5				 UDOT LABEL FAR	 ; CFA
1  4508	24F5  1852r			     DW	$COL
   4509					 ; печать числа	без знака
   4510	24F7  18FFr 24CEr 1479r			  DW  ZERO,DDOT,SEMI
   4511
   4512					 ;	   ** Вспомогательные процедуры	**
   4513
   4514						  HEAD	  84h,'LIS',324Q,$LIST,$COL	      ;	LIST
1  4515	      =ARRAY:24FD		 LINK$=$
1  4516	24FD  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4517							 ; 6 - признак immediate. 5- слово не описано
1  4518	24FE  4C 49 53			     DB	 'LIS'
1  4519	2501  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4520	2502  24F0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4521	      =ARRAY:24FD		 LINK=LINK$
1  4522	2504				 $LIST LABEL FAR  ; CFA
1  4523	2504  1852r			     DW	$COL
   4524					 ; n ->	вывод содержимого экрана
   4525	2506  1751r 1A8Fr 155Cr	  +		  DW  DECIMA,CR,DUBL,SCR,STORE,PDOTQ
   4526	      19E2r 1678r 1C0Cr
   4527	2512  03 53 23 20			  DB  3,'S# '
   4528	2516  24DCr				  DW  $DOT
   4529	2518  0EBCr 0010 18FFr	  +		  DW  LIT,20Q,ZERO,XDO
   4530	      0F14r
   4531	2520  1A8Fr 14C3r 1917r	  +	LSTI:	  DW  CR,I,THREE,DOTR,SPACE
   4532	      24ADr 1AC8r
   4533	252A  14C3r 19E2r 1658r	  +		  DW  I,SCR,AT,DLINE
   4534	      2209r
   4535	2532  0F31r FFEC 1A8Fr	  +		  DW XLOOP,LSTI-$,CR,SEMI
   4536	      1479r
   4537
   4538						  HEAD	  85h,'INDE',330Q,INDEX,$COL	      ;	INDEX
1  4539	      =ARRAY:253A		 LINK$=$
1  4540	253A  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4541							 ; 6 - признак immediate. 5- слово не описано
1  4542	253B  49 4E 44 45		     DB	 'INDE'
1  4543	253F  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  4544	2540  24FDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4545	      =ARRAY:253A		 LINK=LINK$
1  4546	2542				 INDEX LABEL FAR  ; CFA
1  4547	2542  1852r			     DW	$COL
   4548	2544  12A4r 1528r 0F14r			  DW  ONEP,SWAP,XDO
   4549	254A  1A8Fr 14C3r 1917r	  +	INDX:	  DW  CR,I,THREE,DOTR,SPACE,ZERO,I,DLINE
   4550	      24ADr 1AC8r 18FFr	  +
   4551	      14C3r 2209r
   4552	255A  0F31r FFEE 1479r			  DW  XLOOP,INDX-$,SEMI
   4553
   4554						  HEAD	  84h,'TRI',317Q,TRIO,$COL	      ;	TRIO
1  4555	      =ARRAY:2560		 LINK$=$
1  4556	2560  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4557							 ; 6 - признак immediate. 5- слово не описано
1  4558	2561  54 52 49			     DB	 'TRI'
1  4559	2564  CF			     DB	 317Q	; последний символ слова + 128 (7 бит =	1).
1  4560	2565  253Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 81
forth.asm



1  4561	      =ARRAY:2560		 LINK=LINK$
1  4562	2567				 TRIO LABEL FAR	 ; CFA
1  4563	2567  1852r			     DW	$COL
   4564	2569  0EBCr 000C 113Er			  DW  LIT,14Q,EMIT
   4565	256F  1917r 1514r 136Cr	  +		  DW  THREE,OVER,PLUS,SWAP,XDO
   4566	      1528r 0F14r
   4567	2579  14C3r 2504r 0F31r	  +	TRI:	  DW  I,$LIST,XLOOP,TRI-$,SEMI
   4568	      FFFA 1479r
   4569
   4570						  HEAD	  85h,'VLIS',324Q,VLIST,$COL	      ;	VLIST
1  4571	      =ARRAY:2583		 LINK$=$
1  4572	2583  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4573							 ; 6 - признак immediate. 5- слово не описано
1  4574	2584  56 4C 49 53		     DB	 'VLIS'
1  4575	2588  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4576	2589  2560r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4577	      =ARRAY:2583		 LINK=LINK$
1  4578	258B				 VLIST LABEL FAR  ; CFA
1  4579	258B  1852r			     DW	$COL
   4580					 ; список слов в словаре
   4581	258D  19FDr 1658r 1658r			  DW  CONT,AT,AT
   4582	2593  1A8Fr 1917r 18FFr	  +	VL0:	  DW  CR,THREE,ZERO,XDO
   4583	      0F14r
   4584	259B  155Cr 1EB4r 0EBCr	  +	VL1:	  DW  DUBL,IDDOT,LIT,15Q,OVER,CAT,LIT,37Q,$AND,SUBB
   4585	      000D 1514r 1667r	  +
   4586	      0EBCr 001F 13E0r	  +
   4587	      137Cr
   4588	25AF  23F0r 1AD6r 155Cr	  +		  DW  SPACS,PFA,DUBL,LIT,6,UDOTR,SPACE,LIT,41Q
   4589	      0EBCr 0006 24BFr	  +
   4590	      1AC8r 0EBCr 0021
   4591	25C1  113Er 1AC8r 121Br	  +		  DW  EMIT,SPACE,KEY, DROP, LFA,AT,DUBL,ZEQU,ZBRAN,VL2-$
   4592	      15B7r 16AAr 1658r	  +
   4593	      155Cr 1004r 0EEBr	  +
   4594	      0004
   4595	25D5  148Er				  DW  LEAV ; добавил паузу
   4596	25D7  0F31r FFC2 156Dr	  +	VL2:	  DW  XLOOP,VL1-$,DDUP,ZEQU,ZBRAN,VL0-$,SEMI
   4597	      1004r 0EEBr FFB2	  +
   4598	      1479r
   4599
   4600						  HEAD	  83h,'LC',314Q,LCL,$COL	      ;	LCL
1  4601	      =ARRAY:25E5		 LINK$=$
1  4602	25E5  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4603							 ; 6 - признак immediate. 5- слово не описано
1  4604	25E6  4C 43			     DB	 'LC'
1  4605	25E8  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  4606	25E9  2583r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4607	      =ARRAY:25E5		 LINK=LINK$
1  4608	25EB				 LCL LABEL FAR	; CFA
1  4609	25EB  1852r			     DW	$COL
   4610					 ; очистка командной строки
   4611	25ED  18FFr 18FFr 11E6r	  +		  DW  ZERO,ZERO,FIX,$CL,SPACS,RC,SEMI
   4612	      1931r 23F0r 117Dr	  +
   4613	      1479r
   4614
   4615						  HEAD	  82h,'H',324Q,HT,$COL		      ;	HT HOME?
1  4616	      =ARRAY:25FB		 LINK$=$
1  4617	25FB  82			     DB	 82h  ;	NFA 7 бит равен	1.
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 82
forth.asm



1  4618							 ; 6 - признак immediate. 5- слово не описано
1  4619	25FC  48			     DB	 'H'
1  4620	25FD  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4621	25FE  25E5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4622	      =ARRAY:25FB		 LINK=LINK$
1  4623	2600				 HT LABEL FAR  ; CFA
1  4624	2600  1852r			     DW	$COL
   4625					 ; курсор в начало экрана
   4626	2602  18FFr 18FFr 11E6r	  +		  DW  ZERO,ZERO,FIX,SEMI
   4627	      1479r
   4628
   4629						  HEAD	  84h,'COP',331Q,COPY,$COL	      ;	COPY
1  4630	      =ARRAY:260A		 LINK$=$
1  4631	260A  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4632							 ; 6 - признак immediate. 5- слово не описано
1  4633	260B  43 4F 50			     DB	 'COP'
1  4634	260E  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  4635	260F  25FBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4636	      =ARRAY:260A		 LINK=LINK$
1  4637	2611				 COPY LABEL FAR	 ; CFA
1  4638	2611  1852r			     DW	$COL
   4639					 ; копия экрана
   4640	2613  1528r 21B3r 16BCr	  +		  DW  SWAP,BLOCK,CFA,STORE,UPDAT,FLUSH,SEMI
   4641	      1678r 1816r 213Ar	  +
   4642	      1479r
   4643
   4644						  HEAD	  82h,'T',331Q,TY$$,$COL	      ;	TY
1  4645	      =ARRAY:2621		 LINK$=$
1  4646	2621  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4647							 ; 6 - признак immediate. 5- слово не описано
1  4648	2622  54			     DB	 'T'
1  4649	2623  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  4650	2624  260Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4651	      =ARRAY:2621		 LINK=LINK$
1  4652	2626				 TY$$ LABEL FAR	 ; CFA
1  4653	2626  1852r			     DW	$COL
   4654					 ; adr n ->  дамп памяти
   4655	2628  18FFr 0F14r			  DW  ZERO,XDO
   4656	262C  14C3r 191Fr 20CBr	  +	TY4:	  DW  I,EIGHT,$MOD,ZEQU,ZBRAN,TY5-$
   4657	      1004r 0EEBr 000C
   4658	2638  1A8Fr 155Cr 0EBCr	  +		  DW  CR,DUBL,LIT,7,UDOTR
   4659	      0007 24BFr
   4660	2642  155Cr 1658r 0EBCr	  +	TY5:	  DW  DUBL,AT,LIT,7,UDOTR,TWOP,XLOOP,TY4-$,SEMI
   4661	      0007 24BFr 12B3r	  +
   4662	      0F31r FFDC 1479r
   4663
   4664						  HEAD	  85h,'DEPT',310Q,DEPTH,$COL	      ;	DEPTH
1  4665	      =ARRAY:2654		 LINK$=$
1  4666	2654  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4667							 ; 6 - признак immediate. 5- слово не описано
1  4668	2655  44 45 50 54		     DB	 'DEPT'
1  4669	2659  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1  4670	265A  2621r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4671	      =ARRAY:2654		 LINK=LINK$
1  4672	265C				 DEPTH LABEL FAR  ; CFA
1  4673	265C  1852r			     DW	$COL
   4674					 ; число элементов в стеке
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 83
forth.asm



   4675	265E  1943r 1658r 144Dr	  +		  DW  SZERO,AT,SPAT,TWOP,SUBB,DIV2,SEMI
   4676	      12B3r 137Cr 12E3r	  +
   4677	      1479r
   4678
   4679						  HEAD	  84h,'DUM',320Q,DUMP,$COL	      ;	DUMP
1  4680	      =ARRAY:266C		 LINK$=$
1  4681	266C  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4682							 ; 6 - признак immediate. 5- слово не описано
1  4683	266D  44 55 4D			     DB	 'DUM'
1  4684	2670  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  4685	2671  2654r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4686	      =ARRAY:266C		 LINK=LINK$
1  4687	2673				 DUMP LABEL FAR	 ; CFA
1  4688	2673  1852r			     DW	$COL
   4689					 ; адр u --> - Отображает u байт памяти	начиная	с адр
   4690	2675  18FFr 0F14r			  DW  ZERO,XDO
   4691	2679  155Cr 0EBCr 0007	  +	DMP:	  DW  DUBL,LIT,7,UDOTR,SPACE,EIGHT,ZERO,XDO
   4692	      24BFr 1AC8r 191Fr	  +
   4693	      18FFr 0F14r
   4694	2689  155Cr 14C3r 136Cr	  +	DP1:	  DW  DUBL,I,PLUS,CAT,LIT,5,DOTR,XLOOP,DP1-$
   4695	      1667r 0EBCr 0005	  +
   4696	      24ADr 0F31r FFF0
   4697	269B  0EBCr 0004 23F0r	  +		  DW  LIT,4,SPACS,EIGHT,ZERO,XDO
   4698	      191Fr 18FFr 0F14r
   4699	26A7  155Cr 14C3r 136Cr	  +	DP2:	  DW  DUBL,I,PLUS,CAT,LIT,177Q,$AND,DUBL,BLAN
   4700	      1667r 0EBCr 007F	  +
   4701	      13E0r 155Cr 1928r
   4702	26B9  1058r 0EEBr 0008	  +		  DW  LESS,ZBRAN,DP3-$,DROP,LIT,56Q
   4703	      15B7r 0EBCr 002E
   4704	26C5  113Er 0F31r FFDE	  +	DP3:	  DW  EMIT,XLOOP,DP2-$,CR,EIGHT,PLUS,EIGHT
   4705	      1A8Fr 191Fr 136Cr	  +
   4706	      191Fr
   4707	26D3  0F53r FFA4 15B7r	  +		  DW  XPLOO,DMP-$,DROP,SEMI
   4708	      1479r
   4709
   4710						  HEAD	  84h,'SWA',323Q,SWAS,$COL	      ;	SWAS
1  4711	      =ARRAY:26DB		 LINK$=$
1  4712	26DB  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4713							 ; 6 - признак immediate. 5- слово не описано
1  4714	26DC  53 57 41			     DB	 'SWA'
1  4715	26DF  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  4716	26E0  266Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4717	      =ARRAY:26DB		 LINK=LINK$
1  4718	26E2				 SWAS LABEL FAR	 ; CFA
1  4719	26E2  1852r			     DW	$COL
   4720					     ; перемены	 мест экранов М	и N
   4721	26E4  14A0r 21B3r 16BCr	  +		  DW  TOR,BLOCK,CFA,DUBL,AT,I,BLOCK,CFA,STORE,UPDAT
   4722	      155Cr 1658r 14C3r	  +
   4723	      21B3r 16BCr 1678r	  +
   4724	      1816r
   4725	26F8  14B2r 0EBCr 8000	  +		  DW  FROMR,LIT,100000Q,$OR,SWAP,STORE,FLUSH,SEMI
   4726	      13F1r 1528r 1678r	  +
   4727	      213Ar 1479r
   4728
   4729						  HEAD	  83h,'ST',331Q,STY,$COL	      ;	STY
1  4730	      =ARRAY:2708		 LINK$=$
1  4731	2708  83			     DB	 83h  ;	NFA 7 бит равен	1.
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 84
forth.asm



1  4732							 ; 6 - признак immediate. 5- слово не описано
1  4733	2709  53 54			     DB	 'ST'
1  4734	270B  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  4735	270C  26DBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4736	      =ARRAY:2708		 LINK=LINK$
1  4737	270E				 STY LABEL FAR	; CFA
1  4738	270E  1852r			     DW	$COL
   4739					     ; печать стека
   4740	2710  265Cr 156Dr 0EEBr	  +		  DW  DEPTH,DDUP,ZBRAN,STY3-$,ZERO,XDO
   4741	      0024 18FFr 0F14r
   4742	271C  14C3r 191Fr 20CBr	  +	STY1:	  DW  I,EIGHT,$MOD,ZEQU,ZBRAN,STY2-$,CR
   4743	      1004r 0EEBr 0004	  +
   4744	      1A8Fr
   4745	272A  14C3r 12A4r 14F8r	  +	STY2:	  DW  I,ONEP,PICK,LIT,7,UDOTR,XLOOP,STY1-$
   4746	      0EBCr 0007 24BFr	  +
   4747	      0F31r FFE4
   4748	273A  1479r			STY3:	  DW  SEMI
   4749
   4750						  HEAD	  82h,'O',256Q,ODOT,$COL	      ;	O.
1  4751	      =ARRAY:273C		 LINK$=$
1  4752	273C  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4753							 ; 6 - признак immediate. 5- слово не описано
1  4754	273D  4F			     DB	 'O'
1  4755	273E  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  4756	273F  2708r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4757	      =ARRAY:273C		 LINK=LINK$
1  4758	2741				 ODOT LABEL FAR	 ; CFA
1  4759	2741  1852r			     DW	$COL
   4760					     ; тоже что	и S. в octal системе
   4761	2743  1A22r 1658r 1514r	  +		  DW  BASE,AT,OVER,OCTAL,UDOT,BASE,STORE,SEMI
   4762	      1765r 24F5r 1A22r	  +
   4763	      1678r 1479r
   4764
   4765						  HEAD	  83h,'R/',327Q,RW		      ;	R/W
1  4766	      =ARRAY:2753		 LINK$=$
1  4767	2753  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4768							 ; 6 - признак immediate. 5- слово не описано
1  4769	2754  52 2F			     DB	 'R/'
1  4770	2756  D7			     DB	 327Q	; последний символ слова + 128 (7 бит =	1).
1  4771	2757  273Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4772	      =ARRAY:2753		 LINK=LINK$
1  4773	2759				 RW LABEL FAR  ; CFA
1  4774	2759  275Br			     DW	 $+2
   4775					; Открытие файла
   4776	275B  BA 2806r				  MOV	DX, OFFSET file
   4777						  ;MOV	 AH, 0FH      ;	open file
   4778	275E  B4 3D				  MOV	AH, 3dh
   4779	2760  B0 02				  mov	al, 2
   4780	2762  CD 21				  INT	21H
   4781						  ;CMP	 AL, 0FFH
   4782						  ;JE	 ERR0
   4783	2764  72 53				  jc ERR0
   4784	2766  A3 2804r				  mov	 handle, ax
   4785	2769  5B				  POP	BX  ; R/W - флаг
   4786	276A  58				  POP	AX  ; Номер блока
   4787	276B  5A				  POP	DX  ; Адрес буфера
   4788	276C  48				  DEC	AX
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 85
forth.asm



   4789	276D  B1 0A				  MOV	CL, 10 ; 3 было
   4790	276F  D3 E0				  SAL	AX, CL	; (BLOCK#-1)*8 ; теперь	на 1024	байт
   4791						  ;MOV	 RANDREC,AX
   4792						  ;MOV	 RANDREC+2,0
   4793	2771  53				  push	 bx
   4794	2772  52				  push	 dx
   4795	2773  8B D0				  mov	 dx, ax
   4796	2775  B9 0000				  mov	 cx, 0
   4797	2778  B8 4200				  mov	 ax, 4200h
   4798	277B  8B 1E 2804r			  mov bx, handle
   4799	277F  CD 21				  int 21h
   4800	2781  72 36				  jc ERR0
   4801	2783  5A				  pop	 dx
   4802	2784  5B				  pop	 bx
   4803	2785  83 FB 00				  CMP	BX, 0 ;	режим
   4804	2788  75 0F				  JNE	RED
   4805					; WRITE
   4806						  ;MOV	 BX, DX
   4807						  ;MOV	 CX, 8	    ; Номер записи
   4808	278A				WR:	  ;MOV	 DX, BX
   4809						  ;MOV	 AH,1AH	    ; Запись адреса буфера (Set	disk transfer address)
   4810						  ;INT	 21H
   4811						  ;MOV	 DX,OFFSET FCB
   4812						  ;MOV	 AH, 22H    ; Запись RECORD (Random write)
   4813						  ;INT	 21H
   4814	278A  B4 40				  MOV	AH, 40H
   4815	278C  B9 0400				  MOV	CX, 1024
   4816	278F  8B 1E 2804r			  mov	 bx, handle
   4817	2793  CD 21				  INT	21H
   4818						  ;CMP	 AL, 0
   4819						  ;JNE	 ERR1
   4820	2795  72 27				  jc err1
   4821						  ;INC	 RANDREC    ; Коррекция	адреса буфера
   4822						  ;ADD	 BX, 80H
   4823						  ;LOOP	 WR
   4824	2797  EB 11				  JMP  OUT1
   4825
   4826	2799				 RED:	  ;MOV	 CX, 8
   4827						  ;MOV	 BX, DX
   4828					 ;RD:	  ;MOV	 DX, BX	      ;	адрес буфера
   4829						  ;MOV	 AH, 1AH     ; Запись адреса буфера
   4830	2799  B4 3F				  MOV	AH, 3fH
   4831	279B  B9 0400				  MOV	CX, 1024
   4832	279E  8B 1E 2804r			  mov	 bx, handle
   4833	27A2  CD 21				  INT	21H
   4834	27A4  72 22				  jc ERR3
   4835	27A6  3B C1				  cmp ax,cx
   4836	27A8  75 1E				  jne err3
   4837						  ;MOV	 DX, OFFSET  FCB
   4838						  ;MOV	 AH, 21H      ;	Random read
   4839						  ;INT	 21H
   4840						  ;CMP	 AL, 0
   4841						  ;JNE	 ERR3
   4842						  ;INC	 RANDREC     ; Коррекция адреса
   4843						  ;ADD	 BX, 80H
   4844						 ; LOOP	  RD
   4845
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 86
forth.asm



   4846	27AA				OUT1:	  ;MOV	 DX, OFFSET  FCB  ; Закрытие файла
   4847	27AA  8B 1E 2804r			  mov bx, handle
   4848						  ;MOV	 AH, 10H
   4849	27AE  B4 3E				  mov ah, 3eh
   4850	27B0  CD 21				  INT	21H
   4851						  ;CMP	 AL, 0
   4852						  ;JNE	 ERR2
   4853	27B2  72 0F				  jc ERR2
   4854	27B4				EXIT:	  NEXT
1  4855
1  4856	27B4  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  4857	27B5  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  4858	27B7  FF 27			     JMP WORD PTR [BX] ;
   4859	27B9  BA 2837r			ERR0:	  MOV	DX, OFFSET  ERMES0
   4860	27BC  EB 0D				  JMP	DONE
   4861	27BE  BA 2848r			ERR1:	  MOV	DX, OFFSET  ERMES1
   4862	27C1  EB 08				  JMP	DONE
   4863	27C3  BA 2859r			ERR2:	  MOV	DX, OFFSET  ERMES2
   4864	27C6  EB 03				  JMP	DONE
   4865	27C8  BA 286Ar			ERR3:	  MOV	DX, OFFSET  ERMES3
   4866	27CB  B4 09			DONE:	  MOV	AH, 9H ; вывод сообщения
   4867	27CD  CD 21				  INT	21H
   4868	27CF  EB E3				  JMP	EXIT
   4869
   4870						  HEAD	  305Q,';COD','E'+80h,SEMIC,$COL	  ; ;CODE
1  4871	      =ARRAY:27D1		 LINK$=$
1  4872	27D1  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  4873							 ; 6 - признак immediate. 5- слово не описано
1  4874	27D2  3B 43 4F 44		     DB	 ';COD'
1  4875	27D6  C5			     DB	 'E'+80h   ; последний символ слова + 128 (7 бит = 1).
1  4876	27D7  2753r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4877	      =ARRAY:27D1		 LINK=LINK$
1  4878	27D9				 SEMIC LABEL FAR  ; CFA
1  4879	27D9  1852r			     DW	$COL
   4880					 ; для определения в форт программе слов на ассемблере
   4881	27DB  1B43r 1B77r 1BA4r	  +		  DW  QCSP,COMP,PSCOD,LBRAC,SMUG,SEMI
   4882	      1719r 1B90r 1479r
   4883
   4884						  HEAD	  305Q,'FORT','H'+80h,FORTH,$DOE	  ; FORTH
1  4885	      =ARRAY:27E7		 LINK$=$
1  4886	27E7  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  4887							 ; 6 - признак immediate. 5- слово не описано
1  4888	27E8  46 4F 52 54		     DB	 'FORT'
1  4889	27EC  C8			     DB	 'H'+80h   ; последний символ слова + 128 (7 бит = 1).
1  4890	27ED  27D1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4891	      =ARRAY:27E7		 LINK=LINK$
1  4892	27EF				 FORTH LABEL FAR  ; CFA
1  4893	27EF  18DBr			     DW	$DOE
   4894					 ; Делает словарь Форт контекстным
   4895	27F1  201Er A081 27F9r			 DW  DOVOC,120201Q,TASK-7 ; NFA	TASK последнее слово в этом словаре
   4896									 ; 120201=A0 81
   4897	27F7				XVOC	 LABEL	 FAR	     ;	VOC-LINK
   4898	27F7  0000				 DW  0		     ;	ссылка на предыдущий словарь
   4899
   4900						  HEAD	  84h,'TAS','K'+80h,TASK,$COL		 ; TASK
1  4901	      =ARRAY:27F9		 LINK$=$
1  4902	27F9  84			     DB	 84h  ;	NFA 7 бит равен	1.
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 87
forth.asm



1  4903							 ; 6 - признак immediate. 5- слово не описано
1  4904	27FA  54 41 53			     DB	 'TAS'
1  4905	27FD  CB			     DB	 'K'+80h   ; последний символ слова + 128 (7 бит = 1).
1  4906	27FE  27E7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4907	      =ARRAY:27F9		 LINK=LINK$
1  4908	2800				 TASK LABEL FAR	 ; CFA
1  4909	2800  1852r			     DW	$COL
   4910					     ; пустое определение
   4911	2802  1479r				  DW  SEMI
   4912
   4913	2804  0000			handle	 dw 0
   4914	2806  66 6F 72 74 68 2E	64+	file	 db "forth.dat", 0
   4915	      61 74 00
   4916					; FCB not used now
   4917	2810				FCB	  LABEL	WORD
   4918	2810  00			DRIVE	  DB	0
   4919	2811  46 4F 52 54 48 20	20+	FN	  DB	'FORTH	 '
   4920	      20
   4921	2819  44 41 54			EXT	  DB	'DAT'
   4922	281C  0000			CURBLK	  DW	0	   ; Относительное начало файла
   4923	281E  0080			RECSIZE	  DW	80H	   ; размер логичю записи
   4924	2820  1388 0000			FILESIZE  DW	5000,0	   ; размер файла
   4925	2824  0000 0000			DATE	  DW	0,0
   4926	2828  00 00 00 00 00 00	00+		  DB	0,0,0,0,0, 0,0,0,0,0 ; REZERV
   4927	      00 00 00
   4928	2832  00			CURREC	  DB	0	    ; запись с текущего	блока
   4929	2833  0000 0000			RANDREC	  DW	0,0	    ; номер записи
   4930
   4931	2837  45 52 52 20 4F 50	45+	ERMES0	  DB	'ERR OPENING FILE$'
   4932	      4E 49 4E 47 20 46	49+
   4933	      4C 45 24
   4934	2848  45 52 52 20 57 52	49+	ERMES1	  DB	'ERR WRITING FILE$'
   4935	      54 49 4E 47 20 46	49+
   4936	      4C 45 24
   4937	2859  45 52 52 20 43 4C	4F+	ERMES2	  DB	'ERR CLOSING FILE$'
   4938	      53 49 4E 47 20 46	49+
   4939	      4C 45 24
   4940	286A  45 52 52 20 52 45	41+	ERMES3	  DB	'ERR READING FILE$'
   4941	      44 49 4E 47 20 46	49+
   4942	      4C 45 24
   4943
   4944
   4945	287B  3E80*(0000)		XDP	DW  16000 DUP(0)	   ; DICTIONARY
   4946
   4947	0000				STCK   SEGMENT STACK		  ; Стек параметров
   4948	0000  40*(????)				DW  64 DUP (?)
   4949	0080				XS0	LABEL	WORD
   4950	0080  0000 0000				DW  0,0	  ; STACK
   4951	0084				STCK   ENDS
   4952
   4953	A57B				ARRAY	   ENDS
   4954					END	   $INI
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 88
Symbol Table




Symbol Name			  Type	 Value

$ABS				  Far	 ARRAY:13CA
$AND				  Far	 ARRAY:13E0
$BUF				  Word	 ARRAY:0DB0
$CL				  Far	 ARRAY:1931
$COL				  Far	 ARRAY:1852
$COMP				  Near	 ARRAY:17B0
$CON				  Far	 ARRAY:1889
$DATE				  Word	 ARRAY:0004
$DO				  Far	 ARRAY:2339
$DOE				  Far	 ARRAY:18DB
$DOT				  Far	 ARRAY:24DC
$DP				  Far	 ARRAY:1985
$ELSE				  Far	 ARRAY:23BF
$EM				  Near	 ARRAY:112A
$EMIT				  Far	 ARRAY:1140
$EVEN				  Far	 ARRAY:1077
$EX				  Far	 ARRAY:1A68
$GO				  Near	 ARRAY:1508
$HEX				  Far	 ARRAY:173B
$IF				  Far	 ARRAY:23A8
$IN				  Far	 ARRAY:19CE
$INI				  Far	 ARRAY:0DB4
$LESS				  Near	 ARRAY:0F60
$LIST				  Far	 ARRAY:2504
$LOOP				  Near	 ARRAY:0FAB
$MO				  Near	 ARRAY:2110
$MOD				  Far	 ARRAY:20CB
$OR				  Far	 ARRAY:13F1
$PAGE				  Far	 ARRAY:10CA
$REPE				  Near	 ARRAY:15F3
$RS				  Word	 ARRAY:0DA2
$SIG				  Near	 ARRAY:0F99
$STI				  Word	 ARRAY:0D9C
$STK				  Word	 ARRAY:0DA0
$TIME				  Word	 ARRAY:0000
$TYPE				  Far	 ARRAY:1BDF
$UPD				  Near	 ARRAY:1823
$US				  Word	 ARRAY:0D9E
$USE				  Far	 ARRAY:18BA
$VAR				  Far	 ARRAY:18A4
$WARN				  Far	 ARRAY:1970
$WHILE				  Far	 ARRAY:23E1
$WIDTH				  Far	 ARRAY:1962
$WORD				  Far	 ARRAY:1CA6
$XOR				  Far	 ARRAY:13FF
??DATE				  Text	 "04/17/20"
??FILENAME			  Text	 "forth	  "
??TIME				  Text	 "16:00:46"
??VERSION			  Number 030A
?TER$				  Far	 ARRAY:1257
?TERM				  Far	 ARRAY:1A7E
@1				  Near	 ARRAY:0E2F
@32BIT				  Text	 0
@@				  Near	 ARRAY:0E53
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 89
Symbol Table



@CODE				  Text	 _TEXT
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 ARRAY
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@FILENAME			  Text	 FORTH
@INTERFACE			  Text	 00H
@MODEL				  Text	 2
@STACK				  Text	 DGROUP
@WORDSIZE			  Text	 2
A				  Near	 ARRAY:108E
AA				  Near	 ARRAY:10A2
AAA1				  Near	 ARRAY:1092
AB				  Near	 ARRAY:13D4
ABORT				  Far	 ARRAY:2069
ALLOT				  Far	 ARRAY:16F2
ARROW				  Far	 ARRAY:228F
ASCII				  Byte	 ARRAY:0E90
AT				  Far	 ARRAY:1658
ATR				  Far	 ARRAY:19B2
BACK				  Far	 ARRAY:22FD
BASE				  Far	 ARRAY:1A22
BBUF				  Far	 ARRAY:193A
BCK				  Near	 ARRAY:21E5
BCOM				  Far	 ARRAY:1F23
BDIGS				  Far	 ARRAY:240D
BEGIN				  Far	 ARRAY:230F
BLAN				  Far	 ARRAY:1928
BLANK				  Far	 ARRAY:1614
BLANKBUFFER			  Near	 ARRAY:0E52
BLC				  Near	 ARRAY:21F9
BLK				  Far	 ARRAY:19C5
BLO				  Near	 ARRAY:21CD
BLOCK				  Far	 ARRAY:21B3
BN				  Near	 ARRAY:1CEF
BN1				  Near	 ARRAY:1D25
BR1				  Near	 ARRAY:217B
BR2				  Near	 ARRAY:219B
BRAN				  Far	 ARRAY:0F04
BUFFE				  Far	 ARRAY:2171
BUILD				  Far	 ARRAY:1BBC
BYE				  Far	 ARRAY:18F5
C$				  Near	 ARRAY:1560
CAT				  Far	 ARRAY:1667
CCOM				  Far	 ARRAY:1AB4
CFA				  Far	 ARRAY:16BC
CLEAR				  Near	 ARRAY:11D6
CMOV				  Far	 ARRAY:15C9
CNT				  Near	 ARRAY:0F06
COLON				  Far	 ARRAY:183E
COMMA				  Far	 ARRAY:1AA3
COMP				  Far	 ARRAY:1B77
COMPA				  Near	 ARRAY:1796
CON				  Far	 ARRAY:187F
CONT				  Far	 ARRAY:19FD
COPY				  Far	 ARRAY:2611
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 90
Symbol Table



COUNT				  Far	 ARRAY:1BCC
CR				  Far	 ARRAY:1A8F
CRE				  Near	 ARRAY:1EE3
CREAT				  Far	 ARRAY:1ECD
CSP				  Far	 ARRAY:1A36
CSTOR				  Far	 ARRAY:1688
CURBLK				  Word	 ARRAY:281C
CURR				  Far	 ARRAY:1A0B
CURREC				  Byte	 ARRAY:2832
D0TQ				  Far	 ARRAY:1C25
DABS				  Far	 ARRAY:1347
DATE				  Word	 ARRAY:2824
DDOT				  Far	 ARRAY:24CE
DDOTR				  Far	 ARRAY:248A
DDROP				  Far	 ARRAY:15A6
DDUP				  Far	 ARRAY:156D
DEBUG				  Number 0000
DECIMA				  Far	 ARRAY:1751
DEEP				  Near	 ARRAY:1431
DEFIN				  Far	 ARRAY:17D3
DEPTH				  Far	 ARRAY:265C
DFIND				  Far	 ARRAY:1D37
DIG				  Far	 ARRAY:2449
DIGI				  Near	 ARRAY:2465
DIGIT				  Far	 ARRAY:0FE2
DIGS				  Far	 ARRAY:2474
DIS				  Near	 ARRAY:2476
DIV2				  Far	 ARRAY:12E3
DLI				  Near	 ARRAY:1F6A
DLINE				  Far	 ARRAY:2209
DLITE				  Far	 ARRAY:1F5A
DMIN				  Near	 ARRAY:1331
DMINU				  Far	 ARRAY:132E
DMP				  Near	 ARRAY:2679
DOES				  Far	 ARRAY:18CF
DONE				  Near	 ARRAY:27CB
DOTR				  Far	 ARRAY:24AD
DOVOC				  Far	 ARRAY:201E
DP1				  Near	 ARRAY:2689
DP2				  Near	 ARRAY:26A7
DP3				  Near	 ARRAY:26C5
DPL				  Far	 ARRAY:1A2C
DPLUS				  Far	 ARRAY:138D
DRIVE				  Byte	 ARRAY:2810
DRO				  Near	 ARRAY:15A8
DROP				  Far	 ARRAY:15B7
DRP				  Near	 ARRAY:15B9
DSKBUF				  Word	 ARRAY:0006
DSPL				  Far	 ARRAY:1202
DSWAP				  Far	 ARRAY:153B
DTRAI				  Far	 ARRAY:178F
DU				  Near	 ARRAY:155F
DUBL				  Far	 ARRAY:155C
DUMP				  Far	 ARRAY:2673
DUP2				  Far	 ARRAY:157E
EDIGS				  Far	 ARRAY:241C
EIGHT				  Far	 ARRAY:191F
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 91
Symbol Table



EMI$				  Far	 ARRAY:110F
EMIT				  Far	 ARRAY:113E
ENCL				  Far	 ARRAY:1088
ENDA				  Near	 ARRAY:13E6
ENDBUF				  Word	 ARRAY:0C12
ENT				  Near	 ARRAY:0DBE
ENT$				  Near	 ARRAY:1141
EQUAL				  Far	 ARRAY:103B
EQW				  Near	 ARRAY:10AE
ER				  Near	 ARRAY:1E70
ER1				  Near	 ARRAY:1E74
ERASE				  Far	 ARRAY:1605
ERB				  Far	 ARRAY:1A72
ERMES0				  Byte	 ARRAY:2837
ERMES1				  Byte	 ARRAY:2848
ERMES2				  Byte	 ARRAY:2859
ERMES3				  Byte	 ARRAY:286A
ERMES4				  Byte	 ARRAY:1168
ERR0				  Near	 ARRAY:27B9
ERR1				  Near	 ARRAY:27BE
ERR2				  Near	 ARRAY:27C3
ERR3				  Near	 ARRAY:27C8
ERR4				  Near	 ARRAY:1157
ERROR				  Far	 ARRAY:1E88
EXEC				  Far	 ARRAY:0EB1
EXIT				  Near	 ARRAY:27B4
EXP				  Near	 ARRAY:1DFA
EXPE				  Far	 ARRAY:1232
EXT				  Byte	 ARRAY:2819
FAIL				  Near	 ARRAY:0FD5
FALSE				  Near	 ARRAY:100C
FAST				  Near	 ARRAY:0F87
FCB				  Word	 ARRAY:2810
FENCE				  Far	 ARRAY:197C
FILE				  Byte	 ARRAY:2806
FILESIZE			  Word	 ARRAY:2820
FILL				  Far	 ARRAY:15E9
FIN				  Near	 ARRAY:1D5B
FIRST				  Far	 ARRAY:199C
FIX				  Far	 ARRAY:11E6
FL1				  Near	 ARRAY:215C
FLL				  Near	 ARRAY:15EC
FLU				  Near	 ARRAY:2146
FLUSH				  Far	 ARRAY:213A
FN				  Byte	 ARRAY:2811
FORGE				  Far	 ARRAY:22C0
FORTH				  Far	 ARRAY:27EF
FROMR				  Far	 ARRAY:14B2
G$				  Near	 ARRAY:133B
GO$				  Near	 ARRAY:0E14
GREAT				  Far	 ARRAY:1066
HANDLE				  Word	 ARRAY:2804
HERE				  Far	 ARRAY:16E0
HLD				  Far	 ARRAY:1A49
HOLD				  Far	 ARRAY:1622
HT				  Far	 ARRAY:2600
I				  Far	 ARRAY:14C3
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 92
Symbol Table



IDDOT				  Far	 ARRAY:1EB4
IL				  Far	 ARRAY:1189
IMMED				  Far	 ARRAY:1FE7
INDEX				  Far	 ARRAY:2542
INDX				  Near	 ARRAY:254A
INIT				  Far	 ARRAY:0DBC
INTER				  Far	 ARRAY:1F9F
IT1				  Near	 ARRAY:1FA1
IT2				  Near	 ARRAY:1FB7
IT3				  Near	 ARRAY:1FBD
IT4				  Near	 ARRAY:1FD1
IT5				  Near	 ARRAY:1FD5
KEY				  Far	 ARRAY:121B
LATES				  Far	 ARRAY:177A
LBRAC				  Far	 ARRAY:1719
LCL				  Far	 ARRAY:25EB
LEAV				  Far	 ARRAY:148E
LESS				  Far	 ARRAY:1058
LEV				  Far	 ARRAY:14E7
LFA				  Far	 ARRAY:16AA
LIL				  Near	 ARRAY:1F4D
LIMIT				  Far	 ARRAY:19A8
LINK				  Number ARRAY:27F9
LINK$				  Number ARRAY:27F9
LIT				  Far	 ARRAY:0EBC
LITER				  Far	 ARRAY:1F3D
LOA				  Far	 ARRAY:2267
LOO				  Far	 ARRAY:234C
LOP				  Near	 ARRAY:0F36
LSTI				  Near	 ARRAY:2520
LV				  Near	 ARRAY:0F3E
M09				  Near	 ARRAY:0FF8
MATCH				  Near	 ARRAY:0F91
MAX				  Far	 ARRAY:143D
MES				  Near	 ARRAY:2251
MESS				  Far	 ARRAY:222D
MIN				  Far	 ARRAY:1423
MINUS				  Far	 ARRAY:13A7
MM				  Near	 ARRAY:0E70
MMM1				  Near	 ARRAY:0E7B
MMO				  Near	 ARRAY:1D2B
MODA				  Far	 ARRAY:10FD
MS1				  Near	 ARRAY:2253
MSLAS				  Far	 ARRAY:135A
MSMOD				  Far	 ARRAY:20FE
MSTAR				  Far	 ARRAY:1318
MTBUF				  Far	 ARRAY:2124
MUL2				  Far	 ARRAY:12D3
NEMI				  Near	 ARRAY:1E24
NFA				  Far	 ARRAY:1699
NH0				  Near	 ARRAY:1E36
NH1				  Near	 ARRAY:1D90
NH2				  Near	 ARRAY:1DAC
NH3				  Near	 ARRAY:1DBA
NH4				  Near	 ARRAY:1DBC
NH5				  Near	 ARRAY:1E54
NH6				  Near	 ARRAY:1E5E
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 93
Symbol Table



NH7				  Near	 ARRAY:1E68
NO				  Near	 ARRAY:179E
NOTEQ				  Near	 ARRAY:1095
NUL				  Near	 ARRAY:1C89
NULL				  Far	 ARRAY:1C71
NUMB				  Far	 ARRAY:1D66
OCTAL				  Far	 ARRAY:1765
ODOT				  Far	 ARRAY:2741
OFLIM				  Near	 ARRAY:17BD
OFSET				  Far	 ARRAY:19EF
OK				  Near	 ARRAY:1132
ONE				  Far	 ARRAY:1907
ONEM				  Far	 ARRAY:12C4
ONEP				  Far	 ARRAY:12A4
OUT1				  Near	 ARRAY:27AA
OVER				  Far	 ARRAY:1514
P1				  Near	 ARRAY:0E32
P2				  Near	 ARRAY:0E4A
PAD				  Far	 ARRAY:1C93
PAREN				  Far	 ARRAY:202A
PAUSE				  Near	 ARRAY:0E22
PB				  Near	 ARRAY:17FE
PBUF				  Far	 ARRAY:17E7
PDOTQ				  Far	 ARRAY:1C0C
PFA				  Far	 ARRAY:1AD6
PFIND				  Far	 ARRAY:0F73
PG				  Far	 ARRAY:19BB
PICK				  Far	 ARRAY:14F8
PIX				  Far	 ARRAY:10DC
PLOOP				  Far	 ARRAY:2362
PLU				  Near	 ARRAY:1E34
PLUS				  Far	 ARRAY:136C
PNT				  Far	 ARRAY:19D8
PNUMB				  Far	 ARRAY:1CED
PORT				  Far	 ARRAY:1282
PREV				  Far	 ARRAY:1A5E
PRIN				  Far	 ARRAY:1197
PRINT				  Near	 ARRAY:114B
PRINTWORD			  Near	 ARRAY:0E5B
PSCOD				  Far	 ARRAY:1BA4
PSTOR				  Far	 ARRAY:1637
PUT				  Near	 ARRAY:100E
QCOMP				  Far	 ARRAY:1B02
QCSP				  Far	 ARRAY:1B43
QERR				  Far	 ARRAY:1AEA
QEXEC				  Far	 ARRAY:1B1A
QLOAD				  Far	 ARRAY:1B5D
QPAIR				  Far	 ARRAY:1B30
QSTAC				  Far	 ARRAY:1F75
QUERY				  Far	 ARRAY:1C55
QUEST				  Far	 ARRAY:24E8
QUI				  Near	 ARRAY:2045
QUIT				  Far	 ARRAY:203B
R				  Far	 ARRAY:14D1
RANDREC				  Word	 ARRAY:2833
RBRAC				  Far	 ARRAY:1729
RC				  Far	 ARRAY:117D
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 94
Symbol Table



READ				  Far	 ARRAY:1293
RECSIZE				  Word	 ARRAY:281E
RED				  Near	 ARRAY:2799
REPEA				  Far	 ARRAY:238F
RNUM				  Far	 ARRAY:1A3F
ROT				  Far	 ARRAY:1591
RPSTO				  Far	 ARRAY:1469
RR$				  Near	 ARRAY:14C5
RW				  Far	 ARRAY:2759
RZERO				  Far	 ARRAY:194C
SCL				  Far	 ARRAY:11C5
SCR				  Far	 ARRAY:19E2
SCSP				  Far	 ARRAY:16CF
SEMI				  Far	 ARRAY:1479
SEMIC				  Far	 ARRAY:27D9
SIG				  Near	 ARRAY:2443
SIGN				  Far	 ARRAY:2433
SLASH				  Far	 ARRAY:20BB
SLMOD				  Far	 ARRAY:20AB
SLOW				  Near	 ARRAY:0FA5
SLOW1				  Near	 ARRAY:0FB8
SMI				  Far	 ARRAY:1866
SMUG				  Far	 ARRAY:1B90
SP1				  Near	 ARRAY:2406
SPA				  Near	 ARRAY:2400
SPACE				  Far	 ARRAY:1AC8
SPACS				  Far	 ARRAY:23F0
SPAT				  Far	 ARRAY:144D
SPOT				  Far	 ARRAY:2090
SPSTO				  Far	 ARRAY:1459
SRP				  Far	 ARRAY:14DA
SSLA				  Far	 ARRAY:20EC
SSMOD				  Far	 ARRAY:20DB
STAR				  Far	 ARRAY:209C
STATE				  Far	 ARRAY:1A17
STOD				  Far	 ARRAY:140E
STORE				  Far	 ARRAY:1678
STY				  Far	 ARRAY:270E
STY1				  Near	 ARRAY:271C
STY2				  Near	 ARRAY:272A
STY3				  Near	 ARRAY:273A
SUBB				  Far	 ARRAY:137C
SWAB				  Far	 ARRAY:13B9
SWAP				  Far	 ARRAY:1528
SWAS				  Far	 ARRAY:26E2
SZERO				  Far	 ARRAY:1943
TASK				  Far	 ARRAY:2800
TC0				  Near	 ARRAY:1BEB
TC1				  Near	 ARRAY:1C01
TER				  Near	 ARRAY:1264
TERMON				  Far	 ARRAY:0ECE
THEN				  Far	 ARRAY:2320
THREE				  Far	 ARRAY:1917
TIB				  Far	 ARRAY:1956
TICK				  Far	 ARRAY:22A5
TOGL				  Far	 ARRAY:1649
TOHEX				  Near	 ARRAY:0E30
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 95
Symbol Table



TOP				  Near	 ARRAY:142B
TOR				  Far	 ARRAY:14A0
TRAV				  Far	 ARRAY:1704
TRI				  Near	 ARRAY:2579
TRIO				  Far	 ARRAY:2567
TRUE				  Near	 ARRAY:1014
TRV				  Near	 ARRAY:1708
TTT				  Near	 ARRAY:1AF6
TTY				  Far	 ARRAY:11B3
TWO				  Far	 ARRAY:190F
TWOP				  Far	 ARRAY:12B3
TY$$				  Far	 ARRAY:2626
TY4				  Near	 ARRAY:262C
TY5				  Near	 ARRAY:2642
TYPE$				  Near	 ARRAY:11B5
UDOT				  Far	 ARRAY:24F5
UDOTR				  Far	 ARRAY:24BF
ULESS				  Far	 ARRAY:104A
UNTIL				  Far	 ARRAY:2378
UPDAT				  Far	 ARRAY:1816
UPPER				  Far	 ARRAY:17AC
USE				  Far	 ARRAY:1A53
USER				  Far	 ARRAY:18B4
USLAS				  Far	 ARRAY:1305
USTAR				  Far	 ARRAY:12F3
VAR				  Far	 ARRAY:189E
VL0				  Near	 ARRAY:2593
VL1				  Near	 ARRAY:259B
VL2				  Near	 ARRAY:25D7
VLIST				  Far	 ARRAY:258B
VOCAB				  Far	 ARRAY:1FFE
VOCL				  Far	 ARRAY:1990
WD1				  Near	 ARRAY:1CB8
WD2				  Near	 ARRAY:1CBC
WR				  Near	 ARRAY:278A
X				  Far	 ARRAY:182C
XDO				  Far	 ARRAY:0F14
XDP				  Word	 ARRAY:287B
XER				  Near	 ARRAY:1EA8
XLOOP				  Far	 ARRAY:0F31
XPLOO				  Far	 ARRAY:0F53
XR0				  Word	 ARRAY:0CCC
XS0				  Word	 STCK:0080
XT				  Near	 ARRAY:1C43
XTIB				  Word	 ARRAY:0C14
XUP				  Word	 ARRAY:0CD0
XVOC				  Far	 ARRAY:27F7
XXX				  Near	 ARRAY:0DD4
Y$				  Near	 ARRAY:176C
Z$				  Near	 ARRAY:14C8
ZBRAN				  Far	 ARRAY:0EEB
ZEQU				  Far	 ARRAY:1004
ZERO				  Far	 ARRAY:18FF
ZGRET				  Far	 ARRAY:101E
ZLESS				  Far	 ARRAY:102D
ZZZ				  Near	 ARRAY:10BC
Turbo Assembler	 Version 3.1	    04/17/20 16:00:55	    Page 96
Symbol Table




Macro Name

HEAD
NEXT

Groups & Segments		  Bit Size Align  Combine Class

ARRAY				  16  A57B Para	  none
DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
STCK				  16  0084 Para	  Stack
_TEXT				  16  0000 Word	  Public  CODE
