Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 1
forth.asm



      1				     ; 253 слова head
      2				     ; 103 слова используют $col
      3				     ; 9 слова использует $con
      4				     ; 29 слова	использует $use
      5				     ; 1 слово forth
      6
      7				     masm
      8				     .8086
      9	0000			     .MODEL SMALL
     10				     LOCALS
     11	      =0000		     LINK=0
     12					 ; Макроопределения
     13					 ; Описание примитивов и слов высокого уровня
     14					 HEAD  MACRO length,name,lchar,labl,code
     15					 LINK$=$
     16					     DB	 length	 ; NFA 7 бит равен 1.
     17							 ; 6 - признак immediate. 5- слово не описано smudge
     18					     IFNB <name>
     19					     DB	 NAME
     20					     ENDIF
     21					     DB	 lchar	 ; последний символ слова + 128	(7 бит = 1).
     22					     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
     23					 LINK=LINK$
     24					 labl LABEL FAR	 ; CFA
     25					     IFNB <code> ;
     26					     DW	code
     27					     ELSE
     28					     DW	 $+2
     29					     ENDIF
     30					     ENDM
     31
     32					 NEXT MACRO   ;	переход	к исполнению следующего	слова
     33					     local m1
     34					     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
     35					     MOV  BX, AX     ; BX равен	CFA  следующего	слова
     36					 ; ------ call debugger	--------
     37					     cmp byte ptr [di+102Q], 0
     38					     jz	m1
     39					     call printWORD
     40					     call pause
     41					 m1:
     42					 ; -----------------------------
     43					     JMP WORD PTR [BX]
     44					     ENDM
     45
     46
     47	0000				ARRAY	SEGMENT
     48	0000  0000 0000			$TIME	DW  0,0			    ; TIMER COUNTER
     49	0004  0000			$DATE	DW  0			    ; DATE
     50
     51					;  Сегмент стека и словарь пользователя	размещен в конце текста
     52					;  интерпретатора. Для версии, записываемой в ПЗУ, их нужно
     53					;  разместить здесь.
     54
     55	0006  03*(0000 0200*(0000)+	DSKBUF	DW  3 DUP(0,512	DUP(0),0)   ; Экранные буферы на 1024 байта
     56	      0000)
     57	0C12  0000			ENDBUF	DW  0	     ; 6 1034 (40Ah) 2062(80Eh)	адреса буферов
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 2
forth.asm



     58
     59	0C14  5C*(0000)			XTIB	DW  92 DUP(0)		    ; Входной буфер
     60	0CCC  0000 0000			XR0	DW  0,0			    ; Стек возвратов  растет в область
     61									    ; меньших адресов.	ADD BP - убрать	данные
     62	0CD0  66*(0000)			XUP	DW  102	DUP(0)		    ; USER-область на нее указывает DI
     63
     64	0D9C  2D8Br			$STI	DW  TASK-7  ;		    ; Стартовая	таблица	PFA слова TASK
     65	0D9E  0CD0r			$US	DW  XUP	    ;
     66						   ; адрес user	области
     67					;    переменные
     68	0DA0  0080r			$STK	DW  XS0	    ;+6		     ; SO
     69	0DA2  0CCCr			$RS	DW  XR0	    ;+8		     ; RO стек возвратов
     70	0DA4  0C14r				DW  XTIB    ;+10	     ; входной буфер
     71	0DA6  001F				DW  1Fh	    ;+12	     ; WIDTH 31	буква
     72	0DA8  0000				DW  0	    ;+14	     ; WARNING
     73	0DAA  2E0Dr				DW  XDP	    ;+16	     ; словарь FENCE (забор)
     74	0DAC  2E0Dr				DW  XDP	    ;+18	     ; DP
     75	0DAE  2D89r				DW  XVOC    ;+20	     ; словарь VOCL в слове Forth
     76	0DB0  0006r			$BUF	DW  DSKBUF  ;+22	     ; экранный	буфер FIRST
     77	0DB2  0C12r				DW  ENDBUF  ;+24 или 30Q     ; LIMIT
     78
     79					ASSUME	CS:ARRAY, DS:ARRAY, ES:ARRAY, SS:STCK
     80
     81	0DB4				$INI	  PROC	  FAR
     82	0DB4  EB 08				  JMP  ENT
     83					; ** PRIMITIVES	**
     84
     85						  HEAD	  83h,'IN',311Q,INIT		      ;INI
1    86	      =ARRAY:0DB6		 LINK$=$
1    87	0DB6  83			     DB	 83h  ;	NFA 7 бит равен	1.
1    88							 ; 6 - признак immediate. 5- слово не описано smudge
1    89	0DB7  49 4E			     DB	 'IN'
1    90	0DB9  C9			     DB	 311Q	; последний символ слова + 128 (7 бит =	1).
1    91	0DBA  0000			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1    92	      =ARRAY:0DB6		 LINK=LINK$
1    93	0DBC				 INIT LABEL FAR	 ; CFA
1    94	0DBC  0DBEr			     DW	 $+2
     95	0DBE  B9 0000s			ENT:	  MOV	CX, ARRAY
     96	0DC1  8E D9				  MOV	DS, CX		; Установка DX
     97	0DC3  8E C1				  MOV	ES, CX
     98	0DC5  A1 0D9Cr				  MOV	AX, $STI	; Восстановление словаря (PFA слова TASK)
     99	0DC8  BE 2D87r				  LEA	SI, FORTH+6	; Адрес	места нахождения в PFA forth
    100	0DCB  89 04				  MOV	[SI], AX	;
    101	0DCD  8B 36 0DB0r			  MOV	SI, $BUF
    102	0DD1  B9 06CB				  MOV	CX, 1739	; Установка счетчика 1730
    103	0DD4  C7 04 0000		XXX:	  MOV	WORD PTR [SI],0	; Обнуление массивов
    104	0DD8  83 C6 02				  ADD	SI, 2
    105	0DDB  E2 F7				  LOOP	XXX
    106
    107					; INIT 'OFFSET,	USE, PREV
    108	0DDD  8B 1E 0D9Er			  MOV	BX, $US		 ; xup
    109	0DE1  8B 0E 0DB0r			  MOV	CX, $BUF	 ; TO 'USE'
    110	0DE5  89 4F 3A				  MOV	[BX]+72Q,CX	 ; USE ? адрес блока
    111	0DE8  89 4F 3C				  MOV	[BX]+74Q,CX	 ; PREV	? адрес	блока
    112	0DEB  C7 47 42 0000			  MOV	word ptr [BX]+102Q,00h	    ; отладка выключена
    113	0DF0  B9 000A				  MOV	CX, 10		 ; Установка счетчика USER (14Q	надо на	2 меньше уже)
    114	0DF3  8B 3E 0D9Er			  MOV	DI, $US		 ; Запись адреса области USER
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 3
forth.asm



    115	0DF7  83 C7 06				  ADD	DI, 6		 ; почему 6....	? User переменные начинаются с 6 адреса
    116	0DFA  BE 0DA0r				  LEA	SI, $STK	 ; Запись начального адреса
    117						  ; заполняем начальные	значения переменых
    118	0DFD  F3> A5			REP	  MOVS	WORD PTR ES:[DI], WORD PTR DS:[SI]
    119	0DFF  8B 2E 0DA2r			  MOV	BP, $RS		 ; Установка начального	значения
    120									 ; указателя стека возвратов
    121									 ; пересекается	с областью TIB
    122									 ; RS растет в область с меньшими адресами
    123	0E03  8B 3E 0D9Er			  MOV	DI, $US
    124	0E07  C7 45 1A 0007			  MOV	WORD PTR [DI+32Q],7  ; Установка цвета вывода текста
    125	0E0C  C7 45 22 0000			  MOV	WORD PTR [DI+42Q],0  ; Сброс флага печати
    126	0E11  BE 0E25r				  LEA	SI, GO$
    127						  NEXT
1   128	0E14  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   129	0E15  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   130					 ; ------ call debugger	--------
1   131	0E17  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   132	0E1B  74 06			     jz	??0000
1   133	0E1D  E8 012C			     call printWORD
1   134	0E20  E8 0010			     call pause
1   135	0E23				 ??0000:
1   136					 ; -----------------------------
1   137	0E23  FF 27			     JMP WORD PTR [BX]
    138						  ; здесь инструкции языка форт. указатель на них в SI
    139	0E25  1772r 1C0Fr 2D81r	  +	GO$:	  DW SPSTO,DECIMA,FORTH,DEFIN, ONE,LOA,	quit; загрузка первого экрана
    140	      1CCDr 1E6Dr 27D7r	  +
    141	      25ABr
    142	0E33			     $INI      ENDP
    143
    144				     ; ждем нажатия клавиши, по	Q выход	из программы
    145	0E33			     pause proc
    146	0E33				 @start:
    147	0E33  33 C0			     xor ax, ax
    148	0E35  CD 16			     int 16h ; AL = ASCII символ (если AL=0, AH	содержит расширенный код ASCII )
    149						     ; AH = сканкод  или расширенный код ASCII
    150	0E37  80 FC 10			     cmp ah, 10h ; клавиша Q (quit)
    151	0E3A  74 1B			     je	@e
    152	0E3C  80 FC 20			     cmp ah, 20h ; клавиша D (debug off)
    153	0E3F  74 29			     je	@d
    154	0E41  80 FC 1F			     cmp ah, 1Fh ; клавиша S (show stack)
    155	0E44  74 1F			     je	@s
    156	0E46  80 FC 13			     cmp ah, 13h ; клавиша R (show return)
    157	0E49  74 15			     je	@rs
    158	0E4B  80 FC 31			     cmp ah, 31h ; клавиша N (next step)
    159	0E4E  74 1F			     je	@r
    160	0E50  80 FC 11			     cmp ah, 11h ; клавиша W(next word from dict)
    161	0E53  74 06			     je	@v
    162	0E55  EB DC			     jmp @start
    163	0E57  B4 4C			 @e: mov ah, 4Ch ; выход из программы
    164	0E59  CD 21			     int 21h
    165	0E5B  E8 0012			 @v: call showWD
    166	0E5E  EB D3			     jmp @start
    167	0E60  E8 005B			 @rs: call showRS
    168	0E63  EB CE			     jmp @start
    169	0E65  E8 0084			 @s: call showStack
    170	0E68  EB C9			     jmp @start
    171	0E6A  C7 45 42 0000		 @d: mov word ptr [DI]+102Q,00h	 ; отладка выключена
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 4
forth.asm



    172					     ;jmp @start
    173	0E6F  C3			 @r: ret
    174	0E70			     pause endp
    175
    176	0E70			     proc showWD
    177	0E70  57			 push di
    178	0E71  53			 push bx
    179	0E72  BA 0E8Cr			 mov dx, offset	@@caption
    180	0E75  E8 013C			 call outText
    181	0E78  BF 0E99r			 mov di,OFFSET @@ASCII ;
    182	0E7B  8B 04			 mov ax, [si]
    183	0E7D  E8 00A0			 call toHex
    184	0E80  BA 0E99r			 mov dx, offset	@@ASCII
    185	0E83  E8 012E			 call outText
    186	0E86  E8 0120			 call outCR
    187	0E89  5B			 pop bx
    188	0E8A  5F			 pop di
    189	0E8B  C3			 ret
    190	0E8C  4E 45 58 54 20 57	4F+	 @@caption DB "NEXT WORD:  $"
    191	      52 44 3A 20 20 24
    192	0E99  30 30 30 30 20 20	20+	 @@ASCII DB "0000    $"
    193	      20 24
    194	0EA2			     showWD endp
    195
    196	0EA2			     showStDump	proc
    197	0EA2  D1 E9			 shr cx, 1   ; байты в слова
    198	0EA4  0B C9			 or cx , cx
    199	0EA6  74 15			 jz @@r
    200	0EA8  8C D0			 mov ax, ss
    201	0EAA  8E C0			 mov es, ax
    202	0EAC			       @@l:
    203	0EAC  4B			 dec bx
    204	0EAD  4B			 dec bx
    205	0EAE  26: 8B 07			 mov ax, es:[bx]
    206	0EB1  53			 push bx
    207	0EB2  8B FA			 mov di, dx
    208	0EB4  E8 0069			 call toHex
    209					 ;mov dx, offset @@ASCII
    210	0EB7  E8 00FA			 call outText
    211	0EBA  5B			 pop bx
    212	0EBB  E2 EF			 loop @@l
    213	0EBD			       @@r:
    214	0EBD  C3			 ret
    215	0EBE			     showStDump	endP
    216
    217	0EBE			     showRS proc
    218	0EBE  57			 push di
    219	0EBF  56			 push si
    220	0EC0  06			 push es
    221	0EC1  53			 push bx
    222	0EC2  BA 0EE0r			 mov dx, offset	@@caption
    223	0EC5  E8 00EC			 call outText
    224	0EC8  B9 0CCCr			 mov cx, offset	XR0
    225	0ECB  8B DD			 mov bx, BP
    226	0ECD  2B CB			 sub cx, bx
    227	0ECF  BA 0EE6r			 mov dx, offset	@@ASCII
    228	0ED2  BB 0CCCr			 mov bx, offset	XR0
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 5
forth.asm



    229	0ED5  E8 FFCA			 call showStDump
    230	0ED8			       @@r:
    231	0ED8  E8 00CE			 call outCR
    232	0EDB  5B			 pop bx
    233	0EDC  07			 pop es
    234	0EDD  5E			 pop si
    235	0EDE  5F			 pop di
    236	0EDF  C3			 ret
    237	0EE0  52 53 3A 20 20 24		 @@caption DB "RS:  $"
    238	0EE6  30 30 30 30 20 24		 @@ASCII DB "0000 $"
    239	0EEC			     showRS endP
    240
    241	0EEC			     showStack proc
    242	0EEC  57			 push di
    243	0EED  56			 push si
    244	0EEE  06			 push es
    245	0EEF  53			 push bx
    246	0EF0  BA 0F11r			 mov dx, offset	@@caption
    247	0EF3  E8 00BE			 call outText
    248	0EF6  B9 0080			 mov cx, 80h
    249	0EF9  8B DC			 mov bx, SP
    250	0EFB  83 C3 0C			 add bx, 2*6   ; столько лишних	элементов стеке
    251	0EFE  2B CB			 sub cx, bx
    252	0F00  BB 0080			 mov bx, 80h
    253	0F03  BA 0F1Ar			 mov dx, offset	@@ASCII
    254	0F06  E8 FF99			 call showStDump
    255	0F09			       @@r:
    256	0F09  E8 009D			 call outCR
    257	0F0C  5B			 pop bx
    258	0F0D  07			 pop es
    259	0F0E  5E			 pop si
    260	0F0F  5F			 pop di
    261	0F10  C3			 ret
    262	0F11  53 54 41 43 4B 3A	20+	 @@caption DB "STACK:  $"
    263	      20 24
    264	0F1A  30 30 30 30 20 24		 @@ASCII DB "0000 $"
    265	0F20			     showStack endP
    266
    267				     ; AX- значение для	печати в 16 виде
    268				     ; di - адрес строки для вывода
    269	0F20			     toHex PROC
    270	0F20  51			 push cx
    271	0F21  B1 04			 mov cl,4	     ; number of ASCII
    272	0F23  D1 C0 D1 C0 D1 C0	D1+  @@1: rol ax,4	     ; 1 Nibble	(start with highest byte)
    273	      C0
    274	0F2B  8A D8			 mov bl,al
    275	0F2D  80 E3 0F			 and bl,0Fh	     ; only low-Nibble
    276	0F30  80 C3 30			 add bl,30h	     ; convert to ASCII
    277	0F33  80 FB 39			 cmp bl,39h	     ; above 9?
    278	0F36  76 03			 jna short @@2
    279	0F38  80 C3 07			 add bl,7	     ; "A" to "F"
    280	0F3B  88 1D		     @@2: mov [di],bl	      ;	store ASCII in buffer
    281	0F3D  47			 inc di		     ; increase	target address
    282	0F3E  FE C9			 dec cl		     ; decrease	loop counter
    283	0F40  75 E1			 jnz @@1	      ;	jump if	cl is not equal	0 (zeroflag is not set)
    284	0F42  59			 pop cx
    285	0F43  C3			 ret
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 6
forth.asm



    286	0F44			     toHex endP
    287
    288				     ; di- адрес буфера
    289				     ; cx - число символов
    290				     ; заполнение пробелом
    291	0F44			     blankBuffer proc
    292	0F44  57			 push di
    293	0F45  FC			 cld
    294	0F46  B0 20			 mov al, 32
    295	0F48  F3> AA			 rep stosb
    296	0F4A  5F			 pop di
    297	0F4B  C3			 ret
    298	0F4C			     blankBuffer endp
    299
    300				     ; вывод адреса и имени слова
    301				     ; AX- значение адреса
    302	0F4C			     printWORD proc
    303	0F4C  57			 push di
    304	0F4D  56			 push si
    305	0F4E  53			 push bx
    306	0F4F  50			 push ax
    307	0F50  BF 0F8Cr			 mov di,OFFSET ASCII ; get the offset address
    308	0F53  B9 0019			 mov cx, 25
    309	0F56  E8 FFEB			 call blankBuffer
    310					 ; печать адреса слова
    311	0F59  8B C6			 mov ax, si
    312	0F5B  2D 0002			 sub ax, 2
    313	0F5E  E8 FFBF			 call toHex
    314	0F61  47			 inc di
    315	0F62  47			 inc di
    316					 ; печать CFA слова
    317	0F63  58			 pop ax
    318	0F64  50			 push ax
    319	0F65  E8 FFB8			 call toHex
    320	0F68  47			 inc di	 ; вывод имени слова после его адреса
    321	0F69  5B			 pop bx	; адрес	слова CFA?
    322					 ;mov al, byte ptr [bx-3] ; последний символ слова
    323	0F6A  83 EB 03			 SUB bx, 3   ;
    324	0F6D				 mm:	      ;	ищем поле длины
    325	0F6D  4B			 dec bx
    326	0F6E  80 3F 00			 CMP  BYTE PTR [bx],  0
    327	0F71  79 FA			 JNS  mm     ; JUMP IF POSITIVE
    328	0F73  8B 0F			 mov cx, [bx] ;	длина слова + всякие  служ. поля
    329	0F75  83 E1 3F			 and cx, 003Fh
    330	0F78				 mmm1:
    331	0F78  43			 inc bx
    332	0F79  8A 07			 mov al, byte ptr [bx]
    333	0F7B  24 7F			 and al, 7Fh ;	 последний символ увеличен на 80h
    334	0F7D  88 05			 mov [di],al
    335	0F7F  47			 inc di
    336	0F80  E2 F6			 loop mmm1
    337					 ; Print string
    338	0F82  BA 0F8Cr			 mov dx,OFFSET ASCII ; DOS 1+ WRITE STRING TO STANDARD OUTPUT
    339	0F85  E8 002C			 call outText
    340	0F88  5B			 pop bx
    341	0F89  5E			 pop si
    342	0F8A  5F			 pop di
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 7
forth.asm



    343	0F8B  C3			 ret
    344	0F8C  30 30 30 30 3A 20	30+	 ASCII DB "0000: 0000		     ",0Dh,0Ah,"$" ; buffer for	ASCII string
    345	      30 30 30 20 20 20	20+
    346	      20 20 20 20 20 20	20+
    347	      20 20 20 20 20 0D	0A+
    348	      24
    349	0FA9			     printWORD endP
    350
    351	0FA9			     outCR proc
    352	0FA9  B4 09			 mov ah,9	     ; DS:DX->'$'-terminated string
    353	0FAB  BA 0FB1r			 lea dx, @@cr
    354	0FAE  CD 21			 int 21h	     ; (using pipe character">") or output to printer
    355	0FB0  C3			 ret
    356	0FB1  0D 0A 24			 @@cr DB 0Dh, 0Ah, "$"
    357	0FB4			     outCR endp
    358
    359	0FB4			     outText proc
    360	0FB4  B4 09			 mov ah,9	     ; DS:DX->'$'-terminated string
    361	0FB6  CD 21			 int 21h	     ; (using pipe character">") or output to printer
    362	0FB8  C3			 ret
    363	0FB9			     outText endp
    364
    365					; BX - WP находится адрес исполняемого слова
    366					; SI - IP-регистр    должен сохраняться
    367					; DI - указатель области USER
    368					; BP - указатель стека возвратов
    369					; SP - указатель стека параметров
    370
    371						  HEAD	  87h,'EXECUT',305Q,EXEC	      ;
1   372	      =ARRAY:0FB9		 LINK$=$
1   373	0FB9  87			     DB	 87h  ;	NFA 7 бит равен	1.
1   374							 ; 6 - признак immediate. 5- слово не описано smudge
1   375	0FBA  45 58 45 43 55 54		     DB	 'EXECUT'
1   376	0FC0  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1   377	0FC1  0DB6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   378	      =ARRAY:0FB9		 LINK=LINK$
1   379	0FC3				 EXEC LABEL FAR	 ; CFA
1   380	0FC3  0FC5r			     DW	 $+2
    381					 ; в стеке адрес поля CFA (НЕ PFA)
    382	0FC5  5B				  POP	BX
    383	0FC6  FF 27				  JMP  WORD PTR	[ BX ]
    384
    385						  HEAD	  83h,'LI',324Q,LIT		      ;	LIT
1   386	      =ARRAY:0FC8		 LINK$=$
1   387	0FC8  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   388							 ; 6 - признак immediate. 5- слово не описано smudge
1   389	0FC9  4C 49			     DB	 'LI'
1   390	0FCB  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1   391	0FCC  0FB9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   392	      =ARRAY:0FC8		 LINK=LINK$
1   393	0FCE				 LIT LABEL FAR	; CFA
1   394	0FCE  0FD0r			     DW	 $+2
    395	0FD0  AD				  LODSW
    396	0FD1  50				  PUSH	AX
    397						  NEXT
1   398	0FD2  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   399	0FD3  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 8
forth.asm



1   400					 ; ------ call debugger	--------
1   401	0FD5  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   402	0FD9  74 06			     jz	??0001
1   403	0FDB  E8 FF6E			     call printWORD
1   404	0FDE  E8 FE52			     call pause
1   405	0FE1				 ??0001:
1   406					 ; -----------------------------
1   407	0FE1  FF 27			     JMP WORD PTR [BX]
    408
    409						  HEAD	  86h,'TERMO',316Q,TERMON	      ;	TERMON
1   410	      =ARRAY:0FE3		 LINK$=$
1   411	0FE3  86			     DB	 86h  ;	NFA 7 бит равен	1.
1   412							 ; 6 - признак immediate. 5- слово не описано smudge
1   413	0FE4  54 45 52 4D 4F		     DB	 'TERMO'
1   414	0FE9  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1   415	0FEA  0FC8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   416	      =ARRAY:0FE3		 LINK=LINK$
1   417	0FEC				 TERMON	LABEL FAR  ; CFA
1   418	0FEC  0FEEr			     DW	 $+2
    419					 ; NumLock, ScrollLock,	CapsLock, Ins. Состояние этих клавиш записывается
    420					 ; в область данных BIOS в два байта с адресами	0000h:0417h и 0000h:0418h
    421	0FEE  58				  POP	AX
    422	0FEF  06				  PUSH	ES
    423	0FF0  B9 0000				  MOV	CX, 0
    424	0FF3  8E C1				  MOV	ES, CX
    425	0FF5  26: A3 0417			  MOV	ES:417H,AX
    426	0FF9  07				  POP	ES
    427						  NEXT
1   428	0FFA  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   429	0FFB  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   430					 ; ------ call debugger	--------
1   431	0FFD  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   432	1001  74 06			     jz	??0002
1   433	1003  E8 FF46			     call printWORD
1   434	1006  E8 FE2A			     call pause
1   435	1009				 ??0002:
1   436					 ; -----------------------------
1   437	1009  FF 27			     JMP WORD PTR [BX]
    438
    439						  HEAD	  87h,'?BRANC',310Q,ZBRAN	      ;	?BRANCH
1   440	      =ARRAY:100B		 LINK$=$
1   441	100B  87			     DB	 87h  ;	NFA 7 бит равен	1.
1   442							 ; 6 - признак immediate. 5- слово не описано smudge
1   443	100C  3F 42 52 41 4E 43		     DB	 '?BRANC'
1   444	1012  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1   445	1013  0FE3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   446	      =ARRAY:100B		 LINK=LINK$
1   447	1015				 ZBRAN LABEL FAR  ; CFA
1   448	1015  1017r			     DW	 $+2
    449					 ; переход, если 0 в стеке (FALSE)
    450	1017  58				  POP	AX
    451	1018  3D 0000				  CMP	AX, 0
    452	101B  74 1F				  JE	CNT
    453	101D  83 C6 02				  ADD	SI, 2 ;	без перехода пропускаем	следующее слово	(адрес перехода)
    454						  NEXT
1   455	1020  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   456	1021  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 9
forth.asm



1   457					 ; ------ call debugger	--------
1   458	1023  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   459	1027  74 06			     jz	??0003
1   460	1029  E8 FF20			     call printWORD
1   461	102C  E8 FE04			     call pause
1   462	102F				 ??0003:
1   463					 ; -----------------------------
1   464	102F  FF 27			     JMP WORD PTR [BX]
    465
    466						  HEAD	  86h,'BRANC',310Q,BRAN		      ;	BRANCH
1   467	      =ARRAY:1031		 LINK$=$
1   468	1031  86			     DB	 86h  ;	NFA 7 бит равен	1.
1   469							 ; 6 - признак immediate. 5- слово не описано smudge
1   470	1032  42 52 41 4E 43		     DB	 'BRANC'
1   471	1037  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1   472	1038  100Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   473	      =ARRAY:1031		 LINK=LINK$
1   474	103A				 BRAN LABEL FAR	 ; CFA
1   475	103A  103Cr			     DW	 $+2
    476					 ; безусловный переход.	SI указывает на	число инструкций,
    477					 ; которые нужно пропустить
    478	103C  03 34			CNT:	  ADD	SI,  [SI]  ; si	содержит число инструкций,
    479								 ; которые необходимо пропустить
    480						  NEXT
1   481	103E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   482	103F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   483					 ; ------ call debugger	--------
1   484	1041  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   485	1045  74 06			     jz	??0004
1   486	1047  E8 FF02			     call printWORD
1   487	104A  E8 FDE6			     call pause
1   488	104D				 ??0004:
1   489					 ; -----------------------------
1   490	104D  FF 27			     JMP WORD PTR [BX]
    491
    492						  HEAD	  84h,'(DO',251Q,XDO		      ;	(DO)
1   493	      =ARRAY:104F		 LINK$=$
1   494	104F  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   495							 ; 6 - признак immediate. 5- слово не описано smudge
1   496	1050  28 44 4F			     DB	 '(DO'
1   497	1053  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1   498	1054  1031r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   499	      =ARRAY:104F		 LINK=LINK$
1   500	1056				 XDO LABEL FAR	; CFA
1   501	1056  1058r			     DW	 $+2
    502	1058  58				  POP	AX  ; в	стек данных начальное значение цикла
    503	1059  83 ED 02				  SUB	BP, 2
    504	105C  8F 46 00				  POP	[BP] ; конечное	значение цикла
    505	105F  83 ED 02				  SUB	BP, 2
    506	1062  89 46 00				  MOV	WORD PTR  [BP],AX ; в стек возвратов начальное значение	цикла
    507						 ; BP-4	- начальное значение
    508						 ; BP-2	- конечное значение цикла
    509						 ; BP  до входа	в слово. RS растет в сторону с меньшими	адресами
    510						  NEXT
1   511	1065  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   512	1066  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   513					 ; ------ call debugger	--------
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 10
forth.asm



1   514	1068  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   515	106C  74 06			     jz	??0005
1   516	106E  E8 FEDB			     call printWORD
1   517	1071  E8 FDBF			     call pause
1   518	1074				 ??0005:
1   519					 ; -----------------------------
1   520	1074  FF 27			     JMP WORD PTR [BX]
    521
    522						  HEAD	  86h,'(LOOP',251Q,XLOOP	      ;	(LOOP)
1   523	      =ARRAY:1076		 LINK$=$
1   524	1076  86			     DB	 86h  ;	NFA 7 бит равен	1.
1   525							 ; 6 - признак immediate. 5- слово не описано smudge
1   526	1077  28 4C 4F 4F 50		     DB	 '(LOOP'
1   527	107C  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1   528	107D  104Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   529	      =ARRAY:1076		 LINK=LINK$
1   530	107F				 XLOOP LABEL FAR  ; CFA
1   531	107F  1081r			     DW	 $+2
    532					; Приращение индекса цикла LOOP	и может	быть  ветвление
    533	1081  FF 46 00				  INC	WORD PTR  [BP] ; начальное значение увеличиваем
    534	1084  8B 46 00			LOP:	  MOV	AX,  [BP]    ; индекс
    535	1087  3B 46 02				  CMP	AX,  [BP+2]  ; предел цикла
    536	108A  7C B0				  JL	CNT
    537	108C  83 C5 04			LV:	  ADD	BP,  4 ; удаляем параметры цикла
    538	108F  83 C6 02				  ADD	SI,  2 ; переход к следующеу слову
    539						  NEXT
1   540	1092  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   541	1093  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   542					 ; ------ call debugger	--------
1   543	1095  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   544	1099  74 06			     jz	??0006
1   545	109B  E8 FEAE			     call printWORD
1   546	109E  E8 FD92			     call pause
1   547	10A1				 ??0006:
1   548					 ; -----------------------------
1   549	10A1  FF 27			     JMP WORD PTR [BX]
    550
    551						  HEAD	  87h,'(+LOOP',251Q,XPLOO	      ;	(+LOOP)
1   552	      =ARRAY:10A3		 LINK$=$
1   553	10A3  87			     DB	 87h  ;	NFA 7 бит равен	1.
1   554							 ; 6 - признак immediate. 5- слово не описано smudge
1   555	10A4  28 2B 4C 4F 4F 50		     DB	 '(+LOOP'
1   556	10AA  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1   557	10AB  1076r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   558	      =ARRAY:10A3		 LINK=LINK$
1   559	10AD				 XPLOO LABEL FAR  ; CFA
1   560	10AD  10AFr			     DW	 $+2
    561					 ; n  ---
    562	10AF  58				  POP	AX
    563	10B0  01 46 00				  ADD	[BP],	AX
    564	10B3  3D 0000				  CMP	AX, 0
    565	10B6  7C 02				  JL	$LESS
    566	10B8  EB CA				  JMP	LOP
    567	10BA  8B 4E 00			  $LESS:  MOV	CX, [BP]   ; Работа с отрицательными приращениями
    568	10BD  39 4E 02				  CMP	[BP]+2,	CX
    569	10C0  7E CA				  JLE	LV
    570	10C2  E9 FF77				  JMP	CNT
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 11
forth.asm



    571
    572						  HEAD	  86h,'(FIND',251Q,PFIND	      ;	PFIND
1   573	      =ARRAY:10C5		 LINK$=$
1   574	10C5  86			     DB	 86h  ;	NFA 7 бит равен	1.
1   575							 ; 6 - признак immediate. 5- слово не описано smudge
1   576	10C6  28 46 49 4E 44		     DB	 '(FIND'
1   577	10CB  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1   578	10CC  10A3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   579	      =ARRAY:10C5		 LINK=LINK$
1   580	10CE				 PFIND LABEL FAR  ; CFA
1   581	10CE  10D0r			     DW	 $+2
    582					     ;	addr1 addr2 ---	pfa b tf (ok) оператор поиска
    583					; Адрес	строки	NFA => PFA длина TRUE/FALSE (!реально СFA !)
    584	10D0  58				  POP	AX	 ; NFA последнего слова	в context словаре
    585	10D1  59				  POP	CX	 ; addr1 строка	для поиска. первый байт	длина образца
    586	10D2  55				  PUSH	BP	 ; сохранение содержимого регистров
    587	10D3  56				  PUSH	SI	 ; --
    588	10D4  57				  PUSH	DI	 ; --
    589	10D5  8B F1				  MOV	SI, CX	 ; адрес образца
    590	10D7  2B ED				  SUB	BP, BP	 ;
    591	10D9  8B F8				  MOV	DI, AX	 ; NFA	последнего слова в словаре
    592	10DB  8B 14				  MOV	DX,WORD	PTR [SI] ; длина строки	поиска и первый	символ
    593	10DD  81 E2 7F7F			  AND	DX, 77577Q ; 7F7f - сброс старших битов. кажется лишним
    594	10E1  FC				  CLD			 ; DF=0	(вперед)
    595	10E2  8B 0D			FAST:	  MOV	CX,WORD	PTR [DI] ;
    596	10E4  81 E1 7F3F			  AND	CX, 77477Q ; сброс 7-ых	и 6 бита в первом байте
    597	10E8  3B D1				  CMP	DX, CX	 ; сравним длину и первый символ
    598	10EA  74 14				  JE	SLOW	 ; если	равны, может то, что ищем
    599	10EC  83 3D 00			MATCH:	  CMP	WORD PTR [DI], 0 ; ищем	конец nfa
    600	10EF  78 03				  JS	$SIG	     ; BPL
    601	10F1  47				  INC	DI	     ; следующий символ	в слове
    602	10F2  EB F8				  JMP	MATCH
    603	10F4  83 C7 02			$SIG:	  ADD	DI, 2	     ; переход к полю LFA
    604	10F7  83 3D 00				  CMP	WORD PTR [DI],0	 ; список слов закончился
    605	10FA  74 34				  JE	FAIL		 ; LFA =0, поиск не удачен
    606	10FC  8B 3D				  MOV	DI,WORD	PTR [DI] ; переход к другому слову в словаре
    607	10FE  EB E2				  JMP	FAST
    608	1100  8B 2D			SLOW:	  MOV	BP,WORD	PTR [DI] ; длина и первый символ найденого слова
    609	1102  8B DE				  MOV	BX, SI		 ; адрес образца
    610	1104  EB 0D				  JMP	SLOW1
    611	1106  43			$LOOP:	  INC	BX		 ; перебор символов
    612	1107  8B 07				  MOV	AX,WORD	PTR [BX]
    613	1109  8B 0D				  MOV	CX,WORD	PTR [DI]
    614	110B  81 E1 7FFF			  AND	CX, 77777Q   ; 7FFFh
    615	110F  3B C1				  CMP	AX, CX
    616	1111  75 D9				  JNE	MATCH	     ; не совпало, переход на начало
    617	1113  47			SLOW1:	  INC	DI
    618	1114  F7 45 FF 8000			  TEST	WORD PTR -1[DI],100000Q	; 8000h
    619	1119  74 EB				  JZ	$LOOP	     ; переход,	если 7 бит РАВЕН 0
    620	111B  8B D5				  MOV	DX, BP	     ; длина слова
    621	111D  83 C7 05				  ADD	DI, 5	     ; PFA найденого слова
    622	1120  8B C7				  MOV	AX, DI
    623	1122  5F				  POP	DI	     ; восстановление содержимого регистров
    624	1123  5E				  POP	SI
    625	1124  5D				  POP	BP
    626	1125  2D 0002				  SUB	AX, 2	     ; CFA
    627	1128  50				  PUSH	AX
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 12
forth.asm



    628	1129  81 E2 00FF			  AND	DX, 377Q	; FFh выделяем байт длины и ФЛАГОВ
    629	112D  52				  PUSH	DX		; в стек
    630	112E  EB 4B				  JMP	TRUE		; Установка флага "Найдено"
    631	1130  5F			FAIL:	  POP	DI
    632	1131  5E				  POP	SI
    633	1132  5D				  POP	BP
    634	1133  EB 32				  JMP	FALSE
    635
    636						  HEAD	  85h,'DIGI',324Q,DIGIT		      ;	DIGIT
1   637	      =ARRAY:1135		 LINK$=$
1   638	1135  85			     DB	 85h  ;	NFA 7 бит равен	1.
1   639							 ; 6 - признак immediate. 5- слово не описано smudge
1   640	1136  44 49 47 49		     DB	 'DIGI'
1   641	113A  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1   642	113B  10C5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   643	      =ARRAY:1135		 LINK=LINK$
1   644	113D				 DIGIT LABEL FAR  ; CFA
1   645	113D  113Fr			     DW	 $+2
    646					; ASCII-DIGIT BASE=>DIGIT-VALUE	TRUE (FALSE)
    647	113F  58				  POP	AX	; AX=BASE
    648	1140  59				  POP	CX
    649	1141  83 E9 30				  SUB	CX, 60Q	; VALID	DIGIT =	ASCII-60
    650	1144  7C 21				  JL	FALSE
    651	1146  83 F9 09				  CMP	CX, 9	; Если >9
    652	1149  7E 08				  JLE	M09
    653	114B  83 E9 07				  SUB	CX, 7
    654	114E  83 F9 0A				  CMP	CX, 10
    655	1151  7C 14				  JL	FALSE
    656	1153  3B C8			M09:	  CMP	CX, AX	; Если не меньше BASE, то ошибка
    657	1155  7D 10				  JGE	FALSE
    658	1157  51				  PUSH	CX	; Запись цифры в стек
    659	1158  EB 21				  JMP	TRUE	; "Успешный" выход
    660
    661					;	  **  Стандартные слова	 **
    662					;	  **  Условные операторы  **
    663
    664						  HEAD	  82h,'0',275Q,ZEQU		      ;	0=
1   665	      =ARRAY:115A		 LINK$=$
1   666	115A  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   667							 ; 6 - признак immediate. 5- слово не описано smudge
1   668	115B  30			     DB	 '0'
1   669	115C  BD			     DB	 275Q	; последний символ слова + 128 (7 бит =	1).
1   670	115D  1135r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   671	      =ARRAY:115A		 LINK=LINK$
1   672	115F				 ZEQU LABEL FAR	 ; CFA
1   673	115F  1161r			     DW	 $+2
    674	1161  58				  POP	AX
    675	1162  3D 0000				  CMP	AX,  0
    676	1165  74 14				  JE	TRUE
    677	1167  2B C0			FALSE:	  SUB	AX,  AX
    678	1169  50			PUT:	  PUSH	AX
    679						  NEXT
1   680	116A  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   681	116B  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   682					 ; ------ call debugger	--------
1   683	116D  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   684	1171  74 06			     jz	??0007
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 13
forth.asm



1   685	1173  E8 FDD6			     call printWORD
1   686	1176  E8 FCBA			     call pause
1   687	1179				 ??0007:
1   688					 ; -----------------------------
1   689	1179  FF 27			     JMP WORD PTR [BX]
    690	117B  B8 0001			TRUE:	  MOV	AX,  1
    691	117E  EB E9				  JMP	PUT
    692
    693						  HEAD	  82h,'0',276Q,ZGRET		      ;	0>
1   694	      =ARRAY:1180		 LINK$=$
1   695	1180  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   696							 ; 6 - признак immediate. 5- слово не описано smudge
1   697	1181  30			     DB	 '0'
1   698	1182  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1   699	1183  115Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   700	      =ARRAY:1180		 LINK=LINK$
1   701	1185				 ZGRET LABEL FAR  ; CFA
1   702	1185  1187r			     DW	 $+2
    703	1187  58				  POP	AX
    704	1188  3D 0000				  CMP	AX, 0
    705	118B  7F EE				  JG	TRUE
    706	118D  EB D8				  JMP	FALSE
    707
    708						  HEAD	  82h,'0',274Q,ZLESS		      ;	0<
1   709	      =ARRAY:118F		 LINK$=$
1   710	118F  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   711							 ; 6 - признак immediate. 5- слово не описано smudge
1   712	1190  30			     DB	 '0'
1   713	1191  BC			     DB	 274Q	; последний символ слова + 128 (7 бит =	1).
1   714	1192  1180r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   715	      =ARRAY:118F		 LINK=LINK$
1   716	1194				 ZLESS LABEL FAR  ; CFA
1   717	1194  1196r			     DW	 $+2
    718	1196  58				  POP	AX
    719	1197  3D 0000				  CMP	AX, 0
    720	119A  78 DF				  JS	TRUE	     ; Если минус
    721	119C  EB C9				  JMP	FALSE
    722
    723						  HEAD	  81h,,275Q,EQUAL		      ;	=
1   724	      =ARRAY:119E		 LINK$=$
1   725	119E  81			     DB	 81h  ;	NFA 7 бит равен	1.
1   726							 ; 6 - признак immediate. 5- слово не описано smudge
1   727	119F  BD			     DB	 275Q	; последний символ слова + 128 (7 бит =	1).
1   728	11A0  118Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   729	      =ARRAY:119E		 LINK=LINK$
1   730	11A2				 EQUAL LABEL FAR  ; CFA
1   731	11A2  11A4r			     DW	 $+2
    732	11A4  58				  POP	AX
    733	11A5  59				  POP	CX
    734	11A6  3B C8				  CMP	CX, AX
    735	11A8  74 D1				  JE	TRUE
    736	11AA  EB BB				  JMP	FALSE
    737
    738						  HEAD	  82h,'U',274Q,ULESS		      ;	U<
1   739	      =ARRAY:11AC		 LINK$=$
1   740	11AC  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   741							 ; 6 - признак immediate. 5- слово не описано smudge
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 14
forth.asm



1   742	11AD  55			     DB	 'U'
1   743	11AE  BC			     DB	 274Q	; последний символ слова + 128 (7 бит =	1).
1   744	11AF  119Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   745	      =ARRAY:11AC		 LINK=LINK$
1   746	11B1				 ULESS LABEL FAR  ; CFA
1   747	11B1  11B3r			     DW	 $+2
    748	11B3  58				  POP	AX
    749	11B4  59				  POP	CX
    750	11B5  3B C8				  CMP	CX, AX
    751	11B7  72 C2				  JB	TRUE	       ; для чисел без знака
    752	11B9  EB AC				  JMP	FALSE
    753
    754						  HEAD	  81h,,274Q,LESS		      ;	<
1   755	      =ARRAY:11BB		 LINK$=$
1   756	11BB  81			     DB	 81h  ;	NFA 7 бит равен	1.
1   757							 ; 6 - признак immediate. 5- слово не описано smudge
1   758	11BC  BC			     DB	 274Q	; последний символ слова + 128 (7 бит =	1).
1   759	11BD  11ACr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   760	      =ARRAY:11BB		 LINK=LINK$
1   761	11BF				 LESS LABEL FAR	 ; CFA
1   762	11BF  11C1r			     DW	 $+2
    763	11C1  58				  POP	AX
    764	11C2  59				  POP	CX
    765	11C3  3B C1				  CMP	AX, CX
    766	11C5  7F B4				  JG	TRUE
    767	11C7  EB 9E				  JMP	FALSE
    768
    769						  HEAD	  81h,,276Q,GREAT		      ;	>
1   770	      =ARRAY:11C9		 LINK$=$
1   771	11C9  81			     DB	 81h  ;	NFA 7 бит равен	1.
1   772							 ; 6 - признак immediate. 5- слово не описано smudge
1   773	11CA  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1   774	11CB  11BBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   775	      =ARRAY:11C9		 LINK=LINK$
1   776	11CD				 GREAT LABEL FAR  ; CFA
1   777	11CD  11CFr			     DW	 $+2
    778	11CF  58				  POP	AX
    779	11D0  59				  POP	CX
    780	11D1  3B C1				  CMP	AX, CX
    781	11D3  7C A6				      JL    TRUE
    782	11D5  EB 90				  JMP	FALSE
    783
    784						 HEAD	  84h,'EVE', 'N'+80h, $EVEN	      ;	EVEN
1   785	      =ARRAY:11D7		 LINK$=$
1   786	11D7  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   787							 ; 6 - признак immediate. 5- слово не описано smudge
1   788	11D8  45 56 45			     DB	 'EVE'
1   789	11DB  CE			     DB	 'N'+80h   ; последний символ слова + 128 (7 бит = 1).
1   790	11DC  11C9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   791	      =ARRAY:11D7		 LINK=LINK$
1   792	11DE				 $EVEN LABEL FAR  ; CFA
1   793	11DE  11E0r			     DW	 $+2
    794					 ; проверка на четность
    795	11E0  58				 pop ax
    796	11E1  A9 0001				 test ax, 1 ; проверяем	младший	бит
    797	11E4  74 95				 jz true ; если	бит=0, то число	четное
    798	11E6  E9 FF7E				 jmp false
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 15
forth.asm



    799
    800					;	  ******************
    801
    802						  HEAD	  84h,'ENC',314Q,ENCL		      ;	ENCLOSE
1   803	      =ARRAY:11E9		 LINK$=$
1   804	11E9  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   805							 ; 6 - признак immediate. 5- слово не описано smudge
1   806	11EA  45 4E 43			     DB	 'ENC'
1   807	11ED  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1   808	11EE  11D7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   809	      =ARRAY:11E9		 LINK=LINK$
1   810	11F0				 ENCL LABEL FAR	 ; CFA
1   811	11F0  11F2r			     DW	 $+2
    812					 ; addr1 c -- addr1 n1 n2 n3
    813	11F2  58				  POP	AX	   ; разделитель
    814	11F3  59				  POP	CX	   ; начальный адрес
    815	11F4  8B D9				  MOV	BX, CX
    816	11F6  38 07			A:	  CMP	BYTE PTR  [BX],	AL ; обход разделителей	в начале
    817	11F8  75 03				  JNE	NOTEQ
    818	11FA  43			AAA1:	  INC	BX
    819	11FB  EB F9				  JMP	A
    820	11FD  80 3F 0D			NOTEQ:	  CMP	BYTE PTR  [BX],	15Q ; обход перевода строки
    821	1200  74 F8				  JE	AAA1
    822	1202  80 3F 0A				  CMP	BYTE PTR  [BX],	12Q
    823	1205  74 F3				  JE	AAA1		     ; обход перевода строки
    824	1207  8B D3				  MOV	DX, BX		     ; начало лексемы
    825	1209  52				  PUSH	DX
    826	120A  80 3F 00			AA:	  CMP	BYTE PTR  [BX],	 0
    827	120D  74 21				  JE	ZZZ		     ; если нуль
    828	120F  38 07				  CMP	BYTE PTR  [BX],	AL   ; не нуль,	ищем конец лексемы
    829	1211  74 03				  JE	EQW
    830	1213  43				  INC	BX
    831	1214  EB F4				  JMP	AA
    832	1216  8B C3			EQW:	  MOV	AX, BX
    833	1218  2B DA				  SUB	BX, DX
    834	121A  53				  PUSH	BX
    835	121B  2B C1				  SUB	AX, CX
    836	121D  40				  INC	AX
    837	121E  50				  PUSH	AX
    838						  NEXT		     ; выход из	слова
1   839	121F  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   840	1220  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   841					 ; ------ call debugger	--------
1   842	1222  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   843	1226  74 06			     jz	??0008
1   844	1228  E8 FD21			     call printWORD
1   845	122B  E8 FC05			     call pause
1   846	122E				 ??0008:
1   847					 ; -----------------------------
1   848	122E  FF 27			     JMP WORD PTR [BX]
    849
    850	1230  3B DA			ZZZ:	  CMP	BX, DX
    851	1232  75 E2				  JNE	EQW
    852	1234  43				  INC	BX
    853	1235  EB DF				  JMP	EQW
    854
    855					 ;	   ** Дисплей **
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 16
forth.asm



    856
    857						  HEAD	  84h,'PAG',305Q,$PAGE		      ;	PAGE
1   858	      =ARRAY:1237		 LINK$=$
1   859	1237  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   860							 ; 6 - признак immediate. 5- слово не описано smudge
1   861	1238  50 41 47			     DB	 'PAG'
1   862	123B  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1   863	123C  11E9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   864	      =ARRAY:1237		 LINK=LINK$
1   865	123E				 $PAGE LABEL FAR  ; CFA
1   866	123E  1240r			     DW	 $+2
    867					 ; Установка активной страницы ( PAGE --)
    868	1240  58				  POP	AX
    869					 ; вход:  AL = номер страницы (большинство программ использует страницу	0)
    870	1241  B4 05				  MOV	AH, 5
    871	1243  CD 10				  INT	10h
    872						  NEXT
1   873	1245  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   874	1246  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   875					 ; ------ call debugger	--------
1   876	1248  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   877	124C  74 06			     jz	??0009
1   878	124E  E8 FCFB			     call printWORD
1   879	1251  E8 FBDF			     call pause
1   880	1254				 ??0009:
1   881					 ; -----------------------------
1   882	1254  FF 27			     JMP WORD PTR [BX]
    883
    884						  HEAD	  83h,'PI',330Q,PIX		      ;	PIX
1   885	      =ARRAY:1256		 LINK$=$
1   886	1256  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   887							 ; 6 - признак immediate. 5- слово не описано smudge
1   888	1257  50 49			     DB	 'PI'
1   889	1259  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1   890	125A  1237r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   891	      =ARRAY:1256		 LINK=LINK$
1   892	125C				 PIX LABEL FAR	; CFA
1   893	125C  125Er			     DW	 $+2
    894					 ; COLCOD ROW COLUMN -->  -    запись графической точки
    895	125E  59				  POP	CX		    ; колонка
    896	125F  5B				  POP	BX		    ; строка
    897	1260  58				  POP	AX		    ; код цветности
    898	1261  52				  PUSH	DX		    ; сохранение DX
    899	1262  8B D3				  MOV	DX, BX		    ; BH = номер видео страницы	??? где
    900	1264  2A F6				  SUB	DH, DH
    901	1266  50				  push	 ax
    902	1267  B4 0F				  MOV	AH, 0Fh		    ; Чтение текущей страницы
    903	1269  CD 10				  INT	10h		    ; в	BH
    904	126B  58				  pop	 ax		    ; код цветности
    905	126C  B4 0C				  MOV	AH, 0Ch		    ;
    906	126E  CD 10				  INT	10h		    ; запись графической точки
    907	1270  5A				  POP	DX		    ; восстановление DX
    908						  NEXT
1   909	1271  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   910	1272  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   911					 ; ------ call debugger	--------
1   912	1274  80 7D 42 00		     cmp byte ptr [di+102Q], 0
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 17
forth.asm



1   913	1278  74 06			     jz	??000A
1   914	127A  E8 FCCF			     call printWORD
1   915	127D  E8 FBB3			     call pause
1   916	1280				 ??000A:
1   917					 ; -----------------------------
1   918	1280  FF 27			     JMP WORD PTR [BX]
    919
    920						  HEAD	  84h,'MOD','A'+80h,MODA		 ; MODA
1   921	      =ARRAY:1282		 LINK$=$
1   922	1282  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   923							 ; 6 - признак immediate. 5- слово не описано smudge
1   924	1283  4D 4F 44			     DB	 'MOD'
1   925	1286  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1   926	1287  1256r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   927	      =ARRAY:1282		 LINK=LINK$
1   928	1289				 MODA LABEL FAR	 ; CFA
1   929	1289  128Br			     DW	 $+2
    930					 ; установка режима. ( М --> - )
    931	128B  58				  POP	AX
    932	128C  2A E4				  SUB	AH, AH	     ; 00H уст.	видео режим. Очистить экран
    933								     ;	установить поля	BIOS, установить режим.
    934	128E  CD 10				  INT	 10h
    935						  NEXT
1   936	1290  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   937	1291  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   938					 ; ------ call debugger	--------
1   939	1293  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   940	1297  74 06			     jz	??000B
1   941	1299  E8 FCB0			     call printWORD
1   942	129C  E8 FB94			     call pause
1   943	129F				 ??000B:
1   944					 ; -----------------------------
1   945	129F  FF 27			     JMP WORD PTR [BX]
    946
    947						  HEAD	  83h,'EM',311Q,EMI$		      ;	EMI
1   948	      =ARRAY:12A1		 LINK$=$
1   949	12A1  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   950							 ; 6 - признак immediate. 5- слово не описано smudge
1   951	12A2  45 4D			     DB	 'EM'
1   952	12A4  C9			     DB	 311Q	; последний символ слова + 128 (7 бит =	1).
1   953	12A5  1282r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   954	      =ARRAY:12A1		 LINK=LINK$
1   955	12A7				 EMI$ LABEL FAR	 ; CFA
1   956	12A7  12A9r			     DW	 $+2
    957	12A9  59				  POP	CX		; Число	символов
    958	12AA  58				  POP	AX		; Символ
    959	12AB  51				  PUSH	CX		; Сохранение содержимого CX
    960	12AC  50				  PUSH	AX		; Сохранение содержимого AХ
    961	12AD  8B 5D 1A				  MOV	BX, [DI+32Q]	; Установка атрибута
    962	12B0  B4 0F				  MOV	AH, 0Fh		; Чтение текущей страницы
    963	12B2  CD 10				  INT	10h		; в BH
    964	12B4  58				  POP	AX		; Восстановление содержимого AX
    965	12B5  B4 09				  MOV	AH, 9		; Запись строки	символов
    966	12B7  CD 10				  INT	10h
    967	12B9  B4 03				  MOV	AH, 3		; Чтение положения курсора
    968	12BB  CD 10				  INT	10h
    969	12BD  59				  POP	CX
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 18
forth.asm



    970	12BE  02 D1				  ADD	DL, CL		; DH,DL	= строка, колонка (считая от 0)
    971	12C0  B4 02				  MOV	AH, 2		; Установка положения курсора
    972	12C2  CD 10			$EM:	  INT	10h
    973	12C4  83 7D 22 00			  CMP	WORD PTR [DI+42Q], 0  ;	сброс флага печати
    974	12C8  75 25				  JNE	PRINT
    975	12CA				OK:	  NEXT
1   976	12CA  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   977	12CB  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   978					 ; ------ call debugger	--------
1   979	12CD  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   980	12D1  74 06			     jz	??000C
1   981	12D3  E8 FC76			     call printWORD
1   982	12D6  E8 FB5A			     call pause
1   983	12D9				 ??000C:
1   984					 ; -----------------------------
1   985	12D9  FF 27			     JMP WORD PTR [BX]
    986
    987						  HEAD	  84h,'EMI',324Q,EMIT,$EMIT	      ;	EMIT
1   988	      =ARRAY:12DB		 LINK$=$
1   989	12DB  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   990							 ; 6 - признак immediate. 5- слово не описано smudge
1   991	12DC  45 4D 49			     DB	 'EMI'
1   992	12DF  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1   993	12E0  12A1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   994	      =ARRAY:12DB		 LINK=LINK$
1   995	12E2				 EMIT LABEL FAR	 ; CFA
1   996	12E2  12E4r			     DW	$EMIT
    997					 ; вывод текста	без атрибутов (по умолчанию)
    998	12E4				$EMIT	  LABEL	  FAR
    999	12E4  58				  POP	AX
   1000	12E5  50			ENT$:	  PUSH	AX
   1001	12E6  B4 0F				  MOV	AH, 15	     ; Чтение текущей страницы
   1002	12E8  CD 10				  INT	10h
   1003	12EA  58				  POP	AX
   1004	12EB  B4 0E				  MOV	AH, 14	     ;
   1005	12ED  EB D3				  JMP	$EM
   1006
   1007	12EF  BA 0000			PRINT:	  MOV	DX, 0	; Установка номера принтера
   1008	12F2  2A E4				  SUB	AH, AH
   1009	12F4  CD 17				  INT	17h
   1010	12F6  F6 C4 29				  TEST	 AH, 29h
   1011	12F9  74 CF				  JE	OK
   1012	12FB  8A C4			ERR4:	  MOV	AL, AH
   1013	12FD  04 30				  ADD	AL, 60Q
   1014	12FF  B4 0E				  MOV	AH, 14
   1015	1301  CD 10				  INT	10h
   1016	1303  BA 130Cr				  MOV	DX, OFFSET ERMES4
   1017	1306  B4 09				  MOV	AH, 9H
   1018	1308  CD 21				  INT	21H
   1019	130A  EB 59				  JMP	TYPE$
   1020	130C  20 50 52 49 4E 54	45+	ERMES4	  DB   " PRINTER ERROR $" ;
   1021	      52 20 45 52 52 4F	52+
   1022	      20 24
   1023
   1024						  HEAD	  82h,'R',303Q,RC		      ;	RC
1  1025	      =ARRAY:131C		 LINK$=$
1  1026	131C  82			     DB	 82h  ;	NFA 7 бит равен	1.
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 19
forth.asm



1  1027							 ; 6 - признак immediate. 5- слово не описано smudge
1  1028	131D  52			     DB	 'R'
1  1029	131E  C3			     DB	 303Q	; последний символ слова + 128 (7 бит =	1).
1  1030	131F  12DBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1031	      =ARRAY:131C		 LINK=LINK$
1  1032	1321				 RC LABEL FAR  ; CFA
1  1033	1321  1323r			     DW	 $+2
   1034	1323  B8 000D				  MOV	AX, 13
   1035	1326  EB BD				  JMP	ENT$
   1036
   1037						  HEAD	  82h,'I',314Q,IL		      ;	BELL
1  1038	      =ARRAY:1328		 LINK$=$
1  1039	1328  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1040							 ; 6 - признак immediate. 5- слово не описано smudge
1  1041	1329  49			     DB	 'I'
1  1042	132A  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  1043	132B  131Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1044	      =ARRAY:1328		 LINK=LINK$
1  1045	132D				 IL LABEL FAR  ; CFA
1  1046	132D  132Fr			     DW	 $+2
   1047	132F  B8 0007				  MOV	AX, 7
   1048	1332  EB B1				  JMP	ENT$
   1049
   1050						  HEAD	  84h,'PRI',316Q,PRIN		  ; PRINT-FLAG
1  1051	      =ARRAY:1334		 LINK$=$
1  1052	1334  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1053							 ; 6 - признак immediate. 5- слово не описано smudge
1  1054	1335  50 52 49			     DB	 'PRI'
1  1055	1338  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  1056	1339  1328r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1057	      =ARRAY:1334		 LINK=LINK$
1  1058	133B				 PRIN LABEL FAR	 ; CFA
1  1059	133B  133Dr			     DW	 $+2
   1060	133D  FF 45 22				  INC	WORD PTR  [DI+42Q]
   1061	1340  BA 0000				  MOV	DX,  0	     ; Установка номера	принтера
   1062	1343  B4 01				  MOV	AH,  1	     ; Инициализация принтера
   1063	1345  CD 17				  INT	17H
   1064	1347  F6 C4 29				  TEST	AH,  29h
   1065	134A  75 AF				  JNE	ERR4
   1066						  NEXT
1  1067	134C  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1068	134D  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1069					 ; ------ call debugger	--------
1  1070	134F  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1071	1353  74 06			     jz	??000D
1  1072	1355  E8 FBF4			     call printWORD
1  1073	1358  E8 FAD8			     call pause
1  1074	135B				 ??000D:
1  1075					 ; -----------------------------
1  1076	135B  FF 27			     JMP WORD PTR [BX]
   1077
   1078						  HEAD	  83h,'TT',331Q,TTY		 ; TERMI-FLAG
1  1079	      =ARRAY:135D		 LINK$=$
1  1080	135D  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1081							 ; 6 - признак immediate. 5- слово не описано smudge
1  1082	135E  54 54			     DB	 'TT'
1  1083	1360  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 20
forth.asm



1  1084	1361  1334r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1085	      =ARRAY:135D		 LINK=LINK$
1  1086	1363				 TTY LABEL FAR	; CFA
1  1087	1363  1365r			     DW	 $+2
   1088	1365  C7 45 22 0000		TYPE$:	  MOV	WORD PTR [DI+42Q],0
   1089						  NEXT
1  1090	136A  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1091	136B  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1092					 ; ------ call debugger	--------
1  1093	136D  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1094	1371  74 06			     jz	??000E
1  1095	1373  E8 FBD6			     call printWORD
1  1096	1376  E8 FABA			     call pause
1  1097	1379				 ??000E:
1  1098					 ; -----------------------------
1  1099	1379  FF 27			     JMP WORD PTR [BX]
   1100
   1101						  HEAD	  83h,'SC',314Q,SCL		      ;	SCL
1  1102	      =ARRAY:137B		 LINK$=$
1  1103	137B  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1104							 ; 6 - признак immediate. 5- слово не описано smudge
1  1105	137C  53 43			     DB	 'SC'
1  1106	137E  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  1107	137F  135Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1108	      =ARRAY:137B		 LINK=LINK$
1  1109	1381				 SCL LABEL FAR	; CFA
1  1110	1381  1383r			     DW	 $+2
   1111					; SCREEN CLEAR
   1112	1383  B9 0800				  MOV	CX, 2048     ; Загрузка	счетчика
   1113	1386  B4 0F				  MOV	AH, 15
   1114	1388  CD 10				  INT	10h	      ;	Установка текущей страницы
   1115	138A  2B D2				  SUB	DX, DX	     ;	DH,DL =	строка,	колонка	(считая	от 0)
   1116	138C  B4 02				  MOV	AH, 2	     ; Курсор в	исходное положение
   1117	138E  CD 10				  INT	10h
   1118	1390  B3 07				  MOV	BL, 7	     ; атрибут
   1119					 ; 09H писать символ/атрибут в текущей позиции курсора
   1120	1392  B8 0920			CLEAR:	  MOV	AX, 0920H    ; Очистка экрана AL = записываемый	символ
   1121	1395  CD 10				  INT	10h
   1122						  NEXT
1  1123	1397  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1124	1398  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1125					 ; ------ call debugger	--------
1  1126	139A  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1127	139E  74 06			     jz	??000F
1  1128	13A0  E8 FBA9			     call printWORD
1  1129	13A3  E8 FA8D			     call pause
1  1130	13A6				 ??000F:
1  1131					 ; -----------------------------
1  1132	13A6  FF 27			     JMP WORD PTR [BX]
   1133
   1134						  HEAD	  83h,'FI',330Q,FIX		      ;	FIX
1  1135	      =ARRAY:13A8		 LINK$=$
1  1136	13A8  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1137							 ; 6 - признак immediate. 5- слово не описано smudge
1  1138	13A9  46 49			     DB	 'FI'
1  1139	13AB  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  1140	13AC  137Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 21
forth.asm



1  1141	      =ARRAY:13A8		 LINK=LINK$
1  1142	13AE				 FIX LABEL FAR	; CFA
1  1143	13AE  13B0r			     DW	 $+2
   1144					; Позиционирование курсора: COL	ROW FIX
   1145	13B0  B4 0F				  MOV	AH, 0Fh
   1146	13B2  CD 10				  INT	10h	 ; Запись текущего номера страницы в BX
   1147	13B4  5A				  POP	DX
   1148	13B5  8A F2				  MOV	DH, DL	 ; строка
   1149	13B7  58				  POP	AX
   1150
   1151	13B8  8A D0				  MOV	DL, AL	 ; столбец
   1152	13BA  B4 02				  MOV	AH, 2	 ; уст.	позицию	курсора. установка
   1153								 ; на строку 25	делает курсор невидимым.
   1154	13BC  CD 10				  INT	10h	 ; Фиксация положения курсора
   1155						  NEXT
1  1156	13BE  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1157	13BF  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1158					 ; ------ call debugger	--------
1  1159	13C1  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1160	13C5  74 06			     jz	??0010
1  1161	13C7  E8 FB82			     call printWORD
1  1162	13CA  E8 FA66			     call pause
1  1163	13CD				 ??0010:
1  1164					 ; -----------------------------
1  1165	13CD  FF 27			     JMP WORD PTR [BX]
   1166
   1167						  HEAD	  84h,'DSP',314Q,DSPL		      ;	DSPL
1  1168	      =ARRAY:13CF		 LINK$=$
1  1169	13CF  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1170							 ; 6 - признак immediate. 5- слово не описано smudge
1  1171	13D0  44 53 50			     DB	 'DSP'
1  1172	13D3  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  1173	13D4  13A8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1174	      =ARRAY:13CF		 LINK=LINK$
1  1175	13D6				 DSPL LABEL FAR	 ; CFA
1  1176	13D6  13D8r			     DW	 $+2
   1177					; LOAD GRAFBUFFER (b adr DSPL)
   1178					 ; записывает байт в графическую память
   1179	13D8  5B				  POP	BX  ; адрес
   1180	13D9  58				  POP	AX  ; байт
   1181	13DA  06				  PUSH	ES  ; сохранение регистра сегмента
   1182	13DB  B9 B000				  MOV	CX, 0B000H ; GRAFBUF
   1183	13DE  8E C1				  MOV	ES, CX
   1184	13E0  26: 88 07				  MOV	BYTE PTR ES:[BX], AL
   1185	13E3  07				  POP	ES
   1186						  NEXT
1  1187	13E4  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1188	13E5  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1189					 ; ------ call debugger	--------
1  1190	13E7  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1191	13EB  74 06			     jz	??0011
1  1192	13ED  E8 FB5C			     call printWORD
1  1193	13F0  E8 FA40			     call pause
1  1194	13F3				 ??0011:
1  1195					 ; -----------------------------
1  1196	13F3  FF 27			     JMP WORD PTR [BX]
   1197
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 22
forth.asm



   1198					;	  ** Терминал **
   1199
   1200						  HEAD	  83h,'KE',331Q,KEY		      ;	KEY
1  1201	      =ARRAY:13F5		 LINK$=$
1  1202	13F5  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1203							 ; 6 - признак immediate. 5- слово не описано smudge
1  1204	13F6  4B 45			     DB	 'KE'
1  1205	13F8  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  1206	13F9  13CFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1207	      =ARRAY:13F5		 LINK=LINK$
1  1208	13FB				 KEY LABEL FAR	; CFA
1  1209	13FB  13FDr			     DW	 $+2
   1210					     ; читать (ожидать)	следующую нажатую клавишу
   1211					     ; выход: AL = ASCII символ	(если AL=0, AH содержит	расширенный код	ASCII )
   1212					     ; AH = сканкод  или расширенный код ASCII
   1213	13FD  2A E4				  SUB	AH, AH
   1214	13FF  CD 16				  INT	16h
   1215	1401  2A E4				  SUB	AH, AH
   1216	1403  50				  PUSH	AX
   1217						  NEXT
1  1218	1404  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1219	1405  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1220					 ; ------ call debugger	--------
1  1221	1407  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1222	140B  74 06			     jz	??0012
1  1223	140D  E8 FB3C			     call printWORD
1  1224	1410  E8 FA20			     call pause
1  1225	1413				 ??0012:
1  1226					 ; -----------------------------
1  1227	1413  FF 27			     JMP WORD PTR [BX]
   1228
   1229						  HEAD	  86h,'EXPEC',324Q,EXPE		      ;	EXPECT
1  1230	      =ARRAY:1415		 LINK$=$
1  1231	1415  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  1232							 ; 6 - признак immediate. 5- слово не описано smudge
1  1233	1416  45 58 50 45 43		     DB	 'EXPEC'
1  1234	141B  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  1235	141C  13F5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1236	      =ARRAY:1415		 LINK=LINK$
1  1237	141E				 EXPE LABEL FAR	 ; CFA
1  1238	141E  1420r			     DW	 $+2
   1239					     ; adr count ->
   1240	1420  B4 0A				  MOV	AH, 0AH		     ;	ввод строки в буфер
   1241	1422  59				  POP	CX		     ; Число символов
   1242	1423  5B				  POP	BX		     ; Адрес буфера SS
   1243	1424  88 0F				  MOV	BYTE PTR [BX],	CL   ; Засылка ожидаемого числа
   1244	1426  8B D3				  MOV	DX, BX
   1245	1428  CD 21				  INT	21h
   1246
   1247	142A  8A 47 01				  MOV	AL, BYTE PTR [BX+1]  ; фактически введено символов
   1248	142D  2A E4				  SUB	AH, AH		     ;
   1249	142F  03 D8				  ADD	BX, AX		     ; адрес конца строки
   1250	1431  C7 47 02 0000			  MOV	WORD PTR [BX+2],0    ; +2, т.к.	в начале строки	мах длина
   1251									     ; и число введенных символов
   1252						  NEXT
1  1253	1436  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1254	1437  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 23
forth.asm



1  1255					 ; ------ call debugger	--------
1  1256	1439  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1257	143D  74 06			     jz	??0013
1  1258	143F  E8 FB0A			     call printWORD
1  1259	1442  E8 F9EE			     call pause
1  1260	1445				 ??0013:
1  1261					 ; -----------------------------
1  1262	1445  FF 27			     JMP WORD PTR [BX]
   1263
   1264						  HEAD	  85h,'?TER',244Q,?TER$		      ;	?TER$
1  1265	      =ARRAY:1447		 LINK$=$
1  1266	1447  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  1267							 ; 6 - признак immediate. 5- слово не описано smudge
1  1268	1448  3F 54 45 52		     DB	 '?TER'
1  1269	144C  A4			     DB	 244Q	; последний символ слова + 128 (7 бит =	1).
1  1270	144D  1415r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1271	      =ARRAY:1447		 LINK=LINK$
1  1272	144F				 ?TER$ LABEL FAR  ; CFA
1  1273	144F  1451r			     DW	 $+2
   1274	1451  06				  PUSH	ES
   1275	1452  2B C9				  SUB	CX, CX
   1276	1454  8E C1				  MOV	ES, CX
   1277	1456  26: 80 0E	0417 20			  OR	BYTE PTR ES:[417H],  40Q
   1278	145C  B4 01			TER:	  MOV	AH, 1	 ; проверить готовность	символа	(и показать его, если так)
   1279								 ; выход: ZF = 1 если символ не	готов.
   1280								 ; ZF =	0 если символ готов.
   1281								 ; AX =	как для	подфункции 00H (но символ здесь	не
   1282								 ; удаляется из	очереди).
   1283	145E  CD 16				  INT	16h
   1284	1460  74 FA				  JZ	TER
   1285	1462  2A E4				  SUB	AH, AH	 ; читать (ожидать) следующую нажатую клавишу
   1286	1464  CD 16				  INT	16h
   1287	1466  26: 80 26	0417 DF			  AND	BYTE PTR ES:[417H],337Q	 ; Сброс 'NUM LOCK'
   1288	146C  07				  POP	ES		; Восстановление ES
   1289	146D  50				  PUSH	AX		; Запись символа
   1290						  NEXT
1  1291	146E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1292	146F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1293					 ; ------ call debugger	--------
1  1294	1471  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1295	1475  74 06			     jz	??0014
1  1296	1477  E8 FAD2			     call printWORD
1  1297	147A  E8 F9B6			     call pause
1  1298	147D				 ??0014:
1  1299					 ; -----------------------------
1  1300	147D  FF 27			     JMP WORD PTR [BX]
   1301
   1302					; ** Ввод/Вывод	**
   1303
   1304						  HEAD	  84h,'POR',324Q,PORT		      ;	PORT
1  1305	      =ARRAY:147F		 LINK$=$
1  1306	147F  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1307							 ; 6 - признак immediate. 5- слово не описано smudge
1  1308	1480  50 4F 52			     DB	 'POR'
1  1309	1483  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  1310	1484  1447r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1311	      =ARRAY:147F		 LINK=LINK$
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 24
forth.asm



1  1312	1486				 PORT LABEL FAR	 ; CFA
1  1313	1486  1488r			     DW	 $+2
   1314	1488  5A				  POP	DX
   1315	1489  58				  POP	AX
   1316	148A  EE				  OUT	DX, AL
   1317						  NEXT
1  1318	148B  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1319	148C  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1320					 ; ------ call debugger	--------
1  1321	148E  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1322	1492  74 06			     jz	??0015
1  1323	1494  E8 FAB5			     call printWORD
1  1324	1497  E8 F999			     call pause
1  1325	149A				 ??0015:
1  1326					 ; -----------------------------
1  1327	149A  FF 27			     JMP WORD PTR [BX]
   1328
   1329						  HEAD	  84h,'REA',304Q,READ		      ;	READ
1  1330	      =ARRAY:149C		 LINK$=$
1  1331	149C  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1332							 ; 6 - признак immediate. 5- слово не описано smudge
1  1333	149D  52 45 41			     DB	 'REA'
1  1334	14A0  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  1335	14A1  147Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1336	      =ARRAY:149C		 LINK=LINK$
1  1337	14A3				 READ LABEL FAR	 ; CFA
1  1338	14A3  14A5r			     DW	 $+2
   1339	14A5  5A				  POP	DX
   1340	14A6  EC				  IN	AL, DX
   1341	14A7  2A E4				  SUB	AH, AH
   1342	14A9  50				  PUSH	AX
   1343						  NEXT
1  1344	14AA  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1345	14AB  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1346					 ; ------ call debugger	--------
1  1347	14AD  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1348	14B1  74 06			     jz	??0016
1  1349	14B3  E8 FA96			     call printWORD
1  1350	14B6  E8 F97A			     call pause
1  1351	14B9				 ??0016:
1  1352					 ; -----------------------------
1  1353	14B9  FF 27			     JMP WORD PTR [BX]
   1354
   1355					;	  ** Арифметика	**
   1356
   1357						  HEAD	  82h,'1',253Q,ONEP		      ;	1+
1  1358	      =ARRAY:14BB		 LINK$=$
1  1359	14BB  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1360							 ; 6 - признак immediate. 5- слово не описано smudge
1  1361	14BC  31			     DB	 '1'
1  1362	14BD  AB			     DB	 253Q	; последний символ слова + 128 (7 бит =	1).
1  1363	14BE  149Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1364	      =ARRAY:14BB		 LINK=LINK$
1  1365	14C0				 ONEP LABEL FAR	 ; CFA
1  1366	14C0  14C2r			     DW	 $+2
   1367	14C2  58				  POP	AX
   1368	14C3  40				  INC	AX
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 25
forth.asm



   1369	14C4  50				  PUSH	AX
   1370						  NEXT
1  1371	14C5  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1372	14C6  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1373					 ; ------ call debugger	--------
1  1374	14C8  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1375	14CC  74 06			     jz	??0017
1  1376	14CE  E8 FA7B			     call printWORD
1  1377	14D1  E8 F95F			     call pause
1  1378	14D4				 ??0017:
1  1379					 ; -----------------------------
1  1380	14D4  FF 27			     JMP WORD PTR [BX]
   1381
   1382						  HEAD	  82h,'2',253Q,TWOP		      ;	2+
1  1383	      =ARRAY:14D6		 LINK$=$
1  1384	14D6  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1385							 ; 6 - признак immediate. 5- слово не описано smudge
1  1386	14D7  32			     DB	 '2'
1  1387	14D8  AB			     DB	 253Q	; последний символ слова + 128 (7 бит =	1).
1  1388	14D9  14BBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1389	      =ARRAY:14D6		 LINK=LINK$
1  1390	14DB				 TWOP LABEL FAR	 ; CFA
1  1391	14DB  14DDr			     DW	 $+2
   1392	14DD  58				  POP	AX
   1393	14DE  05 0002				  ADD	AX, 2
   1394	14E1  50				  PUSH	AX
   1395						  NEXT
1  1396	14E2  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1397	14E3  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1398					 ; ------ call debugger	--------
1  1399	14E5  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1400	14E9  74 06			     jz	??0018
1  1401	14EB  E8 FA5E			     call printWORD
1  1402	14EE  E8 F942			     call pause
1  1403	14F1				 ??0018:
1  1404					 ; -----------------------------
1  1405	14F1  FF 27			     JMP WORD PTR [BX]
   1406
   1407						  HEAD	  82h,'1',255Q,ONEM		      ;	1-
1  1408	      =ARRAY:14F3		 LINK$=$
1  1409	14F3  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1410							 ; 6 - признак immediate. 5- слово не описано smudge
1  1411	14F4  31			     DB	 '1'
1  1412	14F5  AD			     DB	 255Q	; последний символ слова + 128 (7 бит =	1).
1  1413	14F6  14D6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1414	      =ARRAY:14F3		 LINK=LINK$
1  1415	14F8				 ONEM LABEL FAR	 ; CFA
1  1416	14F8  14FAr			     DW	 $+2
   1417	14FA  58				  POP	AX
   1418	14FB  48				  DEC	AX
   1419	14FC  50				  PUSH	AX
   1420						  NEXT
1  1421	14FD  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1422	14FE  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1423					 ; ------ call debugger	--------
1  1424	1500  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1425	1504  74 06			     jz	??0019
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 26
forth.asm



1  1426	1506  E8 FA43			     call printWORD
1  1427	1509  E8 F927			     call pause
1  1428	150C				 ??0019:
1  1429					 ; -----------------------------
1  1430	150C  FF 27			     JMP WORD PTR [BX]
   1431
   1432						  HEAD	  82h,'2',252Q,MUL2		      ;	2*
1  1433	      =ARRAY:150E		 LINK$=$
1  1434	150E  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1435							 ; 6 - признак immediate. 5- слово не описано smudge
1  1436	150F  32			     DB	 '2'
1  1437	1510  AA			     DB	 252Q	; последний символ слова + 128 (7 бит =	1).
1  1438	1511  14F3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1439	      =ARRAY:150E		 LINK=LINK$
1  1440	1513				 MUL2 LABEL FAR	 ; CFA
1  1441	1513  1515r			     DW	 $+2
   1442	1515  58				  POP	AX
   1443	1516  D1 E0				  SAL	AX,  1
   1444	1518  50				  PUSH	AX
   1445						  NEXT
1  1446	1519  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1447	151A  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1448					 ; ------ call debugger	--------
1  1449	151C  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1450	1520  74 06			     jz	??001A
1  1451	1522  E8 FA27			     call printWORD
1  1452	1525  E8 F90B			     call pause
1  1453	1528				 ??001A:
1  1454					 ; -----------------------------
1  1455	1528  FF 27			     JMP WORD PTR [BX]
   1456
   1457						  HEAD	  82h,'2',257Q,DIV2		      ;	2/
1  1458	      =ARRAY:152A		 LINK$=$
1  1459	152A  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1460							 ; 6 - признак immediate. 5- слово не описано smudge
1  1461	152B  32			     DB	 '2'
1  1462	152C  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  1463	152D  150Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1464	      =ARRAY:152A		 LINK=LINK$
1  1465	152F				 DIV2 LABEL FAR	 ; CFA
1  1466	152F  1531r			     DW	 $+2
   1467	1531  58				  POP	AX
   1468	1532  D1 F8				  SAR	AX, 1
   1469	1534  50				  PUSH	AX
   1470						  NEXT
1  1471	1535  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1472	1536  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1473					 ; ------ call debugger	--------
1  1474	1538  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1475	153C  74 06			     jz	??001B
1  1476	153E  E8 FA0B			     call printWORD
1  1477	1541  E8 F8EF			     call pause
1  1478	1544				 ??001B:
1  1479					 ; -----------------------------
1  1480	1544  FF 27			     JMP WORD PTR [BX]
   1481
   1482						  HEAD	  82h, 'U', 252Q,USTAR		      ;	U*
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 27
forth.asm



1  1483	      =ARRAY:1546		 LINK$=$
1  1484	1546  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1485							 ; 6 - признак immediate. 5- слово не описано smudge
1  1486	1547  55			     DB	 'U'
1  1487	1548  AA			     DB	 252Q	; последний символ слова + 128 (7 бит =	1).
1  1488	1549  152Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1489	      =ARRAY:1546		 LINK=LINK$
1  1490	154B				 USTAR LABEL FAR  ; CFA
1  1491	154B  154Dr			     DW	 $+2
   1492					 ; u1  u2  ---	ud
   1493	154D  58				  POP	AX
   1494	154E  59				  POP	CX
   1495	154F  F7 E1				  MUL	CX
   1496	1551  50				  PUSH	AX
   1497	1552  52				  PUSH	DX
   1498						  NEXT
1  1499	1553  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1500	1554  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1501					 ; ------ call debugger	--------
1  1502	1556  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1503	155A  74 06			     jz	??001C
1  1504	155C  E8 F9ED			     call printWORD
1  1505	155F  E8 F8D1			     call pause
1  1506	1562				 ??001C:
1  1507					 ; -----------------------------
1  1508	1562  FF 27			     JMP WORD PTR [BX]
   1509
   1510						  HEAD	  82h,'U',257Q,USLAS		      ;	U/
1  1511	      =ARRAY:1564		 LINK$=$
1  1512	1564  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1513							 ; 6 - признак immediate. 5- слово не описано smudge
1  1514	1565  55			     DB	 'U'
1  1515	1566  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  1516	1567  1546r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1517	      =ARRAY:1564		 LINK=LINK$
1  1518	1569				 USLAS LABEL FAR  ; CFA
1  1519	1569  156Br			     DW	 $+2
   1520					 ; ud u1 --- u2	u3
   1521	156B  59				  POP	CX	    ; Делитель
   1522	156C  5A				  POP	DX
   1523	156D  58				  POP	AX
   1524	156E  F7 F1				  DIV	CX
   1525	1570  52				  PUSH	DX	    ; Остаток
   1526	1571  50				  PUSH	AX	    ; Засылка  результата
   1527						  NEXT
1  1528	1572  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1529	1573  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1530					 ; ------ call debugger	--------
1  1531	1575  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1532	1579  74 06			     jz	??001D
1  1533	157B  E8 F9CE			     call printWORD
1  1534	157E  E8 F8B2			     call pause
1  1535	1581				 ??001D:
1  1536					 ; -----------------------------
1  1537	1581  FF 27			     JMP WORD PTR [BX]
   1538
   1539						  HEAD	  82h,'M',252Q,MSTAR		      ;	M*
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 28
forth.asm



1  1540	      =ARRAY:1583		 LINK$=$
1  1541	1583  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1542							 ; 6 - признак immediate. 5- слово не описано smudge
1  1543	1584  4D			     DB	 'M'
1  1544	1585  AA			     DB	 252Q	; последний символ слова + 128 (7 бит =	1).
1  1545	1586  1564r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1546	      =ARRAY:1583		 LINK=LINK$
1  1547	1588				 MSTAR LABEL FAR  ; CFA
1  1548	1588  158Ar			     DW	 $+2
   1549	158A  58				  POP	AX
   1550	158B  59				  POP	CX
   1551	158C  F7 E9				  IMUL	CX
   1552	158E  50				  PUSH	AX
   1553	158F  52				  PUSH	DX
   1554						  NEXT
1  1555	1590  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1556	1591  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1557					 ; ------ call debugger	--------
1  1558	1593  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1559	1597  74 06			     jz	??001E
1  1560	1599  E8 F9B0			     call printWORD
1  1561	159C  E8 F894			     call pause
1  1562	159F				 ??001E:
1  1563					 ; -----------------------------
1  1564	159F  FF 27			     JMP WORD PTR [BX]
   1565
   1566						  HEAD	   86h,'DMINU',323Q,DMINU	      ;	DMINUS
1  1567	      =ARRAY:15A1		 LINK$=$
1  1568	15A1  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  1569							 ; 6 - признак immediate. 5- слово не описано smudge
1  1570	15A2  44 4D 49 4E 55		     DB	 'DMINU'
1  1571	15A7  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  1572	15A8  1583r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1573	      =ARRAY:15A1		 LINK=LINK$
1  1574	15AA				 DMINU LABEL FAR  ; CFA
1  1575	15AA  15ACr			     DW	 $+2
   1576					; Изменение знака числа	двойной	длины
   1577	15AC  58				  POP  AX
   1578	15AD  F7 D8			DMIN:	  NEG  AX
   1579	15AF  59				  POP  CX
   1580	15B0  F7 D9				  NEG  CX
   1581	15B2  1D 0000				  SBB  AX, 0	   ; sub with borrow
   1582	15B5  51				  PUSH CX
   1583	15B6  50				  PUSH AX
   1584	15B7				G$:	  NEXT
1  1585	15B7  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1586	15B8  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1587					 ; ------ call debugger	--------
1  1588	15BA  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1589	15BE  74 06			     jz	??001F
1  1590	15C0  E8 F989			     call printWORD
1  1591	15C3  E8 F86D			     call pause
1  1592	15C6				 ??001F:
1  1593					 ; -----------------------------
1  1594	15C6  FF 27			     JMP WORD PTR [BX]
   1595
   1596						 HEAD	  84h,'DAB',323Q,DABS		      ;	DABS
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 29
forth.asm



1  1597	      =ARRAY:15C8		 LINK$=$
1  1598	15C8  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1599							 ; 6 - признак immediate. 5- слово не описано smudge
1  1600	15C9  44 41 42			     DB	 'DAB'
1  1601	15CC  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  1602	15CD  15A1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1603	      =ARRAY:15C8		 LINK=LINK$
1  1604	15CF				 DABS LABEL FAR	 ; CFA
1  1605	15CF  15D1r			     DW	 $+2
   1606	15D1  58				 POP   AX
   1607	15D2  3D 0000				 CMP   AX, 0
   1608	15D5  78 D6				 JS    DMIN
   1609	15D7  50				 PUSH  AX
   1610						 NEXT
1  1611	15D8  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1612	15D9  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1613					 ; ------ call debugger	--------
1  1614	15DB  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1615	15DF  74 06			     jz	??0020
1  1616	15E1  E8 F968			     call printWORD
1  1617	15E4  E8 F84C			     call pause
1  1618	15E7				 ??0020:
1  1619					 ; -----------------------------
1  1620	15E7  FF 27			     JMP WORD PTR [BX]
   1621
   1622						 HEAD	  82h,'M',257Q,MSLAS		      ;	M/
1  1623	      =ARRAY:15E9		 LINK$=$
1  1624	15E9  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1625							 ; 6 - признак immediate. 5- слово не описано smudge
1  1626	15EA  4D			     DB	 'M'
1  1627	15EB  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  1628	15EC  15C8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1629	      =ARRAY:15E9		 LINK=LINK$
1  1630	15EE				 MSLAS LABEL FAR  ; CFA
1  1631	15EE  15F0r			     DW	 $+2
   1632	15F0  59				 POP   CX	   ; Делимое
   1633	15F1  5A				 POP   DX
   1634	15F2  58				 POP   AX
   1635	15F3  F7 F9				 IDIV  CX
   1636	15F5  52				 PUSH  DX
   1637	15F6  50				 PUSH  AX
   1638						 NEXT
1  1639	15F7  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1640	15F8  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1641					 ; ------ call debugger	--------
1  1642	15FA  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1643	15FE  74 06			     jz	??0021
1  1644	1600  E8 F949			     call printWORD
1  1645	1603  E8 F82D			     call pause
1  1646	1606				 ??0021:
1  1647					 ; -----------------------------
1  1648	1606  FF 27			     JMP WORD PTR [BX]
   1649
   1650						 HEAD	  81h,,253Q,PLUS		      ;	+
1  1651	      =ARRAY:1608		 LINK$=$
1  1652	1608  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  1653							 ; 6 - признак immediate. 5- слово не описано smudge
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 30
forth.asm



1  1654	1609  AB			     DB	 253Q	; последний символ слова + 128 (7 бит =	1).
1  1655	160A  15E9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1656	      =ARRAY:1608		 LINK=LINK$
1  1657	160C				 PLUS LABEL FAR	 ; CFA
1  1658	160C  160Er			     DW	 $+2
   1659	160E  58				 POP  AX
   1660	160F  59				 POP  CX
   1661	1610  03 C1				 ADD  AX, CX
   1662	1612  50				 PUSH AX
   1663						 NEXT
1  1664	1613  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1665	1614  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1666					 ; ------ call debugger	--------
1  1667	1616  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1668	161A  74 06			     jz	??0022
1  1669	161C  E8 F92D			     call printWORD
1  1670	161F  E8 F811			     call pause
1  1671	1622				 ??0022:
1  1672					 ; -----------------------------
1  1673	1622  FF 27			     JMP WORD PTR [BX]
   1674
   1675						 HEAD	  81h,,255Q,SUBB		       ; -
1  1676	      =ARRAY:1624		 LINK$=$
1  1677	1624  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  1678							 ; 6 - признак immediate. 5- слово не описано smudge
1  1679	1625  AD			     DB	 255Q	; последний символ слова + 128 (7 бит =	1).
1  1680	1626  1608r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1681	      =ARRAY:1624		 LINK=LINK$
1  1682	1628				 SUBB LABEL FAR	 ; CFA
1  1683	1628  162Ar			     DW	 $+2
   1684					 ; n1 n2 -> n1-n2
   1685	162A  59				 POP  CX
   1686	162B  58				 POP  AX
   1687	162C  2B C1				 SUB  AX, CX
   1688	162E  50				 PUSH AX
   1689						 NEXT
1  1690	162F  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1691	1630  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1692					 ; ------ call debugger	--------
1  1693	1632  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1694	1636  74 06			     jz	??0023
1  1695	1638  E8 F911			     call printWORD
1  1696	163B  E8 F7F5			     call pause
1  1697	163E				 ??0023:
1  1698					 ; -----------------------------
1  1699	163E  FF 27			     JMP WORD PTR [BX]
   1700
   1701						 HEAD	  82h,'D',253Q,DPLUS		      ;	D+
1  1702	      =ARRAY:1640		 LINK$=$
1  1703	1640  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1704							 ; 6 - признак immediate. 5- слово не описано smudge
1  1705	1641  44			     DB	 'D'
1  1706	1642  AB			     DB	 253Q	; последний символ слова + 128 (7 бит =	1).
1  1707	1643  1624r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1708	      =ARRAY:1640		 LINK=LINK$
1  1709	1645				 DPLUS LABEL FAR  ; CFA
1  1710	1645  1647r			     DW	 $+2
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 31
forth.asm



   1711	1647  58				 POP  AX
   1712	1648  59				 POP  CX
   1713	1649  8B DC				 MOV  BX, SP
   1714	164B  36: 01 4F	02			 ADD  SS:[BX+2],  CX
   1715	164F  36: 11 07				 ADC  SS:[BX],	  AX
   1716						 NEXT
1  1717	1652  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1718	1653  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1719					 ; ------ call debugger	--------
1  1720	1655  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1721	1659  74 06			     jz	??0024
1  1722	165B  E8 F8EE			     call printWORD
1  1723	165E  E8 F7D2			     call pause
1  1724	1661				 ??0024:
1  1725					 ; -----------------------------
1  1726	1661  FF 27			     JMP WORD PTR [BX]
   1727
   1728						 HEAD	  85h,'MINU',323Q,MINUS		      ;	MINUS
1  1729	      =ARRAY:1663		 LINK$=$
1  1730	1663  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  1731							 ; 6 - признак immediate. 5- слово не описано smudge
1  1732	1664  4D 49 4E 55		     DB	 'MINU'
1  1733	1668  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  1734	1669  1640r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1735	      =ARRAY:1663		 LINK=LINK$
1  1736	166B				 MINUS LABEL FAR  ; CFA
1  1737	166B  166Dr			     DW	 $+2
   1738	166D  58				 POP  AX
   1739	166E  F7 D8				 NEG  AX
   1740	1670  50				 PUSH AX
   1741						 NEXT
1  1742	1671  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1743	1672  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1744					 ; ------ call debugger	--------
1  1745	1674  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1746	1678  74 06			     jz	??0025
1  1747	167A  E8 F8CF			     call printWORD
1  1748	167D  E8 F7B3			     call pause
1  1749	1680				 ??0025:
1  1750					 ; -----------------------------
1  1751	1680  FF 27			     JMP WORD PTR [BX]
   1752
   1753						 HEAD	  84h,'SWA',302Q,SWAB		      ;	SWAB
1  1754	      =ARRAY:1682		 LINK$=$
1  1755	1682  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1756							 ; 6 - признак immediate. 5- слово не описано smudge
1  1757	1683  53 57 41			     DB	 'SWA'
1  1758	1686  C2			     DB	 302Q	; последний символ слова + 128 (7 бит =	1).
1  1759	1687  1663r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1760	      =ARRAY:1682		 LINK=LINK$
1  1761	1689				 SWAB LABEL FAR	 ; CFA
1  1762	1689  168Br			     DW	 $+2
   1763					     ; обмен байтами слова в стеке
   1764	168B  58				 POP  AX
   1765	168C  86 C4				 XCHG AL, AH
   1766	168E  50				 PUSH AX
   1767						 NEXT
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 32
forth.asm



1  1768	168F  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1769	1690  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1770					 ; ------ call debugger	--------
1  1771	1692  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1772	1696  74 06			     jz	??0026
1  1773	1698  E8 F8B1			     call printWORD
1  1774	169B  E8 F795			     call pause
1  1775	169E				 ??0026:
1  1776					 ; -----------------------------
1  1777	169E  FF 27			     JMP WORD PTR [BX]
   1778
   1779						 HEAD	  83h,'AB',323Q,$ABS		       ; ABS
1  1780	      =ARRAY:16A0		 LINK$=$
1  1781	16A0  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1782							 ; 6 - признак immediate. 5- слово не описано smudge
1  1783	16A1  41 42			     DB	 'AB'
1  1784	16A3  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  1785	16A4  1682r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1786	      =ARRAY:16A0		 LINK=LINK$
1  1787	16A6				 $ABS LABEL FAR	 ; CFA
1  1788	16A6  16A8r			     DW	 $+2
   1789	16A8  58				 POP  AX
   1790	16A9  3D 0000				 CMP  AX, 0
   1791	16AC  79 02				 JNS  AB
   1792	16AE  F7 D8				 NEG  AX
   1793	16B0  50			AB:	 PUSH AX
   1794						 NEXT
1  1795	16B1  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1796	16B2  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1797					 ; ------ call debugger	--------
1  1798	16B4  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1799	16B8  74 06			     jz	??0027
1  1800	16BA  E8 F88F			     call printWORD
1  1801	16BD  E8 F773			     call pause
1  1802	16C0				 ??0027:
1  1803					 ; -----------------------------
1  1804	16C0  FF 27			     JMP WORD PTR [BX]
   1805
   1806						 HEAD	  83h,'AN',304Q,$AND		      ;	AND
1  1807	      =ARRAY:16C2		 LINK$=$
1  1808	16C2  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1809							 ; 6 - признак immediate. 5- слово не описано smudge
1  1810	16C3  41 4E			     DB	 'AN'
1  1811	16C5  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  1812	16C6  16A0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1813	      =ARRAY:16C2		 LINK=LINK$
1  1814	16C8				 $AND LABEL FAR	 ; CFA
1  1815	16C8  16CAr			     DW	 $+2
   1816	16CA  58				 POP  AX
   1817	16CB  59				 POP  CX
   1818	16CC  23 C1				 AND  AX,  CX
   1819	16CE  50			ENDA:	 PUSH AX
   1820						 NEXT
1  1821	16CF  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1822	16D0  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1823					 ; ------ call debugger	--------
1  1824	16D2  80 7D 42 00		     cmp byte ptr [di+102Q], 0
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 33
forth.asm



1  1825	16D6  74 06			     jz	??0028
1  1826	16D8  E8 F871			     call printWORD
1  1827	16DB  E8 F755			     call pause
1  1828	16DE				 ??0028:
1  1829					 ; -----------------------------
1  1830	16DE  FF 27			     JMP WORD PTR [BX]
   1831
   1832						 HEAD	  82h,'O',322Q,$OR		      ;	OR
1  1833	      =ARRAY:16E0		 LINK$=$
1  1834	16E0  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1835							 ; 6 - признак immediate. 5- слово не описано smudge
1  1836	16E1  4F			     DB	 'O'
1  1837	16E2  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  1838	16E3  16C2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1839	      =ARRAY:16E0		 LINK=LINK$
1  1840	16E5				 $OR LABEL FAR	; CFA
1  1841	16E5  16E7r			     DW	 $+2
   1842	16E7  58				 POP  AX
   1843	16E8  59				 POP  CX
   1844	16E9  0B C1				 OR   AX, CX
   1845	16EB  EB E1				 JMP  ENDA
   1846
   1847						 HEAD	  83h,'XO',322Q,$XOR		      ;	XOR
1  1848	      =ARRAY:16ED		 LINK$=$
1  1849	16ED  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1850							 ; 6 - признак immediate. 5- слово не описано smudge
1  1851	16EE  58 4F			     DB	 'XO'
1  1852	16F0  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  1853	16F1  16E0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1854	      =ARRAY:16ED		 LINK=LINK$
1  1855	16F3				 $XOR LABEL FAR	 ; CFA
1  1856	16F3  16F5r			     DW	 $+2
   1857	16F5  58				 POP  AX
   1858	16F6  59				 POP  CX
   1859	16F7  33 C1				 XOR  AX, CX
   1860	16F9  EB D3				 JMP  ENDA
   1861
   1862						 HEAD	  84h,'S-#',304Q,STOD		      ;	S->D ; sds S->
1  1863	      =ARRAY:16FB		 LINK$=$
1  1864	16FB  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1865							 ; 6 - признак immediate. 5- слово не описано smudge
1  1866	16FC  53 2D 23			     DB	 'S-#'
1  1867	16FF  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  1868	1700  16EDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1869	      =ARRAY:16FB		 LINK=LINK$
1  1870	1702				 STOD LABEL FAR	 ; CFA
1  1871	1702  1704r			     DW	 $+2
   1872	1704  58				 POP  AX
   1873	1705  50				 PUSH AX
   1874	1706  8B CA				 MOV  CX, DX	       ; Сохранение содержимого	DX
   1875	1708  99				 CWD		       ; sign bit AX to	DX
   1876	1709  52				 PUSH  DX
   1877	170A  8B D1				 MOV  DX, CX	       ; Восстановление	DX
   1878						 NEXT
1  1879	170C  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1880	170D  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1881					 ; ------ call debugger	--------
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 34
forth.asm



1  1882	170F  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1883	1713  74 06			     jz	??0029
1  1884	1715  E8 F834			     call printWORD
1  1885	1718  E8 F718			     call pause
1  1886	171B				 ??0029:
1  1887					 ; -----------------------------
1  1888	171B  FF 27			     JMP WORD PTR [BX]
   1889
   1890						 HEAD	  83h,'MI',316Q,MIN		      ;	MIN
1  1891	      =ARRAY:171D		 LINK$=$
1  1892	171D  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1893							 ; 6 - признак immediate. 5- слово не описано smudge
1  1894	171E  4D 49			     DB	 'MI'
1  1895	1720  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  1896	1721  16FBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1897	      =ARRAY:171D		 LINK=LINK$
1  1898	1723				 MIN LABEL FAR	; CFA
1  1899	1723  1725r			     DW	 $+2
   1900	1725  58				 POP  AX
   1901	1726  59				 POP  CX
   1902	1727  3B C8				 CMP  CX,  AX
   1903	1729  7C 12				 JL  DEEP	     ;
   1904	172B  50			TOP:	 PUSH AX
   1905						 NEXT
1  1906	172C  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1907	172D  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1908					 ; ------ call debugger	--------
1  1909	172F  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1910	1733  74 06			     jz	??002A
1  1911	1735  E8 F814			     call printWORD
1  1912	1738  E8 F6F8			     call pause
1  1913	173B				 ??002A:
1  1914					 ; -----------------------------
1  1915	173B  FF 27			     JMP WORD PTR [BX]
   1916	173D  51			DEEP:	 PUSH CX
   1917						 NEXT
1  1918	173E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1919	173F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1920					 ; ------ call debugger	--------
1  1921	1741  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1922	1745  74 06			     jz	??002B
1  1923	1747  E8 F802			     call printWORD
1  1924	174A  E8 F6E6			     call pause
1  1925	174D				 ??002B:
1  1926					 ; -----------------------------
1  1927	174D  FF 27			     JMP WORD PTR [BX]
   1928
   1929						 HEAD	  83h,'MA',330Q,MAX		      ;	MAX
1  1930	      =ARRAY:174F		 LINK$=$
1  1931	174F  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1932							 ; 6 - признак immediate. 5- слово не описано smudge
1  1933	1750  4D 41			     DB	 'MA'
1  1934	1752  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  1935	1753  171Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1936	      =ARRAY:174F		 LINK=LINK$
1  1937	1755				 MAX LABEL FAR	; CFA
1  1938	1755  1757r			     DW	 $+2
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 35
forth.asm



   1939	1757  58				 POP  AX
   1940	1758  59				 POP  CX
   1941	1759  3B C8				 CMP  CX, AX
   1942	175B  7D E0				 JGE  DEEP
   1943	175D  EB CC				 JMP  TOP
   1944
   1945						 HEAD	  83h,'SP',300Q,SPAT		      ;	SP@
1  1946	      =ARRAY:175F		 LINK$=$
1  1947	175F  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1948							 ; 6 - признак immediate. 5- слово не описано smudge
1  1949	1760  53 50			     DB	 'SP'
1  1950	1762  C0			     DB	 300Q	; последний символ слова + 128 (7 бит =	1).
1  1951	1763  174Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1952	      =ARRAY:175F		 LINK=LINK$
1  1953	1765				 SPAT LABEL FAR	 ; CFA
1  1954	1765  1767r			     DW	 $+2
   1955					     ; значение	текущего указателя регистра SP в стек
   1956	1767  8B C4				 MOV  AX, SP
   1957	1769  E9 FF62				 JMP  ENDA
   1958
   1959						 HEAD	  83h,'SP',241Q,SPSTO		      ;	SP!
1  1960	      =ARRAY:176C		 LINK$=$
1  1961	176C  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1962							 ; 6 - признак immediate. 5- слово не описано smudge
1  1963	176D  53 50			     DB	 'SP'
1  1964	176F  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  1965	1770  175Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1966	      =ARRAY:176C		 LINK=LINK$
1  1967	1772				 SPSTO LABEL FAR  ; CFA
1  1968	1772  1774r			     DW	 $+2
   1969	1774  8B 65 06				 MOV  SP, [DI+6]			     ; 80h
   1970						 NEXT
1  1971	1777  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1972	1778  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1973					 ; ------ call debugger	--------
1  1974	177A  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1975	177E  74 06			     jz	??002C
1  1976	1780  E8 F7C9			     call printWORD
1  1977	1783  E8 F6AD			     call pause
1  1978	1786				 ??002C:
1  1979					 ; -----------------------------
1  1980	1786  FF 27			     JMP WORD PTR [BX]
   1981
   1982						 HEAD	  83h,'RP',241Q,RPSTO		      ;	RP!
1  1983	      =ARRAY:1788		 LINK$=$
1  1984	1788  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1985							 ; 6 - признак immediate. 5- слово не описано smudge
1  1986	1789  52 50			     DB	 'RP'
1  1987	178B  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  1988	178C  176Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1989	      =ARRAY:1788		 LINK=LINK$
1  1990	178E				 RPSTO LABEL FAR  ; CFA
1  1991	178E  1790r			     DW	 $+2
   1992	1790  8B 2E 0DA2r			 MOV  BP, $RS				     ; ccch
   1993						 NEXT
1  1994	1794  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1995	1795  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 36
forth.asm



1  1996					 ; ------ call debugger	--------
1  1997	1797  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1998	179B  74 06			     jz	??002D
1  1999	179D  E8 F7AC			     call printWORD
1  2000	17A0  E8 F690			     call pause
1  2001	17A3				 ??002D:
1  2002					 ; -----------------------------
1  2003	17A3  FF 27			     JMP WORD PTR [BX]
   2004
   2005						 HEAD	  82h,';',323Q,SEMI		      ;	;S
1  2006	      =ARRAY:17A5		 LINK$=$
1  2007	17A5  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2008							 ; 6 - признак immediate. 5- слово не описано smudge
1  2009	17A6  3B			     DB	 ';'
1  2010	17A7  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  2011	17A8  1788r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2012	      =ARRAY:17A5		 LINK=LINK$
1  2013	17AA				 SEMI LABEL FAR	 ; CFA
1  2014	17AA  17ACr			     DW	 $+2
   2015					     ; переход на слово	по адресу в стеке возврата СЛОЖНО
   2016					     ; слово,которым заканчивается слова на форте
   2017	17AC  8B 76 00				 MOV  SI, [BP] ; в RS хранится адрес следующего	слова,
   2018							     ; до перехода на исполнение слова,	которое	завершается
   2019	17AF  83 C5 02				 ADD  BP, 2 ; удаляем из RS
   2020						 NEXT ;	 возврат на предыдущее слово
1  2021	17B2  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2022	17B3  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2023					 ; ------ call debugger	--------
1  2024	17B5  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2025	17B9  74 06			     jz	??002E
1  2026	17BB  E8 F78E			     call printWORD
1  2027	17BE  E8 F672			     call pause
1  2028	17C1				 ??002E:
1  2029					 ; -----------------------------
1  2030	17C1  FF 27			     JMP WORD PTR [BX]
   2031
   2032					;	 ** Стек возвратов **
   2033
   2034						 HEAD	  85h, 'LEAV',305Q,LEAV		       ; LEAVE
1  2035	      =ARRAY:17C3		 LINK$=$
1  2036	17C3  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2037							 ; 6 - признак immediate. 5- слово не описано smudge
1  2038	17C4  4C 45 41 56		     DB	 'LEAV'
1  2039	17C8  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  2040	17C9  17A5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2041	      =ARRAY:17C3		 LINK=LINK$
1  2042	17CB				 LEAV LABEL FAR	 ; CFA
1  2043	17CB  17CDr			     DW	 $+2
   2044					     ; надо смотреть дальше с хранением	адресов
   2045					     ; приравнивает значения индекса и предела
   2046	17CD  8B 46 00				     MOV  AX, [BP]
   2047	17D0  89 46 02				 MOV  [BP+2], AX
   2048						 NEXT
1  2049	17D3  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2050	17D4  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2051					 ; ------ call debugger	--------
1  2052	17D6  80 7D 42 00		     cmp byte ptr [di+102Q], 0
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 37
forth.asm



1  2053	17DA  74 06			     jz	??002F
1  2054	17DC  E8 F76D			     call printWORD
1  2055	17DF  E8 F651			     call pause
1  2056	17E2				 ??002F:
1  2057					 ; -----------------------------
1  2058	17E2  FF 27			     JMP WORD PTR [BX]
   2059
   2060						 HEAD	  82h, 62,322Q,TOR		      ;	>R sds
1  2061	      =ARRAY:17E4		 LINK$=$
1  2062	17E4  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2063							 ; 6 - признак immediate. 5- слово не описано smudge
1  2064	17E5  3E			     DB	 62
1  2065	17E6  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  2066	17E7  17C3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2067	      =ARRAY:17E4		 LINK=LINK$
1  2068	17E9				 TOR LABEL FAR	; CFA
1  2069	17E9  17EBr			     DW	 $+2
   2070					     ; пишем в стек возвратов
   2071					     ; слово из	стека данных
   2072	17EB  83 ED 02				 SUB  BP, 2 ; заняли ячейку
   2073	17EE  8F 46 00				 POP  [BP]   ; записали	значение
   2074						 NEXT
1  2075	17F1  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2076	17F2  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2077					 ; ------ call debugger	--------
1  2078	17F4  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2079	17F8  74 06			     jz	??0030
1  2080	17FA  E8 F74F			     call printWORD
1  2081	17FD  E8 F633			     call pause
1  2082	1800				 ??0030:
1  2083					 ; -----------------------------
1  2084	1800  FF 27			     JMP WORD PTR [BX]
   2085
   2086						     HEAD     82h, 'R',276Q,FROMR		   ; R>
1  2087	      =ARRAY:1802		 LINK$=$
1  2088	1802  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2089							 ; 6 - признак immediate. 5- слово не описано smudge
1  2090	1803  52			     DB	 'R'
1  2091	1804  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1  2092	1805  17E4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2093	      =ARRAY:1802		 LINK=LINK$
1  2094	1807				 FROMR LABEL FAR  ; CFA
1  2095	1807  1809r			     DW	 $+2
   2096					     ; в стек данных слово по адресу из	стека возвратов
   2097	1809  FF 76 00				     PUSH [BP] ; в стек	записали
   2098	180C  83 C5 02				 ADD  BP, 2 ; убрали
   2099						 NEXT
1  2100	180F  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2101	1810  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2102					 ; ------ call debugger	--------
1  2103	1812  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2104	1816  74 06			     jz	??0031
1  2105	1818  E8 F731			     call printWORD
1  2106	181B  E8 F615			     call pause
1  2107	181E				 ??0031:
1  2108					 ; -----------------------------
1  2109	181E  FF 27			     JMP WORD PTR [BX]
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 38
forth.asm



   2110
   2111						 HEAD	  81h,,311Q,I			      ;	I R R@
1  2112	      =ARRAY:1820		 LINK$=$
1  2113	1820  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2114							 ; 6 - признак immediate. 5- слово не описано smudge
1  2115	1821  C9			     DB	 311Q	; последний символ слова + 128 (7 бит =	1).
1  2116	1822  1802r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2117	      =ARRAY:1820		 LINK=LINK$
1  2118	1824				 I LABEL FAR  ;	CFA
1  2119	1824  1826r			     DW	 $+2
   2120					     ; Копирует	верхнее	число из стека возвратов
   2121					     ; и записывая в стек параметров
   2122	1826  FF 76 00		       RR$:	 PUSH [BP]
   2123	1829			       Z$:	 NEXT
1  2124	1829  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2125	182A  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2126					 ; ------ call debugger	--------
1  2127	182C  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2128	1830  74 06			     jz	??0032
1  2129	1832  E8 F717			     call printWORD
1  2130	1835  E8 F5FB			     call pause
1  2131	1838				 ??0032:
1  2132					 ; -----------------------------
1  2133	1838  FF 27			     JMP WORD PTR [BX]
   2134
   2135						 HEAD	  81h,,322Q,R			      ;	R
1  2136	      =ARRAY:183A		 LINK$=$
1  2137	183A  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2138							 ; 6 - признак immediate. 5- слово не описано smudge
1  2139	183B  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  2140	183C  1820r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2141	      =ARRAY:183A		 LINK=LINK$
1  2142	183E				 R LABEL FAR  ;	CFA
1  2143	183E  1840r			     DW	 $+2
   2144	1840  EB E4				 JMP  RR$
   2145
   2146						 HEAD	  82h,'I',247Q,SRP		      ;	I'
1  2147	      =ARRAY:1842		 LINK$=$
1  2148	1842  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2149							 ; 6 - признак immediate. 5- слово не описано smudge
1  2150	1843  49			     DB	 'I'
1  2151	1844  A7			     DB	 247Q	; последний символ слова + 128 (7 бит =	1).
1  2152	1845  183Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2153	      =ARRAY:1842		 LINK=LINK$
1  2154	1847				 SRP LABEL FAR	; CFA
1  2155	1847  1849r			     DW	 $+2
   2156					     ; Копирует	второе сверху число из стека возвратов
   2157					     ; и записывает его	в стек параметров
   2158	1849  FF 76 02				 PUSH [BP+2]
   2159	184C  EB DB				 JMP  Z$
   2160
   2161						 HEAD	  83h,'LE',326Q,LEV		      ;	LEV
1  2162	      =ARRAY:184E		 LINK$=$
1  2163	184E  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2164							 ; 6 - признак immediate. 5- слово не описано smudge
1  2165	184F  4C 45			     DB	 'LE'
1  2166	1851  D6			     DB	 326Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 39
forth.asm



1  2167	1852  1842r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2168	      =ARRAY:184E		 LINK=LINK$
1  2169	1854				 LEV LABEL FAR	; CFA
1  2170	1854  1856r			     DW	 $+2
   2171					     ; эквивалент R> DROP :) только быстрее
   2172					     ; для выхода из interpret
   2173	1856  83 C5 02				 ADD  BP, 2
   2174						 NEXT
1  2175	1859  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2176	185A  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2177					 ; ------ call debugger	--------
1  2178	185C  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2179	1860  74 06			     jz	??0033
1  2180	1862  E8 F6E7			     call printWORD
1  2181	1865  E8 F5CB			     call pause
1  2182	1868				 ??0033:
1  2183					 ; -----------------------------
1  2184	1868  FF 27			     JMP WORD PTR [BX]
   2185
   2186						 ;** Операции со стеком	параметров **
   2187
   2188						 HEAD	  84h,'PIC',313Q,PICK		      ;	PICK
1  2189	      =ARRAY:186A		 LINK$=$
1  2190	186A  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2191							 ; 6 - признак immediate. 5- слово не описано smudge
1  2192	186B  50 49 43			     DB	 'PIC'
1  2193	186E  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  2194	186F  184Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2195	      =ARRAY:186A		 LINK=LINK$
1  2196	1871				 PICK LABEL FAR	 ; CFA
1  2197	1871  1873r			     DW	 $+2
   2198	1873  5B				 POP  BX
   2199	1874  83 FB 00				 CMP  BX,  0
   2200	1877  7E 08				 JLE  $GO
   2201	1879  4B				 DEC  BX
   2202	187A  D1 E3				 SAL  BX, 1
   2203	187C  03 DC				 ADD  BX, SP
   2204	187E  36: FF 37				 PUSH SS:[BX]
   2205	1881				$GO:	 NEXT
1  2206	1881  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2207	1882  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2208					 ; ------ call debugger	--------
1  2209	1884  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2210	1888  74 06			     jz	??0034
1  2211	188A  E8 F6BF			     call printWORD
1  2212	188D  E8 F5A3			     call pause
1  2213	1890				 ??0034:
1  2214					 ; -----------------------------
1  2215	1890  FF 27			     JMP WORD PTR [BX]
   2216
   2217						 HEAD	  84h,'OVE',322Q,OVER		      ;	OVER
1  2218	      =ARRAY:1892		 LINK$=$
1  2219	1892  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2220							 ; 6 - признак immediate. 5- слово не описано smudge
1  2221	1893  4F 56 45			     DB	 'OVE'
1  2222	1896  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  2223	1897  186Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 40
forth.asm



1  2224	      =ARRAY:1892		 LINK=LINK$
1  2225	1899				 OVER LABEL FAR	 ; CFA
1  2226	1899  189Br			     DW	 $+2
   2227	189B  8B DC				 MOV  BX, SP
   2228	189D  36: FF 77	02			     PUSH SS:[BX+2]
   2229						 NEXT
1  2230	18A1  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2231	18A2  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2232					 ; ------ call debugger	--------
1  2233	18A4  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2234	18A8  74 06			     jz	??0035
1  2235	18AA  E8 F69F			     call printWORD
1  2236	18AD  E8 F583			     call pause
1  2237	18B0				 ??0035:
1  2238					 ; -----------------------------
1  2239	18B0  FF 27			     JMP WORD PTR [BX]
   2240
   2241						 HEAD	  84h,'SWA',320Q,SWAP		      ;	SWAP
1  2242	      =ARRAY:18B2		 LINK$=$
1  2243	18B2  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2244							 ; 6 - признак immediate. 5- слово не описано smudge
1  2245	18B3  53 57 41			     DB	 'SWA'
1  2246	18B6  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2247	18B7  1892r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2248	      =ARRAY:18B2		 LINK=LINK$
1  2249	18B9				 SWAP LABEL FAR	 ; CFA
1  2250	18B9  18BBr			     DW	 $+2
   2251	18BB  59				 POP  CX
   2252	18BC  58				 POP  AX
   2253	18BD  51				 PUSH CX
   2254	18BE  50				 PUSH AX
   2255						 NEXT
1  2256	18BF  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2257	18C0  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2258					 ; ------ call debugger	--------
1  2259	18C2  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2260	18C6  74 06			     jz	??0036
1  2261	18C8  E8 F681			     call printWORD
1  2262	18CB  E8 F565			     call pause
1  2263	18CE				 ??0036:
1  2264					 ; -----------------------------
1  2265	18CE  FF 27			     JMP WORD PTR [BX]
   2266
   2267						 HEAD	  85h,'2SWA',320Q,DSWAP		      ;	2SWAP
1  2268	      =ARRAY:18D0		 LINK$=$
1  2269	18D0  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2270							 ; 6 - признак immediate. 5- слово не описано smudge
1  2271	18D1  32 53 57 41		     DB	 '2SWA'
1  2272	18D5  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2273	18D6  18B2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2274	      =ARRAY:18D0		 LINK=LINK$
1  2275	18D8				 DSWAP LABEL FAR  ; CFA
1  2276	18D8  18DAr			     DW	 $+2
   2277	18DA  58				 POP  AX
   2278	18DB  59				 POP  CX
   2279	18DC  8B DC				 MOV  BX,  SP
   2280	18DE  36: 8B 57	02			 MOV  DX,WORD PTR SS:[BX+2]
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 41
forth.asm



   2281	18E2  52				 PUSH DX
   2282	18E3  36: 8B 17				 MOV  DX,WORD PTR SS:[BX]
   2283	18E6  52				 PUSH DX
   2284	18E7  36: 89 07				 MOV  WORD  PTR	SS:[BX],AX
   2285	18EA  36: 89 4F	02			 MOV  WORD  PTR	SS:[BX+2],CX
   2286						 NEXT
1  2287	18EE  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2288	18EF  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2289					 ; ------ call debugger	--------
1  2290	18F1  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2291	18F5  74 06			     jz	??0037
1  2292	18F7  E8 F652			     call printWORD
1  2293	18FA  E8 F536			     call pause
1  2294	18FD				 ??0037:
1  2295					 ; -----------------------------
1  2296	18FD  FF 27			     JMP WORD PTR [BX]
   2297
   2298						 HEAD	  83h,'DU',320Q,DUBL		      ;	DUP
1  2299	      =ARRAY:18FF		 LINK$=$
1  2300	18FF  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2301							 ; 6 - признак immediate. 5- слово не описано smudge
1  2302	1900  44 55			     DB	 'DU'
1  2303	1902  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2304	1903  18D0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2305	      =ARRAY:18FF		 LINK=LINK$
1  2306	1905				 DUBL LABEL FAR	 ; CFA
1  2307	1905  1907r			     DW	 $+2
   2308	1907  58				 POP  AX
   2309	1908  50			DU:	 PUSH AX
   2310	1909  50			C$:	 PUSH AX
   2311						 NEXT
1  2312	190A  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2313	190B  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2314					 ; ------ call debugger	--------
1  2315	190D  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2316	1911  74 06			     jz	??0038
1  2317	1913  E8 F636			     call printWORD
1  2318	1916  E8 F51A			     call pause
1  2319	1919				 ??0038:
1  2320					 ; -----------------------------
1  2321	1919  FF 27			     JMP WORD PTR [BX]
   2322
   2323						 HEAD	  84h,'-DU',320Q,DDUP		      ;	-DUP
1  2324	      =ARRAY:191B		 LINK$=$
1  2325	191B  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2326							 ; 6 - признак immediate. 5- слово не описано smudge
1  2327	191C  2D 44 55			     DB	 '-DU'
1  2328	191F  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2329	1920  18FFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2330	      =ARRAY:191B		 LINK=LINK$
1  2331	1922				 DDUP LABEL FAR	 ; CFA
1  2332	1922  1924r			     DW	 $+2
   2333					     ; DUP если	в стеке	не 0
   2334	1924  58				 POP  AX
   2335	1925  3D 0000				 CMP  AX,  0
   2336	1928  75 DE				 JNE  DU
   2337	192A  EB DD				 JMP  C$
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 42
forth.asm



   2338
   2339						 HEAD	  84h,'2DU',320Q,DUP2		      ;	2DUP
1  2340	      =ARRAY:192C		 LINK$=$
1  2341	192C  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2342							 ; 6 - признак immediate. 5- слово не описано smudge
1  2343	192D  32 44 55			     DB	 '2DU'
1  2344	1930  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2345	1931  191Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2346	      =ARRAY:192C		 LINK=LINK$
1  2347	1933				 DUP2 LABEL FAR	 ; CFA
1  2348	1933  1935r			     DW	 $+2
   2349	1935  58				 POP  AX
   2350	1936  59				 POP  CX
   2351	1937  51				 PUSH CX
   2352	1938  50				 PUSH AX
   2353	1939  51				 PUSH CX
   2354	193A  50				 PUSH AX
   2355						 NEXT
1  2356	193B  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2357	193C  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2358					 ; ------ call debugger	--------
1  2359	193E  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2360	1942  74 06			     jz	??0039
1  2361	1944  E8 F605			     call printWORD
1  2362	1947  E8 F4E9			     call pause
1  2363	194A				 ??0039:
1  2364					 ; -----------------------------
1  2365	194A  FF 27			     JMP WORD PTR [BX]
   2366
   2367						 HEAD	  83h,'RO',324Q,ROT		      ;	ROT
1  2368	      =ARRAY:194C		 LINK$=$
1  2369	194C  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2370							 ; 6 - признак immediate. 5- слово не описано smudge
1  2371	194D  52 4F			     DB	 'RO'
1  2372	194F  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  2373	1950  192Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2374	      =ARRAY:194C		 LINK=LINK$
1  2375	1952				 ROT LABEL FAR	; CFA
1  2376	1952  1954r			     DW	 $+2
   2377	1954  58				 POP  AX
   2378	1955  59				 POP  CX
   2379	1956  5B				 POP  BX
   2380	1957  51				 PUSH CX
   2381	1958  50				 PUSH AX
   2382	1959  53				 PUSH BX
   2383						 NEXT
1  2384	195A  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2385	195B  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2386					 ; ------ call debugger	--------
1  2387	195D  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2388	1961  74 06			     jz	??003A
1  2389	1963  E8 F5E6			     call printWORD
1  2390	1966  E8 F4CA			     call pause
1  2391	1969				 ??003A:
1  2392					 ; -----------------------------
1  2393	1969  FF 27			     JMP WORD PTR [BX]
   2394
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 43
forth.asm



   2395						 HEAD	  85h,'2DRO',320Q,DDROP		      ;	2DROP
1  2396	      =ARRAY:196B		 LINK$=$
1  2397	196B  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2398							 ; 6 - признак immediate. 5- слово не описано smudge
1  2399	196C  32 44 52 4F		     DB	 '2DRO'
1  2400	1970  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2401	1971  194Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2402	      =ARRAY:196B		 LINK=LINK$
1  2403	1973				 DDROP LABEL FAR  ; CFA
1  2404	1973  1975r			     DW	 $+2
   2405	1975  83 C4 04			DRO:	 ADD  SP, 4
   2406						 NEXT
1  2407	1978  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2408	1979  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2409					 ; ------ call debugger	--------
1  2410	197B  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2411	197F  74 06			     jz	??003B
1  2412	1981  E8 F5C8			     call printWORD
1  2413	1984  E8 F4AC			     call pause
1  2414	1987				 ??003B:
1  2415					 ; -----------------------------
1  2416	1987  FF 27			     JMP WORD PTR [BX]
   2417
   2418						 HEAD	  84h,'DRO',320Q,DROP		      ;	DROP
1  2419	      =ARRAY:1989		 LINK$=$
1  2420	1989  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2421							 ; 6 - признак immediate. 5- слово не описано smudge
1  2422	198A  44 52 4F			     DB	 'DRO'
1  2423	198D  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2424	198E  196Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2425	      =ARRAY:1989		 LINK=LINK$
1  2426	1990				 DROP LABEL FAR	 ; CFA
1  2427	1990  1992r			     DW	 $+2
   2428	1992  83 C4 02			DRP:	 ADD  SP, 2
   2429						 NEXT
1  2430	1995  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2431	1996  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2432					 ; ------ call debugger	--------
1  2433	1998  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2434	199C  74 06			     jz	??003C
1  2435	199E  E8 F5AB			     call printWORD
1  2436	19A1  E8 F48F			     call pause
1  2437	19A4				 ??003C:
1  2438					 ; -----------------------------
1  2439	19A4  FF 27			     JMP WORD PTR [BX]
   2440
   2441					;	 ** Работа с памятью **
   2442
   2443						 HEAD	  85h,'CMOV',305Q,CMOV		     ; CMOVE
1  2444	      =ARRAY:19A6		 LINK$=$
1  2445	19A6  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2446							 ; 6 - признак immediate. 5- слово не описано smudge
1  2447	19A7  43 4D 4F 56		     DB	 'CMOV'
1  2448	19AB  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  2449	19AC  1989r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2450	      =ARRAY:19A6		 LINK=LINK$
1  2451	19AE				 CMOV LABEL FAR	 ; CFA
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 44
forth.asm



1  2452	19AE  19B0r			     DW	 $+2
   2453					     ; src dst cnt -> перенос области памяти
   2454	19B0  59				 POP  CX	 ; Счетчик
   2455	19B1  83 F9 00				 CMP  CX,  0
   2456	19B4  7E BF				 JLE  DRO	 ; выход, c сбросом двух параметров в стеке
   2457	19B6  8B C7				 MOV  AX,  DI	  ; Сохранение содержимого DI,SI
   2458	19B8  8B DE				 MOV  BX,  SI
   2459	19BA  5F				 POP  DI	  ; Куда
   2460	19BB  5E				 POP  SI	  ; Откуда
   2461	19BC  F3> A4			REP	 MOVS  BYTE PTR	ES:[DI], BYTE PTR DS:[SI]
   2462	19BE  8B F8				 MOV  DI, AX	  ; Восстановление DI,SI
   2463	19C0  8B F3				 MOV  SI, BX
   2464						 NEXT
1  2465	19C2  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2466	19C3  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2467					 ; ------ call debugger	--------
1  2468	19C5  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2469	19C9  74 06			     jz	??003D
1  2470	19CB  E8 F57E			     call printWORD
1  2471	19CE  E8 F462			     call pause
1  2472	19D1				 ??003D:
1  2473					 ; -----------------------------
1  2474	19D1  FF 27			     JMP WORD PTR [BX]
   2475
   2476						 HEAD	  84h,'FIL',314Q,FILL		      ;	FILL
1  2477	      =ARRAY:19D3		 LINK$=$
1  2478	19D3  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2479							 ; 6 - признак immediate. 5- слово не описано smudge
1  2480	19D4  46 49 4C			     DB	 'FIL'
1  2481	19D7  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  2482	19D8  19A6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2483	      =ARRAY:19D3		 LINK=LINK$
1  2484	19DA				 FILL LABEL FAR	 ; CFA
1  2485	19DA  19DCr			     DW	 $+2
   2486					 ; addr	cnt chr	-> заполнение области памяти
   2487	19DC  58				 POP  AX      ;	Символ
   2488	19DD  59			FLL:	 POP  CX      ;	Счетчик	символов
   2489	19DE  83 F9 00				 CMP  CX, 0
   2490	19E1  7E AF				 JLE  DRP     ;
   2491	19E3  5B				 POP  BX
   2492	19E4  88 07			$REPE:	 MOV  BYTE PTR [BX],  AL
   2493	19E6  43				 INC  BX
   2494	19E7  E2 FB				 LOOP $REPE
   2495						 NEXT
1  2496	19E9  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2497	19EA  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2498					 ; ------ call debugger	--------
1  2499	19EC  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2500	19F0  74 06			     jz	??003E
1  2501	19F2  E8 F557			     call printWORD
1  2502	19F5  E8 F43B			     call pause
1  2503	19F8				 ??003E:
1  2504					 ; -----------------------------
1  2505	19F8  FF 27			     JMP WORD PTR [BX]
   2506
   2507						 HEAD	  85h,'ERAS',305Q,ERASE		      ;	ERASE
1  2508	      =ARRAY:19FA		 LINK$=$
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 45
forth.asm



1  2509	19FA  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2510							 ; 6 - признак immediate. 5- слово не описано smudge
1  2511	19FB  45 52 41 53		     DB	 'ERAS'
1  2512	19FF  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  2513	1A00  19D3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2514	      =ARRAY:19FA		 LINK=LINK$
1  2515	1A02				 ERASE LABEL FAR  ; CFA
1  2516	1A02  1A04r			     DW	 $+2
   2517					     ; заполнение нулем
   2518	1A04  2B C0				 SUB  AX, AX
   2519	1A06  EB D5				 JMP  FLL
   2520
   2521						 HEAD	  86h,'BLANK',323Q,BLANK	      ;	BLANKS
1  2522	      =ARRAY:1A08		 LINK$=$
1  2523	1A08  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  2524							 ; 6 - признак immediate. 5- слово не описано smudge
1  2525	1A09  42 4C 41 4E 4B		     DB	 'BLANK'
1  2526	1A0E  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  2527	1A0F  19FAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2528	      =ARRAY:1A08		 LINK=LINK$
1  2529	1A11				 BLANK LABEL FAR  ; CFA
1  2530	1A11  1A13r			     DW	 $+2
   2531					     ; заполнение  пробелом
   2532	1A13  B8 0020				 MOV  AX, 32
   2533	1A16  EB C5				 JMP  FLL
   2534
   2535						 HEAD	  84h,'HOL',304Q,HOLD		      ;	HOLD
1  2536	      =ARRAY:1A18		 LINK$=$
1  2537	1A18  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2538							 ; 6 - признак immediate. 5- слово не описано smudge
1  2539	1A19  48 4F 4C			     DB	 'HOL'
1  2540	1A1C  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  2541	1A1D  1A08r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2542	      =ARRAY:1A18		 LINK=LINK$
1  2543	1A1F				 HOLD LABEL FAR	 ; CFA
1  2544	1A1F  1A21r			     DW	 $+2
   2545					     ; Вводит в	текущую	ячейку выходного буфера	символ,
   2546					     ; код которого в стеке. Должен использоваться между <# и #>
   2547					     ; уменьшает на 1 значение указателя HLD.
   2548	1A21  FF 4D 38				 DEC  WORD PTR	[DI+70Q]
   2549	1A24  58				 POP  AX
   2550	1A25  8B 5D 38				 MOV  BX,  [DI+70Q]
   2551	1A28  88 07				 MOV  BYTE PTR [BX], AL
   2552						 NEXT
1  2553	1A2A  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2554	1A2B  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2555					 ; ------ call debugger	--------
1  2556	1A2D  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2557	1A31  74 06			     jz	??003F
1  2558	1A33  E8 F516			     call printWORD
1  2559	1A36  E8 F3FA			     call pause
1  2560	1A39				 ??003F:
1  2561					 ; -----------------------------
1  2562	1A39  FF 27			     JMP WORD PTR [BX]
   2563
   2564						 HEAD	  82h,'+',241Q,PSTOR		      ;	+!
1  2565	      =ARRAY:1A3B		 LINK$=$
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 46
forth.asm



1  2566	1A3B  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2567							 ; 6 - признак immediate. 5- слово не описано smudge
1  2568	1A3C  2B			     DB	 '+'
1  2569	1A3D  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  2570	1A3E  1A18r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2571	      =ARRAY:1A3B		 LINK=LINK$
1  2572	1A40				 PSTOR LABEL FAR  ; CFA
1  2573	1A40  1A42r			     DW	 $+2
   2574	1A42  5B				 POP  BX
   2575	1A43  59				 POP  CX
   2576	1A44  01 0F				 ADD  [BX], CX
   2577						 NEXT
1  2578	1A46  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2579	1A47  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2580					 ; ------ call debugger	--------
1  2581	1A49  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2582	1A4D  74 06			     jz	??0040
1  2583	1A4F  E8 F4FA			     call printWORD
1  2584	1A52  E8 F3DE			     call pause
1  2585	1A55				 ??0040:
1  2586					 ; -----------------------------
1  2587	1A55  FF 27			     JMP WORD PTR [BX]
   2588
   2589						 HEAD	  84h,'TOG',314Q,TOGL		      ;	TOGGLE
1  2590	      =ARRAY:1A57		 LINK$=$
1  2591	1A57  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2592							 ; 6 - признак immediate. 5- слово не описано smudge
1  2593	1A58  54 4F 47			     DB	 'TOG'
1  2594	1A5B  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  2595	1A5C  1A3Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2596	      =ARRAY:1A57		 LINK=LINK$
1  2597	1A5E				 TOGL LABEL FAR	 ; CFA
1  2598	1A5E  1A60r			     DW	 $+2
   2599					; адр-байта маска -> XOR в байт	памяти
   2600	1A60  59				 POP  CX	 ; Маска
   2601	1A61  5B				 POP  BX
   2602	1A62  30 0F				 XOR  BYTE PTR [BX],CL
   2603						 NEXT
1  2604	1A64  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2605	1A65  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2606					 ; ------ call debugger	--------
1  2607	1A67  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2608	1A6B  74 06			     jz	??0041
1  2609	1A6D  E8 F4DC			     call printWORD
1  2610	1A70  E8 F3C0			     call pause
1  2611	1A73				 ??0041:
1  2612					 ; -----------------------------
1  2613	1A73  FF 27			     JMP WORD PTR [BX]
   2614
   2615						 HEAD	  81h,,300Q,AT			      ;	@
1  2616	      =ARRAY:1A75		 LINK$=$
1  2617	1A75  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2618							 ; 6 - признак immediate. 5- слово не описано smudge
1  2619	1A76  C0			     DB	 300Q	; последний символ слова + 128 (7 бит =	1).
1  2620	1A77  1A57r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2621	      =ARRAY:1A75		 LINK=LINK$
1  2622	1A79				 AT LABEL FAR  ; CFA
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 47
forth.asm



1  2623	1A79  1A7Br			     DW	 $+2
   2624					     ; addr -> n
   2625	1A7B  5B				 POP  BX
   2626	1A7C  FF 37				 PUSH [BX]
   2627						 NEXT
1  2628	1A7E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2629	1A7F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2630					 ; ------ call debugger	--------
1  2631	1A81  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2632	1A85  74 06			     jz	??0042
1  2633	1A87  E8 F4C2			     call printWORD
1  2634	1A8A  E8 F3A6			     call pause
1  2635	1A8D				 ??0042:
1  2636					 ; -----------------------------
1  2637	1A8D  FF 27			     JMP WORD PTR [BX]
   2638
   2639						 HEAD	  82h,'C',300Q,CAT		      ;	C@
1  2640	      =ARRAY:1A8F		 LINK$=$
1  2641	1A8F  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2642							 ; 6 - признак immediate. 5- слово не описано smudge
1  2643	1A90  43			     DB	 'C'
1  2644	1A91  C0			     DB	 300Q	; последний символ слова + 128 (7 бит =	1).
1  2645	1A92  1A75r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2646	      =ARRAY:1A8F		 LINK=LINK$
1  2647	1A94				 CAT LABEL FAR	; CFA
1  2648	1A94  1A96r			     DW	 $+2
   2649					     ; Извлекает байт информации из ячейки,
   2650					     ; адрес которой находится в стеке
   2651	1A96  5B				 POP  BX
   2652	1A97  8A 07				 MOV  AL, BYTE PTR [BX]
   2653	1A99  2A E4				 SUB  AH, AH
   2654	1A9B  50				 PUSH AX
   2655						 NEXT
1  2656	1A9C  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2657	1A9D  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2658					 ; ------ call debugger	--------
1  2659	1A9F  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2660	1AA3  74 06			     jz	??0043
1  2661	1AA5  E8 F4A4			     call printWORD
1  2662	1AA8  E8 F388			     call pause
1  2663	1AAB				 ??0043:
1  2664					 ; -----------------------------
1  2665	1AAB  FF 27			     JMP WORD PTR [BX]
   2666
   2667						 HEAD	  81h,,241Q,STORE		      ;	!
1  2668	      =ARRAY:1AAD		 LINK$=$
1  2669	1AAD  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2670							 ; 6 - признак immediate. 5- слово не описано smudge
1  2671	1AAE  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  2672	1AAF  1A8Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2673	      =ARRAY:1AAD		 LINK=LINK$
1  2674	1AB1				 STORE LABEL FAR  ; CFA
1  2675	1AB1  1AB3r			     DW	 $+2
   2676					     ; n addr ->
   2677	1AB3  5B				 POP  BX
   2678	1AB4  58				 POP  AX
   2679	1AB5  89 07				 MOV  [BX],   AX
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 48
forth.asm



   2680						 NEXT
1  2681	1AB7  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2682	1AB8  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2683					 ; ------ call debugger	--------
1  2684	1ABA  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2685	1ABE  74 06			     jz	??0044
1  2686	1AC0  E8 F489			     call printWORD
1  2687	1AC3  E8 F36D			     call pause
1  2688	1AC6				 ??0044:
1  2689					 ; -----------------------------
1  2690	1AC6  FF 27			     JMP WORD PTR [BX]
   2691
   2692						 HEAD	  82h,'C',241Q,CSTOR		     ; C!
1  2693	      =ARRAY:1AC8		 LINK$=$
1  2694	1AC8  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2695							 ; 6 - признак immediate. 5- слово не описано smudge
1  2696	1AC9  43			     DB	 'C'
1  2697	1ACA  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  2698	1ACB  1AADr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2699	      =ARRAY:1AC8		 LINK=LINK$
1  2700	1ACD				 CSTOR LABEL FAR  ; CFA
1  2701	1ACD  1ACFr			     DW	 $+2
   2702	1ACF  5B				 POP  BX
   2703	1AD0  58				 POP  AX
   2704	1AD1  88 07				 MOV  BYTE PTR [BX],  AL
   2705						 NEXT
1  2706	1AD3  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2707	1AD4  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2708					 ; ------ call debugger	--------
1  2709	1AD6  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2710	1ADA  74 06			     jz	??0045
1  2711	1ADC  E8 F46D			     call printWORD
1  2712	1ADF  E8 F351			     call pause
1  2713	1AE2				 ??0045:
1  2714					 ; -----------------------------
1  2715	1AE2  FF 27			     JMP WORD PTR [BX]
   2716
   2717						 HEAD	  83h,'NF','A'+80h,NFA		     ; NFA
1  2718	      =ARRAY:1AE4		 LINK$=$
1  2719	1AE4  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2720							 ; 6 - признак immediate. 5- слово не описано smudge
1  2721	1AE5  4E 46			     DB	 'NF'
1  2722	1AE7  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  2723	1AE8  1AC8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2724	      =ARRAY:1AE4		 LINK=LINK$
1  2725	1AEA				 NFA LABEL FAR	; CFA
1  2726	1AEA  1AECr			     DW	 $+2
   2727					 ; pfa -> nfa
   2728	1AEC  5B				 POP  BX
   2729	1AED  83 EB 05				 SUB  BX, 5
   2730	1AF0  B9 FFFF				 MOV  CX, -1
   2731
   2732	1AF3  E9 00A0				 JMP  TRV
   2733
   2734						 HEAD	  83h,'LF','A'+80h,LFA		     ; LFA
1  2735	      =ARRAY:1AF6		 LINK$=$
1  2736	1AF6  83			     DB	 83h  ;	NFA 7 бит равен	1.
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 49
forth.asm



1  2737							 ; 6 - признак immediate. 5- слово не описано smudge
1  2738	1AF7  4C 46			     DB	 'LF'
1  2739	1AF9  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  2740	1AFA  1AE4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2741	      =ARRAY:1AF6		 LINK=LINK$
1  2742	1AFC				 LFA LABEL FAR	; CFA
1  2743	1AFC  1AFEr			     DW	 $+2
   2744	1AFE  58				 POP  AX
   2745	1AFF  2D 0004				 SUB  AX, 4
   2746	1B02  50				 PUSH AX
   2747						 NEXT
1  2748	1B03  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2749	1B04  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2750					 ; ------ call debugger	--------
1  2751	1B06  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2752	1B0A  74 06			     jz	??0046
1  2753	1B0C  E8 F43D			     call printWORD
1  2754	1B0F  E8 F321			     call pause
1  2755	1B12				 ??0046:
1  2756					 ; -----------------------------
1  2757	1B12  FF 27			     JMP WORD PTR [BX]
   2758
   2759						 HEAD	  83h,'CF','A'+80h,CFA		     ; CFA
1  2760	      =ARRAY:1B14		 LINK$=$
1  2761	1B14  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2762							 ; 6 - признак immediate. 5- слово не описано smudge
1  2763	1B15  43 46			     DB	 'CF'
1  2764	1B17  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  2765	1B18  1AF6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2766	      =ARRAY:1B14		 LINK=LINK$
1  2767	1B1A				 CFA LABEL FAR	; CFA
1  2768	1B1A  1B1Cr			     DW	 $+2
   2769					 ; PFA -> CFA
   2770	1B1C  58				 POP  AX
   2771	1B1D  2D 0002				 SUB  AX, 2
   2772	1B20  50				 PUSH AX
   2773						 NEXT
1  2774	1B21  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2775	1B22  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2776					 ; ------ call debugger	--------
1  2777	1B24  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2778	1B28  74 06			     jz	??0047
1  2779	1B2A  E8 F41F			     call printWORD
1  2780	1B2D  E8 F303			     call pause
1  2781	1B30				 ??0047:
1  2782					 ; -----------------------------
1  2783	1B30  FF 27			     JMP WORD PTR [BX]
   2784
   2785						 HEAD	  84h,'!CS',320Q,SCSP		      ;	!CSP
1  2786	      =ARRAY:1B32		 LINK$=$
1  2787	1B32  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2788							 ; 6 - признак immediate. 5- слово не описано smudge
1  2789	1B33  21 43 53			     DB	 '!CS'
1  2790	1B36  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2791	1B37  1B14r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2792	      =ARRAY:1B32		 LINK=LINK$
1  2793	1B39				 SCSP LABEL FAR	 ; CFA
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 50
forth.asm



1  2794	1B39  1B3Br			     DW	 $+2
   2795					 ; контролируют	сохранение указателя стека параметров
   2796					 ; в процессе интерпретации слова
   2797	1B3B  89 65 34				 MOV  WORD PTR [DI]+64Q,SP
   2798						 NEXT
1  2799	1B3E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2800	1B3F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2801					 ; ------ call debugger	--------
1  2802	1B41  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2803	1B45  74 06			     jz	??0048
1  2804	1B47  E8 F402			     call printWORD
1  2805	1B4A  E8 F2E6			     call pause
1  2806	1B4D				 ??0048:
1  2807					 ; -----------------------------
1  2808	1B4D  FF 27			     JMP WORD PTR [BX]
   2809
   2810						 HEAD	  84h,'HER',305Q,HERE		      ;	HERE
1  2811	      =ARRAY:1B4F		 LINK$=$
1  2812	1B4F  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2813							 ; 6 - признак immediate. 5- слово не описано smudge
1  2814	1B50  48 45 52			     DB	 'HER'
1  2815	1B53  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  2816	1B54  1B32r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2817	      =ARRAY:1B4F		 LINK=LINK$
1  2818	1B56				 HERE LABEL FAR	 ; CFA
1  2819	1B56  1B58r			     DW	 $+2
   2820	1B58  FF 75 12				 PUSH [DI+22Q]
   2821						 NEXT
1  2822	1B5B  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2823	1B5C  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2824					 ; ------ call debugger	--------
1  2825	1B5E  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2826	1B62  74 06			     jz	??0049
1  2827	1B64  E8 F3E5			     call printWORD
1  2828	1B67  E8 F2C9			     call pause
1  2829	1B6A				 ??0049:
1  2830					 ; -----------------------------
1  2831	1B6A  FF 27			     JMP WORD PTR [BX]
   2832
   2833						 HEAD	  85h,'ALLO',324Q,ALLOT		      ;	ALLOT
1  2834	      =ARRAY:1B6C		 LINK$=$
1  2835	1B6C  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2836							 ; 6 - признак immediate. 5- слово не описано smudge
1  2837	1B6D  41 4C 4C 4F		     DB	 'ALLO'
1  2838	1B71  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  2839	1B72  1B4Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2840	      =ARRAY:1B6C		 LINK=LINK$
1  2841	1B74				 ALLOT LABEL FAR  ; CFA
1  2842	1B74  1B76r			     DW	 $+2
   2843	1B76  5B				 POP  BX
   2844	1B77  01 5D 12				 ADD  [DI+22Q],BX	 ;
   2845						 NEXT
1  2846	1B7A  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2847	1B7B  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2848					 ; ------ call debugger	--------
1  2849	1B7D  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2850	1B81  74 06			     jz	??004A
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 51
forth.asm



1  2851	1B83  E8 F3C6			     call printWORD
1  2852	1B86  E8 F2AA			     call pause
1  2853	1B89				 ??004A:
1  2854					 ; -----------------------------
1  2855	1B89  FF 27			     JMP WORD PTR [BX]
   2856
   2857						 HEAD	  84h,'TRA',326Q,TRAV		      ;	TRAVERSE
1  2858	      =ARRAY:1B8B		 LINK$=$
1  2859	1B8B  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2860							 ; 6 - признак immediate. 5- слово не описано smudge
1  2861	1B8C  54 52 41			     DB	 'TRA'
1  2862	1B8F  D6			     DB	 326Q	; последний символ слова + 128 (7 бит =	1).
1  2863	1B90  1B6Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2864	      =ARRAY:1B8B		 LINK=LINK$
1  2865	1B92				 TRAV LABEL FAR	 ; CFA
1  2866	1B92  1B94r			     DW	 $+2
   2867						 ; Движение вперед/назад вдоль имени переменной	длины
   2868	1B94  59				 POP  CX     ; DELTA
   2869	1B95  5B				 POP  BX     ; адрес строки
   2870	1B96  03 D9			 TRV:	 ADD  BX, CX
   2871	1B98  80 3F 00				 CMP  BYTE PTR [BX],  0
   2872	1B9B  79 F9				 JNS  TRV    ; JUMP IF POSITIVE
   2873	1B9D  53				 PUSH BX
   2874						 NEXT
1  2875	1B9E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2876	1B9F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2877					 ; ------ call debugger	--------
1  2878	1BA1  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2879	1BA5  74 06			     jz	??004B
1  2880	1BA7  E8 F3A2			     call printWORD
1  2881	1BAA  E8 F286			     call pause
1  2882	1BAD				 ??004B:
1  2883					 ; -----------------------------
1  2884	1BAD  FF 27			     JMP WORD PTR [BX]
   2885
   2886						 HEAD	  301Q,,333Q,LBRAC		       ; [
1  2887	      =ARRAY:1BAF		 LINK$=$
1  2888	1BAF  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  2889							 ; 6 - признак immediate. 5- слово не описано smudge
1  2890	1BB0  DB			     DB	 333Q	; последний символ слова + 128 (7 бит =	1).
1  2891	1BB1  1B8Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2892	      =ARRAY:1BAF		 LINK=LINK$
1  2893	1BB3				 LBRAC LABEL FAR  ; CFA
1  2894	1BB3  1BB5r			     DW	 $+2
   2895						 ; Прекращение компил.,	начало исполн. (обнуление STATE)
   2896	1BB5  C7 45 2C 0000			 MOV  WORD PTR [DI+54Q],0
   2897						 NEXT
1  2898	1BBA  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2899	1BBB  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2900					 ; ------ call debugger	--------
1  2901	1BBD  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2902	1BC1  74 06			     jz	??004C
1  2903	1BC3  E8 F386			     call printWORD
1  2904	1BC6  E8 F26A			     call pause
1  2905	1BC9				 ??004C:
1  2906					 ; -----------------------------
1  2907	1BC9  FF 27			     JMP WORD PTR [BX]
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 52
forth.asm



   2908
   2909						 HEAD	  301Q,,335Q,RBRAC		       ; ]
1  2910	      =ARRAY:1BCB		 LINK$=$
1  2911	1BCB  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  2912							 ; 6 - признак immediate. 5- слово не описано smudge
1  2913	1BCC  DD			     DB	 335Q	; последний символ слова + 128 (7 бит =	1).
1  2914	1BCD  1BAFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2915	      =ARRAY:1BCB		 LINK=LINK$
1  2916	1BCF				 RBRAC LABEL FAR  ; CFA
1  2917	1BCF  1BD1r			     DW	 $+2
   2918	1BD1  C7 45 2C 00C0			 MOV  WORD PTR [DI+54Q],300Q   ; Начало	компиляции
   2919						 NEXT
1  2920	1BD6  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2921	1BD7  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2922					 ; ------ call debugger	--------
1  2923	1BD9  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2924	1BDD  74 06			     jz	??004D
1  2925	1BDF  E8 F36A			     call printWORD
1  2926	1BE2  E8 F24E			     call pause
1  2927	1BE5				 ??004D:
1  2928					 ; -----------------------------
1  2929	1BE5  FF 27			     JMP WORD PTR [BX]
   2930
   2931						 HEAD	  83h,'HE',330Q,$HEX		      ;	HEX
1  2932	      =ARRAY:1BE7		 LINK$=$
1  2933	1BE7  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2934							 ; 6 - признак immediate. 5- слово не описано smudge
1  2935	1BE8  48 45			     DB	 'HE'
1  2936	1BEA  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  2937	1BEB  1BCBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2938	      =ARRAY:1BE7		 LINK=LINK$
1  2939	1BED				 $HEX LABEL FAR	 ; CFA
1  2940	1BED  1BEFr			     DW	 $+2
   2941	1BEF  C7 45 2E 0010			 MOV  WORD PTR [DI+56Q],16
   2942						 NEXT
1  2943	1BF4  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2944	1BF5  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2945					 ; ------ call debugger	--------
1  2946	1BF7  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2947	1BFB  74 06			     jz	??004E
1  2948	1BFD  E8 F34C			     call printWORD
1  2949	1C00  E8 F230			     call pause
1  2950	1C03				 ??004E:
1  2951					 ; -----------------------------
1  2952	1C03  FF 27			     JMP WORD PTR [BX]
   2953
   2954						 HEAD	  87h,'DECIMA',314Q,DECIMA	       ; DECIMAL
1  2955	      =ARRAY:1C05		 LINK$=$
1  2956	1C05  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  2957							 ; 6 - признак immediate. 5- слово не описано smudge
1  2958	1C06  44 45 43 49 4D 41		     DB	 'DECIMA'
1  2959	1C0C  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  2960	1C0D  1BE7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2961	      =ARRAY:1C05		 LINK=LINK$
1  2962	1C0F				 DECIMA	LABEL FAR  ; CFA
1  2963	1C0F  1C11r			     DW	 $+2
   2964	1C11  C7 45 2E 000A			 MOV  WORD PTR [DI+56Q],10
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 53
forth.asm



   2965						 NEXT
1  2966	1C16  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2967	1C17  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2968					 ; ------ call debugger	--------
1  2969	1C19  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2970	1C1D  74 06			     jz	??004F
1  2971	1C1F  E8 F32A			     call printWORD
1  2972	1C22  E8 F20E			     call pause
1  2973	1C25				 ??004F:
1  2974					 ; -----------------------------
1  2975	1C25  FF 27			     JMP WORD PTR [BX]
   2976
   2977						 HEAD	  85h,'OCTA',314Q,OCTAL		      ;	OCTAL
1  2978	      =ARRAY:1C27		 LINK$=$
1  2979	1C27  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2980							 ; 6 - признак immediate. 5- слово не описано smudge
1  2981	1C28  4F 43 54 41		     DB	 'OCTA'
1  2982	1C2C  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  2983	1C2D  1C05r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2984	      =ARRAY:1C27		 LINK=LINK$
1  2985	1C2F				 OCTAL LABEL FAR  ; CFA
1  2986	1C2F  1C31r			     DW	 $+2
   2987	1C31  C7 45 2E 0008			 MOV  WORD PTR [DI+56Q],  8
   2988	1C36				Y$:	 NEXT
1  2989	1C36  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2990	1C37  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2991					 ; ------ call debugger	--------
1  2992	1C39  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2993	1C3D  74 06			     jz	??0050
1  2994	1C3F  E8 F30A			     call printWORD
1  2995	1C42  E8 F1EE			     call pause
1  2996	1C45				 ??0050:
1  2997					 ; -----------------------------
1  2998	1C45  FF 27			     JMP WORD PTR [BX]
   2999
   3000						 HEAD	  86h,'LATES',324Q,LATES	      ;	LATEST
1  3001	      =ARRAY:1C47		 LINK$=$
1  3002	1C47  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  3003							 ; 6 - признак immediate. 5- слово не описано smudge
1  3004	1C48  4C 41 54 45 53		     DB	 'LATES'
1  3005	1C4D  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3006	1C4E  1C27r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3007	      =ARRAY:1C47		 LINK=LINK$
1  3008	1C50				 LATES LABEL FAR  ; CFA
1  3009	1C50  1C52r			     DW	 $+2
   3010					     ; в стек данных NFA  последнего определенного слова
   3011					     ; в current словаре
   3012	1C52  8B 5D 2A				 MOV  BX, [DI+52Q]
   3013	1C55  FF 37				 PUSH [BX]
   3014						 NEXT
1  3015	1C57  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3016	1C58  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3017					 ; ------ call debugger	--------
1  3018	1C5A  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3019	1C5E  74 06			     jz	??0051
1  3020	1C60  E8 F2E9			     call printWORD
1  3021	1C63  E8 F1CD			     call pause
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 54
forth.asm



1  3022	1C66				 ??0051:
1  3023					 ; -----------------------------
1  3024	1C66  FF 27			     JMP WORD PTR [BX]
   3025
   3026						 HEAD	  86h,'-TRAI',314Q,DTRAI	      ;	-TRAIL
1  3027	      =ARRAY:1C68		 LINK$=$
1  3028	1C68  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  3029							 ; 6 - признак immediate. 5- слово не описано smudge
1  3030	1C69  2D 54 52 41 49		     DB	 '-TRAI'
1  3031	1C6E  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3032	1C6F  1C47r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3033	      =ARRAY:1C68		 LINK=LINK$
1  3034	1C71				 DTRAI LABEL FAR  ; CFA
1  3035	1C71  1C73r			     DW	 $+2
   3036					 ; адр n1 --> адр n2 Убирает пробелы в конце строки
   3037	1C73  59				 POP  CX
   3038	1C74  5B				 POP  BX
   3039	1C75  53				 PUSH BX
   3040	1C76  03 D9				 ADD  BX, CX
   3041	1C78  4B			COMPA:	 DEC  BX
   3042	1C79  80 3F 20				 CMP  BYTE PTR [BX],  32  ; BLANK ?
   3043	1C7C  75 02				 JNE  NO
   3044	1C7E  E2 F8				 LOOP COMPA
   3045	1C80  51			NO:	 PUSH CX
   3046						 NEXT
1  3047	1C81  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3048	1C82  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3049					 ; ------ call debugger	--------
1  3050	1C84  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3051	1C88  74 06			     jz	??0052
1  3052	1C8A  E8 F2BF			     call printWORD
1  3053	1C8D  E8 F1A3			     call pause
1  3054	1C90				 ??0052:
1  3055					 ; -----------------------------
1  3056	1C90  FF 27			     JMP WORD PTR [BX]
   3057
   3058						 HEAD	  85h,'UPPE',322Q,UPPER		      ;	UPPER
1  3059	      =ARRAY:1C92		 LINK$=$
1  3060	1C92  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3061							 ; 6 - признак immediate. 5- слово не описано smudge
1  3062	1C93  55 50 50 45		     DB	 'UPPE'
1  3063	1C97  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  3064	1C98  1C68r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3065	      =ARRAY:1C92		 LINK=LINK$
1  3066	1C9A				 UPPER LABEL FAR  ; CFA
1  3067	1C9A  1C9Cr			     DW	 $+2
   3068	1C9C  59				 POP  CX		 ; число символов
   3069	1C9D  5B				 POP  BX		 ; строка
   3070	1C9E  80 3F 61			$COMP:	 CMP  BYTE PTR [BX],  61h ; a
   3071	1CA1  7C 08				 JL   OFLIM
   3072	1CA3  80 3F 7A				 CMP  BYTE PTR [BX],  7Ah ; z
   3073	1CA6  7F 03				 JG   OFLIM
   3074	1CA8  83 27 DF				 AND  WORD PTR [BX], 177737Q ; FFDF
   3075	1CAB  43			OFLIM:	 INC  BX
   3076	1CAC  E2 F0				 LOOP $COMP
   3077						 NEXT
1  3078	1CAE  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 55
forth.asm



1  3079	1CAF  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3080					 ; ------ call debugger	--------
1  3081	1CB1  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3082	1CB5  74 06			     jz	??0053
1  3083	1CB7  E8 F292			     call printWORD
1  3084	1CBA  E8 F176			     call pause
1  3085	1CBD				 ??0053:
1  3086					 ; -----------------------------
1  3087	1CBD  FF 27			     JMP WORD PTR [BX]
   3088
   3089						 HEAD	  213Q,'DEFINITION',323Q,DEFIN	    ; DEFINITIONS
1  3090	      =ARRAY:1CBF		 LINK$=$
1  3091	1CBF  8B			     DB	 213Q  ; NFA 7 бит равен 1.
1  3092							 ; 6 - признак immediate. 5- слово не описано smudge
1  3093	1CC0  44 45 46 49 4E 49	54+	     DB	 'DEFINITION'
   3094	      49 4F 4E
1  3095	1CCA  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  3096	1CCB  1C92r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3097	      =ARRAY:1CBF		 LINK=LINK$
1  3098	1CCD				 DEFIN LABEL FAR  ; CFA
1  3099	1CCD  1CCFr			     DW	 $+2
   3100					 ; Контекстный словарь становится текущим, все последующие
   3101					 ; описания связаны с этим словарем
   3102	1CCF  8B 45 28				 MOV  AX, [DI+50Q]	 ; context
   3103	1CD2  89 45 2A				 MOV  [DI+52Q],AX	 ; current
   3104						 NEXT
1  3105	1CD5  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3106	1CD6  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3107					 ; ------ call debugger	--------
1  3108	1CD8  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3109	1CDC  74 06			     jz	??0054
1  3110	1CDE  E8 F26B			     call printWORD
1  3111	1CE1  E8 F14F			     call pause
1  3112	1CE4				 ??0054:
1  3113					 ; -----------------------------
1  3114	1CE4  FF 27			     JMP WORD PTR [BX]
   3115
   3116						 HEAD	  84h,'+BU',306Q,PBUF		      ;	+BUF
1  3117	      =ARRAY:1CE6		 LINK$=$
1  3118	1CE6  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3119							 ; 6 - признак immediate. 5- слово не описано smudge
1  3120	1CE7  2B 42 55			     DB	 '+BU'
1  3121	1CEA  C6			     DB	 306Q	; последний символ слова + 128 (7 бит =	1).
1  3122	1CEB  1CBFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3123	      =ARRAY:1CE6		 LINK=LINK$
1  3124	1CED				 PBUF LABEL FAR	 ; CFA
1  3125	1CED  1CEFr			     DW	 $+2
   3126					 ;
   3127	1CEF  8B DC				 MOV  BX, SP	     ;
   3128	1CF1  36: 81 07	0404			 ADD  SS:[BX],1028   ; адрес следующего	буфера
   3129	1CF6  36: 8B 07				 MOV  AX, SS:[BX]
   3130	1CF9  39 45 18				 CMP  [DI+30Q],AX    ; LIMIT
   3131	1CFC  75 06				 JNE  PB	     ; уперлись	в адрес	лимита,	значит буфер - последний
   3132	1CFE  8B 4D 16				 MOV  CX, [DI+26Q]   ; FIRST
   3133	1D01  36: 89 0F				 MOV  SS:[BX],CX     ; переходим на первый буфер
   3134	1D04  36: FF 37			PB:	 PUSH SS:[BX]	     ; полученный адрес	буфера в стек
   3135	1D07  8B 4D 3C				 MOV  CX, [DI+74Q]   ; prev
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 56
forth.asm



   3136	1D0A  36: 29 4F	FE			 SUB  SS:[BX-2],CX   ; стек растет вниз. BX-2 сейчас  вершина стека
   3137								     ; если 0, значит адрес совпадает с	адресом	prev
   3138						 NEXT
1  3139	1D0E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3140	1D0F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3141					 ; ------ call debugger	--------
1  3142	1D11  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3143	1D15  74 06			     jz	??0055
1  3144	1D17  E8 F232			     call printWORD
1  3145	1D1A  E8 F116			     call pause
1  3146	1D1D				 ??0055:
1  3147					 ; -----------------------------
1  3148	1D1D  FF 27			     JMP WORD PTR [BX]
   3149
   3150						 HEAD	  86h,'UPDAT',305Q,UPDAT	      ;	UPDATE
1  3151	      =ARRAY:1D1F		 LINK$=$
1  3152	1D1F  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  3153							 ; 6 - признак immediate. 5- слово не описано smudge
1  3154	1D20  55 50 44 41 54		     DB	 'UPDAT'
1  3155	1D25  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3156	1D26  1CE6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3157	      =ARRAY:1D1F		 LINK=LINK$
1  3158	1D28				 UPDAT LABEL FAR  ; CFA
1  3159	1D28  1D2Ar			     DW	 $+2
   3160	1D2A  8B 5D 3C				 MOV  BX, [DI+74Q]   ; prev buffer
   3161	1D2D  0B DB				 OR BX,	BX	     ; если 0, буфер пустой
   3162	1D2F  74 04				 jz $upd
   3163	1D31  81 0F 8000			 OR  WORD PTR [BX],   100000Q  ; ставим	бит
   3164	1D35				 $upd:	 NEXT
1  3165	1D35  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3166	1D36  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3167					 ; ------ call debugger	--------
1  3168	1D38  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3169	1D3C  74 06			     jz	??0056
1  3170	1D3E  E8 F20B			     call printWORD
1  3171	1D41  E8 F0EF			     call pause
1  3172	1D44				 ??0056:
1  3173					 ; -----------------------------
1  3174	1D44  FF 27			     JMP WORD PTR [BX]
   3175
   3176						 HEAD	  81h,,330Q,X			      ;	X
1  3177	      =ARRAY:1D46		 LINK$=$
1  3178	1D46  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3179							 ; 6 - признак immediate. 5- слово не описано smudge
1  3180	1D47  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  3181	1D48  1D1Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3182	      =ARRAY:1D46		 LINK=LINK$
1  3183	1D4A				 X LABEL FAR  ;	CFA
1  3184	1D4A  1D4Cr			     DW	 $+2
   3185					 ; сброс бита сохранения буфера
   3186	1D4C  5B				 POP  BX
   3187	1D4D  81 27 7FFF			 AND WORD PTR [BX],   77777Q   ;
   3188	1D51  FF 37				 PUSH [BX]
   3189						 NEXT
1  3190	1D53  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3191	1D54  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3192					 ; ------ call debugger	--------
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 57
forth.asm



1  3193	1D56  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3194	1D5A  74 06			     jz	??0057
1  3195	1D5C  E8 F1ED			     call printWORD
1  3196	1D5F  E8 F0D1			     call pause
1  3197	1D62				 ??0057:
1  3198					 ; -----------------------------
1  3199	1D62  FF 27			     JMP WORD PTR [BX]
   3200
   3201					;	 ** Управляющие	слова **
   3202
   3203						 HEAD	  301Q,,272Q,COLON,$COL		       ; :
1  3204	      =ARRAY:1D64		 LINK$=$
1  3205	1D64  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  3206							 ; 6 - признак immediate. 5- слово не описано smudge
1  3207	1D65  BA			     DB	 272Q	; последний символ слова + 128 (7 бит =	1).
1  3208	1D66  1D46r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3209	      =ARRAY:1D64		 LINK=LINK$
1  3210	1D68				 COLON LABEL FAR  ; CFA
1  3211	1D68  1D7Cr			     DW	$COL
   3212					     ; слово для создания новых	слов из	Форта
   3213	1D6A  208Ar 1B39r 1F71r	  +		 DW QEXEC,SCSP,CURR,AT,CONT,STORE,CREAT
   3214	      1A79r 1F63r 1AB1r	  +
   3215	      243Dr
   3216	1D78  1BCFr 2114r			 DW RBRAC,PSCOD	; после	этого слова SI указывает на следующий код,
   3217								; адрес, которого попадет в CFA	создаваемого слова
   3218	1D7C				$COL	 LABEL	 FAR ; код для исполнения слов на форте	из этого исходника
   3219							     ; функция интерпретатора
   3220	1D7C  83 C5 FE				 ADD  BP, -2 ; резервируем место в стеке возвратов
   3221	1D7F  83 C3 02				 ADD  BX, 2  ; BX указывает на CFA здесь это $COL
   3222							     ; BX+2 будет указывать на адрес QEXEC
   3223	1D82  89 76 00				 MOV  [BP], SI ; сохраняем текущий указатель IP
   3224	1D85  8B F3				 MOV  SI, BX ; исполняем слово QEXEC
   3225						 NEXT
1  3226	1D87  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3227	1D88  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3228					 ; ------ call debugger	--------
1  3229	1D8A  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3230	1D8E  74 06			     jz	??0058
1  3231	1D90  E8 F1B9			     call printWORD
1  3232	1D93  E8 F09D			     call pause
1  3233	1D96				 ??0058:
1  3234					 ; -----------------------------
1  3235	1D96  FF 27			     JMP WORD PTR [BX]
   3236
   3237						 HEAD	  301Q,,273Q,SMI,$COL		       ; ;
1  3238	      =ARRAY:1D98		 LINK$=$
1  3239	1D98  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  3240							 ; 6 - признак immediate. 5- слово не описано smudge
1  3241	1D99  BB			     DB	 273Q	; последний символ слова + 128 (7 бит =	1).
1  3242	1D9A  1D64r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3243	      =ARRAY:1D98		 LINK=LINK$
1  3244	1D9C				 SMI LABEL FAR	; CFA
1  3245	1D9C  1D7Cr			     DW	$COL
   3246					     ; слово для завершения новых слов из Форта
   3247	1D9E  20B3r 20E7r 17AAr	  +		 DW QCSP,COMP,SEMI,SMUG,LBRAC,SEMI
   3248	      2100r 1BB3r 17AAr
   3249
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 58
forth.asm



   3250						 HEAD	  88h,'CONSTAN',324Q,CON,$COL	      ;	CONSTANT
1  3251	      =ARRAY:1DAA		 LINK$=$
1  3252	1DAA  88			     DB	 88h  ;	NFA 7 бит равен	1.
1  3253							 ; 6 - признак immediate. 5- слово не описано smudge
1  3254	1DAB  43 4F 4E 53 54 41	4E	     DB	 'CONSTAN'
1  3255	1DB2  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3256	1DB3  1D98r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3257	      =ARRAY:1DAA		 LINK=LINK$
1  3258	1DB5				 CON LABEL FAR	; CFA
1  3259	1DB5  1D7Cr			     DW	$COL
   3260	1DB7  243Dr 2100r 2013r	  +		 DW CREAT,SMUG,COMMA,PSCOD		      ;
   3261	      2114r
   3262	1DBF				$CON	 LABEL	 FAR
   3263	1DBF  83 C3 02				 ADD  BX, 2 ; аналогично переменной
   3264	1DC2  FF 37				 PUSH [BX]  ; вместо адреса пишем значение по этому адресу PFA
   3265						 NEXT
1  3266	1DC4  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3267	1DC5  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3268					 ; ------ call debugger	--------
1  3269	1DC7  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3270	1DCB  74 06			     jz	??0059
1  3271	1DCD  E8 F17C			     call printWORD
1  3272	1DD0  E8 F060			     call pause
1  3273	1DD3				 ??0059:
1  3274					 ; -----------------------------
1  3275	1DD3  FF 27			     JMP WORD PTR [BX]
   3276
   3277						 HEAD	  88h, 'VARIABL',305Q,VAR,$COL	      ;	VARIABLE
1  3278	      =ARRAY:1DD5		 LINK$=$
1  3279	1DD5  88			     DB	 88h  ;	NFA 7 бит равен	1.
1  3280							 ; 6 - признак immediate. 5- слово не описано smudge
1  3281	1DD6  56 41 52 49 41 42	4C	     DB	 'VARIABL'
1  3282	1DDD  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3283	1DDE  1DAAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3284	      =ARRAY:1DD5		 LINK=LINK$
1  3285	1DE0				 VAR LABEL FAR	; CFA
1  3286	1DE0  1D7Cr			     DW	$COL
   3287	1DE2  1DB5r 2114r			 DW CON,PSCOD
   3288	1DE6				$VAR	 LABEL	 FAR
   3289	1DE6  83 C3 02				 ADD  BX, 2  ; BX указывает на CFA ($COL)
   3290							     ; BX+2 пропускает поле CFA
   3291	1DE9  53				 PUSH BX     ; в BX находится адрес переменной PFA (CON)
   3292						 NEXT
1  3293	1DEA  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3294	1DEB  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3295					 ; ------ call debugger	--------
1  3296	1DED  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3297	1DF1  74 06			     jz	??005A
1  3298	1DF3  E8 F156			     call printWORD
1  3299	1DF6  E8 F03A			     call pause
1  3300	1DF9				 ??005A:
1  3301					 ; -----------------------------
1  3302	1DF9  FF 27			     JMP WORD PTR [BX]
   3303
   3304						 HEAD	  84h,'USE',322Q,USER, $COL	      ;	USER
1  3305	      =ARRAY:1DFB		 LINK$=$
1  3306	1DFB  84			     DB	 84h  ;	NFA 7 бит равен	1.
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 59
forth.asm



1  3307							 ; 6 - признак immediate. 5- слово не описано smudge
1  3308	1DFC  55 53 45			     DB	 'USE'
1  3309	1DFF  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  3310	1E00  1DD5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3311	      =ARRAY:1DFB		 LINK=LINK$
1  3312	1E02				 USER LABEL FAR	 ; CFA
1  3313	1E02  1D7Cr			     DW	$COL
   3314	1E04  1DB5r 2114r			 DW CON,PSCOD
   3315	1E08				$USE	 LABEL	 FAR
   3316	1E08  83 C3 02				 ADD  BX, 2
   3317	1E0B  8B 07				 MOV  AX, [BX] ; берем смещение	из PFA
   3318	1E0D  03 C7				 ADD  AX, DI  ;	вычисляем смещение
   3319	1E0F  50				 PUSH AX ; полученный адрес в стек
   3320						 NEXT
1  3321	1E10  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3322	1E11  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3323					 ; ------ call debugger	--------
1  3324	1E13  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3325	1E17  74 06			     jz	??005B
1  3326	1E19  E8 F130			     call printWORD
1  3327	1E1C  E8 F014			     call pause
1  3328	1E1F				 ??005B:
1  3329					 ; -----------------------------
1  3330	1E1F  FF 27			     JMP WORD PTR [BX]
   3331
   3332						 HEAD	  85h,'DOES',276Q,DOES,$COL	      ;	DOES>
1  3333	      =ARRAY:1E21		 LINK$=$
1  3334	1E21  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3335							 ; 6 - признак immediate. 5- слово не описано smudge
1  3336	1E22  44 4F 45 53		     DB	 'DOES'
1  3337	1E26  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1  3338	1E27  1DFBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3339	      =ARRAY:1E21		 LINK=LINK$
1  3340	1E29				 DOES LABEL FAR	 ; CFA
1  3341	1E29  1D7Cr			     DW	$COL
   3342					 ; запись в адрес PFA слова в словаре адреса кода,
   3343					 ; который следует за DOES>. В CFA пишется адрес кода,
   3344					 ; следующего за PSCOD,	т.е. $DOE
   3345	1E2B  1807r 1C50r 2046r	  +		 DW  FROMR,LATES,PFA,STORE,PSCOD
   3346	      1AB1r 2114r
   3347	1E35				$DOE	 LABEL	 FAR ; здесь используется только в FORTH
   3348	1E35  83 ED 02				 SUB  BP,  2   ; резервируем место в RS
   3349	1E38  89 76 00				 MOV  [BP], SI ; сохраняем SI адрес следующего слова
   3350	1E3B  83 C3 02				 ADD  BX, 2    ; BX+2 это PFA исполняемого слова (FORTH)
   3351	1E3E  8B 37				 MOV  SI, [BX] ; там лежит адрес слова DOVOC
   3352	1E40  83 C3 02				 ADD  BX, 2    ; адрес параметра PFA+2 для DOVOC (120201Q)
   3353	1E43  53				 PUSH BX       ; в стек
   3354						 NEXT	       ; исполняется слово DOVOC (по адресу PFA)
1  3355	1E44  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3356	1E45  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3357					 ; ------ call debugger	--------
1  3358	1E47  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3359	1E4B  74 06			     jz	??005C
1  3360	1E4D  E8 F0FC			     call printWORD
1  3361	1E50  E8 EFE0			     call pause
1  3362	1E53				 ??005C:
1  3363					 ; -----------------------------
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 60
forth.asm



1  3364	1E53  FF 27			     JMP WORD PTR [BX]
   3365
   3366						 HEAD	  83h,'BY','E'+80h,BYE			; BYE
1  3367	      =ARRAY:1E55		 LINK$=$
1  3368	1E55  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3369							 ; 6 - признак immediate. 5- слово не описано smudge
1  3370	1E56  42 59			     DB	 'BY'
1  3371	1E58  C5			     DB	 'E'+80h   ; последний символ слова + 128 (7 бит = 1).
1  3372	1E59  1E21r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3373	      =ARRAY:1E55		 LINK=LINK$
1  3374	1E5B				 BYE LABEL FAR	; CFA
1  3375	1E5B  1E5Dr			     DW	 $+2
   3376	1E5D  B4 4C				 mov ah, 4ch
   3377	1E5F  CD 21				 int 21h
   3378
   3379					;	 ** Константы **
   3380
   3381						 HEAD	  81h,,260Q,ZERO,$CON		      ;	0
1  3382	      =ARRAY:1E61		 LINK$=$
1  3383	1E61  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3384							 ; 6 - признак immediate. 5- слово не описано smudge
1  3385	1E62  B0			     DB	 260Q	; последний символ слова + 128 (7 бит =	1).
1  3386	1E63  1E55r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3387	      =ARRAY:1E61		 LINK=LINK$
1  3388	1E65				 ZERO LABEL FAR	 ; CFA
1  3389	1E65  1DBFr			     DW	$CON
   3390	1E67  0000				 DW 0
   3391
   3392						 HEAD	  81h,,261Q,ONE,$CON		      ;	1
1  3393	      =ARRAY:1E69		 LINK$=$
1  3394	1E69  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3395							 ; 6 - признак immediate. 5- слово не описано smudge
1  3396	1E6A  B1			     DB	 261Q	; последний символ слова + 128 (7 бит =	1).
1  3397	1E6B  1E61r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3398	      =ARRAY:1E69		 LINK=LINK$
1  3399	1E6D				 ONE LABEL FAR	; CFA
1  3400	1E6D  1DBFr			     DW	$CON
   3401	1E6F  0001				 DW 1
   3402
   3403						 HEAD	  81h,,262Q,TWO,$CON		      ;	2
1  3404	      =ARRAY:1E71		 LINK$=$
1  3405	1E71  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3406							 ; 6 - признак immediate. 5- слово не описано smudge
1  3407	1E72  B2			     DB	 262Q	; последний символ слова + 128 (7 бит =	1).
1  3408	1E73  1E69r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3409	      =ARRAY:1E71		 LINK=LINK$
1  3410	1E75				 TWO LABEL FAR	; CFA
1  3411	1E75  1DBFr			     DW	$CON
   3412	1E77  0002				 DW 2
   3413
   3414						 HEAD	  81h,,263Q,THREE,$CON		      ;	3
1  3415	      =ARRAY:1E79		 LINK$=$
1  3416	1E79  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3417							 ; 6 - признак immediate. 5- слово не описано smudge
1  3418	1E7A  B3			     DB	 263Q	; последний символ слова + 128 (7 бит =	1).
1  3419	1E7B  1E71r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3420	      =ARRAY:1E79		 LINK=LINK$
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 61
forth.asm



1  3421	1E7D				 THREE LABEL FAR  ; CFA
1  3422	1E7D  1DBFr			     DW	$CON
   3423	1E7F  0003				 DW 3
   3424
   3425						 HEAD	  81h,,270Q,EIGHT, $CON		      ;	8
1  3426	      =ARRAY:1E81		 LINK$=$
1  3427	1E81  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3428							 ; 6 - признак immediate. 5- слово не описано smudge
1  3429	1E82  B8			     DB	 270Q	; последний символ слова + 128 (7 бит =	1).
1  3430	1E83  1E79r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3431	      =ARRAY:1E81		 LINK=LINK$
1  3432	1E85				 EIGHT LABEL FAR  ; CFA
1  3433	1E85  1DBFr			     DW	$CON
   3434	1E87  0008				 DW 8
   3435
   3436						 HEAD	  82h,'B',314Q,BLAN,$CON	      ;	BL
1  3437	      =ARRAY:1E89		 LINK$=$
1  3438	1E89  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3439							 ; 6 - признак immediate. 5- слово не описано smudge
1  3440	1E8A  42			     DB	 'B'
1  3441	1E8B  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3442	1E8C  1E81r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3443	      =ARRAY:1E89		 LINK=LINK$
1  3444	1E8E				 BLAN LABEL FAR	 ; CFA
1  3445	1E8E  1DBFr			     DW	$CON
   3446	1E90  0020				 DW 32
   3447
   3448						 HEAD	  82h,'C',314Q,$CL,$CON		      ;	C/L
1  3449	      =ARRAY:1E92		 LINK$=$
1  3450	1E92  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3451							 ; 6 - признак immediate. 5- слово не описано smudge
1  3452	1E93  43			     DB	 'C'
1  3453	1E94  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3454	1E95  1E89r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3455	      =ARRAY:1E92		 LINK=LINK$
1  3456	1E97				 $CL LABEL FAR	; CFA
1  3457	1E97  1DBFr			     DW	$CON
   3458	1E99  0040				 DW 64	 ;CHAR#	PER LINE
   3459
   3460						 HEAD	  82h,'1',313Q,BBUF,$CON	      ;	BBUF
1  3461	      =ARRAY:1E9B		 LINK$=$
1  3462	1E9B  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3463							 ; 6 - признак immediate. 5- слово не описано smudge
1  3464	1E9C  31			     DB	 '1'
1  3465	1E9D  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  3466	1E9E  1E92r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3467	      =ARRAY:1E9B		 LINK=LINK$
1  3468	1EA0				 BBUF LABEL FAR	 ; CFA
1  3469	1EA0  1DBFr			     DW	$CON
   3470	1EA2  0400				 DW 1024 ; длина буфера
   3471
   3472						 ;** USER-переменные **
   3473
   3474						 HEAD	  82h,'S',260Q,SZERO,$USE	      ;	SO
1  3475	      =ARRAY:1EA4		 LINK$=$
1  3476	1EA4  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3477							 ; 6 - признак immediate. 5- слово не описано smudge
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 62
forth.asm



1  3478	1EA5  53			     DB	 'S'
1  3479	1EA6  B0			     DB	 260Q	; последний символ слова + 128 (7 бит =	1).
1  3480	1EA7  1E9Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3481	      =ARRAY:1EA4		 LINK=LINK$
1  3482	1EA9				 SZERO LABEL FAR  ; CFA
1  3483	1EA9  1E08r			     DW	$USE
   3484	1EAB  0006				 DW 6 ;	Указатель начала стека параметров
   3485
   3486						 HEAD	  82h,'R',260Q,RZERO,$USE	      ;	RO
1  3487	      =ARRAY:1EAD		 LINK$=$
1  3488	1EAD  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3489							 ; 6 - признак immediate. 5- слово не описано smudge
1  3490	1EAE  52			     DB	 'R'
1  3491	1EAF  B0			     DB	 260Q	; последний символ слова + 128 (7 бит =	1).
1  3492	1EB0  1EA4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3493	      =ARRAY:1EAD		 LINK=LINK$
1  3494	1EB2				 RZERO LABEL FAR  ; CFA
1  3495	1EB2  1E08r			     DW	$USE
   3496	1EB4  0008				 DW 8  ; Указатель начала стека	возврата
   3497
   3498						 HEAD	  83h, 'TI',302Q,TIB,$USE	      ;	TIB
1  3499	      =ARRAY:1EB6		 LINK$=$
1  3500	1EB6  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3501							 ; 6 - признак immediate. 5- слово не описано smudge
1  3502	1EB7  54 49			     DB	 'TI'
1  3503	1EB9  C2			     DB	 302Q	; последний символ слова + 128 (7 бит =	1).
1  3504	1EBA  1EADr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3505	      =ARRAY:1EB6		 LINK=LINK$
1  3506	1EBC				 TIB LABEL FAR	; CFA
1  3507	1EBC  1E08r			     DW	$USE
   3508	1EBE  000A				 DW 12Q	 ;Входной буфер	терминала 10
   3509
   3510						 HEAD	  85h,'WIDT',310Q,$WIDTH,$USE	      ;	WIDTH
1  3511	      =ARRAY:1EC0		 LINK$=$
1  3512	1EC0  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3513							 ; 6 - признак immediate. 5- слово не описано smudge
1  3514	1EC1  57 49 44 54		     DB	 'WIDT'
1  3515	1EC5  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1  3516	1EC6  1EB6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3517	      =ARRAY:1EC0		 LINK=LINK$
1  3518	1EC8				 $WIDTH	LABEL FAR  ; CFA
1  3519	1EC8  1E08r			     DW	$USE
   3520	1ECA  000C				 DW 14Q	; Определяет максимальную длину	имени в	словаре
   3521
   3522						 HEAD	  87h,'WARNIN',307Q,$WARN,$USE	      ;	WARNING
1  3523	      =ARRAY:1ECC		 LINK$=$
1  3524	1ECC  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  3525							 ; 6 - признак immediate. 5- слово не описано smudge
1  3526	1ECD  57 41 52 4E 49 4E		     DB	 'WARNIN'
1  3527	1ED3  C7			     DB	 307Q	; последний символ слова + 128 (7 бит =	1).
1  3528	1ED4  1EC0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3529	      =ARRAY:1ECC		 LINK=LINK$
1  3530	1ED6				 $WARN LABEL FAR  ; CFA
1  3531	1ED6  1E08r			     DW	$USE
   3532	1ED8  000E				 DW 16Q	 ;  при	0 только код ошибки выводится
   3533
   3534						 HEAD	  85h,'FENC',305Q,FENCE,$USE	      ;	FENCE
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 63
forth.asm



1  3535	      =ARRAY:1EDA		 LINK$=$
1  3536	1EDA  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3537							 ; 6 - признак immediate. 5- слово не описано smudge
1  3538	1EDB  46 45 4E 43		     DB	 'FENC'
1  3539	1EDF  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3540	1EE0  1ECCr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3541	      =ARRAY:1EDA		 LINK=LINK$
1  3542	1EE2				 FENCE LABEL FAR  ; CFA
1  3543	1EE2  1E08r			     DW	$USE
   3544	1EE4  0010				 DW 20Q	; FENCE	указывает верхний край базового	словаря
   3545						 ; FENCE  (ограда) служит  для	защиты	базового словаря
   3546						 ; от стирания с помощью оператора FORGET,  указывает адрес,
   3547						 ; предшествующий первой  свободной  ячейке  в словаре сразу
   3548						 ; после загрузки системы Форт,	т.е. при этом FENCE @ равно HERE-2
   3549
   3550						 HEAD	  82h,'D',320Q,$DP,$USE		      ;	DP
1  3551	      =ARRAY:1EE6		 LINK$=$
1  3552	1EE6  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3553							 ; 6 - признак immediate. 5- слово не описано smudge
1  3554	1EE7  44			     DB	 'D'
1  3555	1EE8  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  3556	1EE9  1EDAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3557	      =ARRAY:1EE6		 LINK=LINK$
1  3558	1EEB				 $DP LABEL FAR	; CFA
1  3559	1EEB  1E08r			     DW	$USE
   3560	1EED  0012				 DW 22Q	; указывает на первую свободную	ячейку словаря (DP @ = HERE)
   3561
   3562						 HEAD	  84h,'VOC',314Q,VOCL,$USE	      ;	VOCL
1  3563	      =ARRAY:1EEF		 LINK$=$
1  3564	1EEF  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3565							 ; 6 - признак immediate. 5- слово не описано smudge
1  3566	1EF0  56 4F 43			     DB	 'VOC'
1  3567	1EF3  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3568	1EF4  1EE6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3569	      =ARRAY:1EEF		 LINK=LINK$
1  3570	1EF6				 VOCL LABEL FAR	 ; CFA
1  3571	1EF6  1E08r			     DW	$USE
   3572						 ; хранится адрес XVOC
   3573	1EF8  0014				 DW 24Q	; переменная  связи контекстных	словарей.
   3574
   3575						 HEAD	  85h,'FIRS',324Q,FIRST,$USE	      ;	FIRST
1  3576	      =ARRAY:1EFA		 LINK$=$
1  3577	1EFA  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3578							 ; 6 - признак immediate. 5- слово не описано smudge
1  3579	1EFB  46 49 52 53		     DB	 'FIRS'
1  3580	1EFF  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3581	1F00  1EEFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3582	      =ARRAY:1EFA		 LINK=LINK$
1  3583	1F02				 FIRST LABEL FAR  ; CFA
1  3584	1F02  1E08r			     DW	$USE
   3585	1F04  0016				 DW 26Q	; адрес	первого	байта экранных буферов
   3586
   3587						 HEAD	  85h,'LIMI',324Q,LIMIT,$USE	      ;	LIMIT
1  3588	      =ARRAY:1F06		 LINK$=$
1  3589	1F06  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3590							 ; 6 - признак immediate. 5- слово не описано smudge
1  3591	1F07  4C 49 4D 49		     DB	 'LIMI'
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 64
forth.asm



1  3592	1F0B  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3593	1F0C  1EFAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3594	      =ARRAY:1F06		 LINK=LINK$
1  3595	1F0E				 LIMIT LABEL FAR  ; CFA
1  3596	1F0E  1E08r			     DW	$USE
   3597	1F10  0018				 DW 30Q	; указатель конца экранных буферов и некоторые другие
   3598
   3599						 HEAD	  83h,'AT',322Q,ATR,$USE	      ;	ATR
1  3600	      =ARRAY:1F12		 LINK$=$
1  3601	1F12  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3602							 ; 6 - признак immediate. 5- слово не описано smudge
1  3603	1F13  41 54			     DB	 'AT'
1  3604	1F15  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  3605	1F16  1F06r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3606	      =ARRAY:1F12		 LINK=LINK$
1  3607	1F18				 ATR LABEL FAR	; CFA
1  3608	1F18  1E08r			     DW	$USE
   3609	1F1A  001A				 DW 32Q		 ;Атрибут
   3610
   3611						 HEAD	  82h,'P',307Q,PG,$USE		      ;	PG
1  3612	      =ARRAY:1F1C		 LINK$=$
1  3613	1F1C  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3614							 ; 6 - признак immediate. 5- слово не описано smudge
1  3615	1F1D  50			     DB	 'P'
1  3616	1F1E  C7			     DB	 307Q	; последний символ слова + 128 (7 бит =	1).
1  3617	1F1F  1F12r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3618	      =ARRAY:1F1C		 LINK=LINK$
1  3619	1F21				 PG LABEL FAR  ; CFA
1  3620	1F21  1E08r			     DW	$USE
   3621	1F23  001C				 DW 34Q		 ; Текущая страница
   3622
   3623						 HEAD	  83h,'BL',313Q,BLK,$USE	      ;	BLK
1  3624	      =ARRAY:1F25		 LINK$=$
1  3625	1F25  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3626							 ; 6 - признак immediate. 5- слово не описано smudge
1  3627	1F26  42 4C			     DB	 'BL'
1  3628	1F28  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  3629	1F29  1F1Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3630	      =ARRAY:1F25		 LINK=LINK$
1  3631	1F2B				 BLK LABEL FAR	; CFA
1  3632	1F2B  1E08r			     DW	$USE
   3633	1F2D  001E				 DW 36Q	; 0  для  входного  буфера  и  номеру экрана
   3634							; в противном  случае
   3635
   3636						 HEAD	  82h,'I',316Q,$IN,$USE		      ;	IN
1  3637	      =ARRAY:1F2F		 LINK$=$
1  3638	1F2F  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3639							 ; 6 - признак immediate. 5- слово не описано smudge
1  3640	1F30  49			     DB	 'I'
1  3641	1F31  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  3642	1F32  1F25r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3643	      =ARRAY:1F2F		 LINK=LINK$
1  3644	1F34				 $IN LABEL FAR	; CFA
1  3645	1F34  1E08r			     DW	$USE
   3646	1F36  0020				 DW 40Q	; внутренний   указатель   входного   буфера
   3647
   3648						 HEAD	  83h,'PN',324Q,PNT,$USE	      ;	PNT
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 65
forth.asm



1  3649	      =ARRAY:1F38		 LINK$=$
1  3650	1F38  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3651							 ; 6 - признак immediate. 5- слово не описано smudge
1  3652	1F39  50 4E			     DB	 'PN'
1  3653	1F3B  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3654	1F3C  1F2Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3655	      =ARRAY:1F38		 LINK=LINK$
1  3656	1F3E				 PNT LABEL FAR	; CFA
1  3657	1F3E  1E08r			     DW	$USE
   3658	1F40  0022				 DW 42Q		 ;Флаг-печати
   3659
   3660						 HEAD	  83h,'SC',322Q,SCR,$USE	      ;	SCR
1  3661	      =ARRAY:1F42		 LINK$=$
1  3662	1F42  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3663							 ; 6 - признак immediate. 5- слово не описано smudge
1  3664	1F43  53 43			     DB	 'SC'
1  3665	1F45  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  3666	1F46  1F38r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3667	      =ARRAY:1F42		 LINK=LINK$
1  3668	1F48				 SCR LABEL FAR	; CFA
1  3669	1F48  1E08r			     DW	$USE
   3670	1F4A  0024				 DW 44Q	; для хранения текущего	значения номера	экрана
   3671							 ; только в list
   3672
   3673						 HEAD	  86h,'OFFSE',324Q,OFSET,$USE	     ; OFFSET
1  3674	      =ARRAY:1F4C		 LINK$=$
1  3675	1F4C  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  3676							 ; 6 - признак immediate. 5- слово не описано smudge
1  3677	1F4D  4F 46 46 53 45		     DB	 'OFFSE'
1  3678	1F52  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3679	1F53  1F42r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3680	      =ARRAY:1F4C		 LINK=LINK$
1  3681	1F55				 OFSET LABEL FAR  ; CFA
1  3682	1F55  1E08r			     DW	$USE
   3683	1F57  0026				 DW 46Q	; Диагностические сообщения обычно размещаются
   3684						     ; на экранах 4 и 5. Если это не так, задачу можно решить,
   3685						     ; поменяв значение	OFFSET или исправив число, стоящее
   3686						     ; перед OFFSET в описании MESSAGE
   3687
   3688						 HEAD	  87h,'CONTEX',324Q,CONT,$USE	      ;	CONTEXT
1  3689	      =ARRAY:1F59		 LINK$=$
1  3690	1F59  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  3691							 ; 6 - признак immediate. 5- слово не описано smudge
1  3692	1F5A  43 4F 4E 54 45 58		     DB	 'CONTEX'
1  3693	1F60  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3694	1F61  1F4Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3695	      =ARRAY:1F59		 LINK=LINK$
1  3696	1F63				 CONT LABEL FAR	 ; CFA
1  3697	1F63  1E08r			     DW	$USE
   3698					 ; Пребывание в	том  или ином  словаре	контролируется системной переменной
   3699					 ; CONTEXT,  в которой хранится	 ссылка	 на  адрес  последнего	слова,
   3700					 ; описанного  в  данном (контекстном) словаре.
   3701	1F65  0028				 DW 50Q	; Указатель, с какого словаря следует начинать просмотр
   3702							; при интерпретации
   3703
   3704						 HEAD	 87h, 'CURREN',324Q,CURR,$USE	     ; CURRENT
1  3705	      =ARRAY:1F67		 LINK$=$
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 66
forth.asm



1  3706	1F67  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  3707							 ; 6 - признак immediate. 5- слово не описано smudge
1  3708	1F68  43 55 52 52 45 4E		     DB	 'CURREN'
1  3709	1F6E  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3710	1F6F  1F59r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3711	      =ARRAY:1F67		 LINK=LINK$
1  3712	1F71				 CURR LABEL FAR	 ; CFA
1  3713	1F71  1E08r			     DW	$USE
   3714	1F73  002A				 DW 52Q	 ; хранящая ссылку в слове Словаря на последнее	слово,
   3715							 ; описанное в текущем Словаре.	очевидно, что
   3716							 ; текущий Словарь может не совпадать с	контекстным
   3717							 ; это же адрес	latest
   3718
   3719						 HEAD	  85h,'STAT',305Q,STATE,$USE	      ;	STATE
1  3720	      =ARRAY:1F75		 LINK$=$
1  3721	1F75  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3722							 ; 6 - признак immediate. 5- слово не описано smudge
1  3723	1F76  53 54 41 54		     DB	 'STAT'
1  3724	1F7A  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3725	1F7B  1F67r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3726	      =ARRAY:1F75		 LINK=LINK$
1  3727	1F7D				 STATE LABEL FAR  ; CFA
1  3728	1F7D  1E08r			     DW	$USE
   3729	1F7F  002C				 DW 54Q	 ; 0=> Исполнение
   3730
   3731						 HEAD	  84h,'BAS',305Q,BASE,$USE	      ;	BASE
1  3732	      =ARRAY:1F81		 LINK$=$
1  3733	1F81  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3734							 ; 6 - признак immediate. 5- слово не описано smudge
1  3735	1F82  42 41 53			     DB	 'BAS'
1  3736	1F85  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3737	1F86  1F75r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3738	      =ARRAY:1F81		 LINK=LINK$
1  3739	1F88				 BASE LABEL FAR	 ; CFA
1  3740	1F88  1E08r			     DW	$USE
   3741	1F8A  002E				 DW 56Q	 ; система исчисления
   3742
   3743						 HEAD	  83h,'DP',314Q,DPL,$USE	      ;	DPL
1  3744	      =ARRAY:1F8C		 LINK$=$
1  3745	1F8C  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3746							 ; 6 - признак immediate. 5- слово не описано smudge
1  3747	1F8D  44 50			     DB	 'DP'
1  3748	1F8F  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3749	1F90  1F81r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3750	      =ARRAY:1F8C		 LINK=LINK$
1  3751	1F92				 DPL LABEL FAR	; CFA
1  3752	1F92  1E08r			     DW	$USE
   3753	1F94  0030				 DW 60Q	; DPL определяет положение десятичной запятой (во входном
   3754							; представлении	это точка), для	чисел одинарной	длины DPL=-1.
   3755
   3756						 HEAD	  83h,'CS',320Q,CSP,$USE	      ;	CSP
1  3757	      =ARRAY:1F96		 LINK$=$
1  3758	1F96  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3759							 ; 6 - признак immediate. 5- слово не описано smudge
1  3760	1F97  43 53			     DB	 'CS'
1  3761	1F99  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  3762	1F9A  1F8Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 67
forth.asm



1  3763	      =ARRAY:1F96		 LINK=LINK$
1  3764	1F9C				 CSP LABEL FAR	; CFA
1  3765	1F9C  1E08r			     DW	$USE
   3766	1F9E  0034				 DW 64Q
   3767
   3768						 HEAD	  82h,'R',243Q,RNUM,$USE	      ;	R#
1  3769	      =ARRAY:1FA0		 LINK$=$
1  3770	1FA0  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3771							 ; 6 - признак immediate. 5- слово не описано smudge
1  3772	1FA1  52			     DB	 'R'
1  3773	1FA2  A3			     DB	 243Q	; последний символ слова + 128 (7 бит =	1).
1  3774	1FA3  1F96r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3775	      =ARRAY:1FA0		 LINK=LINK$
1  3776	1FA5				 RNUM LABEL FAR	 ; CFA
1  3777	1FA5  1E08r			     DW	$USE
   3778	1FA7  0036				 DW 66Q	; указатель  положения	курсора	 на  экране
   3779
   3780						 HEAD	  83h,'HL',304Q,HLD,$USE	      ;	HLD
1  3781	      =ARRAY:1FA9		 LINK$=$
1  3782	1FA9  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3783							 ; 6 - признак immediate. 5- слово не описано smudge
1  3784	1FAA  48 4C			     DB	 'HL'
1  3785	1FAC  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  3786	1FAD  1FA0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3787	      =ARRAY:1FA9		 LINK=LINK$
1  3788	1FAF				 HLD LABEL FAR	; CFA
1  3789	1FAF  1E08r			     DW	$USE
   3790	1FB1  0038				 DW 70Q	; которая является указателем позиции
   3791							; в выходном буфере (обычно PAD)
   3792
   3793						 HEAD	  83h,'US',305Q,USE,$USE	      ;	USE
1  3794	      =ARRAY:1FB3		 LINK$=$
1  3795	1FB3  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3796							 ; 6 - признак immediate. 5- слово не описано smudge
1  3797	1FB4  55 53			     DB	 'US'
1  3798	1FB6  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3799	1FB7  1FA9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3800	      =ARRAY:1FB3		 LINK=LINK$
1  3801	1FB9				 USE LABEL FAR	; CFA
1  3802	1FB9  1E08r			     DW	$USE
   3803	1FBB  003A				 DW 72Q	;
   3804						 ; A variable containing the address of	the block buffer to use	next,
   3805						 ; as the least	recently written.
   3806
   3807						 HEAD	  84h,'PRE',326Q,PREV,$USE	      ;	PREV
1  3808	      =ARRAY:1FBD		 LINK$=$
1  3809	1FBD  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3810							 ; 6 - признак immediate. 5- слово не описано smudge
1  3811	1FBE  50 52 45			     DB	 'PRE'
1  3812	1FC1  D6			     DB	 326Q	; последний символ слова + 128 (7 бит =	1).
1  3813	1FC2  1FB3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3814	      =ARRAY:1FBD		 LINK=LINK$
1  3815	1FC4				 PREV LABEL FAR	 ; CFA
1  3816	1FC4  1E08r			     DW	$USE
   3817	1FC6  003C				 DW 74Q	; адрес	экранного блока
   3818						 ; A variable containing the address of	the disc buffer	most recently
   3819						 ; referenced. The UPDATE command marks	this buffer to be later	written
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 68
forth.asm



   3820						 ; to disc.
   3821
   3822						 HEAD	  83h,'$E',330Q,$EX,$USE	      ;	EXP
1  3823	      =ARRAY:1FC8		 LINK$=$
1  3824	1FC8  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3825							 ; 6 - признак immediate. 5- слово не описано smudge
1  3826	1FC9  24 45			     DB	 '$E'
1  3827	1FCB  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  3828	1FCC  1FBDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3829	      =ARRAY:1FC8		 LINK=LINK$
1  3830	1FCE				 $EX LABEL FAR	; CFA
1  3831	1FCE  1E08r			     DW	$USE
   3832	1FD0  003E				 DW 76Q	 ; целочисленное значение  порядка  числа,
   3833							 ; который  следует  за	признаком Е
   3834
   3835						 HEAD	  83h,'ER',302Q,ERB,$USE	      ;	ERB
1  3836	      =ARRAY:1FD2		 LINK$=$
1  3837	1FD2  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3838							 ; 6 - признак immediate. 5- слово не описано smudge
1  3839	1FD3  45 52			     DB	 'ER'
1  3840	1FD5  C2			     DB	 302Q	; последний символ слова + 128 (7 бит =	1).
1  3841	1FD6  1FC8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3842	      =ARRAY:1FD2		 LINK=LINK$
1  3843	1FD8				 ERB LABEL FAR	; CFA
1  3844	1FD8  1E08r			     DW	$USE
   3845	1FDA  0040				 DW 100Q ; 64d 40h
   3846						 ; Если	ERB=0,	ERROR  работает	 обычным  образом,  в противном	случае
   3847						 ; переменная ERB обнуляется,  а уход из  программы  в	Форт  через  QUIT
   3848						 ; блокируется.
   3849
   3850						 HEAD	  83h,'DE','B'+80h,DEB,$USE		 ; DEB
1  3851	      =ARRAY:1FDC		 LINK$=$
1  3852	1FDC  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3853							 ; 6 - признак immediate. 5- слово не описано smudge
1  3854	1FDD  44 45			     DB	 'DE'
1  3855	1FDF  C2			     DB	 'B'+80h   ; последний символ слова + 128 (7 бит = 1).
1  3856	1FE0  1FD2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3857	      =ARRAY:1FDC		 LINK=LINK$
1  3858	1FE2				 DEB LABEL FAR	; CFA
1  3859	1FE2  1E08r			     DW	$USE
   3860	1FE4  0042				 DW 102Q  ; признак отладки
   3861							 ;
   3862
   3863					     ;** Слова высокого	уровня **
   3864
   3865						 HEAD	  85h,'?TER',315Q,?TERM,$COL	      ;	?TERM
1  3866	      =ARRAY:1FE6		 LINK$=$
1  3867	1FE6  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3868							 ; 6 - признак immediate. 5- слово не описано smudge
1  3869	1FE7  3F 54 45 52		     DB	 '?TER'
1  3870	1FEB  CD			     DB	 315Q	; последний символ слова + 128 (7 бит =	1).
1  3871	1FEC  1FDCr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3872	      =ARRAY:1FE6		 LINK=LINK$
1  3873	1FEE				 ?TERM LABEL FAR  ; CFA
1  3874	1FEE  1D7Cr			     DW	$COL
   3875					 ; вывод в стек	кода символа из	буфера клавиатуры без ожидания нажатия
   3876	1FF0  144Fr 0FCEr 00FF	  +		 DW ?TER$,LIT,377Q,$AND,SEMI
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 69
forth.asm



   3877	      16C8r 17AAr
   3878
   3879						 HEAD	  82h,'C',322Q,CR,$COL		      ;	CR
1  3880	      =ARRAY:1FFA		 LINK$=$
1  3881	1FFA  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3882							 ; 6 - признак immediate. 5- слово не описано smudge
1  3883	1FFB  43			     DB	 'C'
1  3884	1FFC  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  3885	1FFD  1FE6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3886	      =ARRAY:1FFA		 LINK=LINK$
1  3887	1FFF				 CR LABEL FAR  ; CFA
1  3888	1FFF  1D7Cr			     DW	$COL
   3889					 ; вывод символов 0D 0A
   3890	2001  0FCEr 000D 12E2r	  +		 DW LIT,15Q,EMIT,LIT,12Q,EMIT,SEMI
   3891	      0FCEr 000A 12E2r	  +
   3892	      17AAr
   3893
   3894						 HEAD	  81h,,254Q,COMMA,$COL		      ;	,
1  3895	      =ARRAY:200F		 LINK$=$
1  3896	200F  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3897							 ; 6 - признак immediate. 5- слово не описано smudge
1  3898	2010  AC			     DB	 254Q	; последний символ слова + 128 (7 бит =	1).
1  3899	2011  1FFAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3900	      =ARRAY:200F		 LINK=LINK$
1  3901	2013				 COMMA LABEL FAR  ; CFA
1  3902	2013  1D7Cr			     DW	$COL
   3903					 ; в  свободную	ячейку словаря помещяем	число из стека и
   3904					 ;  занимаем эту ячейку	(смещаем указатель here)
   3905	2015  1B56r 1AB1r 1E75r	  +		 DW HERE,STORE,TWO,ALLOT,SEMI
   3906	      1B74r 17AAr
   3907
   3908						 HEAD	  82h,'C',254Q,CCOM,$COL	      ;	C,
1  3909	      =ARRAY:201F		 LINK$=$
1  3910	201F  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3911							 ; 6 - признак immediate. 5- слово не описано smudge
1  3912	2020  43			     DB	 'C'
1  3913	2021  AC			     DB	 254Q	; последний символ слова + 128 (7 бит =	1).
1  3914	2022  200Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3915	      =ARRAY:201F		 LINK=LINK$
1  3916	2024				 CCOM LABEL FAR	 ; CFA
1  3917	2024  1D7Cr			     DW	$COL
   3918	2026  1B56r 1ACDr 1E6Dr	  +		 DW HERE,CSTOR,ONE,ALLOT,SEMI
   3919	      1B74r 17AAr
   3920
   3921						 HEAD	   85h,'SPAC',305Q,SPACE,$COL	      ;	SPACE
1  3922	      =ARRAY:2030		 LINK$=$
1  3923	2030  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3924							 ; 6 - признак immediate. 5- слово не описано smudge
1  3925	2031  53 50 41 43		     DB	 'SPAC'
1  3926	2035  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3927	2036  201Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3928	      =ARRAY:2030		 LINK=LINK$
1  3929	2038				 SPACE LABEL FAR  ; CFA
1  3930	2038  1D7Cr			     DW	$COL
   3931	203A  1E8Er 12E2r 17AAr			 DW BLAN,EMIT,SEMI
   3932
   3933						  HEAD	  83h,'PF','A'+80h,PFA,$COL	      ;	PFA
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 70
forth.asm



1  3934	      =ARRAY:2040		 LINK$=$
1  3935	2040  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3936							 ; 6 - признак immediate. 5- слово не описано smudge
1  3937	2041  50 46			     DB	 'PF'
1  3938	2043  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  3939	2044  2030r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3940	      =ARRAY:2040		 LINK=LINK$
1  3941	2046				 PFA LABEL FAR	; CFA
1  3942	2046  1D7Cr			     DW	$COL
   3943					 ; NFA -> PFA
   3944	2048  1E6Dr 1B92r 0FCEr	  +		  DW  ONE,TRAV,LIT,5,PLUS,SEMI
   3945	      0005 160Cr 17AAr
   3946
   3947						  HEAD	  83h,'?E',322Q,QERR,$COL	      ;	?ER
1  3948	      =ARRAY:2054		 LINK$=$
1  3949	2054  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3950							 ; 6 - признак immediate. 5- слово не описано smudge
1  3951	2055  3F 45			     DB	 '?E'
1  3952	2057  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  3953	2058  2040r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3954	      =ARRAY:2054		 LINK=LINK$
1  3955	205A				 QERR LABEL FAR	 ; CFA
1  3956	205A  1D7Cr			     DW	$COL
   3957					 ; f errorcode -> если f=0, то без ошибок
   3958	205C  18B9r 1015r 0006	  +		  DW  SWAP,ZBRAN,TTT-$,ERROR,SEMI
   3959	      23F8r 17AAr
   3960	2066  1990r 17AAr		TTT:	  DW  DROP,SEMI
   3961
   3962						  HEAD	  85h,'?COM',320Q,QCOMP,$COL	      ;	?COMP
1  3963	      =ARRAY:206A		 LINK$=$
1  3964	206A  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3965							 ; 6 - признак immediate. 5- слово не описано smudge
1  3966	206B  3F 43 4F 4D		     DB	 '?COM'
1  3967	206F  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  3968	2070  2054r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3969	      =ARRAY:206A		 LINK=LINK$
1  3970	2072				 QCOMP LABEL FAR  ; CFA
1  3971	2072  1D7Cr			     DW	$COL
   3972					     ; проверка	режима работы. система в режиме	компиляции?
   3973	2074  1F7Dr 1A79r 115Fr	  +		  DW  STATE,AT,ZEQU,LIT,21Q,QERR,SEMI	     ; 17
   3974	      0FCEr 0011 205Ar	  +
   3975	      17AAr
   3976
   3977						  HEAD	  85h,'?EXE',303Q,QEXEC,$COL	      ;	?EXEC
1  3978	      =ARRAY:2082		 LINK$=$
1  3979	2082  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3980							 ; 6 - признак immediate. 5- слово не описано smudge
1  3981	2083  3F 45 58 45		     DB	 '?EXE'
1  3982	2087  C3			     DB	 303Q	; последний символ слова + 128 (7 бит =	1).
1  3983	2088  206Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3984	      =ARRAY:2082		 LINK=LINK$
1  3985	208A				 QEXEC LABEL FAR  ; CFA
1  3986	208A  1D7Cr			     DW	$COL
   3987					     ; проверка	режима исполнения    0=> Исполнение
   3988	208C  1F7Dr 1A79r 0FCEr	  +		  DW  STATE,AT,LIT,22Q,QERR,SEMI	     ; 18
   3989	      0012 205Ar 17AAr
   3990
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 71
forth.asm



   3991						  HEAD	  85h,'?PAI',322Q,QPAIR,$COL	      ;	?PAIR
1  3992	      =ARRAY:2098		 LINK$=$
1  3993	2098  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3994							 ; 6 - признак immediate. 5- слово не описано smudge
1  3995	2099  3F 50 41 49		     DB	 '?PAI'
1  3996	209D  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  3997	209E  2082r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3998	      =ARRAY:2098		 LINK=LINK$
1  3999	20A0				 QPAIR LABEL FAR  ; CFA
1  4000	20A0  1D7Cr			     DW	$COL
   4001	20A2  1628r 0FCEr 0013	  +		  DW  SUBB,LIT,23Q,QERR,SEMI
   4002	      205Ar 17AAr
   4003
   4004						  HEAD	  84h,'?CS',320Q,QCSP,$COL	      ;	?CSP
1  4005	      =ARRAY:20AC		 LINK$=$
1  4006	20AC  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4007							 ; 6 - признак immediate. 5- слово не описано smudge
1  4008	20AD  3F 43 53			     DB	 '?CS'
1  4009	20B0  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  4010	20B1  2098r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4011	      =ARRAY:20AC		 LINK=LINK$
1  4012	20B3				 QCSP LABEL FAR	 ; CFA
1  4013	20B3  1D7Cr			     DW	$COL
   4014					     ; контролируют сохранение указателя
   4015					     ; стека параметров	в процессе интерпретации слова
   4016					     ; текущее и сохраненное значение стека должны быть	равны
   4017	20B5  1765r 1F9Cr 1A79r	  +		  DW  SPAT,CSP,AT,SUBB,LIT,24Q,QERR,SEMI
   4018	      1628r 0FCEr 0014	  +
   4019	      205Ar 17AAr
   4020
   4021						  HEAD	  85h,'?LOA',304Q,QLOAD,$COL	      ;	?LOAD
1  4022	      =ARRAY:20C5		 LINK$=$
1  4023	20C5  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4024							 ; 6 - признак immediate. 5- слово не описано smudge
1  4025	20C6  3F 4C 4F 41		     DB	 '?LOA'
1  4026	20CA  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4027	20CB  20ACr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4028	      =ARRAY:20C5		 LINK=LINK$
1  4029	20CD				 QLOAD LABEL FAR  ; CFA
1  4030	20CD  1D7Cr			     DW	$COL
   4031					     ; ошибка, если не вовремя загрузки
   4032	20CF  1F2Br 1A79r 115Fr	  +		  DW  BLK,AT,ZEQU,LIT,26Q,QERR,SEMI	 ; 22
   4033	      0FCEr 0016 205Ar	  +
   4034	      17AAr
   4035
   4036						  HEAD	  87h,'COMPIL',305Q,COMP,$COL	      ;	COMPILE
1  4037	      =ARRAY:20DD		 LINK$=$
1  4038	20DD  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  4039							 ; 6 - признак immediate. 5- слово не описано smudge
1  4040	20DE  43 4F 4D 50 49 4C		     DB	 'COMPIL'
1  4041	20E4  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4042	20E5  20C5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4043	      =ARRAY:20DD		 LINK=LINK$
1  4044	20E7				 COMP LABEL FAR	 ; CFA
1  4045	20E7  1D7Cr			     DW	$COL
   4046					 ; Компиляция исполнительного адреса, следующего за оператором
   4047	20E9  2072r 1824r 1807r	  +		  DW  QCOMP,I,FROMR,TWOP,TOR,AT,COMMA,SEMI
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 72
forth.asm



   4048	      14DBr 17E9r 1A79r	  +
   4049	      2013r 17AAr
   4050
   4051						  HEAD	  84h,'SMU',307Q,SMUG,$COL	      ;	SMUDGE
1  4052	      =ARRAY:20F9		 LINK$=$
1  4053	20F9  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4054							 ; 6 - признак immediate. 5- слово не описано smudge
1  4055	20FA  53 4D 55			     DB	 'SMU'
1  4056	20FD  C7			     DB	 307Q	; последний символ слова + 128 (7 бит =	1).
1  4057	20FE  20DDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4058	      =ARRAY:20F9		 LINK=LINK$
1  4059	2100				 SMUG LABEL FAR	 ; CFA
1  4060	2100  1D7Cr			     DW	$COL
   4061					     ; сбрасывает 5-й бит первого байта	 описания  и  тем  самым
   4062					     ; делает	данное	 слово	полноправным  членом  текущего	словаря
   4063	2102  1C50r 1E8Er 1A5Er	  +		  DW  LATES,BLAN,TOGL,SEMI
   4064	      17AAr
   4065
   4066						  HEAD	  87h,'(;CODE',251Q,PSCOD,$COL	      ;	(;CODE)
1  4067	      =ARRAY:210A		 LINK$=$
1  4068	210A  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  4069							 ; 6 - признак immediate. 5- слово не описано smudge
1  4070	210B  28 3B 43 4F 44 45		     DB	 '(;CODE'
1  4071	2111  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1  4072	2112  20F9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4073	      =ARRAY:210A		 LINK=LINK$
1  4074	2114				 PSCOD LABEL FAR  ; CFA
1  4075	2114  1D7Cr			     DW	$COL
   4076					     ; адрес из	стека возвратов	(там находится адрес начала кода на ассемблере)
   4077					     ; пишем в CFA последнего определенного слова
   4078					     ; таким образом в CFA будет свой код интерпретатора на ассемблере
   4079	2116  1807r 1C50r 2046r	  +		  DW  FROMR,LATES,PFA,CFA,STORE,SEMI
   4080	      1B1Ar 1AB1r 17AAr
   4081
   4082						  HEAD	  87h,'#BUILD',323Q,BUILD,$COL	      ;	<BUILDS	;
1  4083	      =ARRAY:2122		 LINK$=$
1  4084	2122  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  4085							 ; 6 - признак immediate. 5- слово не описано smudge
1  4086	2123  23 42 55 49 4C 44		     DB	 '#BUILD'
1  4087	2129  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  4088	212A  210Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4089	      =ARRAY:2122		 LINK=LINK$
1  4090	212C				 BUILD LABEL FAR  ; CFA
1  4091	212C  1D7Cr			     DW	$COL
   4092					     ; формирует в словаре описание константы равной 0 с именем	XXX
   4093	212E  1E65r 1DB5r 17AAr			  DW  ZERO,CON,SEMI
   4094
   4095						  HEAD	  85h,'COUN',324Q,COUNT,$COL	      ;	COUNT
1  4096	      =ARRAY:2134		 LINK$=$
1  4097	2134  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4098							 ; 6 - признак immediate. 5- слово не описано smudge
1  4099	2135  43 4F 55 4E		     DB	 'COUN'
1  4100	2139  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4101	213A  2122r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4102	      =ARRAY:2134		 LINK=LINK$
1  4103	213C				 COUNT LABEL FAR  ; CFA
1  4104	213C  1D7Cr			     DW	$COL
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 73
forth.asm



   4105					     ; addr1 --- addr2 n
   4106					     ; адрес HERE+1 (это адрес первого байта слова)
   4107					     ; и число символов	в  слове  (HERE	 C@)
   4108	213E  1905r				  DW  DUBL	     ; addr1 addr1
   4109	2140  14C0r 18B9r			  DW  ONEP,SWAP	     ; addr1+1 addr1
   4110	2144  1A94r 17AAr			  DW  CAT,SEMI	     ; addr1+1 u8(addr1)
   4111
   4112						  HEAD	  84h,'TYP',305Q,$TYPE,$COL	      ;	TYPE
1  4113	      =ARRAY:2148		 LINK$=$
1  4114	2148  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4115							 ; 6 - признак immediate. 5- слово не описано smudge
1  4116	2149  54 59 50			     DB	 'TYP'
1  4117	214C  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4118	214D  2134r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4119	      =ARRAY:2148		 LINK=LINK$
1  4120	214F				 $TYPE LABEL FAR  ; CFA
1  4121	214F  1D7Cr			     DW	$COL
   4122					 ; адр count ->	вывод строки на	экран
   4123	2151  1922r 1015r 001C	  +		  DW  DDUP,ZBRAN,TC1-$,ZERO,XDO
   4124	      1E65r 1056r
   4125	215B  1905r 1824r 160Cr	  +	TC0:	  DW  DUBL,I,PLUS,CAT,LIT,177Q,$AND
   4126	      1A94r 0FCEr 007F	  +
   4127	      16C8r
   4128	2169  1E6Dr 12A7r 107Fr	  +		  DW  ONE,EMI$,XLOOP,TC0-$
   4129	      FFEC
   4130	2171  1990r 17AAr		TC1:	  DW  DROP,SEMI
   4131
   4132						  HEAD	  84h,'(."',251Q,PDOTQ,$COL	      ;	(.")
1  4133	      =ARRAY:2175		 LINK$=$
1  4134	2175  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4135							 ; 6 - признак immediate. 5- слово не описано smudge
1  4136	2176  28 2E 22			     DB	 '(."'
1  4137	2179  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1  4138	217A  2148r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4139	      =ARRAY:2175		 LINK=LINK$
1  4140	217C				 PDOTQ LABEL FAR  ; CFA
1  4141	217C  1D7Cr			     DW	$COL
   4142	217E  1824r				  DW  I	     ; при исполнении следующее	число -
   4143							     ; число символов сохраняется в RS
   4144	2180  213Cr 1905r 14C0r			  DW COUNT,DUBL,ONEP
   4145	2186  1807r 160Cr 17E9r	  +		  DW  FROMR,PLUS,TOR,$TYPE,SEMI
   4146	      214Fr 17AAr
   4147
   4148						  HEAD	  302Q,'.',242Q,D0TQ,$COL	       ; ."
1  4149	      =ARRAY:2190		 LINK$=$
1  4150	2190  C2			     DB	 302Q  ; NFA 7 бит равен 1.
1  4151							 ; 6 - признак immediate. 5- слово не описано smudge
1  4152	2191  2E			     DB	 '.'
1  4153	2192  A2			     DB	 242Q	; последний символ слова + 128 (7 бит =	1).
1  4154	2193  2175r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4155	      =ARRAY:2190		 LINK=LINK$
1  4156	2195				 D0TQ LABEL FAR	 ; CFA
1  4157	2195  1D7Cr			     DW	$COL
   4158	2197  0FCEr 0022 1F7Dr	  +		  DW  LIT,34,STATE,AT,ZBRAN,XT-$
   4159	      1A79r 1015r 0012
   4160	21A3  20E7r 217Cr 2216r	  +		  DW  COMP,PDOTQ,$WORD,HERE,CAT,ONEP
   4161	      1B56r 1A94r 14C0r
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 74
forth.asm



   4162	21AF  1B74r 17AAr			  DW  ALLOT, SEMI
   4163	21B3  2216r 1B56r 213Cr	  +	XT:	  DW  $WORD,HERE,COUNT,$TYPE,SEMI
   4164	      214Fr 17AAr
   4165
   4166						  HEAD	  85h,'QUER',331Q,QUERY,$COL	      ;	QUERY
1  4167	      =ARRAY:21BD		 LINK$=$
1  4168	21BD  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4169							 ; 6 - признак immediate. 5- слово не описано smudge
1  4170	21BE  51 55 45 52		     DB	 'QUER'
1  4171	21C2  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  4172	21C3  2190r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4173	      =ARRAY:21BD		 LINK=LINK$
1  4174	21C5				 QUERY LABEL FAR  ; CFA
1  4175	21C5  1D7Cr			     DW	$COL
   4176					 ; входной буфер,  адрес которого хранится в системной переменной
   4177					 ; по имени TIB	(Terminal Input	Buffer).  Ввод	в  этот	 буфер
   4178					 ; осуществляется оператором QUERY
   4179	21C7  1EBCr 1A79r 1B1Ar	  +		  DW  TIB,AT,CFA,LIT,120Q,EXPE
   4180	      0FCEr 0050 141Er
   4181	21D3  1E65r 1F34r 1AB1r	  +		  DW  ZERO,$IN,STORE,CR,SEMI
   4182	      1FFFr 17AAr
   4183
   4184						  HEAD	  301Q,,200Q,NULL,$COL		       ; NULL
1  4185	      =ARRAY:21DD		 LINK$=$
1  4186	21DD  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  4187							 ; 6 - признак immediate. 5- слово не описано smudge
1  4188	21DE  80			     DB	 200Q	; последний символ слова + 128 (7 бит =	1).
1  4189	21DF  21BDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4190	      =ARRAY:21DD		 LINK=LINK$
1  4191	21E1				 NULL LABEL FAR	 ; CFA
1  4192	21E1  1D7Cr			     DW	$COL
   4193					 ; немедленного	исполнения. исполняется, если встретился 0 в коде
   4194					 ; прерывает бесконечное испольнение INTERPRET
   4195	21E3  1F2Br 1A79r 1015r	  +		  DW  BLK,AT,ZBRAN,NUL-$	 ; если	пультовый режим
   4196	      0010
   4197	21EB  1E6Dr 1F2Br 1A40r	  +		  DW  ONE,BLK,PSTOR,ZERO,$IN,STORE,QEXEC
   4198	      1E65r 1F34r 1AB1r	  +
   4199	      208Ar
   4200	21F9  1854r 17AAr		NUL:	  DW  LEV,SEMI
   4201
   4202						  HEAD	  83h,'PA',304Q,PAD,$COL	      ;	PAD
1  4203	      =ARRAY:21FD		 LINK$=$
1  4204	21FD  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4205							 ; 6 - признак immediate. 5- слово не описано smudge
1  4206	21FE  50 41			     DB	 'PA'
1  4207	2200  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4208	2201  21DDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4209	      =ARRAY:21FD		 LINK=LINK$
1  4210	2203				 PAD LABEL FAR	; CFA
1  4211	2203  1D7Cr			     DW	$COL
   4212					     ; Многие операции	 выдачи	  результатов	и   сообщений	на   экран
   4213					     ; производятся   через   специальный   буфер,   адрес   которого  смещен
   4214					     ; относительно HERE.  В базовом словаре имеется  оператор	PAD,  который
   4215					     ; выдает в	стек адрес КОНЦА этого буфера:
   4216	2205  1B56r 0FCEr 0044	  +		  DW  HERE,LIT,104Q,PLUS,SEMI
   4217	      160Cr 17AAr
   4218
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 75
forth.asm



   4219						  HEAD	  84h,'WOR',304Q,$WORD,$COL	      ;	WORD
1  4220	      =ARRAY:220F		 LINK$=$
1  4221	220F  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4222							 ; 6 - признак immediate. 5- слово не описано smudge
1  4223	2210  57 4F 52			     DB	 'WOR'
1  4224	2213  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4225	2214  21FDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4226	      =ARRAY:220F		 LINK=LINK$
1  4227	2216				 $WORD LABEL FAR  ; CFA
1  4228	2216  1D7Cr			     DW	$COL
   4229					     ; разделитель -> число_символов строка по адресу here
   4230	2218  1F2Br 1A79r 1922r	  +		  DW  BLK,AT,DDUP,ZBRAN,WD1-$; ввод с клавиатуры
   4231	      1015r 0008
   4232	2222  2723r 103Ar 0006			  DW  BLOCK,BRAN,WD2-$	     ; адрес буфера из переменной BLK
   4233	2228  1EBCr 1A79r		WD1:	  DW  TIB,AT		     ; адрес входного терминала
   4234	222C  1F34r 1A79r 160Cr	  +	WD2:	  DW  $IN,AT,PLUS,SWAP,ENCL,HERE,BLAN,BLANK,$IN
   4235	      18B9r 11F0r 1B56r	  +
   4236	      1E8Er 1A11r 1F34r
   4237	223E  1A40r 17E9r 1824r	  +		  DW  PSTOR,TOR,I,HERE,CSTOR
   4238	      1B56r 1ACDr
   4239	2248  1B56r 14C0r 1807r	  +		  DW  HERE,ONEP,FROMR,CMOV,SEMI
   4240	      19AEr 17AAr
   4241
   4242						  HEAD	  88h,'(NUMBER',251Q,PNUMB,$COL	      ;	(NUMBER)
1  4243	      =ARRAY:2252		 LINK$=$
1  4244	2252  88			     DB	 88h  ;	NFA 7 бит равен	1.
1  4245							 ; 6 - признак immediate. 5- слово не описано smudge
1  4246	2253  28 4E 55 4D 42 45	52	     DB	 '(NUMBER'
1  4247	225A  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1  4248	225B  220Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4249	      =ARRAY:2252		 LINK=LINK$
1  4250	225D				 PNUMB LABEL FAR  ; CFA
1  4251	225D  1D7Cr			     DW	$COL
   4252	225F  14C0r 17E9r 1824r	  +	BN:	  DW  ONEP,TOR,I,CAT,BASE,AT,DIGIT,ZBRAN,MMO-$
   4253	      1A94r 1F88r 1A79r	  +
   4254	      113Dr 1015r 002C
   4255	2271  18B9r 1F88r 1A79r	  +		  DW  SWAP,BASE,AT,USTAR,DROP,ROT,BASE,AT,USTAR
   4256	      154Br 1990r 1952r	  +
   4257	      1F88r 1A79r 154Br
   4258	2283  1645r 1F92r 1A79r	  +		  DW  DPLUS,DPL,AT,ONEP,ZBRAN,BN1-$,ONE,DPL,PSTOR
   4259	      14C0r 1015r 0008	  +
   4260	      1E6Dr 1F92r 1A40r
   4261	2295  1807r 103Ar FFC6		BN1:	  DW  FROMR,BRAN,BN-$
   4262	229B  1807r 17AAr		MMO:	  DW  FROMR,SEMI
   4263
   4264						  HEAD	  85h,'-FIN',304Q,DFIND,$COL	      ;	-FIND
1  4265	      =ARRAY:229F		 LINK$=$
1  4266	229F  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4267							 ; 6 - признак immediate. 5- слово не описано smudge
1  4268	22A0  2D 46 49 4E		     DB	 '-FIN'
1  4269	22A4  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4270	22A5  2252r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4271	      =ARRAY:229F		 LINK=LINK$
1  4272	22A7				 DFIND LABEL FAR  ; CFA
1  4273	22A7  1D7Cr			     DW	$COL
   4274					     ; Поиск слова в словаре, которое следует следующим	в тексте программы
   4275	22A9  1E8Er 2216r 1B56r	  +		  DW  BLAN,$WORD,HERE,COUNT,UPPER,HERE
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 76
forth.asm



   4276	      213Cr 1C9Ar 1B56r
   4277	22B5  1F63r 1A79r 1A79r			  DW  CONT,AT,AT ; поиска в контекстном	словаре
   4278	22BB  10CEr 1922r 115Fr	  +		  DW  PFIND,DDUP,ZEQU,ZBRAN,FIN-$,HERE,LATES,PFIND
   4279	      1015r 0008 1B56r	  +
   4280	      1C50r 10CEr
   4281	22CB  17AAr			FIN:	  DW  SEMI
   4282
   4283						  HEAD	  86h,'NUMBE',322Q,NUMB,$COL	      ;	NUMBER
1  4284	      =ARRAY:22CD		 LINK$=$
1  4285	22CD  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  4286							 ; 6 - признак immediate. 5- слово не описано smudge
1  4287	22CE  4E 55 4D 42 45		     DB	 'NUMBE'
1  4288	22D3  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4289	22D4  229Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4290	      =ARRAY:22CD		 LINK=LINK$
1  4291	22D6				 NUMB LABEL FAR	 ; CFA
1  4292	22D6  1D7Cr			     DW	$COL
   4293	22D8  1E65r 1FCEr 1AB1r	  +		  DW  ZERO,$EX,STORE,BASE,AT,ZERO,ROT
   4294	      1F88r 1A79r 1E65r	  +
   4295	      1952r
   4296	22E6  14C0r 1905r 1A94r	  +		  DW  ONEP,DUBL,CAT,DUBL,LIT,53Q,EQUAL
   4297	      1905r 0FCEr 002B	  +
   4298	      11A2r
   4299	22F4  1015r 000A 1C0Fr	  +		  DW  ZBRAN,NH1-$,DECIMA,DROP,BRAN,NH4-$
   4300	      1990r 103Ar 002E
   4301	2300  1905r 0FCEr 002D	  +	NH1:	  DW  DUBL,LIT,55Q,EQUAL,ZBRAN,NH2-$,DROP,DECIMA
   4302	      11A2r 1015r 0012	  +
   4303	      1990r 1C0Fr
   4304	2310  18B9r 1990r 1E6Dr	  +		  DW  SWAP,DROP,ONE,SWAP,BRAN,NH4-$
   4305	      18B9r 103Ar 0012
   4306	231C  0FCEr 0027 11A2r	  +	NH2:	  DW  LIT,47Q,EQUAL,ZBRAN,NH3-$,OCTAL,ONEP
   4307	      1015r 0006 1C2Fr	  +
   4308	      14C0r
   4309	232A  14F8r			NH3:	  DW  ONEM
   4310	232C  0FCEr FFFF 1F92r	  +	NH4:	  DW  LIT,-1,DPL,STORE,ZERO,ZERO,ROT,PNUMB,DUBL
   4311	      1AB1r 1E65r 1E65r	  +
   4312	      1952r 225Dr 1905r
   4313	233E  1A94r 1E8Er 1628r	  +		  DW  CAT,BLAN,SUBB,ZBRAN,NH6-$
   4314	      1015r 0088
   4315	2348  1905r 1A94r 0FCEr	  +		  DW  DUBL,CAT,LIT,56Q,EQUAL,ZBRAN,EXP-$
   4316	      002E 11A2r 1015r	  +
   4317	      0016
   4318	2356  1E65r 1F92r 1AB1r	  +		  DW  ZERO,DPL,STORE,PNUMB,DUBL,CAT,BLAN,SUBB,ZBRAN,NH6-$
   4319	      225Dr 1905r 1A94r	  +
   4320	      1E8Er 1628r 1015r	  +
   4321	      0066
   4322	236A  1F92r 1A79r 18B9r	  +	EXP:	  DW  DPL,AT,SWAP,DUBL,CAT,LIT
   4323	      1905r 1A94r 0FCEr
   4324	2376  0045 11A2r 1015r	  +		  DW  105Q,EQUAL,ZBRAN,ER1-$,ONEP,DUBL,CAT
   4325	      0068 14C0r 1905r	  +
   4326	      1A94r
   4327	2384  0FCEr 002D 11A2r	  +		  DW  LIT,55Q,EQUAL,ZBRAN,NEMI-$,ONE,BRAN,NH0-$
   4328	      1015r 0008 1E6Dr	  +
   4329	      103Ar 0014
   4330	2394  1905r 1A94r 0FCEr	  +	NEMI:	  DW  DUBL,CAT,LIT,53Q,SUBB,ZBRAN,PLU-$,ONEM
   4331	      002B 1628r 1015r	  +
   4332	      0004 14F8r
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 77
forth.asm



   4333	23A4  1E65r			PLU:	  DW  ZERO
   4334	23A6  18B9r 1E65r 1E65r	  +	NH0:	  DW  SWAP,ZERO,ZERO,ROT,PNUMB,CAT,BLAN,EQUAL,ZBRAN,ER-$
   4335	      1952r 225Dr 1A94r	  +
   4336	      1E8Er 11A2r 1015r	  +
   4337	      0028
   4338	23BA  1990r 18B9r 1015r	  +		  DW  DROP,SWAP,ZBRAN,NH5-$,MINUS
   4339	      0004 166Br
   4340	23C4  1FCEr 1AB1r 1F92r	  +	NH5:	  DW  $EX,STORE,DPL,STORE,ZERO
   4341	      1AB1r 1E65r
   4342	23CE  1990r 1952r 1015r	  +	NH6:	  DW  DROP,ROT,ZBRAN,NH7-$,DMINU
   4343	      0004 15AAr
   4344	23D8  1952r 1F88r 1AB1r	  +	NH7:	  DW  ROT,BASE,STORE,SEMI
   4345	      17AAr
   4346	23E0  1973r 1990r		ER:	  DW  DDROP,DROP
   4347	23E4  1973r 1973r 1990r	  +	ER1:	  DW  DDROP,DDROP,DROP,ZERO,ERROR,SEMI
   4348	      1E65r 23F8r 17AAr
   4349
   4350						  HEAD	  85h,'ERRO',322Q,ERROR,$COL	      ;	ERROR
1  4351	      =ARRAY:23F0		 LINK$=$
1  4352	23F0  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4353							 ; 6 - признак immediate. 5- слово не описано smudge
1  4354	23F1  45 52 52 4F		     DB	 'ERRO'
1  4355	23F5  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4356	23F6  22CDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4357	      =ARRAY:23F0		 LINK=LINK$
1  4358	23F8				 ERROR LABEL FAR  ; CFA
1  4359	23F8  1D7Cr			     DW	$COL
   4360	23FA  1B56r 213Cr 214Fr	  +		  DW  HERE,COUNT,$TYPE,PDOTQ
   4361	      217Cr
   4362	2402  03 20 3F 20			  DB  3	, ' ? '
   4363	2406  1FD8r 1A79r 1015r	  +		  DW  ERB,AT,ZBRAN,XER-$
   4364	      000C
   4365	240E  1E65r 1FD8r 1AB1r	  +		  DW  ZERO,ERB,STORE,DROP,SEMI
   4366	      1990r 17AAr
   4367	2418  279Dr 1772r 25ABr		XER:	  DW  MESS,SPSTO,QUIT
   4368
   4369						  HEAD	  83h,'ID',256Q,IDDOT,$COL	      ;	ID.
1  4370	      =ARRAY:241E		 LINK$=$
1  4371	241E  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4372							 ; 6 - признак immediate. 5- слово не описано smudge
1  4373	241F  49 44			     DB	 'ID'
1  4374	2421  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  4375	2422  23F0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4376	      =ARRAY:241E		 LINK=LINK$
1  4377	2424				 IDDOT LABEL FAR  ; CFA
1  4378	2424  1D7Cr			     DW	$COL
   4379					     ; печатает	  имя	слова
   4380	2426  213Cr 0FCEr 001F	  +		  DW  COUNT,LIT,37Q,$AND,$TYPE,SPACE,SEMI
   4381	      16C8r 214Fr 2038r	  +
   4382	      17AAr
   4383
   4384						  HEAD	  86h,'CREAT',305Q,CREAT,$COL	      ;	CREATE	- --> адр XXX (I, C)
1  4385	      =ARRAY:2434		 LINK$=$
1  4386	2434  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  4387							 ; 6 - признак immediate. 5- слово не описано smudge
1  4388	2435  43 52 45 41 54		     DB	 'CREAT'
1  4389	243A  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 78
forth.asm



1  4390	243B  241Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4391	      =ARRAY:2434		 LINK=LINK$
1  4392	243D				 CREAT LABEL FAR  ; CFA
1  4393	243D  1D7Cr			     DW	$COL
   4394					     ; формирование новых слов - описателей.
   4395					     ; (CREATE XXX DOES>) XXX исполняется на этапе компиляции,
   4396					     ; текст программы,	следующий за DOES>, адрес которого
   4397					     ; помещается в PFA	- на этапе исполнения.
   4398	243F  22A7r 1015r 0010	  +		  DW  DFIND,ZBRAN,CRE-$,DROP,TWOP,NFA,IDDOT
   4399	      1990r 14DBr 1AEAr	  +
   4400	      2424r
   4401	244D  0FCEr 0004 279Dr			  DW  LIT,4,MESS	     ; сообщение о повторном определении слова
   4402	2453  1B56r 1905r 1A94r	  +	CRE:	  DW  HERE,DUBL,CAT,$WIDTH,AT,MIN,ONEP,ALLOT ; here указывает на число символов	слова
   4403	      1EC8r 1A79r 1723r	  +
   4404	      14C0r 1B74r
   4405										     ; сдвигаем	here на	длину слова + сам байт длины
   4406	2463  1905r 0FCEr 00A0	  +		  DW  DUBL,LIT,240Q,TOGL,HERE,ONEM   ; выключаем из поиска
   4407	      1A5Er 1B56r 14F8r
   4408										     ; 240Q = 10100000
   4409	246F  0FCEr 0080 1A5Er	  +		  DW  LIT,200Q,TOGL,LATES,COMMA,CURR,AT,STORE ;	в последней букве слова	включаем 7  +
   4410	      1C50r 2013r 1F71r	  +  бит
   4411	      1A79r 1AB1r
   4412										 ; ссылка на пред слово	и сохраняем ссылку на вновь
   4413										 ; созданное слово
   4414	247F  1B56r 14DBr 2013r	  +		  DW  HERE,TWOP,COMMA,SEMI	 ; в словарь адрес here
   4415	      17AAr
   4416
   4417						  HEAD	  311Q,'[COMPILE',335Q,BCOM,$COL       ; [COMPILE]
1  4418	      =ARRAY:2487		 LINK$=$
1  4419	2487  C9			     DB	 311Q  ; NFA 7 бит равен 1.
1  4420							 ; 6 - признак immediate. 5- слово не описано smudge
1  4421	2488  5B 43 4F 4D 50 49	4C+	     DB	 '[COMPILE'
   4422	      45
1  4423	2490  DD			     DB	 335Q	; последний символ слова + 128 (7 бит =	1).
1  4424	2491  2434r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4425	      =ARRAY:2487		 LINK=LINK$
1  4426	2493				 BCOM LABEL FAR	 ; CFA
1  4427	2493  1D7Cr			     DW	$COL
   4428					     ; Используется в описании типа двоеточия и	служит для
   4429						     ; компиляции слова	немедленного действия XXX, как если бы оно
   4430					     ; не было таким. Слово XXX	будет исполнено	тогда, когда будет
   4431					     ; исполнено слово,	в котором использована комбинация [COMPILE] XXX
   4432					     ; кладет в	словарь	CFA компилируемого слова
   4433	2495  22A7r 115Fr 1E65r	  +		  DW  DFIND,ZEQU,ZERO,QERR,DROP,COMMA,SEMI
   4434	      205Ar 1990r 2013r	  +
   4435	      17AAr
   4436
   4437						 HEAD	 307Q,'LITERA',314Q,LITER,$COL	      ;	LITERAL
1  4438	      =ARRAY:24A3		 LINK$=$
1  4439	24A3  C7			     DB	 307Q  ; NFA 7 бит равен 1.
1  4440							 ; 6 - признак immediate. 5- слово не описано smudge
1  4441	24A4  4C 49 54 45 52 41		     DB	 'LITERA'
1  4442	24AA  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  4443	24AB  2487r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4444	      =ARRAY:24A3		 LINK=LINK$
1  4445	24AD				 LITER LABEL FAR  ; CFA
1  4446	24AD  1D7Cr			     DW	$COL
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 79
forth.asm



   4447					 ; компилирует число в словарь
   4448	24AF  1F7Dr 1A79r 1015r	  +		 DW  STATE,AT,ZBRAN,LIL-$	; в режиме исполнения ничего не	делает
   4449	      0008
   4450	24B7  20E7r 0FCEr 2013r			 DW  COMP,LIT,COMMA
   4451	24BD  17AAr			 LIL:	 DW  SEMI
   4452
   4453						  HEAD	  310Q,'DLITERA',314Q,DLITE,$COL       ; DLITERAL
1  4454	      =ARRAY:24BF		 LINK$=$
1  4455	24BF  C8			     DB	 310Q  ; NFA 7 бит равен 1.
1  4456							 ; 6 - признак immediate. 5- слово не описано smudge
1  4457	24C0  44 4C 49 54 45 52	41	     DB	 'DLITERA'
1  4458	24C7  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  4459	24C8  24A3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4460	      =ARRAY:24BF		 LINK=LINK$
1  4461	24CA				 DLITE LABEL FAR  ; CFA
1  4462	24CA  1D7Cr			     DW	$COL
   4463					 ; компилирует в словарь двойное число
   4464	24CC  1F7Dr 1A79r 1015r	  +		  DW  STATE,AT,ZBRAN,DLI-$
   4465	      0008
   4466	24D4  18B9r 24ADr 24ADr			 DW  SWAP,LITER,LITER
   4467	24DA  17AAr			DLI:	  DW  SEMI
   4468
   4469						  HEAD	  86h,'?STAC',313Q,QSTAC,$COL	      ;	?STACK
1  4470	      =ARRAY:24DC		 LINK$=$
1  4471	24DC  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  4472							 ; 6 - признак immediate. 5- слово не описано smudge
1  4473	24DD  3F 53 54 41 43		     DB	 '?STAC'
1  4474	24E2  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  4475	24E3  24BFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4476	      =ARRAY:24DC		 LINK=LINK$
1  4477	24E5				 QSTAC LABEL FAR  ; CFA
1  4478	24E5  1D7Cr			     DW	$COL
   4479					 ; -> f	, true если значение указателя стека в пределах	допусков
   4480	24E7  1EA9r 1A79r 1B1Ar	  +		  DW  SZERO,AT,CFA,SPAT,ULESS,ONE,QERR
   4481	      1765r 11B1r 1E6Dr	  +
   4482	      205Ar
   4483	24F5  0FCEr FF80 1765r	  +		  DW  LIT,-200Q,SPAT,ULESS,TWO
   4484	      11B1r 1E75r
   4485	24FF  205Ar 17AAr			  DW  QERR, SEMI
   4486
   4487						  HEAD	  211Q,'INTERPRE',324Q,INTER,$COL      ; INTERPRET
1  4488	      =ARRAY:2503		 LINK$=$
1  4489	2503  89			     DB	 211Q  ; NFA 7 бит равен 1.
1  4490							 ; 6 - признак immediate. 5- слово не описано smudge
1  4491	2504  49 4E 54 45 52 50	52+	     DB	 'INTERPRE'
   4492	      45
1  4493	250C  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4494	250D  24DCr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4495	      =ARRAY:2503		 LINK=LINK$
1  4496	250F				 INTER LABEL FAR  ; CFA
1  4497	250F  1D7Cr			     DW	$COL
   4498	2511  22A7r 1015r 0018		IT1:	  DW  DFIND,ZBRAN,IT3-$	; переход если не найдено
   4499	2517  1F7Dr 1A79r 11BFr	  +		  DW  STATE,AT,LESS, ZBRAN,IT2-$ ; выполнить
   4500	      1015r 0008
   4501	2521  2013r 103Ar 0020			  DW  COMMA,BRAN,IT5-$
   4502	2527  0FC3r 103Ar 001A		IT2:	  DW  EXEC,BRAN,IT5-$
   4503	252D  1B56r 22D6r 1F92r	  +	IT3:	  DW  HERE,NUMB,DPL,AT,ONEP,ZBRAN,IT4-$
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 80
forth.asm



   4504	      1A79r 14C0r 1015r	  +
   4505	      0008
   4506	253B  24CAr 103Ar 0006			  DW  DLITE,BRAN,IT5-$
   4507	2541  1990r 24ADr		IT4:	  DW  DROP,LITER
   4508	2545  24E5r 103Ar FFC8		IT5:	  DW  QSTAC,BRAN,IT1-$
   4509
   4510						  HEAD	  211Q,'IMMEDIAT',305Q,IMMED,$COL      ; IMMEDIATE
1  4511	      =ARRAY:254B		 LINK$=$
1  4512	254B  89			     DB	 211Q  ; NFA 7 бит равен 1.
1  4513							 ; 6 - признак immediate. 5- слово не описано smudge
1  4514	254C  49 4D 4D 45 44 49	41+	     DB	 'IMMEDIAT'
   4515	      54
1  4516	2554  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4517	2555  2503r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4518	      =ARRAY:254B		 LINK=LINK$
1  4519	2557				 IMMED LABEL FAR  ; CFA
1  4520	2557  1D7Cr			     DW	$COL
   4521					 ; отмечает последнее слово признаком
   4522	2559  1C50r 1E97r 1A5Er	  +		  DW  LATES,$CL,TOGL,SEMI	 ; cl -	6 бит
   4523	      17AAr
   4524
   4525						 HEAD	 212Q,'VOCABULAR',331Q,VOCAB,$COL     ;	VOCABULARY
1  4526	      =ARRAY:2561		 LINK$=$
1  4527	2561  8A			     DB	 212Q  ; NFA 7 бит равен 1.
1  4528							 ; 6 - признак immediate. 5- слово не описано smudge
1  4529	2562  56 4F 43 41 42 55	4C+	     DB	 'VOCABULAR'
   4530	      41 52
1  4531	256B  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  4532	256C  254Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4533	      =ARRAY:2561		 LINK=LINK$
1  4534	256E				 VOCAB LABEL FAR  ; CFA
1  4535	256E  1D7Cr			     DW	$COL
   4536					 ; создание нового словаря
   4537	2570  212Cr 0FCEr A081	  +		 DW  BUILD,LIT,120201Q,COMMA ;
   4538	      2013r
   4539	2578  1F71r 1A79r 1B1Ar	  +		 DW  CURR,AT,CFA,COMMA
   4540	      2013r
   4541	2580  1B56r 1EF6r 1A79r	  +		 DW  HERE,VOCL,AT,COMMA,VOCL,STORE,DOES
   4542	      2013r 1EF6r 1AB1r	  +
   4543	      1E29r
   4544	258E				 DOVOC	 LABEL	  FAR
   4545	258E  14DBr 1F63r 1AB1r	  +		 DW  TWOP,CONT,STORE,SEMI ; этот код будет в PFA нового	словаря
   4546	      17AAr
   4547									  ; в CFA словаря попадет код $DOE, который
   4548									  ; передает управлению	коду по	адресу PFA
   4549									  ; в стек кладет адрес	PFA+2
   4550
   4551
   4552						  HEAD	  301Q,,250Q,PAREN,$COL		       ; (
1  4553	      =ARRAY:2596		 LINK$=$
1  4554	2596  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  4555							 ; 6 - признак immediate. 5- слово не описано smudge
1  4556	2597  A8			     DB	 250Q	; последний символ слова + 128 (7 бит =	1).
1  4557	2598  2561r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4558	      =ARRAY:2596		 LINK=LINK$
1  4559	259A				 PAREN LABEL FAR  ; CFA
1  4560	259A  1D7Cr			     DW	$COL
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 81
forth.asm



   4561					     ; пропуск до следующей )
   4562	259C  0FCEr 0029 2216r	  +		  DW  LIT,29h,$WORD,SEMI
   4563	      17AAr
   4564
   4565						  HEAD	  84h,'QUI',324Q,QUIT,$COL	      ;	QUIT
1  4566	      =ARRAY:25A4		 LINK$=$
1  4567	25A4  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4568							 ; 6 - признак immediate. 5- слово не описано smudge
1  4569	25A5  51 55 49			     DB	 'QUI'
1  4570	25A8  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4571	25A9  2596r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4572	      =ARRAY:25A4		 LINK=LINK$
1  4573	25AB				 QUIT LABEL FAR	 ; CFA
1  4574	25AB  1D7Cr			     DW	$COL
   4575					 ; Очищает оба стека и возвращает управление терминалу.
   4576					 ; Не выдается никаких сообщений
   4577	25AD  1E65r 1F2Br 1AB1r	  +		  DW  ZERO,BLK,STORE,LBRAC
   4578	      1BB3r
   4579	25B5  178Er 1FFFr 21C5r	  +	QUI:	  DW  RPSTO,CR,QUERY,INTER,STATE,AT
   4580	      250Fr 1F7Dr 1A79r
   4581	25C1  115Fr 1015r FFF0	  +		  DW  ZEQU,ZBRAN,QUI-$,PDOTQ
   4582	      217Cr
   4583	25C9  03 20 4F 4B			  DB  3,' OK'
   4584	25CD  103Ar FFE6			  DW  BRAN,QUI-$
   4585
   4586						  HEAD	  85h,'ABOR',324Q,ABORT,$COL	      ;	ABORT
1  4587	      =ARRAY:25D1		 LINK$=$
1  4588	25D1  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4589							 ; 6 - признак immediate. 5- слово не описано smudge
1  4590	25D2  41 42 4F 52		     DB	 'ABOR'
1  4591	25D6  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4592	25D7  25A4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4593	      =ARRAY:25D1		 LINK=LINK$
1  4594	25D9				 ABORT LABEL FAR  ; CFA
1  4595	25D9  1D7Cr			     DW	$COL
   4596					 ; Прерывает исполнение, делает	словарь	Форт контекстным,
   4597					 ; выполняет QUIT. Распечатывает версию	интерпретатора
   4598	25DB  1772r 1C0Fr 1FFFr	  +		  DW  SPSTO,DECIMA,CR,PDOTQ
   4599	      217Cr
   4600	25E3  11 46 4F 52 54 48	2D+		  DB  17,'FORTH-PC IS HERE '
   4601	      50 43 20 49 53 20	48+
   4602	      45 52 45 20
   4603	25F5  2D81r 1CCDr 25ABr			  DW  FORTH,DEFIN,QUIT
   4604
   4605						  HEAD	  82h,'S',256Q,SPOT,$COL	      ;	S.
1  4606	      =ARRAY:25FB		 LINK$=$
1  4607	25FB  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4608							 ; 6 - признак immediate. 5- слово не описано smudge
1  4609	25FC  53			     DB	 'S'
1  4610	25FD  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  4611	25FE  25D1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4612	      =ARRAY:25FB		 LINK=LINK$
1  4613	2600				 SPOT LABEL FAR	 ; CFA
1  4614	2600  1D7Cr			     DW	$COL
   4615					 ; печать верхнего значения со стека без его изменения
   4616	2602  1905r 2A7Br 17AAr			  DW  DUBL,UDOT,SEMI
   4617
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 82
forth.asm



   4618						  HEAD	  81h,,252Q,STAR,$COL		      ;	*
1  4619	      =ARRAY:2608		 LINK$=$
1  4620	2608  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  4621							 ; 6 - признак immediate. 5- слово не описано smudge
1  4622	2609  AA			     DB	 252Q	; последний символ слова + 128 (7 бит =	1).
1  4623	260A  25FBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4624	      =ARRAY:2608		 LINK=LINK$
1  4625	260C				 STAR LABEL FAR	 ; CFA
1  4626	260C  1D7Cr			     DW	$COL
   4627	260E  1588r 1990r 17AAr			  DW  MSTAR,DROP,SEMI
   4628
   4629						  HEAD	  84h,'/MO',304Q,SLMOD,$COL	      ;	/MOD
1  4630	      =ARRAY:2614		 LINK$=$
1  4631	2614  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4632							 ; 6 - признак immediate. 5- слово не описано smudge
1  4633	2615  2F 4D 4F			     DB	 '/MO'
1  4634	2618  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4635	2619  2608r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4636	      =ARRAY:2614		 LINK=LINK$
1  4637	261B				 SLMOD LABEL FAR  ; CFA
1  4638	261B  1D7Cr			     DW	$COL
   4639	261D  17E9r 1702r 1807r	  +		  DW  TOR,STOD,FROMR,MSLAS,SEMI
   4640	      15EEr 17AAr
   4641
   4642						  HEAD	  81h,,257Q,SLASH,$COL		      ;	/
1  4643	      =ARRAY:2627		 LINK$=$
1  4644	2627  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  4645							 ; 6 - признак immediate. 5- слово не описано smudge
1  4646	2628  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  4647	2629  2614r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4648	      =ARRAY:2627		 LINK=LINK$
1  4649	262B				 SLASH LABEL FAR  ; CFA
1  4650	262B  1D7Cr			     DW	$COL
   4651	262D  261Br 18B9r 1990r	  +		  DW  SLMOD,SWAP,DROP,SEMI
   4652	      17AAr
   4653
   4654						  HEAD	  83h,'MO',304Q,$MOD,$COL	      ;	MOD
1  4655	      =ARRAY:2635		 LINK$=$
1  4656	2635  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4657							 ; 6 - признак immediate. 5- слово не описано smudge
1  4658	2636  4D 4F			     DB	 'MO'
1  4659	2638  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4660	2639  2627r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4661	      =ARRAY:2635		 LINK=LINK$
1  4662	263B				 $MOD LABEL FAR	 ; CFA
1  4663	263B  1D7Cr			     DW	$COL
   4664	263D  261Br 1990r 17AAr			  DW  SLMOD,DROP,SEMI
   4665
   4666						  HEAD	  85h,'*/MO',304Q,SSMOD,$COL	      ;. */MOD
1  4667	      =ARRAY:2643		 LINK$=$
1  4668	2643  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4669							 ; 6 - признак immediate. 5- слово не описано smudge
1  4670	2644  2A 2F 4D 4F		     DB	 '*/MO'
1  4671	2648  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4672	2649  2635r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4673	      =ARRAY:2643		 LINK=LINK$
1  4674	264B				 SSMOD LABEL FAR  ; CFA
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 83
forth.asm



1  4675	264B  1D7Cr			     DW	$COL
   4676	264D  17E9r 1588r 1807r	  +		  DW  TOR,MSTAR,FROMR,MSLAS,SEMI
   4677	      15EEr 17AAr
   4678
   4679						  HEAD	  82h,'*',257Q,SSLA,$COL	      ;	*/
1  4680	      =ARRAY:2657		 LINK$=$
1  4681	2657  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4682							 ; 6 - признак immediate. 5- слово не описано smudge
1  4683	2658  2A			     DB	 '*'
1  4684	2659  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  4685	265A  2643r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4686	      =ARRAY:2657		 LINK=LINK$
1  4687	265C				 SSLA LABEL FAR	 ; CFA
1  4688	265C  1D7Cr			     DW	$COL
   4689	265E  264Br 18B9r 1990r	  +		  DW  SSMOD,SWAP,DROP,SEMI
   4690	      17AAr
   4691
   4692						  HEAD	  85h,'M/MO',304Q,MSMOD,$COL	      ;	M/MOD
1  4693	      =ARRAY:2666		 LINK$=$
1  4694	2666  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4695							 ; 6 - признак immediate. 5- слово не описано smudge
1  4696	2667  4D 2F 4D 4F		     DB	 'M/MO'
1  4697	266B  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4698	266C  2657r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4699	      =ARRAY:2666		 LINK=LINK$
1  4700	266E				 MSMOD LABEL FAR  ; CFA
1  4701	266E  1D7Cr			     DW	$COL
   4702	2670  17E9r 1E65r 1824r	  +		  DW  TOR,ZERO,I,USLAS,FROMR,SWAP,TOR,USLAS
   4703	      1569r 1807r 18B9r	  +
   4704	      17E9r 1569r
   4705	2680  1807r 17AAr		$MO:	  DW  FROMR,SEMI
   4706
   4707						  HEAD	  215Q,'EMPTY-BUFFER',323Q,MTBUF,$COL  ;EMPTY-BUFFERS
1  4708	      =ARRAY:2684		 LINK$=$
1  4709	2684  8D			     DB	 215Q  ; NFA 7 бит равен 1.
1  4710							 ; 6 - признак immediate. 5- слово не описано smudge
1  4711	2685  45 4D 50 54 59 2D	42+	     DB	 'EMPTY-BUFFER'
   4712	      55 46 46 45 52
1  4713	2691  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  4714	2692  2666r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4715	      =ARRAY:2684		 LINK=LINK$
1  4716	2694				 MTBUF LABEL FAR  ; CFA
1  4717	2694  1D7Cr			     DW	$COL
   4718	2696  1F02r 1A79r 0FCEr	  +		  DW  FIRST,AT,LIT,0C12h,ERASE,SEMI   ;	3084 было
   4719	      0C12 1A02r 17AAr
   4720
   4721						  HEAD	  85h,'FLUS',310Q,FLUSH,$COL	      ;	FLUSH
1  4722	      =ARRAY:26A2		 LINK$=$
1  4723	26A2  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4724							 ; 6 - признак immediate. 5- слово не описано smudge
1  4725	26A3  46 4C 55 53		     DB	 'FLUS'
1  4726	26A7  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1  4727	26A8  2684r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4728	      =ARRAY:26A2		 LINK=LINK$
1  4729	26AA				 FLUSH LABEL FAR  ; CFA
1  4730	26AA  1D7Cr			     DW	$COL
   4731					 ; запись буферов на диск
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 84
forth.asm



   4732	26AC  1F0Er 1A79r 1F02r	  +		  DW  LIMIT,AT,FIRST,AT,XDO
   4733	      1A79r 1056r
   4734	26B6  1824r 1A79r 1194r	  +	FLU:	  DW  I,AT,ZLESS,ZBRAN,FL1-$
   4735	      1015r 000E
   4736	26C0  1824r 14DBr 1824r	  +		  DW  I,TWOP,I,X,ZERO, RW
   4737	      1D4Ar 1E65r 2CDFr
   4738	26CC  0FCEr 0404 10ADr	  +	FL1:	  DW  LIT,1028,XPLOO,FLU-$,MTBUF,SEMI
   4739	      FFE4 2694r 17AAr
   4740
   4741						  HEAD	  86h,'BUFFE',322Q,BUFFE,$COL	      ;	BUFFER
1  4742	      =ARRAY:26D8		 LINK$=$
1  4743	26D8  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  4744							 ; 6 - признак immediate. 5- слово не описано smudge
1  4745	26D9  42 55 46 46 45		     DB	 'BUFFE'
1  4746	26DE  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4747	26DF  26A2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4748	      =ARRAY:26D8		 LINK=LINK$
1  4749	26E1				 BUFFE LABEL FAR  ; CFA
1  4750	26E1  1D7Cr			     DW	$COL
   4751					 ; u --> адр  Резервирует блок в памяти, приписывает ему
   4752					 ; номер u, но никакого	чтения с носителя не производится
   4753	26E3  1FB9r 1A79r 17E9r	  +		  DW  USE,AT,TOR,I	 ; адрес буфера	в стеках
   4754	      1824r
   4755	26EB  1CEDr 1015r FFFC		BR1:	  DW  PBUF,ZBRAN,BR1-$	 ; ищем	свободный буфер
   4756	26F1  1FB9r 1AB1r			 DW USE,STORE		 ; полученный адрес сохранить в	USE
   4757	26F5  1824r 1A79r 1194r	  +		  DW  I,AT,ZLESS,ZBRAN,BR2-$ ; если buffer изменен,
   4758	      1015r 000E
   4759	26FF  1824r 14DBr 1824r	  +		  DW  I,TWOP,I,X,ZERO, RW    ; то запись его на	диск
   4760	      1D4Ar 1E65r 2CDFr
   4761	270B  1824r 1AB1r 1824r	  +	BR2:	  DW  I,STORE,I,PREV,STORE   ; номер буфера записать и адрес сохранить в PREV
   4762	      1FC4r 1AB1r
   4763	2715  1807r 14DBr 17AAr			 DW FROMR,TWOP,SEMI	     ; возвращаемое значение
   4764
   4765						  HEAD	  85h,'BLOC',313Q,BLOCK,$COL	      ;	BLOCK
1  4766	      =ARRAY:271B		 LINK$=$
1  4767	271B  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4768							 ; 6 - признак immediate. 5- слово не описано smudge
1  4769	271C  42 4C 4F 43		     DB	 'BLOC'
1  4770	2720  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  4771	2721  26D8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4772	      =ARRAY:271B		 LINK=LINK$
1  4773	2723				 BLOCK LABEL FAR  ; CFA
1  4774	2723  1D7Cr			     DW	$COL
   4775					 ;   u --> адр	Записывает в стек адрес	первого	байта в	блоке с
   4776					 ;   номером u.	Если блок не находится в памяти, он переносится	с носителя
   4777	2725  1F55r 1A79r 160Cr	  +		  DW  OFSET,AT,PLUS,TOR
   4778	      17E9r
   4779	272D  1FC4r 1A79r 1905r	  +		  DW  PREV,AT,DUBL,X,I,SUBB,ZBRAN,BLC-$
   4780	      1D4Ar 1824r 1628r	  +
   4781	      1015r 002E
   4782	273D  1CEDr 115Fr 1015r	  +	BLO:	  DW  PBUF,ZEQU,ZBRAN,BCK-$
   4783	      0012
   4784	2745  1990r 1824r 26E1r	  +		  DW  DROP,I,BUFFE,DUBL,I,ONE,RW,CFA
   4785	      1905r 1824r 1E6Dr	  +
   4786	      2CDFr 1B1Ar
   4787	2755  1905r 1D4Ar 1824r	  +	BCK:	  DW  DUBL,X,I,SUBB,ZEQU
   4788	      1628r 115Fr
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 85
forth.asm



   4789	275F  1015r FFDC 1905r	  +		  DW  ZBRAN,BLO-$,DUBL,PREV,STORE
   4790	      1FC4r 1AB1r
   4791	2769  1807r 1990r 14DBr	  +	BLC:	  DW  FROMR,DROP,TWOP,SEMI
   4792	      17AAr
   4793
   4794						  HEAD	  85h,'.LIN',305Q,DLINE,$COL	      ;	.LINE
1  4795	      =ARRAY:2771		 LINK$=$
1  4796	2771  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4797							 ; 6 - признак immediate. 5- слово не описано smudge
1  4798	2772  2E 4C 49 4E		     DB	 '.LIN'
1  4799	2776  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4800	2777  271Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4801	      =ARRAY:2771		 LINK=LINK$
1  4802	2779				 DLINE LABEL FAR  ; CFA
1  4803	2779  1D7Cr			     DW	$COL
   4804					 ; печать строки по номеру экрана
   4805	277B  17E9r 1E97r 1EA0r	  +		  DW  TOR,$CL,BBUF,SSMOD,FROMR,PLUS,BLOCK
   4806	      264Br 1807r 160Cr	  +
   4807	      2723r
   4808	2789  160Cr 1E97r 1C71r	  +		  DW  PLUS,$CL,DTRAI,$TYPE,SEMI
   4809	      214Fr 17AAr
   4810
   4811						  HEAD	  87h,'MESSAG',305Q,MESS,$COL	      ;	MESSAGE
1  4812	      =ARRAY:2793		 LINK$=$
1  4813	2793  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  4814							 ; 6 - признак immediate. 5- слово не описано smudge
1  4815	2794  4D 45 53 53 41 47		     DB	 'MESSAG'
1  4816	279A  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4817	279B  2771r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4818	      =ARRAY:2793		 LINK=LINK$
1  4819	279D				 MESS LABEL FAR	 ; CFA
1  4820	279D  1D7Cr			     DW	$COL
   4821	279F  1F34r 1A79r 1FA5r	  +		  DW  $IN,AT,RNUM,STORE	; сохранить значение $in
   4822	      1AB1r
   4823	27A7  1ED6r 1A79r 1015r	  +		  DW  $WARN,AT,ZBRAN,MS1-$ ; нужен ли текст сообщения
   4824	      0016
   4825	27AF  1922r 1015r 000E			  DW  DDUP,ZBRAN,MES-$
   4826	27B5  0FCEr 0004 1F55r	  +		  DW  LIT,4,OFSET,AT,SUBB,DLINE	; текстовые сообщения на 4 экране
   4827	      1A79r 1628r 2779r
   4828	27C1  17AAr			MES:	  DW  SEMI
   4829	27C3  217Cr			MS1:	  DW  PDOTQ
   4830	27C5  06 4D 53 47 20 23	20		  DB  6,'MSG # '
   4831	27CC  2A62r 17AAr			  DW $DOT,SEMI
   4832
   4833						  HEAD	  84h,'LOA',304Q,LOA,$COL	     ; LOAD
1  4834	      =ARRAY:27D0		 LINK$=$
1  4835	27D0  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4836							 ; 6 - признак immediate. 5- слово не описано smudge
1  4837	27D1  4C 4F 41			     DB	 'LOA'
1  4838	27D4  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4839	27D5  2793r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4840	      =ARRAY:27D0		 LINK=LINK$
1  4841	27D7				 LOA LABEL FAR	; CFA
1  4842	27D7  1D7Cr			     DW	$COL
   4843					 ; n ->	номер экрана
   4844	27D9  1F2Br 1A79r 1F34r	  +		  DW  BLK,AT,$IN,AT,ZERO,$IN,STORE,ROT,BLK
   4845	      1A79r 1E65r 1F34r	  +
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 86
forth.asm



   4846	      1AB1r 1952r 1F2Br
   4847	27EB  1AB1r 250Fr 1F34r	  +		  DW  STORE,INTER,$IN,STORE,BLK,STORE,SEMI
   4848	      1AB1r 1F2Br 1AB1r	  +
   4849	      17AAr
   4850
   4851						  HEAD	  303Q,'--',276Q,ARROW,$COL	       ; -->
1  4852	      =ARRAY:27F9		 LINK$=$
1  4853	27F9  C3			     DB	 303Q  ; NFA 7 бит равен 1.
1  4854							 ; 6 - признак immediate. 5- слово не описано smudge
1  4855	27FA  2D 2D			     DB	 '--'
1  4856	27FC  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1  4857	27FD  27D0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4858	      =ARRAY:27F9		 LINK=LINK$
1  4859	27FF				 ARROW LABEL FAR  ; CFA
1  4860	27FF  1D7Cr			     DW	$COL
   4861					 ; згрузка следующего экрана
   4862	2801  20CDr 1E65r 1F34r	  +		  DW  QLOAD,ZERO,$IN,STORE,ONE
   4863	      1AB1r 1E6Dr
   4864	280B  1F2Br 1A40r 17AAr			  DW  BLK,PSTOR,SEMI
   4865
   4866						  HEAD	  301Q,,247Q,TICK,$COL		       ; '
1  4867	      =ARRAY:2811		 LINK$=$
1  4868	2811  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  4869							 ; 6 - признак immediate. 5- слово не описано smudge
1  4870	2812  A7			     DB	 247Q	; последний символ слова + 128 (7 бит =	1).
1  4871	2813  27F9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4872	      =ARRAY:2811		 LINK=LINK$
1  4873	2815				 TICK LABEL FAR	 ; CFA
1  4874	2815  1D7Cr			     DW	$COL
   4875					 ; Ищет	слово XXX в словаре и записывает в стек	его PFA
   4876	2817  22A7r 115Fr 1E65r	  +		  DW  DFIND,ZEQU,ZERO,QERR,DROP,TWOP,LITER,SEMI
   4877	      205Ar 1990r 14DBr	  +
   4878	      24ADr 17AAr
   4879
   4880						  HEAD	  86h,'FORGE',324Q,FORGE,$COL	      ;	FORGET
1  4881	      =ARRAY:2827		 LINK$=$
1  4882	2827  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  4883							 ; 6 - признак immediate. 5- слово не описано smudge
1  4884	2828  46 4F 52 47 45		     DB	 'FORGE'
1  4885	282D  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4886	282E  2811r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4887	      =ARRAY:2827		 LINK=LINK$
1  4888	2830				 FORGE LABEL FAR  ; CFA
1  4889	2830  1D7Cr			     DW	$COL
   4890	2832  1F71r 1A79r 1F63r	  +		  DW  CURR,AT,CONT,AT,SUBB,LIT,30Q,QERR	    ; 24 ошибка	не описана
   4891	      1A79r 1628r 0FCEr	  +
   4892	      0018 205Ar
   4893											     ; ошибка если CURRENT = CONTEXT
   4894	2842  2815r 1905r 1EE2r	  +		  DW  TICK,DUBL,FENCE,AT,ULESS,LIT,25Q,QERR  ; 21 слово	защищено
   4895	      1A79r 11B1r 0FCEr	  +
   4896	      0015 205Ar
   4897	2852  1905r 1AEAr 1EEBr	  +		  DW  DUBL,NFA,$DP,STORE		    ; словарь свободен до указаного слова
   4898	      1AB1r
   4899	285A  1AFCr 1A79r 1F63r	  +		  DW  LFA,AT,CONT,AT,STORE,SEMI		    ; в	переменную context пишем адрес
   4900	      1A79r 1AB1r 17AAr
   4901										     ; значение	LFA забываемого	слова
   4902
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 87
forth.asm



   4903						  HEAD	  84h,'BAC',313Q,BACK,$COL	      ;	BACK
1  4904	      =ARRAY:2866		 LINK$=$
1  4905	2866  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4906							 ; 6 - признак immediate. 5- слово не описано smudge
1  4907	2867  42 41 43			     DB	 'BAC'
1  4908	286A  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  4909	286B  2827r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4910	      =ARRAY:2866		 LINK=LINK$
1  4911	286D				 BACK LABEL FAR	 ; CFA
1  4912	286D  1D7Cr			     DW	$COL
   4913					 ; HERE	- , ; (компилирует в описание слова адрес возврата)
   4914	286F  1B56r 1628r 2013r	  +		  DW  HERE,SUBB,COMMA,SEMI
   4915	      17AAr
   4916
   4917						  HEAD	  305Q,'BEGI',316Q,BEGIN,$COL	       ; BEGIN
1  4918	      =ARRAY:2877		 LINK$=$
1  4919	2877  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  4920							 ; 6 - признак immediate. 5- слово не описано smudge
1  4921	2878  42 45 47 49		     DB	 'BEGI'
1  4922	287C  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  4923	287D  2866r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4924	      =ARRAY:2877		 LINK=LINK$
1  4925	287F				 BEGIN LABEL FAR  ; CFA
1  4926	287F  1D7Cr			     DW	$COL
   4927					 ; BEGIN ... UNTIL
   4928					 ; BEGIN ... AGAIN
   4929					 ; BEGIN ... WHILE ... REPEAT
   4930	2881  2072r 1B56r 1E6Dr	  +		  DW  QCOMP,HERE,ONE,SEMI
   4931	      17AAr
   4932
   4933						  HEAD	  302Q,'D',317Q,$DO,$COL	       ; DO
1  4934	      =ARRAY:2889		 LINK$=$
1  4935	2889  C2			     DB	 302Q  ; NFA 7 бит равен 1.
1  4936							 ; 6 - признак immediate. 5- слово не описано smudge
1  4937	288A  44			     DB	 'D'
1  4938	288B  CF			     DB	 317Q	; последний символ слова + 128 (7 бит =	1).
1  4939	288C  2877r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4940	      =ARRAY:2889		 LINK=LINK$
1  4941	288E				 $DO LABEL FAR	; CFA
1  4942	288E  1D7Cr			     DW	$COL
   4943	2890  20E7r 1056r 1B56r	  +		  DW  COMP,XDO,HERE,THREE,SEMI
   4944	      1E7Dr 17AAr
   4945
   4946						  HEAD	  304Q,'LOO',320Q,LOO,$COL	      ;	LOOP
1  4947	      =ARRAY:289A		 LINK$=$
1  4948	289A  C4			     DB	 304Q  ; NFA 7 бит равен 1.
1  4949							 ; 6 - признак immediate. 5- слово не описано smudge
1  4950	289B  4C 4F 4F			     DB	 'LOO'
1  4951	289E  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  4952	289F  2889r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4953	      =ARRAY:289A		 LINK=LINK$
1  4954	28A1				 LOO LABEL FAR	; CFA
1  4955	28A1  1D7Cr			     DW	$COL
   4956	28A3  1E7Dr 20A0r 20E7r	  +		  DW  THREE,QPAIR,COMP,XLOOP,BACK,SEMI
   4957	      107Fr 286Dr 17AAr
   4958
   4959						  HEAD	  305Q,'+LOO',320Q,PLOOP,$COL	       ; +LOOP
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 88
forth.asm



1  4960	      =ARRAY:28AF		 LINK$=$
1  4961	28AF  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  4962							 ; 6 - признак immediate. 5- слово не описано smudge
1  4963	28B0  2B 4C 4F 4F		     DB	 '+LOO'
1  4964	28B4  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  4965	28B5  289Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4966	      =ARRAY:28AF		 LINK=LINK$
1  4967	28B7				 PLOOP LABEL FAR  ; CFA
1  4968	28B7  1D7Cr			     DW	$COL
   4969	28B9  1E7Dr 20A0r 20E7r	  +		  DW  THREE,QPAIR,COMP,XPLOO,BACK,SEMI
   4970	      10ADr 286Dr 17AAr
   4971
   4972						  HEAD	  305Q,'UNTI',314Q,UNTIL,$COL	       ; UNTIL
1  4973	      =ARRAY:28C5		 LINK$=$
1  4974	28C5  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  4975							 ; 6 - признак immediate. 5- слово не описано smudge
1  4976	28C6  55 4E 54 49		     DB	 'UNTI'
1  4977	28CA  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  4978	28CB  28AFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4979	      =ARRAY:28C5		 LINK=LINK$
1  4980	28CD				 UNTIL LABEL FAR  ; CFA
1  4981	28CD  1D7Cr			     DW	$COL
   4982	28CF  1E6Dr 20A0r 20E7r	  +		  DW  ONE,QPAIR,COMP,ZBRAN,BACK,SEMI
   4983	      1015r 286Dr 17AAr
   4984
   4985						 HEAD	 305Q,'AGAI','N'+80h,AGAIN,$COL	       ; AGAIN sds
1  4986	      =ARRAY:28DB		 LINK$=$
1  4987	28DB  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  4988							 ; 6 - признак immediate. 5- слово не описано smudge
1  4989	28DC  41 47 41 49		     DB	 'AGAI'
1  4990	28E0  CE			     DB	 'N'+80h   ; последний символ слова + 128 (7 бит = 1).
1  4991	28E1  28C5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4992	      =ARRAY:28DB		 LINK=LINK$
1  4993	28E3				 AGAIN LABEL FAR  ; CFA
1  4994	28E3  1D7Cr			     DW	$COL
   4995	28E5  1E6Dr 20A0r 20E7r	  +		 DW  ONE,QPAIR,COMP,BRAN,BACK,SEMI
   4996	      103Ar 286Dr 17AAr
   4997
   4998						  HEAD	  305Q,'WHIL',305Q,$WHILE,$COL	       ; WHILE
1  4999	      =ARRAY:28F1		 LINK$=$
1  5000	28F1  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  5001							 ; 6 - признак immediate. 5- слово не описано smudge
1  5002	28F2  57 48 49 4C		     DB	 'WHIL'
1  5003	28F6  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  5004	28F7  28DBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5005	      =ARRAY:28F1		 LINK=LINK$
1  5006	28F9				 $WHILE	LABEL FAR  ; CFA
1  5007	28F9  1D7Cr			     DW	$COL
   5008	28FB  2921r 17AAr			  DW  $IF,SEMI
   5009
   5010						  HEAD	  306Q,'REPEA',324Q,REPEA,$COL	      ;	REPEAT
1  5011	      =ARRAY:28FF		 LINK$=$
1  5012	28FF  C6			     DB	 306Q  ; NFA 7 бит равен 1.
1  5013							 ; 6 - признак immediate. 5- слово не описано smudge
1  5014	2900  52 45 50 45 41		     DB	 'REPEA'
1  5015	2905  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  5016	2906  28F1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 89
forth.asm



1  5017	      =ARRAY:28FF		 LINK=LINK$
1  5018	2908				 REPEA LABEL FAR  ; CFA
1  5019	2908  1D7Cr			     DW	$COL
   5020	290A  1952r 1E6Dr 20A0r	  +		  DW  ROT,ONE,QPAIR,ROT,COMP,BRAN,BACK
   5021	      1952r 20E7r 103Ar	  +
   5022	      286Dr
   5023	2918  2959r 17AAr			  DW  THEN,SEMI
   5024
   5025						  HEAD	  302Q,'I',306Q,$IF,$COL	       ; IF
1  5026	      =ARRAY:291C		 LINK$=$
1  5027	291C  C2			     DB	 302Q  ; NFA 7 бит равен 1.
1  5028							 ; 6 - признак immediate. 5- слово не описано smudge
1  5029	291D  49			     DB	 'I'
1  5030	291E  C6			     DB	 306Q	; последний символ слова + 128 (7 бит =	1).
1  5031	291F  28FFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5032	      =ARRAY:291C		 LINK=LINK$
1  5033	2921				 $IF LABEL FAR	; CFA
1  5034	2921  1D7Cr			     DW	$COL
   5035	2923  20E7r 1015r 1B56r	  +		  DW  COMP,ZBRAN,HERE,ZERO,COMMA,TWO,SEMI
   5036	      1E65r 2013r 1E75r	  +
   5037	      17AAr
   5038
   5039						  HEAD	  304Q,'ELS',305Q,$ELSE,$COL	       ; ELSE
1  5040	      =ARRAY:2931		 LINK$=$
1  5041	2931  C4			     DB	 304Q  ; NFA 7 бит равен 1.
1  5042							 ; 6 - признак immediate. 5- слово не описано smudge
1  5043	2932  45 4C 53			     DB	 'ELS'
1  5044	2935  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  5045	2936  291Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5046	      =ARRAY:2931		 LINK=LINK$
1  5047	2938				 $ELSE LABEL FAR  ; CFA
1  5048	2938  1D7Cr			     DW	$COL
   5049	293A  1E75r 20A0r 20E7r			  DW  TWO,QPAIR,COMP
   5050	2940  103Ar 1B56r 1E65r	  +		  DW  BRAN,HERE,ZERO,COMMA   ; если исполнение пришло к	этому BRAN
   5051	      2013r
   5052									     ; значит была выполнена ветка TRUE	и
   5053									     ; надо перепрыгнуть ветку FALSE (безусловно)
   5054	2948  18B9r 1E75r 2959r	  +		  DW  SWAP,TWO,THEN,TWO,SEMI ; адреса переходов	меняем местами,	т.к.
   5055	      1E75r 17AAr
   5056									     ; по условию FALSE	должен выполниться
   5057									     ; код после слова ELSE, воспользуемся
   5058									     ; для этого словом	THEN
   5059
   5060						  HEAD	  304Q,'THE',316Q,THEN,$COL	       ; THEN
1  5061	      =ARRAY:2952		 LINK$=$
1  5062	2952  C4			     DB	 304Q  ; NFA 7 бит равен 1.
1  5063							 ; 6 - признак immediate. 5- слово не описано smudge
1  5064	2953  54 48 45			     DB	 'THE'
1  5065	2956  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  5066	2957  2931r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5067	      =ARRAY:2952		 LINK=LINK$
1  5068	2959				 THEN LABEL FAR	 ; CFA
1  5069	2959  1D7Cr			     DW	$COL
   5070	295B  2072r 1E75r 20A0r	  +		  DW  QCOMP,TWO,QPAIR,HERE,OVER,SUBB,SWAP,STORE,SEMI
   5071	      1B56r 1899r 1628r	  +
   5072	      18B9r 1AB1r 17AAr
   5073					 ; if -	step	  cond if true else false then
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 90
forth.asm



   5074					     ; DICT:  ?BRANCH 0
   5075					     ; STACK:  adr_if
   5076					 ; else	- step получается слишком много	кода...	Вроде разобрался! :)
   5077					     ; ?BRANCH 0     BRANCH 0
   5078					     ;	adr_else adr_if
   5079					 ; then	- step
   5080					     ;1	DICT:  ?BRANCH 0
   5081					     ;1	STACK:	adr_if
   5082					     ;2	STACK:	adr_if adr_then
   5083					     ;3	STACK:	adr_if adr_then	 adr_if
   5084					     ;4	STACK:	adr_if (adr_if-adr_then)
   5085					     ;4	STACK:	(adr_if-adr_then) adr_if
   5086					     ;5	DICT:  ?BRANCH [adr_if]=(adr_if-adr_then)
   5087					     ;5	STACK:
   5088
   5089						  HEAD	  86h,'SPACE',323Q,SPACS,$COL	      ;	SPACES
1  5090	      =ARRAY:296D		 LINK$=$
1  5091	296D  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  5092							 ; 6 - признак immediate. 5- слово не описано smudge
1  5093	296E  53 50 41 43 45		     DB	 'SPACE'
1  5094	2973  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  5095	2974  2952r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5096	      =ARRAY:296D		 LINK=LINK$
1  5097	2976				 SPACS LABEL FAR  ; CFA
1  5098	2976  1D7Cr			     DW	$COL
   5099	2978  1E65r 1755r 1922r	  +		  DW  ZERO,MAX,DDUP,ZBRAN,SP1-$,ZERO,XDO
   5100	      1015r 000C 1E65r	  +
   5101	      1056r
   5102	2986  2038r 107Fr FFFC		SPA:	  DW  SPACE,XLOOP,SPA-$
   5103	298C  17AAr			SP1:	  DW  SEMI
   5104
   5105						  HEAD	  82h,'#',243Q,BDIGS,$COL	      ;	<# ; sds replace
1  5106	      =ARRAY:298E		 LINK$=$
1  5107	298E  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5108							 ; 6 - признак immediate. 5- слово не описано smudge
1  5109	298F  23			     DB	 '#'
1  5110	2990  A3			     DB	 243Q	; последний символ слова + 128 (7 бит =	1).
1  5111	2991  296Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5112	      =ARRAY:298E		 LINK=LINK$
1  5113	2993				 BDIGS LABEL FAR  ; CFA
1  5114	2993  1D7Cr			     DW	$COL
   5115					 ; Начинает процесс преобразования числа в последовательность кодов ASCII.
   5116					 ; Исходное число в стеке должно быть двойной длины без	знака
   5117	2995  2203r 1FAFr 1AB1r	  +		  DW  PAD,HLD,STORE,SEMI
   5118	      17AAr
   5119
   5120						  HEAD	  82h,'#',276Q,EDIGS,$COL	      ;	#>
1  5121	      =ARRAY:299D		 LINK$=$
1  5122	299D  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5123							 ; 6 - признак immediate. 5- слово не описано smudge
1  5124	299E  23			     DB	 '#'
1  5125	299F  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1  5126	29A0  298Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5127	      =ARRAY:299D		 LINK=LINK$
1  5128	29A2				 EDIGS LABEL FAR  ; CFA
1  5129	29A2  1D7Cr			     DW	$COL
   5130					 ; Завершает преобразование числа. В стеке остается число
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 91
forth.asm



   5131					 ; полученных символов и адрес,	как это	требуется для
   5132					 ; оператора TYPE
   5133	29A4  1973r 1FAFr 1A79r	  +		  DW  DDROP,HLD,AT,PAD,OVER,SUBB,SEMI
   5134	      2203r 1899r 1628r	  +
   5135	      17AAr
   5136
   5137						  HEAD	  84h,'SIG',316Q,SIGN,$COL	      ;	SIGN
1  5138	      =ARRAY:29B2		 LINK$=$
1  5139	29B2  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5140							 ; 6 - признак immediate. 5- слово не описано smudge
1  5141	29B3  53 49 47			     DB	 'SIG'
1  5142	29B6  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  5143	29B7  299Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5144	      =ARRAY:29B2		 LINK=LINK$
1  5145	29B9				 SIGN LABEL FAR	 ; CFA
1  5146	29B9  1D7Cr			     DW	$COL
   5147					 ; Вводит знак "минус" в выходной буфер
   5148	29BB  1952r 1194r 1015r	  +		  DW  ROT,ZLESS,ZBRAN,SIG-$,LIT,55Q,HOLD
   5149	      0008 0FCEr 002D	  +
   5150	      1A1Fr
   5151	29C9  17AAr			SIG:	  DW  SEMI
   5152
   5153						  HEAD	  81h,,243Q,DIG,$COL		      ;	#
1  5154	      =ARRAY:29CB		 LINK$=$
1  5155	29CB  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  5156							 ; 6 - признак immediate. 5- слово не описано smudge
1  5157	29CC  A3			     DB	 243Q	; последний символ слова + 128 (7 бит =	1).
1  5158	29CD  29B2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5159	      =ARRAY:29CB		 LINK=LINK$
1  5160	29CF				 DIG LABEL FAR	; CFA
1  5161	29CF  1D7Cr			     DW	$COL
   5162					 ; Преобразует одну цифру и записывает ее в выходной буфер (PAD),
   5163					 ; выдает цифру	всегда,	если преобразовывать нечего, записывается 0
   5164	29D1  1F88r 1A79r 266Er	  +		  DW  BASE,AT,MSMOD,ROT,LIT,11Q,OVER,LESS
   5165	      1952r 0FCEr 0009	  +
   5166	      1899r 11BFr
   5167	29E1  1015r 0008 0FCEr	  +		  DW  ZBRAN,DIGI-$,LIT,7,PLUS
   5168	      0007 160Cr
   5169	29EB  0FCEr 0030 160Cr	  +	DIGI:	  DW  LIT,60Q,PLUS,HOLD,SEMI
   5170	      1A1Fr 17AAr
   5171
   5172						  HEAD	  82h,'#',323Q,DIGS,$COL	      ;	#S
1  5173	      =ARRAY:29F5		 LINK$=$
1  5174	29F5  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5175							 ; 6 - признак immediate. 5- слово не описано smudge
1  5176	29F6  23			     DB	 '#'
1  5177	29F7  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  5178	29F8  29CBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5179	      =ARRAY:29F5		 LINK=LINK$
1  5180	29FA				 DIGS LABEL FAR	 ; CFA
1  5181	29FA  1D7Cr			     DW	$COL
   5182					 ; Преобразует число до	тех пор, пока не будет получен 0.
   5183					 ; Одна	цифра выдается в любом случае (0)
   5184	29FC  29CFr 1933r 16E5r	  +	DIS:	  DW  DIG,DUP2,$OR,ZEQU,ZBRAN,DIS-$,SEMI
   5185	      115Fr 1015r FFF6	  +
   5186	      17AAr
   5187
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 92
forth.asm



   5188						  HEAD	  83h,'D.',322Q,DDOTR,$COL	      ;	D.R
1  5189	      =ARRAY:2A0A		 LINK$=$
1  5190	2A0A  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  5191							 ; 6 - признак immediate. 5- слово не описано smudge
1  5192	2A0B  44 2E			     DB	 'D.'
1  5193	2A0D  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  5194	2A0E  29F5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5195	      =ARRAY:2A0A		 LINK=LINK$
1  5196	2A10				 DDOTR LABEL FAR  ; CFA
1  5197	2A10  1D7Cr			     DW	$COL
   5198					 ; s width -> печать двойного числа со знаком с	выравниваем вправо
   5199	2A12  17E9r 18B9r 1899r	  +		  DW  TOR,SWAP,OVER,DABS,BDIGS,DIGS,SIGN,EDIGS
   5200	      15CFr 2993r 29FAr	  +
   5201	      29B9r 29A2r
   5202	2A22  1807r 1899r 1628r	  +		  DW  FROMR,OVER,SUBB,SPACS,$TYPE,SEMI
   5203	      2976r 214Fr 17AAr
   5204
   5205						  HEAD	  82h,'.',322Q,DOTR,$COL	      ;	.R
1  5206	      =ARRAY:2A2E		 LINK$=$
1  5207	2A2E  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5208							 ; 6 - признак immediate. 5- слово не описано smudge
1  5209	2A2F  2E			     DB	 '.'
1  5210	2A30  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  5211	2A31  2A0Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5212	      =ARRAY:2A2E		 LINK=LINK$
1  5213	2A33				 DOTR LABEL FAR	 ; CFA
1  5214	2A33  1D7Cr			     DW	$COL
   5215					 ; s width -> печать числа со знаком с выравниваем вправо
   5216	2A35  17E9r 1702r 1807r	  +		  DW  TOR,STOD,FROMR,DDOTR,SEMI
   5217	      2A10r 17AAr
   5218
   5219						  HEAD	  83h,'U.',322Q,UDOTR,$COL	      ;	U.R
1  5220	      =ARRAY:2A3F		 LINK$=$
1  5221	2A3F  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  5222							 ; 6 - признак immediate. 5- слово не описано smudge
1  5223	2A40  55 2E			     DB	 'U.'
1  5224	2A42  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  5225	2A43  2A2Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5226	      =ARRAY:2A3F		 LINK=LINK$
1  5227	2A45				 UDOTR LABEL FAR  ; CFA
1  5228	2A45  1D7Cr			     DW	$COL
   5229					 ; u width -> печать числа без знака с выравниваем вправо
   5230	2A47  1E65r 18B9r 2A10r	  +		  DW  ZERO,SWAP,DDOTR,SEMI
   5231	      17AAr
   5232
   5233						  HEAD	  82h,'D',256Q,DDOT,$COL	      ;	D.
1  5234	      =ARRAY:2A4F		 LINK$=$
1  5235	2A4F  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5236							 ; 6 - признак immediate. 5- слово не описано smudge
1  5237	2A50  44			     DB	 'D'
1  5238	2A51  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  5239	2A52  2A3Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5240	      =ARRAY:2A4F		 LINK=LINK$
1  5241	2A54				 DDOT LABEL FAR	 ; CFA
1  5242	2A54  1D7Cr			     DW	$COL
   5243					 ; печать двойных чисел
   5244	2A56  1E65r 2A10r 2038r	  +		  DW  ZERO,DDOTR,SPACE,SEMI
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 93
forth.asm



   5245	      17AAr
   5246
   5247						  HEAD	  81h,,256Q,$DOT,$COL		      ;	.
1  5248	      =ARRAY:2A5E		 LINK$=$
1  5249	2A5E  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  5250							 ; 6 - признак immediate. 5- слово не описано smudge
1  5251	2A5F  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  5252	2A60  2A4Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5253	      =ARRAY:2A5E		 LINK=LINK$
1  5254	2A62				 $DOT LABEL FAR	 ; CFA
1  5255	2A62  1D7Cr			     DW	$COL
   5256	2A64  1702r 2A54r 17AAr			  DW  STOD,DDOT,SEMI
   5257
   5258						  HEAD	  81h,,277Q,QUEST,$COL		      ;	?
1  5259	      =ARRAY:2A6A		 LINK$=$
1  5260	2A6A  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  5261							 ; 6 - признак immediate. 5- слово не описано smudge
1  5262	2A6B  BF			     DB	 277Q	; последний символ слова + 128 (7 бит =	1).
1  5263	2A6C  2A5Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5264	      =ARRAY:2A6A		 LINK=LINK$
1  5265	2A6E				 QUEST LABEL FAR  ; CFA
1  5266	2A6E  1D7Cr			     DW	$COL
   5267					 ; печать содержимого по адресу	в стеке
   5268	2A70  1A79r 2A62r 17AAr			  DW  AT,$DOT,SEMI
   5269
   5270						  HEAD	  82h,'U',256Q,UDOT,$COL	      ;	U.
1  5271	      =ARRAY:2A76		 LINK$=$
1  5272	2A76  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5273							 ; 6 - признак immediate. 5- слово не описано smudge
1  5274	2A77  55			     DB	 'U'
1  5275	2A78  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  5276	2A79  2A6Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5277	      =ARRAY:2A76		 LINK=LINK$
1  5278	2A7B				 UDOT LABEL FAR	 ; CFA
1  5279	2A7B  1D7Cr			     DW	$COL
   5280					 ; печать числа	без знака
   5281	2A7D  1E65r 2A54r 17AAr			  DW  ZERO,DDOT,SEMI
   5282
   5283					 ;	   ** Вспомогательные процедуры	**
   5284
   5285						  HEAD	  84h,'LIS',324Q,$LIST,$COL	      ;	LIST
1  5286	      =ARRAY:2A83		 LINK$=$
1  5287	2A83  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5288							 ; 6 - признак immediate. 5- слово не описано smudge
1  5289	2A84  4C 49 53			     DB	 'LIS'
1  5290	2A87  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  5291	2A88  2A76r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5292	      =ARRAY:2A83		 LINK=LINK$
1  5293	2A8A				 $LIST LABEL FAR  ; CFA
1  5294	2A8A  1D7Cr			     DW	$COL
   5295					 ; n ->	вывод содержимого экрана
   5296	2A8C  1C0Fr 1FFFr 1905r	  +		  DW  DECIMA,CR,DUBL,SCR,STORE,PDOTQ
   5297	      1F48r 1AB1r 217Cr
   5298	2A98  03 53 23 20			  DB  3,'S# '
   5299	2A9C  2A62r				  DW  $DOT
   5300	2A9E  0FCEr 0010 1E65r	  +		  DW  LIT,20Q,ZERO,XDO
   5301	      1056r
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 94
forth.asm



   5302	2AA6  1FFFr 1824r 1E7Dr	  +	LSTI:	  DW  CR,I,THREE,DOTR,SPACE
   5303	      2A33r 2038r
   5304	2AB0  1824r 1F48r 1A79r	  +		  DW  I,SCR,AT,DLINE
   5305	      2779r
   5306	2AB8  107Fr FFEC 1FFFr	  +		  DW XLOOP,LSTI-$,CR,SEMI
   5307	      17AAr
   5308
   5309						  HEAD	  85h,'INDE',330Q,INDEX,$COL	      ;	INDEX
1  5310	      =ARRAY:2AC0		 LINK$=$
1  5311	2AC0  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5312							 ; 6 - признак immediate. 5- слово не описано smudge
1  5313	2AC1  49 4E 44 45		     DB	 'INDE'
1  5314	2AC5  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  5315	2AC6  2A83r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5316	      =ARRAY:2AC0		 LINK=LINK$
1  5317	2AC8				 INDEX LABEL FAR  ; CFA
1  5318	2AC8  1D7Cr			     DW	$COL
   5319					 ; n1 n2 -> выводит первую строку экранов с n1 по n2
   5320	2ACA  14C0r 18B9r 1056r			  DW  ONEP,SWAP,XDO
   5321	2AD0  1FFFr 1824r 1E7Dr	  +	INDX:	  DW  CR,I,THREE,DOTR,SPACE,ZERO,I,DLINE
   5322	      2A33r 2038r 1E65r	  +
   5323	      1824r 2779r
   5324	2AE0  107Fr FFEE 17AAr			  DW  XLOOP,INDX-$,SEMI
   5325
   5326						  HEAD	  84h,'TRI',317Q,TRIO,$COL	      ;	TRIO
1  5327	      =ARRAY:2AE6		 LINK$=$
1  5328	2AE6  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5329							 ; 6 - признак immediate. 5- слово не описано smudge
1  5330	2AE7  54 52 49			     DB	 'TRI'
1  5331	2AEA  CF			     DB	 317Q	; последний символ слова + 128 (7 бит =	1).
1  5332	2AEB  2AC0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5333	      =ARRAY:2AE6		 LINK=LINK$
1  5334	2AED				 TRIO LABEL FAR	 ; CFA
1  5335	2AED  1D7Cr			     DW	$COL
   5336					 ; При документировании	текстов	программ оказывается удобным размещать
   5337					 ; тексты экранов по три на странице
   5338	2AEF  0FCEr 000C 12E2r			  DW  LIT,14Q,EMIT
   5339	2AF5  1E7Dr 1899r 160Cr	  +		  DW  THREE,OVER,PLUS,SWAP,XDO
   5340	      18B9r 1056r
   5341	2AFF  1824r 2A8Ar 107Fr	  +	TRI:	  DW  I,$LIST,XLOOP,TRI-$,SEMI
   5342	      FFFA 17AAr
   5343
   5344						  HEAD	  85h,'VLIS',324Q,VLIST,$COL	      ;	VLIST
1  5345	      =ARRAY:2B09		 LINK$=$
1  5346	2B09  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5347							 ; 6 - признак immediate. 5- слово не описано smudge
1  5348	2B0A  56 4C 49 53		     DB	 'VLIS'
1  5349	2B0E  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  5350	2B0F  2AE6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5351	      =ARRAY:2B09		 LINK=LINK$
1  5352	2B11				 VLIST LABEL FAR  ; CFA
1  5353	2B11  1D7Cr			     DW	$COL
   5354					 ; список слов в контекстном словаре
   5355	2B13  1F63r 1A79r 1A79r			  DW  CONT,AT,AT
   5356	2B19  1FFFr 1E7Dr 1E65r	  +	VL0:	  DW  CR,THREE,ZERO,XDO
   5357	      1056r
   5358	2B21  1905r 2424r 0FCEr	  +	VL1:	  DW  DUBL,IDDOT,LIT,15Q,OVER,CAT,LIT,37Q,$AND,SUBB
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 95
forth.asm



   5359	      000D 1899r 1A94r	  +
   5360	      0FCEr 001F 16C8r	  +
   5361	      1628r
   5362	2B35  2976r 2046r 1905r	  +		  DW  SPACS,PFA,DUBL,LIT,6,UDOTR,SPACE,LIT,41Q
   5363	      0FCEr 0006 2A45r	  +
   5364	      2038r 0FCEr 0021
   5365	2B47  12E2r 2038r 1AFCr	  +		  DW  EMIT,SPACE,   LFA,AT,DUBL,ZEQU,ZBRAN,VL2-$
   5366	      1A79r 1905r 115Fr	  +
   5367	      1015r 0004
   5368	2B57  17CBr				  DW  LEAV ; добавил паузу
   5369	2B59  107Fr FFC6 13FBr	  +	VL2:	  DW  XLOOP,VL1-$, KEY,	DROP
   5370	      1990r
   5371	2B61  1922r 115Fr 1015r	  +		  DW  DDUP,ZEQU,ZBRAN,VL0-$,SEMI
   5372	      FFB2 17AAr
   5373
   5374						  HEAD	  83h,'LC',314Q,LCL,$COL	      ;	LCL
1  5375	      =ARRAY:2B6B		 LINK$=$
1  5376	2B6B  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  5377							 ; 6 - признак immediate. 5- слово не описано smudge
1  5378	2B6C  4C 43			     DB	 'LC'
1  5379	2B6E  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  5380	2B6F  2B09r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5381	      =ARRAY:2B6B		 LINK=LINK$
1  5382	2B71				 LCL LABEL FAR	; CFA
1  5383	2B71  1D7Cr			     DW	$COL
   5384					 ; очистка командной строки
   5385	2B73  1E65r 1E65r 13AEr	  +		  DW  ZERO,ZERO,FIX,$CL,SPACS,RC,SEMI
   5386	      1E97r 2976r 1321r	  +
   5387	      17AAr
   5388
   5389						  HEAD	  82h,'H',324Q,HT,$COL		      ;	HT HOME?
1  5390	      =ARRAY:2B81		 LINK$=$
1  5391	2B81  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5392							 ; 6 - признак immediate. 5- слово не описано smudge
1  5393	2B82  48			     DB	 'H'
1  5394	2B83  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  5395	2B84  2B6Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5396	      =ARRAY:2B81		 LINK=LINK$
1  5397	2B86				 HT LABEL FAR  ; CFA
1  5398	2B86  1D7Cr			     DW	$COL
   5399					 ; курсор в начало экрана
   5400	2B88  1E65r 1E65r 13AEr	  +		  DW  ZERO,ZERO,FIX,SEMI
   5401	      17AAr
   5402
   5403						  HEAD	  84h,'COP',331Q,COPY,$COL	      ;	COPY
1  5404	      =ARRAY:2B90		 LINK$=$
1  5405	2B90  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5406							 ; 6 - признак immediate. 5- слово не описано smudge
1  5407	2B91  43 4F 50			     DB	 'COP'
1  5408	2B94  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  5409	2B95  2B81r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5410	      =ARRAY:2B90		 LINK=LINK$
1  5411	2B97				 COPY LABEL FAR	 ; CFA
1  5412	2B97  1D7Cr			     DW	$COL
   5413					 ; копия экрана
   5414	2B99  18B9r 2723r 1B1Ar	  +		  DW  SWAP,BLOCK,CFA,STORE,UPDAT,FLUSH,SEMI
   5415	      1AB1r 1D28r 26AAr	  +
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 96
forth.asm



   5416	      17AAr
   5417
   5418						  HEAD	  82h,'T',331Q,TY$$,$COL	      ;	TY
1  5419	      =ARRAY:2BA7		 LINK$=$
1  5420	2BA7  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5421							 ; 6 - признак immediate. 5- слово не описано smudge
1  5422	2BA8  54			     DB	 'T'
1  5423	2BA9  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  5424	2BAA  2B90r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5425	      =ARRAY:2BA7		 LINK=LINK$
1  5426	2BAC				 TY$$ LABEL FAR	 ; CFA
1  5427	2BAC  1D7Cr			     DW	$COL
   5428					 ; adr n ->  дамп памяти
   5429	2BAE  1E65r 1056r			  DW  ZERO,XDO
   5430	2BB2  1824r 1E85r 263Br	  +	TY4:	  DW  I,EIGHT,$MOD,ZEQU,ZBRAN,TY5-$
   5431	      115Fr 1015r 000C
   5432	2BBE  1FFFr 1905r 0FCEr	  +		  DW  CR,DUBL,LIT,7,UDOTR
   5433	      0007 2A45r
   5434	2BC8  1905r 1A79r 0FCEr	  +	TY5:	  DW  DUBL,AT,LIT,7,UDOTR,TWOP,XLOOP,TY4-$,SEMI
   5435	      0007 2A45r 14DBr	  +
   5436	      107Fr FFDC 17AAr
   5437
   5438						  HEAD	  85h,'DEPT',310Q,DEPTH,$COL	      ;	DEPTH
1  5439	      =ARRAY:2BDA		 LINK$=$
1  5440	2BDA  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5441							 ; 6 - признак immediate. 5- слово не описано smudge
1  5442	2BDB  44 45 50 54		     DB	 'DEPT'
1  5443	2BDF  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1  5444	2BE0  2BA7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5445	      =ARRAY:2BDA		 LINK=LINK$
1  5446	2BE2				 DEPTH LABEL FAR  ; CFA
1  5447	2BE2  1D7Cr			     DW	$COL
   5448					 ; число элементов в стеке
   5449	2BE4  1EA9r 1A79r 1765r	  +		  DW  SZERO,AT,SPAT,TWOP,SUBB,DIV2,SEMI
   5450	      14DBr 1628r 152Fr	  +
   5451	      17AAr
   5452
   5453						  HEAD	  84h,'DUM',320Q,DUMP,$COL	      ;	DUMP
1  5454	      =ARRAY:2BF2		 LINK$=$
1  5455	2BF2  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5456							 ; 6 - признак immediate. 5- слово не описано smudge
1  5457	2BF3  44 55 4D			     DB	 'DUM'
1  5458	2BF6  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  5459	2BF7  2BDAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5460	      =ARRAY:2BF2		 LINK=LINK$
1  5461	2BF9				 DUMP LABEL FAR	 ; CFA
1  5462	2BF9  1D7Cr			     DW	$COL
   5463					 ; адр u --> - Отображает u байт памяти	начиная	с адр
   5464	2BFB  1E65r 1056r			  DW  ZERO,XDO
   5465	2BFF  1905r 0FCEr 0007	  +	DMP:	  DW  DUBL,LIT,7,UDOTR,SPACE,EIGHT,ZERO,XDO
   5466	      2A45r 2038r 1E85r	  +
   5467	      1E65r 1056r
   5468	2C0F  1905r 1824r 160Cr	  +	DP1:	  DW  DUBL,I,PLUS,CAT,LIT,5,DOTR,XLOOP,DP1-$
   5469	      1A94r 0FCEr 0005	  +
   5470	      2A33r 107Fr FFF0
   5471	2C21  0FCEr 0004 2976r	  +		  DW  LIT,4,SPACS,EIGHT,ZERO,XDO
   5472	      1E85r 1E65r 1056r
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 97
forth.asm



   5473	2C2D  1905r 1824r 160Cr	  +	DP2:	  DW  DUBL,I,PLUS,CAT,LIT,177Q,$AND,DUBL,BLAN
   5474	      1A94r 0FCEr 007F	  +
   5475	      16C8r 1905r 1E8Er
   5476	2C3F  11BFr 1015r 0008	  +		  DW  LESS,ZBRAN,DP3-$,DROP,LIT,56Q
   5477	      1990r 0FCEr 002E
   5478	2C4B  12E2r 107Fr FFDE	  +	DP3:	  DW  EMIT,XLOOP,DP2-$,CR,EIGHT,PLUS,EIGHT
   5479	      1FFFr 1E85r 160Cr	  +
   5480	      1E85r
   5481	2C59  10ADr FFA4 1990r	  +		  DW  XPLOO,DMP-$,DROP,SEMI
   5482	      17AAr
   5483
   5484						  HEAD	  84h,'SWA',323Q,SWAS,$COL	      ;	SWAS
1  5485	      =ARRAY:2C61		 LINK$=$
1  5486	2C61  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5487							 ; 6 - признак immediate. 5- слово не описано smudge
1  5488	2C62  53 57 41			     DB	 'SWA'
1  5489	2C65  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  5490	2C66  2BF2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5491	      =ARRAY:2C61		 LINK=LINK$
1  5492	2C68				 SWAS LABEL FAR	 ; CFA
1  5493	2C68  1D7Cr			     DW	$COL
   5494					     ; перемены	 мест экранов М	и N
   5495	2C6A  17E9r 2723r 1B1Ar	  +		  DW  TOR,BLOCK,CFA,DUBL,AT,I,BLOCK,CFA,STORE,UPDAT
   5496	      1905r 1A79r 1824r	  +
   5497	      2723r 1B1Ar 1AB1r	  +
   5498	      1D28r
   5499	2C7E  1807r 0FCEr 8000	  +		  DW  FROMR,LIT,100000Q,$OR,SWAP,STORE,FLUSH,SEMI
   5500	      16E5r 18B9r 1AB1r	  +
   5501	      26AAr 17AAr
   5502
   5503						  HEAD	  83h,'ST',331Q,STY,$COL	      ;	STY
1  5504	      =ARRAY:2C8E		 LINK$=$
1  5505	2C8E  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  5506							 ; 6 - признак immediate. 5- слово не описано smudge
1  5507	2C8F  53 54			     DB	 'ST'
1  5508	2C91  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  5509	2C92  2C61r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5510	      =ARRAY:2C8E		 LINK=LINK$
1  5511	2C94				 STY LABEL FAR	; CFA
1  5512	2C94  1D7Cr			     DW	$COL
   5513					     ; печать стека
   5514	2C96  2BE2r 1922r 1015r	  +		  DW  DEPTH,DDUP,ZBRAN,STY3-$,ZERO,XDO
   5515	      0024 1E65r 1056r
   5516	2CA2  1824r 1E85r 263Br	  +	STY1:	  DW  I,EIGHT,$MOD,ZEQU,ZBRAN,STY2-$,CR
   5517	      115Fr 1015r 0004	  +
   5518	      1FFFr
   5519	2CB0  1824r 14C0r 1871r	  +	STY2:	  DW  I,ONEP,PICK,LIT,7,UDOTR,XLOOP,STY1-$
   5520	      0FCEr 0007 2A45r	  +
   5521	      107Fr FFE4
   5522	2CC0  17AAr			STY3:	  DW  SEMI
   5523
   5524						  HEAD	  82h,'O',256Q,ODOT,$COL	      ;	O.
1  5525	      =ARRAY:2CC2		 LINK$=$
1  5526	2CC2  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5527							 ; 6 - признак immediate. 5- слово не описано smudge
1  5528	2CC3  4F			     DB	 'O'
1  5529	2CC4  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 98
forth.asm



1  5530	2CC5  2C8Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5531	      =ARRAY:2CC2		 LINK=LINK$
1  5532	2CC7				 ODOT LABEL FAR	 ; CFA
1  5533	2CC7  1D7Cr			     DW	$COL
   5534					     ; тоже что	и S. в octal системе
   5535	2CC9  1F88r 1A79r 1899r	  +		  DW  BASE,AT,OVER,OCTAL,UDOT,BASE,STORE,SEMI
   5536	      1C2Fr 2A7Br 1F88r	  +
   5537	      1AB1r 17AAr
   5538
   5539						  HEAD	  83h,'R/',327Q,RW		      ;	R/W
1  5540	      =ARRAY:2CD9		 LINK$=$
1  5541	2CD9  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  5542							 ; 6 - признак immediate. 5- слово не описано smudge
1  5543	2CDA  52 2F			     DB	 'R/'
1  5544	2CDC  D7			     DB	 327Q	; последний символ слова + 128 (7 бит =	1).
1  5545	2CDD  2CC2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5546	      =ARRAY:2CD9		 LINK=LINK$
1  5547	2CDF				 RW LABEL FAR  ; CFA
1  5548	2CDF  2CE1r			     DW	 $+2
   5549					; Открытие файла
   5550	2CE1  BA 2D98r				  MOV	DX, OFFSET file
   5551						  ;MOV	 AH, 0FH      ;	open file
   5552	2CE4  B4 3D				  MOV	AH, 3dh
   5553	2CE6  B0 02				  mov	al, 2
   5554	2CE8  CD 21				  INT	21H
   5555						  ;CMP	 AL, 0FFH
   5556						  ;JE	 ERR0
   5557	2CEA  72 5F				  jc ERR0
   5558	2CEC  A3 2D96r				  mov	 handle, ax
   5559	2CEF  5B				  POP	BX  ; R/W - флаг
   5560	2CF0  58				  POP	AX  ; Номер блока
   5561	2CF1  5A				  POP	DX  ; Адрес буфера
   5562	2CF2  48				  DEC	AX
   5563	2CF3  B1 0A				  MOV	CL, 10 ; 3 было
   5564	2CF5  D3 E0				  SAL	AX, CL	; (BLOCK#-1)*8 ; теперь	на 1024	байт
   5565						  ;MOV	 RANDREC,AX
   5566						  ;MOV	 RANDREC+2,0
   5567	2CF7  53				  push	 bx
   5568	2CF8  52				  push	 dx
   5569	2CF9  8B D0				  mov	 dx, ax
   5570	2CFB  B9 0000				  mov	 cx, 0
   5571	2CFE  B8 4200				  mov	 ax, 4200h
   5572	2D01  8B 1E 2D96r			  mov bx, handle
   5573	2D05  CD 21				  int 21h
   5574	2D07  72 42				  jc ERR0
   5575	2D09  5A				  pop	 dx
   5576	2D0A  5B				  pop	 bx
   5577	2D0B  83 FB 00				  CMP	BX, 0 ;	режим
   5578	2D0E  75 0F				  JNE	RED
   5579					; WRITE
   5580						  ;MOV	 BX, DX
   5581						  ;MOV	 CX, 8	    ; Номер записи
   5582	2D10				WR:	  ;MOV	 DX, BX
   5583						  ;MOV	 AH,1AH	    ; Запись адреса буфера (Set	disk transfer address)
   5584						  ;INT	 21H
   5585						  ;MOV	 DX,OFFSET FCB
   5586						  ;MOV	 AH, 22H    ; Запись RECORD (Random write)
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 99
forth.asm



   5587						  ;INT	 21H
   5588	2D10  B4 40				  MOV	AH, 40H
   5589	2D12  B9 0400				  MOV	CX, 1024
   5590	2D15  8B 1E 2D96r			  mov	 bx, handle
   5591	2D19  CD 21				  INT	21H
   5592						  ;CMP	 AL, 0
   5593						  ;JNE	 ERR1
   5594	2D1B  72 33				  jc err1
   5595						  ;INC	 RANDREC    ; Коррекция	адреса буфера
   5596						  ;ADD	 BX, 80H
   5597						  ;LOOP	 WR
   5598	2D1D  EB 11				  JMP  OUT1
   5599
   5600	2D1F				 RED:	  ;MOV	 CX, 8
   5601						  ;MOV	 BX, DX
   5602					 ;RD:	  ;MOV	 DX, BX	      ;	адрес буфера
   5603						  ;MOV	 AH, 1AH     ; Запись адреса буфера
   5604	2D1F  B4 3F				  MOV	AH, 3fH
   5605	2D21  B9 0400				  MOV	CX, 1024
   5606	2D24  8B 1E 2D96r			  mov	 bx, handle
   5607	2D28  CD 21				  INT	21H
   5608	2D2A  72 2E				  jc ERR3
   5609	2D2C  3B C1				  cmp ax,cx
   5610	2D2E  75 2A				  jne err3
   5611						  ;MOV	 DX, OFFSET  FCB
   5612						  ;MOV	 AH, 21H      ;	Random read
   5613						  ;INT	 21H
   5614						  ;CMP	 AL, 0
   5615						  ;JNE	 ERR3
   5616						  ;INC	 RANDREC     ; Коррекция адреса
   5617						  ;ADD	 BX, 80H
   5618						 ; LOOP	  RD
   5619
   5620	2D30				OUT1:	  ;MOV	 DX, OFFSET  FCB  ; Закрытие файла
   5621	2D30  8B 1E 2D96r			  mov bx, handle
   5622						  ;MOV	 AH, 10H
   5623	2D34  B4 3E				  mov ah, 3eh
   5624	2D36  CD 21				  INT	21H
   5625						  ;CMP	 AL, 0
   5626						  ;JNE	 ERR2
   5627	2D38  72 1B				  jc ERR2
   5628	2D3A				EXIT:	  NEXT
1  5629	2D3A  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  5630	2D3B  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  5631					 ; ------ call debugger	--------
1  5632	2D3D  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  5633	2D41  74 06			     jz	??005D
1  5634	2D43  E8 E206			     call printWORD
1  5635	2D46  E8 E0EA			     call pause
1  5636	2D49				 ??005D:
1  5637					 ; -----------------------------
1  5638	2D49  FF 27			     JMP WORD PTR [BX]
   5639	2D4B  BA 2DC9r			ERR0:	  MOV	DX, OFFSET  ERMES0
   5640	2D4E  EB 0D				  JMP	DONE
   5641	2D50  BA 2DDAr			ERR1:	  MOV	DX, OFFSET  ERMES1
   5642	2D53  EB 08				  JMP	DONE
   5643	2D55  BA 2DEBr			ERR2:	  MOV	DX, OFFSET  ERMES2
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 100
forth.asm



   5644	2D58  EB 03				  JMP	DONE
   5645	2D5A  BA 2DFCr			ERR3:	  MOV	DX, OFFSET  ERMES3
   5646	2D5D  B4 09			DONE:	  MOV	AH, 9H ; вывод сообщения
   5647	2D5F  CD 21				  INT	21H
   5648	2D61  EB D7				  JMP	EXIT
   5649
   5650						  HEAD	  305Q,';COD','E'+80h,SEMIC,$COL	  ; ;CODE
1  5651	      =ARRAY:2D63		 LINK$=$
1  5652	2D63  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  5653							 ; 6 - признак immediate. 5- слово не описано smudge
1  5654	2D64  3B 43 4F 44		     DB	 ';COD'
1  5655	2D68  C5			     DB	 'E'+80h   ; последний символ слова + 128 (7 бит = 1).
1  5656	2D69  2CD9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5657	      =ARRAY:2D63		 LINK=LINK$
1  5658	2D6B				 SEMIC LABEL FAR  ; CFA
1  5659	2D6B  1D7Cr			     DW	$COL
   5660					 ; для определения в форт программе слов на ассемблере
   5661	2D6D  20B3r 20E7r 2114r	  +		  DW  QCSP,COMP,PSCOD,LBRAC,SMUG,SEMI
   5662	      1BB3r 2100r 17AAr
   5663
   5664						  HEAD	  305Q,'FORT','H'+80h,FORTH,$DOE	  ; FORTH
1  5665	      =ARRAY:2D79		 LINK$=$
1  5666	2D79  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  5667							 ; 6 - признак immediate. 5- слово не описано smudge
1  5668	2D7A  46 4F 52 54		     DB	 'FORT'
1  5669	2D7E  C8			     DB	 'H'+80h   ; последний символ слова + 128 (7 бит = 1).
1  5670	2D7F  2D63r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5671	      =ARRAY:2D79		 LINK=LINK$
1  5672	2D81				 FORTH LABEL FAR  ; CFA
1  5673	2D81  1E35r			     DW	$DOE
   5674					 ; Делает словарь Форт контекстным.
   5675					 ; см. FORTH DIMENSION
   5676	2D83  258Er				 DW  DOVOC   ; PFA
   5677	2D85  A081				 DW 120201Q  ; = A0 81 мнимый заголовок	слова для связи	словарей
   5678	2D87  2D8Br				 DW TASK-7   ; PFA+4 NFA(TASK) последнее слово в этом словаре
   5679	2D89				 XVOC	 LABEL	 FAR ; VOC-LINK
   5680	2D89  0000				 DW  0	     ; ссылка на предыдущий словарь
   5681							     ; для чего	так и не нашел.	похоже,	здесь не используется
   5682					 ; VOC-LINK ---	addr U
   5683					 ;    A	user variable containing the address of	a field	in the definition
   5684					 ;    of the most recently created vocabulary. All vocabulary names are
   5685					 ;    linked by	these fields to	allow control for FORGETting thru multiple
   5686					 ;    vocabularies.
   5687
   5688						  HEAD	  84h,'TAS','K'+80h,TASK,$COL		 ; TASK
1  5689	      =ARRAY:2D8B		 LINK$=$
1  5690	2D8B  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5691							 ; 6 - признак immediate. 5- слово не описано smudge
1  5692	2D8C  54 41 53			     DB	 'TAS'
1  5693	2D8F  CB			     DB	 'K'+80h   ; последний символ слова + 128 (7 бит = 1).
1  5694	2D90  2D79r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5695	      =ARRAY:2D8B		 LINK=LINK$
1  5696	2D92				 TASK LABEL FAR	 ; CFA
1  5697	2D92  1D7Cr			     DW	$COL
   5698					     ; пустое определение. последнее слово в словаре FORTH
   5699	2D94  17AAr				  DW  SEMI
   5700
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 101
forth.asm



   5701	2D96  0000			handle	 dw 0
   5702	2D98  66 6F 72 74 68 2E	64+	file	 db "forth.dat", 0
   5703	      61 74 00
   5704					; FCB not used now
   5705	2DA2				FCB	  LABEL	WORD
   5706	2DA2  00			DRIVE	  DB	0
   5707	2DA3  46 4F 52 54 48 20	20+	FN	  DB	'FORTH	 '
   5708	      20
   5709	2DAB  44 41 54			EXT	  DB	'DAT'
   5710	2DAE  0000			CURBLK	  DW	0	   ; Относительное начало файла
   5711	2DB0  0080			RECSIZE	  DW	80H	   ; размер логичю записи
   5712	2DB2  1388 0000			FILESIZE  DW	5000,0	   ; размер файла
   5713	2DB6  0000 0000			DATE	  DW	0,0
   5714	2DBA  00 00 00 00 00 00	00+		  DB	0,0,0,0,0, 0,0,0,0,0 ; REZERV
   5715	      00 00 00
   5716	2DC4  00			CURREC	  DB	0	    ; запись с текущего	блока
   5717	2DC5  0000 0000			RANDREC	  DW	0,0	    ; номер записи
   5718
   5719	2DC9  45 52 52 20 4F 50	45+	ERMES0	  DB	'ERR OPENING FILE$'
   5720	      4E 49 4E 47 20 46	49+
   5721	      4C 45 24
   5722	2DDA  45 52 52 20 57 52	49+	ERMES1	  DB	'ERR WRITING FILE$'
   5723	      54 49 4E 47 20 46	49+
   5724	      4C 45 24
   5725	2DEB  45 52 52 20 43 4C	4F+	ERMES2	  DB	'ERR CLOSING FILE$'
   5726	      53 49 4E 47 20 46	49+
   5727	      4C 45 24
   5728	2DFC  45 52 52 20 52 45	41+	ERMES3	  DB	'ERR READING FILE$'
   5729	      44 49 4E 47 20 46	49+
   5730	      4C 45 24
   5731
   5732
   5733	2E0D  3E80*(0000)		XDP	DW  16000 DUP(0)	   ; DICTIONARY
   5734
   5735	0000				STCK   SEGMENT STACK		  ; Стек параметров
   5736	0000  40*(????)				DW  64 DUP (?)
   5737	0080				XS0	LABEL	WORD
   5738	0080  0000 0000				DW  0,0	  ; STACK
   5739	0084				STCK   ENDS
   5740
   5741	AB0D				ARRAY	   ENDS
   5742					END	   $INI
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 102
Symbol Table




Symbol Name			  Type	 Value

$ABS				  Far	 ARRAY:16A6
$AND				  Far	 ARRAY:16C8
$BUF				  Word	 ARRAY:0DB0
$CL				  Far	 ARRAY:1E97
$COL				  Far	 ARRAY:1D7C
$COMP				  Near	 ARRAY:1C9E
$CON				  Far	 ARRAY:1DBF
$DATE				  Word	 ARRAY:0004
$DO				  Far	 ARRAY:288E
$DOE				  Far	 ARRAY:1E35
$DOT				  Far	 ARRAY:2A62
$DP				  Far	 ARRAY:1EEB
$ELSE				  Far	 ARRAY:2938
$EM				  Near	 ARRAY:12C2
$EMIT				  Far	 ARRAY:12E4
$EVEN				  Far	 ARRAY:11DE
$EX				  Far	 ARRAY:1FCE
$GO				  Near	 ARRAY:1881
$HEX				  Far	 ARRAY:1BED
$IF				  Far	 ARRAY:2921
$IN				  Far	 ARRAY:1F34
$INI				  Far	 ARRAY:0DB4
$LESS				  Near	 ARRAY:10BA
$LIST				  Far	 ARRAY:2A8A
$LOOP				  Near	 ARRAY:1106
$MO				  Near	 ARRAY:2680
$MOD				  Far	 ARRAY:263B
$OR				  Far	 ARRAY:16E5
$PAGE				  Far	 ARRAY:123E
$REPE				  Near	 ARRAY:19E4
$RS				  Word	 ARRAY:0DA2
$SIG				  Near	 ARRAY:10F4
$STI				  Word	 ARRAY:0D9C
$STK				  Word	 ARRAY:0DA0
$TIME				  Word	 ARRAY:0000
$TYPE				  Far	 ARRAY:214F
$UPD				  Near	 ARRAY:1D35
$US				  Word	 ARRAY:0D9E
$USE				  Far	 ARRAY:1E08
$VAR				  Far	 ARRAY:1DE6
$WARN				  Far	 ARRAY:1ED6
$WHILE				  Far	 ARRAY:28F9
$WIDTH				  Far	 ARRAY:1EC8
$WORD				  Far	 ARRAY:2216
$XOR				  Far	 ARRAY:16F3
??0000				  Near	 ARRAY:0E23
??0001				  Near	 ARRAY:0FE1
??0002				  Near	 ARRAY:1009
??0003				  Near	 ARRAY:102F
??0004				  Near	 ARRAY:104D
??0005				  Near	 ARRAY:1074
??0006				  Near	 ARRAY:10A1
??0007				  Near	 ARRAY:1179
??0008				  Near	 ARRAY:122E
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 103
Symbol Table



??0009				  Near	 ARRAY:1254
??000A				  Near	 ARRAY:1280
??000B				  Near	 ARRAY:129F
??000C				  Near	 ARRAY:12D9
??000D				  Near	 ARRAY:135B
??000E				  Near	 ARRAY:1379
??000F				  Near	 ARRAY:13A6
??0010				  Near	 ARRAY:13CD
??0011				  Near	 ARRAY:13F3
??0012				  Near	 ARRAY:1413
??0013				  Near	 ARRAY:1445
??0014				  Near	 ARRAY:147D
??0015				  Near	 ARRAY:149A
??0016				  Near	 ARRAY:14B9
??0017				  Near	 ARRAY:14D4
??0018				  Near	 ARRAY:14F1
??0019				  Near	 ARRAY:150C
??001A				  Near	 ARRAY:1528
??001B				  Near	 ARRAY:1544
??001C				  Near	 ARRAY:1562
??001D				  Near	 ARRAY:1581
??001E				  Near	 ARRAY:159F
??001F				  Near	 ARRAY:15C6
??0020				  Near	 ARRAY:15E7
??0021				  Near	 ARRAY:1606
??0022				  Near	 ARRAY:1622
??0023				  Near	 ARRAY:163E
??0024				  Near	 ARRAY:1661
??0025				  Near	 ARRAY:1680
??0026				  Near	 ARRAY:169E
??0027				  Near	 ARRAY:16C0
??0028				  Near	 ARRAY:16DE
??0029				  Near	 ARRAY:171B
??002A				  Near	 ARRAY:173B
??002B				  Near	 ARRAY:174D
??002C				  Near	 ARRAY:1786
??002D				  Near	 ARRAY:17A3
??002E				  Near	 ARRAY:17C1
??002F				  Near	 ARRAY:17E2
??0030				  Near	 ARRAY:1800
??0031				  Near	 ARRAY:181E
??0032				  Near	 ARRAY:1838
??0033				  Near	 ARRAY:1868
??0034				  Near	 ARRAY:1890
??0035				  Near	 ARRAY:18B0
??0036				  Near	 ARRAY:18CE
??0037				  Near	 ARRAY:18FD
??0038				  Near	 ARRAY:1919
??0039				  Near	 ARRAY:194A
??003A				  Near	 ARRAY:1969
??003B				  Near	 ARRAY:1987
??003C				  Near	 ARRAY:19A4
??003D				  Near	 ARRAY:19D1
??003E				  Near	 ARRAY:19F8
??003F				  Near	 ARRAY:1A39
??0040				  Near	 ARRAY:1A55
??0041				  Near	 ARRAY:1A73
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 104
Symbol Table



??0042				  Near	 ARRAY:1A8D
??0043				  Near	 ARRAY:1AAB
??0044				  Near	 ARRAY:1AC6
??0045				  Near	 ARRAY:1AE2
??0046				  Near	 ARRAY:1B12
??0047				  Near	 ARRAY:1B30
??0048				  Near	 ARRAY:1B4D
??0049				  Near	 ARRAY:1B6A
??004A				  Near	 ARRAY:1B89
??004B				  Near	 ARRAY:1BAD
??004C				  Near	 ARRAY:1BC9
??004D				  Near	 ARRAY:1BE5
??004E				  Near	 ARRAY:1C03
??004F				  Near	 ARRAY:1C25
??0050				  Near	 ARRAY:1C45
??0051				  Near	 ARRAY:1C66
??0052				  Near	 ARRAY:1C90
??0053				  Near	 ARRAY:1CBD
??0054				  Near	 ARRAY:1CE4
??0055				  Near	 ARRAY:1D1D
??0056				  Near	 ARRAY:1D44
??0057				  Near	 ARRAY:1D62
??0058				  Near	 ARRAY:1D96
??0059				  Near	 ARRAY:1DD3
??005A				  Near	 ARRAY:1DF9
??005B				  Near	 ARRAY:1E1F
??005C				  Near	 ARRAY:1E53
??005D				  Near	 ARRAY:2D49
??DATE				  Text	 "04/22/20"
??FILENAME			  Text	 "forth	  "
??TIME				  Text	 "13:16:23"
??VERSION			  Number 030A
?TER$				  Far	 ARRAY:144F
?TERM				  Far	 ARRAY:1FEE
@32BIT				  Text	 0
@@1				  Near	 ARRAY:0F23
@@2				  Near	 ARRAY:0F3B
@@ASCII				  Byte	 ARRAY:0E99
@@ASCII				  Byte	 ARRAY:0EE6
@@ASCII				  Byte	 ARRAY:0F1A
@@CAPTION			  Byte	 ARRAY:0E8C
@@CAPTION			  Byte	 ARRAY:0EE0
@@CAPTION			  Byte	 ARRAY:0F11
@@CR				  Byte	 ARRAY:0FB1
@@L				  Near	 ARRAY:0EAC
@@R				  Near	 ARRAY:0ED8
@@R				  Near	 ARRAY:0F09
@@R				  Near	 ARRAY:0EBD
@CODE				  Text	 _TEXT
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 ARRAY
@D				  Near	 ARRAY:0E6A
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@E				  Near	 ARRAY:0E57
@FILENAME			  Text	 FORTH
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 105
Symbol Table



@INTERFACE			  Text	 00H
@MODEL				  Text	 2
@R				  Near	 ARRAY:0E6F
@RS				  Near	 ARRAY:0E60
@S				  Near	 ARRAY:0E65
@STACK				  Text	 DGROUP
@START				  Near	 ARRAY:0E33
@V				  Near	 ARRAY:0E5B
@WORDSIZE			  Text	 2
A				  Near	 ARRAY:11F6
AA				  Near	 ARRAY:120A
AAA1				  Near	 ARRAY:11FA
AB				  Near	 ARRAY:16B0
ABORT				  Far	 ARRAY:25D9
AGAIN				  Far	 ARRAY:28E3
ALLOT				  Far	 ARRAY:1B74
ARROW				  Far	 ARRAY:27FF
ASCII				  Byte	 ARRAY:0F8C
AT				  Far	 ARRAY:1A79
ATR				  Far	 ARRAY:1F18
BACK				  Far	 ARRAY:286D
BASE				  Far	 ARRAY:1F88
BBUF				  Far	 ARRAY:1EA0
BCK				  Near	 ARRAY:2755
BCOM				  Far	 ARRAY:2493
BDIGS				  Far	 ARRAY:2993
BEGIN				  Far	 ARRAY:287F
BLAN				  Far	 ARRAY:1E8E
BLANK				  Far	 ARRAY:1A11
BLANKBUFFER			  Near	 ARRAY:0F44
BLC				  Near	 ARRAY:2769
BLK				  Far	 ARRAY:1F2B
BLO				  Near	 ARRAY:273D
BLOCK				  Far	 ARRAY:2723
BN				  Near	 ARRAY:225F
BN1				  Near	 ARRAY:2295
BR1				  Near	 ARRAY:26EB
BR2				  Near	 ARRAY:270B
BRAN				  Far	 ARRAY:103A
BUFFE				  Far	 ARRAY:26E1
BUILD				  Far	 ARRAY:212C
BYE				  Far	 ARRAY:1E5B
C$				  Near	 ARRAY:1909
CAT				  Far	 ARRAY:1A94
CCOM				  Far	 ARRAY:2024
CFA				  Far	 ARRAY:1B1A
CLEAR				  Near	 ARRAY:1392
CMOV				  Far	 ARRAY:19AE
CNT				  Near	 ARRAY:103C
COLON				  Far	 ARRAY:1D68
COMMA				  Far	 ARRAY:2013
COMP				  Far	 ARRAY:20E7
COMPA				  Near	 ARRAY:1C78
CON				  Far	 ARRAY:1DB5
CONT				  Far	 ARRAY:1F63
COPY				  Far	 ARRAY:2B97
COUNT				  Far	 ARRAY:213C
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 106
Symbol Table



CR				  Far	 ARRAY:1FFF
CRE				  Near	 ARRAY:2453
CREAT				  Far	 ARRAY:243D
CSP				  Far	 ARRAY:1F9C
CSTOR				  Far	 ARRAY:1ACD
CURBLK				  Word	 ARRAY:2DAE
CURR				  Far	 ARRAY:1F71
CURREC				  Byte	 ARRAY:2DC4
D0TQ				  Far	 ARRAY:2195
DABS				  Far	 ARRAY:15CF
DATE				  Word	 ARRAY:2DB6
DDOT				  Far	 ARRAY:2A54
DDOTR				  Far	 ARRAY:2A10
DDROP				  Far	 ARRAY:1973
DDUP				  Far	 ARRAY:1922
DEB				  Far	 ARRAY:1FE2
DECIMA				  Far	 ARRAY:1C0F
DEEP				  Near	 ARRAY:173D
DEFIN				  Far	 ARRAY:1CCD
DEPTH				  Far	 ARRAY:2BE2
DFIND				  Far	 ARRAY:22A7
DIG				  Far	 ARRAY:29CF
DIGI				  Near	 ARRAY:29EB
DIGIT				  Far	 ARRAY:113D
DIGS				  Far	 ARRAY:29FA
DIS				  Near	 ARRAY:29FC
DIV2				  Far	 ARRAY:152F
DLI				  Near	 ARRAY:24DA
DLINE				  Far	 ARRAY:2779
DLITE				  Far	 ARRAY:24CA
DMIN				  Near	 ARRAY:15AD
DMINU				  Far	 ARRAY:15AA
DMP				  Near	 ARRAY:2BFF
DOES				  Far	 ARRAY:1E29
DONE				  Near	 ARRAY:2D5D
DOTR				  Far	 ARRAY:2A33
DOVOC				  Far	 ARRAY:258E
DP1				  Near	 ARRAY:2C0F
DP2				  Near	 ARRAY:2C2D
DP3				  Near	 ARRAY:2C4B
DPL				  Far	 ARRAY:1F92
DPLUS				  Far	 ARRAY:1645
DRIVE				  Byte	 ARRAY:2DA2
DRO				  Near	 ARRAY:1975
DROP				  Far	 ARRAY:1990
DRP				  Near	 ARRAY:1992
DSKBUF				  Word	 ARRAY:0006
DSPL				  Far	 ARRAY:13D6
DSWAP				  Far	 ARRAY:18D8
DTRAI				  Far	 ARRAY:1C71
DU				  Near	 ARRAY:1908
DUBL				  Far	 ARRAY:1905
DUMP				  Far	 ARRAY:2BF9
DUP2				  Far	 ARRAY:1933
EDIGS				  Far	 ARRAY:29A2
EIGHT				  Far	 ARRAY:1E85
EMI$				  Far	 ARRAY:12A7
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 107
Symbol Table



EMIT				  Far	 ARRAY:12E2
ENCL				  Far	 ARRAY:11F0
ENDA				  Near	 ARRAY:16CE
ENDBUF				  Word	 ARRAY:0C12
ENT				  Near	 ARRAY:0DBE
ENT$				  Near	 ARRAY:12E5
EQUAL				  Far	 ARRAY:11A2
EQW				  Near	 ARRAY:1216
ER				  Near	 ARRAY:23E0
ER1				  Near	 ARRAY:23E4
ERASE				  Far	 ARRAY:1A02
ERB				  Far	 ARRAY:1FD8
ERMES0				  Byte	 ARRAY:2DC9
ERMES1				  Byte	 ARRAY:2DDA
ERMES2				  Byte	 ARRAY:2DEB
ERMES3				  Byte	 ARRAY:2DFC
ERMES4				  Byte	 ARRAY:130C
ERR0				  Near	 ARRAY:2D4B
ERR1				  Near	 ARRAY:2D50
ERR2				  Near	 ARRAY:2D55
ERR3				  Near	 ARRAY:2D5A
ERR4				  Near	 ARRAY:12FB
ERROR				  Far	 ARRAY:23F8
EXEC				  Far	 ARRAY:0FC3
EXIT				  Near	 ARRAY:2D3A
EXP				  Near	 ARRAY:236A
EXPE				  Far	 ARRAY:141E
EXT				  Byte	 ARRAY:2DAB
FAIL				  Near	 ARRAY:1130
FALSE				  Near	 ARRAY:1167
FAST				  Near	 ARRAY:10E2
FCB				  Word	 ARRAY:2DA2
FENCE				  Far	 ARRAY:1EE2
FILE				  Byte	 ARRAY:2D98
FILESIZE			  Word	 ARRAY:2DB2
FILL				  Far	 ARRAY:19DA
FIN				  Near	 ARRAY:22CB
FIRST				  Far	 ARRAY:1F02
FIX				  Far	 ARRAY:13AE
FL1				  Near	 ARRAY:26CC
FLL				  Near	 ARRAY:19DD
FLU				  Near	 ARRAY:26B6
FLUSH				  Far	 ARRAY:26AA
FN				  Byte	 ARRAY:2DA3
FORGE				  Far	 ARRAY:2830
FORTH				  Far	 ARRAY:2D81
FROMR				  Far	 ARRAY:1807
G$				  Near	 ARRAY:15B7
GO$				  Near	 ARRAY:0E25
GREAT				  Far	 ARRAY:11CD
HANDLE				  Word	 ARRAY:2D96
HERE				  Far	 ARRAY:1B56
HLD				  Far	 ARRAY:1FAF
HOLD				  Far	 ARRAY:1A1F
HT				  Far	 ARRAY:2B86
I				  Far	 ARRAY:1824
IDDOT				  Far	 ARRAY:2424
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 108
Symbol Table



IL				  Far	 ARRAY:132D
IMMED				  Far	 ARRAY:2557
INDEX				  Far	 ARRAY:2AC8
INDX				  Near	 ARRAY:2AD0
INIT				  Far	 ARRAY:0DBC
INTER				  Far	 ARRAY:250F
IT1				  Near	 ARRAY:2511
IT2				  Near	 ARRAY:2527
IT3				  Near	 ARRAY:252D
IT4				  Near	 ARRAY:2541
IT5				  Near	 ARRAY:2545
KEY				  Far	 ARRAY:13FB
LATES				  Far	 ARRAY:1C50
LBRAC				  Far	 ARRAY:1BB3
LCL				  Far	 ARRAY:2B71
LEAV				  Far	 ARRAY:17CB
LESS				  Far	 ARRAY:11BF
LEV				  Far	 ARRAY:1854
LFA				  Far	 ARRAY:1AFC
LIL				  Near	 ARRAY:24BD
LIMIT				  Far	 ARRAY:1F0E
LINK				  Number ARRAY:2D8B
LINK$				  Number ARRAY:2D8B
LIT				  Far	 ARRAY:0FCE
LITER				  Far	 ARRAY:24AD
LOA				  Far	 ARRAY:27D7
LOO				  Far	 ARRAY:28A1
LOP				  Near	 ARRAY:1084
LSTI				  Near	 ARRAY:2AA6
LV				  Near	 ARRAY:108C
M09				  Near	 ARRAY:1153
MATCH				  Near	 ARRAY:10EC
MAX				  Far	 ARRAY:1755
MES				  Near	 ARRAY:27C1
MESS				  Far	 ARRAY:279D
MIN				  Far	 ARRAY:1723
MINUS				  Far	 ARRAY:166B
MM				  Near	 ARRAY:0F6D
MMM1				  Near	 ARRAY:0F78
MMO				  Near	 ARRAY:229B
MODA				  Far	 ARRAY:1289
MS1				  Near	 ARRAY:27C3
MSLAS				  Far	 ARRAY:15EE
MSMOD				  Far	 ARRAY:266E
MSTAR				  Far	 ARRAY:1588
MTBUF				  Far	 ARRAY:2694
MUL2				  Far	 ARRAY:1513
NEMI				  Near	 ARRAY:2394
NFA				  Far	 ARRAY:1AEA
NH0				  Near	 ARRAY:23A6
NH1				  Near	 ARRAY:2300
NH2				  Near	 ARRAY:231C
NH3				  Near	 ARRAY:232A
NH4				  Near	 ARRAY:232C
NH5				  Near	 ARRAY:23C4
NH6				  Near	 ARRAY:23CE
NH7				  Near	 ARRAY:23D8
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 109
Symbol Table



NO				  Near	 ARRAY:1C80
NOTEQ				  Near	 ARRAY:11FD
NUL				  Near	 ARRAY:21F9
NULL				  Far	 ARRAY:21E1
NUMB				  Far	 ARRAY:22D6
OCTAL				  Far	 ARRAY:1C2F
ODOT				  Far	 ARRAY:2CC7
OFLIM				  Near	 ARRAY:1CAB
OFSET				  Far	 ARRAY:1F55
OK				  Near	 ARRAY:12CA
ONE				  Far	 ARRAY:1E6D
ONEM				  Far	 ARRAY:14F8
ONEP				  Far	 ARRAY:14C0
OUT1				  Near	 ARRAY:2D30
OUTCR				  Near	 ARRAY:0FA9
OUTTEXT				  Near	 ARRAY:0FB4
OVER				  Far	 ARRAY:1899
PAD				  Far	 ARRAY:2203
PAREN				  Far	 ARRAY:259A
PAUSE				  Near	 ARRAY:0E33
PB				  Near	 ARRAY:1D04
PBUF				  Far	 ARRAY:1CED
PDOTQ				  Far	 ARRAY:217C
PFA				  Far	 ARRAY:2046
PFIND				  Far	 ARRAY:10CE
PG				  Far	 ARRAY:1F21
PICK				  Far	 ARRAY:1871
PIX				  Far	 ARRAY:125C
PLOOP				  Far	 ARRAY:28B7
PLU				  Near	 ARRAY:23A4
PLUS				  Far	 ARRAY:160C
PNT				  Far	 ARRAY:1F3E
PNUMB				  Far	 ARRAY:225D
PORT				  Far	 ARRAY:1486
PREV				  Far	 ARRAY:1FC4
PRIN				  Far	 ARRAY:133B
PRINT				  Near	 ARRAY:12EF
PRINTWORD			  Near	 ARRAY:0F4C
PSCOD				  Far	 ARRAY:2114
PSTOR				  Far	 ARRAY:1A40
PUT				  Near	 ARRAY:1169
QCOMP				  Far	 ARRAY:2072
QCSP				  Far	 ARRAY:20B3
QERR				  Far	 ARRAY:205A
QEXEC				  Far	 ARRAY:208A
QLOAD				  Far	 ARRAY:20CD
QPAIR				  Far	 ARRAY:20A0
QSTAC				  Far	 ARRAY:24E5
QUERY				  Far	 ARRAY:21C5
QUEST				  Far	 ARRAY:2A6E
QUI				  Near	 ARRAY:25B5
QUIT				  Far	 ARRAY:25AB
R				  Far	 ARRAY:183E
RANDREC				  Word	 ARRAY:2DC5
RBRAC				  Far	 ARRAY:1BCF
RC				  Far	 ARRAY:1321
READ				  Far	 ARRAY:14A3
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 110
Symbol Table



RECSIZE				  Word	 ARRAY:2DB0
RED				  Near	 ARRAY:2D1F
REPEA				  Far	 ARRAY:2908
RNUM				  Far	 ARRAY:1FA5
ROT				  Far	 ARRAY:1952
RPSTO				  Far	 ARRAY:178E
RR$				  Near	 ARRAY:1826
RW				  Far	 ARRAY:2CDF
RZERO				  Far	 ARRAY:1EB2
SCL				  Far	 ARRAY:1381
SCR				  Far	 ARRAY:1F48
SCSP				  Far	 ARRAY:1B39
SEMI				  Far	 ARRAY:17AA
SEMIC				  Far	 ARRAY:2D6B
SHOWRS				  Near	 ARRAY:0EBE
SHOWSTACK			  Near	 ARRAY:0EEC
SHOWSTDUMP			  Near	 ARRAY:0EA2
SHOWWD				  Near	 ARRAY:0E70
SIG				  Near	 ARRAY:29C9
SIGN				  Far	 ARRAY:29B9
SLASH				  Far	 ARRAY:262B
SLMOD				  Far	 ARRAY:261B
SLOW				  Near	 ARRAY:1100
SLOW1				  Near	 ARRAY:1113
SMI				  Far	 ARRAY:1D9C
SMUG				  Far	 ARRAY:2100
SP1				  Near	 ARRAY:298C
SPA				  Near	 ARRAY:2986
SPACE				  Far	 ARRAY:2038
SPACS				  Far	 ARRAY:2976
SPAT				  Far	 ARRAY:1765
SPOT				  Far	 ARRAY:2600
SPSTO				  Far	 ARRAY:1772
SRP				  Far	 ARRAY:1847
SSLA				  Far	 ARRAY:265C
SSMOD				  Far	 ARRAY:264B
STAR				  Far	 ARRAY:260C
STATE				  Far	 ARRAY:1F7D
STOD				  Far	 ARRAY:1702
STORE				  Far	 ARRAY:1AB1
STY				  Far	 ARRAY:2C94
STY1				  Near	 ARRAY:2CA2
STY2				  Near	 ARRAY:2CB0
STY3				  Near	 ARRAY:2CC0
SUBB				  Far	 ARRAY:1628
SWAB				  Far	 ARRAY:1689
SWAP				  Far	 ARRAY:18B9
SWAS				  Far	 ARRAY:2C68
SZERO				  Far	 ARRAY:1EA9
TASK				  Far	 ARRAY:2D92
TC0				  Near	 ARRAY:215B
TC1				  Near	 ARRAY:2171
TER				  Near	 ARRAY:145C
TERMON				  Far	 ARRAY:0FEC
THEN				  Far	 ARRAY:2959
THREE				  Far	 ARRAY:1E7D
TIB				  Far	 ARRAY:1EBC
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 111
Symbol Table



TICK				  Far	 ARRAY:2815
TOGL				  Far	 ARRAY:1A5E
TOHEX				  Near	 ARRAY:0F20
TOP				  Near	 ARRAY:172B
TOR				  Far	 ARRAY:17E9
TRAV				  Far	 ARRAY:1B92
TRI				  Near	 ARRAY:2AFF
TRIO				  Far	 ARRAY:2AED
TRUE				  Near	 ARRAY:117B
TRV				  Near	 ARRAY:1B96
TTT				  Near	 ARRAY:2066
TTY				  Far	 ARRAY:1363
TWO				  Far	 ARRAY:1E75
TWOP				  Far	 ARRAY:14DB
TY$$				  Far	 ARRAY:2BAC
TY4				  Near	 ARRAY:2BB2
TY5				  Near	 ARRAY:2BC8
TYPE$				  Near	 ARRAY:1365
UDOT				  Far	 ARRAY:2A7B
UDOTR				  Far	 ARRAY:2A45
ULESS				  Far	 ARRAY:11B1
UNTIL				  Far	 ARRAY:28CD
UPDAT				  Far	 ARRAY:1D28
UPPER				  Far	 ARRAY:1C9A
USE				  Far	 ARRAY:1FB9
USER				  Far	 ARRAY:1E02
USLAS				  Far	 ARRAY:1569
USTAR				  Far	 ARRAY:154B
VAR				  Far	 ARRAY:1DE0
VL0				  Near	 ARRAY:2B19
VL1				  Near	 ARRAY:2B21
VL2				  Near	 ARRAY:2B59
VLIST				  Far	 ARRAY:2B11
VOCAB				  Far	 ARRAY:256E
VOCL				  Far	 ARRAY:1EF6
WD1				  Near	 ARRAY:2228
WD2				  Near	 ARRAY:222C
WR				  Near	 ARRAY:2D10
X				  Far	 ARRAY:1D4A
XDO				  Far	 ARRAY:1056
XDP				  Word	 ARRAY:2E0D
XER				  Near	 ARRAY:2418
XLOOP				  Far	 ARRAY:107F
XPLOO				  Far	 ARRAY:10AD
XR0				  Word	 ARRAY:0CCC
XS0				  Word	 STCK:0080
XT				  Near	 ARRAY:21B3
XTIB				  Word	 ARRAY:0C14
XUP				  Word	 ARRAY:0CD0
XVOC				  Far	 ARRAY:2D89
XXX				  Near	 ARRAY:0DD4
Y$				  Near	 ARRAY:1C36
Z$				  Near	 ARRAY:1829
ZBRAN				  Far	 ARRAY:1015
ZEQU				  Far	 ARRAY:115F
ZERO				  Far	 ARRAY:1E65
ZGRET				  Far	 ARRAY:1185
Turbo Assembler	 Version 3.1	    04/22/20 13:16:33	    Page 112
Symbol Table



ZLESS				  Far	 ARRAY:1194
ZZZ				  Near	 ARRAY:1230

Macro Name

HEAD
NEXT

Groups & Segments		  Bit Size Align  Combine Class

ARRAY				  16  AB0D Para	  none
DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
STCK				  16  0084 Para	  Stack
_TEXT				  16  0000 Word	  Public  CODE
