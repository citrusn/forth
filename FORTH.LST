Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 1
forth.asm



      1				     ; 253 слова head
      2				     ; 103 слова используют $col
      3				     ; 9 слова использует $con
      4				     ; 29 слова	использует $use
      5				     ; 1 слово forth
      6
      7				     masm
      8				     .8086
      9	0000			     .MODEL SMALL
     10				     LOCALS
     11	      =0000		     LINK=0
     12					 ; Макроопределения
     13					 ; Описание примитивов и слов высокого уровня
     14					 HEAD  MACRO length,name,lchar,labl,code
     15					 LINK$=$
     16					     DB	 length	 ; NFA 7 бит равен 1.
     17							 ; 6 - признак immediate. 5- слово не описано smudge
     18					     IFNB <name>
     19					     DB	 NAME
     20					     ENDIF
     21					     DB	 lchar	 ; последний символ слова + 128	(7 бит = 1).
     22					     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
     23					 LINK=LINK$
     24					 labl LABEL FAR	 ; CFA
     25					     IFNB <code> ;
     26					     DW	code
     27					     ELSE
     28					     DW	 $+2
     29					     ENDIF
     30					     ENDM
     31
     32	      =0001			 debug equ 1
     33					 NEXT MACRO   ;	переход	к исполнению следующего	слова
     34					     local m1
     35					     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
     36					     MOV  BX, AX     ; BX равен	CFA  следующего	слова
     37					 ; ------ call debugger	--------
     38					 IF debug
     39					     cmp byte ptr [di+102Q], 0
     40					     jz	m1
     41					     call printWORD
     42					     call pause
     43					   m1:
     44					 ENDIF
     45					 ; -----------------------------
     46					     JMP WORD PTR [BX]
     47					     ENDM
     48
     49
     50	0000				ARRAY	SEGMENT
     51	0000  0000 0000			$TIME	DW  0,0			    ; TIMER COUNTER
     52	0004  0000			$DATE	DW  0			    ; DATE
     53
     54					;  Сегмент стека и словарь пользователя	размещен в конце текста
     55					;  интерпретатора. Для версии, записываемой в ПЗУ, их нужно
     56					;  разместить здесь.
     57
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 2
forth.asm



     58	0006  03*(0000 0200*(0000)+	DSKBUF	DW  3 DUP(0,512	DUP(0),0)   ; Экранные буферы на 1024 байта
     59	      0000)
     60	0C12  0000			ENDBUF	DW  0	     ; 6 1034 (40Ah) 2062(80Eh)	адреса буферов
     61
     62	0C14  5C*(0000)			XTIB	DW  92 DUP(0)		    ; Входной буфер
     63	0CCC  0000 0000			XR0	DW  0,0			    ; Стек возвратов  растет в область
     64									    ; меньших адресов.	ADD BP - убрать	данные
     65	0CD0  66*(0000)			XUP	DW  102	DUP(0)		    ; USER-область на нее указывает DI
     66
     67	0D9C  2E60r			$STI	DW  TASK-7  ;		    ; Стартовая	таблица	PFA слова TASK
     68	0D9E  0CD0r			$US	DW  XUP	    ;		    ; адрес user области
     69					;    переменные
     70	0DA0  0080r			$STK	DW  XS0	    ;+6		     ; SO
     71	0DA2  0CCCr			$RS	DW  XR0	    ;+8		     ; RO стек возвратов
     72	0DA4  0C14r				DW  XTIB    ;+10	     ; входной буфер
     73	0DA6  001F				DW  1Fh	    ;+12	     ; WIDTH 31	буква
     74	0DA8  0000				DW  0	    ;+14	     ; WARNING
     75	0DAA  2EE2r				DW  XDP	    ;+16	     ; словарь FENCE (забор)
     76	0DAC  2EE2r				DW  XDP	    ;+18	     ; DP
     77	0DAE  2E5Er				DW  XVOC    ;+20	     ; словарь VOCL в слове Forth
     78	0DB0  0006r			$BUF	DW  DSKBUF  ;+22	     ; экранный	буфер FIRST
     79	0DB2  0C12r				DW  ENDBUF  ;+24 или 30Q     ; LIMIT
     80
     81					ASSUME	CS:ARRAY, DS:ARRAY, ES:ARRAY, SS:STCK
     82
     83	0DB4				$INI	  PROC	  FAR
     84	0DB4  EB 08				  JMP  ENT
     85					; ** PRIMITIVES	**
     86
     87						  HEAD	  83h,'IN',311Q,INIT		      ;INI
1    88	      =ARRAY:0DB6		 LINK$=$
1    89	0DB6  83			     DB	 83h  ;	NFA 7 бит равен	1.
1    90							 ; 6 - признак immediate. 5- слово не описано smudge
1    91	0DB7  49 4E			     DB	 'IN'
1    92	0DB9  C9			     DB	 311Q	; последний символ слова + 128 (7 бит =	1).
1    93	0DBA  0000			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1    94	      =ARRAY:0DB6		 LINK=LINK$
1    95	0DBC				 INIT LABEL FAR	 ; CFA
1    96	0DBC  0DBEr			     DW	 $+2
     97	0DBE  B9 0000s			ENT:	  MOV	CX, ARRAY
     98	0DC1  8E D9				  MOV	DS, CX		; Установка DX
     99	0DC3  8E C1				  MOV	ES, CX
    100	0DC5  A1 0D9Cr				  MOV	AX, $STI	; Восстановление словаря (PFA слова TASK)
    101	0DC8  BE 2E5Cr				  LEA	SI, FORTH+6	; Адрес	места нахождения в PFA forth
    102	0DCB  89 04				  MOV	[SI], AX	;
    103	0DCD  8B 36 0DB0r			  MOV	SI, $BUF
    104	0DD1  B9 06CB				  MOV	CX, 1739	; Установка счетчика 1730
    105	0DD4  C7 04 0000		XXX:	  MOV	WORD PTR [SI],0	; Обнуление массивов
    106	0DD8  83 C6 02				  ADD	SI, 2
    107	0DDB  E2 F7				  LOOP	XXX
    108
    109					; INIT 'OFFSET,	USE, PREV
    110	0DDD  8B 1E 0D9Er			  MOV	BX, $US		 ; xup
    111	0DE1  8B 0E 0DB0r			  MOV	CX, $BUF	 ; TO 'USE'
    112	0DE5  89 4F 3A				  MOV	[BX]+72Q,CX	 ; USE ? адрес блока
    113	0DE8  89 4F 3C				  MOV	[BX]+74Q,CX	 ; PREV	? адрес	блока
    114	0DEB  C7 47 42 0000			  MOV	word ptr [BX]+102Q,00h	    ; отладка выключена
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 3
forth.asm



    115	0DF0  B9 000A				  MOV	CX, 10		 ; Установка счетчика USER (14Q	надо на	2 меньше уже)
    116	0DF3  8B 3E 0D9Er			  MOV	DI, $US		 ; Запись адреса области USER
    117	0DF7  83 C7 06				  ADD	DI, 6		 ; почему 6....	? User переменные начинаются с 6 адреса
    118	0DFA  BE 0DA0r				  LEA	SI, $STK	 ; Запись начального адреса
    119						  ; заполняем начальные	значения переменых
    120	0DFD  F3> A5			REP	  MOVS	WORD PTR ES:[DI], WORD PTR DS:[SI]
    121	0DFF  8B 2E 0DA2r			  MOV	BP, $RS		 ; Установка начального	значения
    122									 ; указателя стека возвратов
    123									 ; пересекается	с областью TIB
    124									 ; RS растет в область с меньшими адресами
    125	0E03  8B 3E 0D9Er			  MOV	DI, $US
    126	0E07  C7 45 1A 0007			  MOV	WORD PTR [DI+32Q],7  ; Установка цвета вывода текста
    127	0E0C  C7 45 22 0000			  MOV	WORD PTR [DI+42Q],0  ; Сброс флага печати
    128	0E11  BE 0E25r				  LEA	SI, GO$
    129						  NEXT
1   130	0E14  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   131	0E15  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   132					 ; ------ call debugger	--------
1   133	0E17  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   134	0E1B  74 06			     jz	??0000
1   135	0E1D  E8 0131			     call printWORD
1   136	0E20  E8 0010			     call pause
1   137	0E23				   ??0000:
1   138					 ; -----------------------------
1   139	0E23  FF 27			     JMP WORD PTR [BX]
    140						  ; здесь инструкции языка форт. указатель на них в SI
    141	0E25  17DDr 1CE4r 2E56r	  +	GO$:	  DW SPSTO,DECIMA,FORTH,DEFIN, ONE,LOA,	quit; загрузка первого экрана
    142	      1DA2r 1F42r 28ACr	  +
    143	      2680r
    144	0E33			     $INI      ENDP
    145
    146				     include debug.asm
1   147				     ; ╨╛╨▒╤А╨░╨▒╨╛╤В╨║╨░ ╨╜╨░╨╢╨░╤В╨╕╤П ╨║╨╗╨░╨▓╨╕╤И
1   148	0E33			     pause proc
1   149	0E33				 @start:
1   150	0E33  33 C0			     xor ax, ax
1   151	0E35  CD 16			     int 16h ; AL = ASCII ╤Б╨╕╨╝╨▓╨╛╨╗ (╨╡╤Б╨╗╨╕ AL=0, AH ╤Б╨╛╨┤╨╡╤А╨╢╨╕╤В		    +
    152				     ╤А╨░╤Б╤И╨╕╤А╨╡╨╜╨╜╤Л╨╣ ╨║╨╛╨┤ ASCII )
1   153						     ; AH = ╤Б╨║╨░╨╜╨║╨╛╨┤  ╨╕╨╗╨╕ ╤А╨░╤Б╤И╨╕╤А╨╡╨╜╨╜╤Л╨╣ ╨║╨╛╨┤ ASCII
1   154	0E37  80 FC 10			     cmp ah, 10h ; ╨║╨╗╨░╨▓╨╕╤И╨░ Q (quit)
1   155	0E3A  74 20			     je	@e
1   156	0E3C  80 FC 20			     cmp ah, 20h ; ╨║╨╗╨░╨▓╨╕╤И╨░ D (debug off)
1   157	0E3F  74 2E			     je	@d
1   158	0E41  80 FC 1F			     cmp ah, 1Fh ; ╨║╨╗╨░╨▓╨╕╤И╨░ S (show parameters stack)
1   159	0E44  74 24			     je	@s
1   160	0E46  80 FC 13			     cmp ah, 13h ; ╨║╨╗╨░╨▓╨╕╤И╨░ R (show return stack)
1   161	0E49  74 1A			     je	@rs
1   162	0E4B  80 FC 31			     cmp ah, 31h ; ╨║╨╗╨░╨▓╨╕╤И╨░ N (next step)
1   163	0E4E  74 24			     je	@r
1   164	0E50  80 FC 39			     cmp ah, 39h ; ╨║╨╗╨░╨▓╨╕╤И╨░ SPACE	(next step)
1   165	0E53  74 1F			     je	@r
1   166	0E55  80 FC 11			     cmp ah, 11h ; ╨║╨╗╨░╨▓╨╕╤И╨░ W(next word from dict)
1   167	0E58  74 06			     je	@v
1   168	0E5A  EB D7			     jmp @start
1   169	0E5C  B4 4C			 @e: mov ah, 4Ch ; ╨▓╤Л╤Е╨╛╨┤ ╨╕╨╖ ╨┐╤А╨╛╨│╤А╨░╨╝╨╝╤Л
1   170	0E5E  CD 21			     int 21h
1   171	0E60  E8 0012			 @v: call showWD
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 4
forth.asm



1   172	0E63  EB CE			     jmp @start
1   173	0E65  E8 005B			 @rs: call showRS
1   174	0E68  EB C9			     jmp @start
1   175	0E6A  E8 0084			 @s: call showStack
1   176	0E6D  EB C4			     jmp @start
1   177	0E6F  C7 45 42 0000		 @d: mov word ptr [DI]+102Q,00h	 ; ╨╛╤В╨╗╨░╨┤╨║╨░ ╨▓╤Л╨║╨╗╤О╤З╨╡╨╜╨░
1   178					     ;jmp @start
1   179	0E74  C3			 @r: ret
1   180	0E75			     pause endp
1   181
1   182	0E75			     proc showWD
1   183	0E75  57			 push di
1   184	0E76  53			 push bx
1   185	0E77  BA 0E91r			 mov dx, offset	@@caption
1   186	0E7A  E8 013C			 call outText
1   187	0E7D  BF 0E9Er			 mov di,OFFSET @@ASCII ;
1   188	0E80  8B 04			 mov ax, [si]
1   189	0E82  E8 00A0			 call toHex
1   190	0E85  BA 0E9Er			 mov dx, offset	@@ASCII
1   191	0E88  E8 012E			 call outText
1   192	0E8B  E8 0120			 call outCR
1   193	0E8E  5B			 pop bx
1   194	0E8F  5F			 pop di
1   195	0E90  C3			 ret
1   196	0E91  4E 45 58 54 20 57	4F+	 @@caption DB "NEXT WORD:  $"
    197	      52 44 3A 20 20 24
1   198	0E9E  30 30 30 30 20 20	20+	 @@ASCII DB "0000    $"
    199	      20 24
1   200	0EA7			     showWD endp
1   201
1   202				     ; ╨┐╨╡╤З╨░╤В╤М ╨┤╨░╨╝╨┐╨░ ╨┐╨░╨╝╤П╤В╨╕ ╨▓ ╨┐╨╛╤А╤П╨┤╨║╨╡ ╤Б╤В╨╡╨║╨░
1   203				     ; c╤Е - ╤З╨╕╤Б╨╗╨╛	╨▒╨░╨╣╤В
1   204				     ; bx - ╨░╨┤╤А╨╡╤Б ╨┐╨░╨╝╤П╤В╨╕
1   205				     ; dx - ╨░╨┤╤А╨╡╤Б ╤Б╤В╤А╨╛╨║╨╕
1   206	0EA7			     showStDump	proc
1   207	0EA7  D1 E9			 shr cx, 1   ; ╨▒╨░╨╣╤В╤Л ╨▓ ╤Б╨╗╨╛╨▓╨░
1   208	0EA9  0B C9			 or cx , cx
1   209	0EAB  74 15			 jz @@r
1   210	0EAD  8C D0			 mov ax, ss
1   211	0EAF  8E C0			 mov es, ax
1   212	0EB1			       @@l:
1   213	0EB1  4B			 dec bx
1   214	0EB2  4B			 dec bx
1   215	0EB3  26: 8B 07			 mov ax, es:[bx]
1   216	0EB6  53			 push bx
1   217	0EB7  8B FA			 mov di, dx
1   218	0EB9  E8 0069			 call toHex
1   219					 ;mov dx, offset @@ASCII
1   220	0EBC  E8 00FA			 call outText
1   221	0EBF  5B			 pop bx
1   222	0EC0  E2 EF			 loop @@l
1   223	0EC2			       @@r:
1   224	0EC2  C3			 ret
1   225	0EC3			     showStDump	endP
1   226
1   227				     ; ╤Б╤В╨╡╨║	╨▓╨╛╨╖╨▓╤А╨░╤В╨╛╨▓
1   228	0EC3			     showRS proc
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 5
forth.asm



1   229	0EC3  57			 push di
1   230	0EC4  56			 push si
1   231	0EC5  06			 push es
1   232	0EC6  53			 push bx
1   233	0EC7  BA 0EE5r			 mov dx, offset	@@caption
1   234	0ECA  E8 00EC			 call outText
1   235	0ECD  B9 0CCCr			 mov cx, offset	XR0
1   236	0ED0  8B DD			 mov bx, BP
1   237	0ED2  2B CB			 sub cx, bx
1   238	0ED4  BA 0EEBr			 mov dx, offset	@@ASCII
1   239	0ED7  BB 0CCCr			 mov bx, offset	XR0
1   240	0EDA  E8 FFCA			 call showStDump
1   241	0EDD			       @@r:
1   242	0EDD  E8 00CE			 call outCR
1   243	0EE0  5B			 pop bx
1   244	0EE1  07			 pop es
1   245	0EE2  5E			 pop si
1   246	0EE3  5F			 pop di
1   247	0EE4  C3			 ret
1   248	0EE5  52 53 3A 20 20 24		 @@caption DB "RS:  $"
1   249	0EEB  30 30 30 30 20 24		 @@ASCII DB "0000 $"
1   250	0EF1			     showRS endP
1   251
1   252				     ; ╤Б╤В╨╡╨║	╨┐╨░╤А╨░╨╝╨╡╤В╤А╨╛╨▓
1   253	0EF1			     showStack proc
1   254	0EF1  57			 push di
1   255	0EF2  56			 push si
1   256	0EF3  06			 push es
1   257	0EF4  53			 push bx
1   258	0EF5  BA 0F16r			 mov dx, offset	@@caption
1   259	0EF8  E8 00BE			 call outText
1   260	0EFB  B9 0080			 mov cx, 80h
1   261	0EFE  8B DC			 mov bx, SP
1   262	0F00  83 C3 0C			 add bx, 2*6   ; ╤Б╤В╨╛╨╗╤М╨║╨╛	╨╗╨╕╤И╨╜╨╕╤Е ╤Н╨╗╨╡╨╝╨╡╨╜╤В╨╛╨▓	╤Б╤В╨╡╨║╨╡
1   263	0F03  2B CB			 sub cx, bx
1   264	0F05  BB 0080			 mov bx, 80h
1   265	0F08  BA 0F1Fr			 mov dx, offset	@@ASCII
1   266	0F0B  E8 FF99			 call showStDump
1   267	0F0E			       @@r:
1   268	0F0E  E8 009D			 call outCR
1   269	0F11  5B			 pop bx
1   270	0F12  07			 pop es
1   271	0F13  5E			 pop si
1   272	0F14  5F			 pop di
1   273	0F15  C3			 ret
1   274	0F16  53 54 41 43 4B 3A	20+	 @@caption DB "STACK:  $"
    275	      20 24
1   276	0F1F  30 30 30 30 20 24		 @@ASCII DB "0000 $"
1   277	0F25			     showStack endP
1   278
1   279				     ; AX- ╨╖╨╜╨░╤З╨╡╨╜╨╕╨╡ ╨┤╨╗╤П ╨┐╨╡╤З╨░╤В╨╕	╨▓ 16 ╨▓╨╕╨┤╨╡
1   280				     ; di - ╨░╨┤╤А╨╡╤Б ╤Б╤В╤А╨╛╨║╨╕ ╨┤╨╗╤П ╨▓╤Л╨▓╨╛╨┤╨░
1   281	0F25			     toHex PROC
1   282	0F25  51			 push cx
1   283	0F26  B1 04			 mov cl,4	     ; number of ASCII
1   284	0F28  D1 C0 D1 C0 D1 C0	D1+  @@1: rol ax,4	     ; 1 Nibble	(start with highest byte)
    285	      C0
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 6
forth.asm



1   286	0F30  8A D8			 mov bl,al
1   287	0F32  80 E3 0F			 and bl,0Fh	     ; only low-Nibble
1   288	0F35  80 C3 30			 add bl,30h	     ; convert to ASCII
1   289	0F38  80 FB 39			 cmp bl,39h	     ; above 9?
1   290	0F3B  76 03			 jna short @@2
1   291	0F3D  80 C3 07			 add bl,7	     ; "A" to "F"
1   292	0F40  88 1D		     @@2: mov [di],bl	      ;	store ASCII in buffer
1   293	0F42  47			 inc di		     ; increase	target address
1   294	0F43  FE C9			 dec cl		     ; decrease	loop counter
1   295	0F45  75 E1			 jnz @@1	      ;	jump if	cl is not equal	0 (zeroflag is not set)
1   296	0F47  59			 pop cx
1   297	0F48  C3			 ret
1   298	0F49			     toHex endP
1   299
1   300				     ; di- ╨░╨┤╤А╨╡╤Б ╨▒╤Г╤Д╨╡╤А╨░
1   301				     ; cx - ╤З╨╕╤Б╨╗╨╛ ╤Б╨╕╨╝╨▓╨╛╨╗╨╛╨▓
1   302				     ; ╨╖╨░╨┐╨╛╨╗╨╜╨╡╨╜╨╕╨╡ ╨┐╤А╨╛╨▒╨╡╨╗╨╛╨╝
1   303	0F49			     blankBuffer proc
1   304	0F49  57			 push di
1   305	0F4A  FC			 cld
1   306	0F4B  B0 20			 mov al, 32
1   307	0F4D  F3> AA			 rep stosb
1   308	0F4F  5F			 pop di
1   309	0F50  C3			 ret
1   310	0F51			     blankBuffer endp
1   311
1   312				     ; ╨▓╤Л╨▓╨╛╨┤ ╨░╨┤╤А╨╡╤Б╨░ ╨╕ ╨╕╨╝╨╡╨╜╨╕ ╤Б╨╗╨╛╨▓╨░
1   313				     ; AX- ╨╖╨╜╨░╤З╨╡╨╜╨╕╨╡ ╨░╨┤╤А╨╡╤Б╨░
1   314	0F51			     printWORD proc
1   315	0F51  57			 push di
1   316	0F52  56			 push si
1   317	0F53  53			 push bx
1   318	0F54  50			 push ax
1   319	0F55  BF 0F91r			 mov di,OFFSET ASCII ; get the offset address
1   320	0F58  B9 0019			 mov cx, 25
1   321	0F5B  E8 FFEB			 call blankBuffer
1   322					 ; ╨┐╨╡╤З╨░╤В╤М	╨░╨┤╤А╨╡╤Б╨░ ╤Б╨╗╨╛╨▓╨░
1   323	0F5E  8B C6			 mov ax, si
1   324	0F60  2D 0002			 sub ax, 2
1   325	0F63  E8 FFBF			 call toHex
1   326	0F66  47			 inc di
1   327	0F67  47			 inc di
1   328					 ; ╨┐╨╡╤З╨░╤В╤М	CFA ╤Б╨╗╨╛╨▓╨░
1   329	0F68  58			 pop ax
1   330	0F69  50			 push ax
1   331	0F6A  E8 FFB8			 call toHex
1   332	0F6D  47			 inc di	 ; ╨▓╤Л╨▓╨╛╨┤ ╨╕╨╝╨╡╨╜╨╕ ╤Б╨╗╨╛╨▓╨░ ╨┐╨╛╤Б╨╗╨╡ ╨╡╨│╨╛ ╨░╨┤╤А╨╡╤Б╨░
1   333	0F6E  5B			 pop bx	; ╨░╨┤╤А╨╡╤Б ╤Б╨╗╨╛╨▓╨░	CFA?
1   334					 ;mov al, byte ptr [bx-3] ; ╨┐╨╛╤Б╨╗╨╡╨┤╨╜╨╕╨╣ ╤Б╨╕╨╝╨▓╨╛╨╗ ╤Б╨╗╨╛╨▓╨░
1   335	0F6F  83 EB 03			 SUB bx, 3   ;
1   336	0F72				 mm:	      ;	╨╕╤Й╨╡╨╝ ╨┐╨╛╨╗╨╡ ╨┤╨╗╨╕╨╜╤Л
1   337	0F72  4B			 dec bx
1   338	0F73  80 3F 00			 CMP  BYTE PTR [bx],  0
1   339	0F76  79 FA			 JNS  mm     ; JUMP IF POSITIVE
1   340	0F78  8B 0F			 mov cx, [bx] ;	╨┤╨╗╨╕╨╜╨░ ╤Б╨╗╨╛╨▓╨░ +	╨▓╤Б╤П╨║╨╕╨╡  ╤Б╨╗╤Г╨╢.	╨┐╨╛╨╗╤П
1   341	0F7A  83 E1 3F			 and cx, 003Fh
1   342	0F7D				 mmm1:
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 7
forth.asm



1   343	0F7D  43			 inc bx
1   344	0F7E  8A 07			 mov al, byte ptr [bx]
1   345	0F80  24 7F			 and al, 7Fh ;	 ╨┐╨╛╤Б╨╗╨╡╨┤╨╜╨╕╨╣ ╤Б╨╕╨╝╨▓╨╛╨╗ ╤Г╨▓╨╡╨╗╨╕╤З╨╡╨╜ ╨╜╨░ 80h
1   346	0F82  88 05			 mov [di],al
1   347	0F84  47			 inc di
1   348	0F85  E2 F6			 loop mmm1
1   349					 ; Print string
1   350	0F87  BA 0F91r			 mov dx,OFFSET ASCII ; DOS 1+ WRITE STRING TO STANDARD OUTPUT
1   351	0F8A  E8 002C			 call outText
1   352	0F8D  5B			 pop bx
1   353	0F8E  5E			 pop si
1   354	0F8F  5F			 pop di
1   355	0F90  C3			 ret
1   356	0F91  30 30 30 30 3A 20	30+	 ASCII DB "0000: 0000		     ",0Dh,0Ah,"$" ; buffer for	ASCII string
    357	      30 30 30 20 20 20	20+
    358	      20 20 20 20 20 20	20+
    359	      20 20 20 20 20 0D	0A+
    360	      24
1   361	0FAE			     printWORD endP
1   362
1   363	0FAE			     outCR proc
1   364	0FAE  B4 09			 mov ah,9	     ; DS:DX->'$'-terminated string
1   365	0FB0  BA 0FB6r			 lea dx, @@cr
1   366	0FB3  CD 21			 int 21h	     ; (using pipe character">") or output to printer
1   367	0FB5  C3			 ret
1   368	0FB6  0D 0A 24			 @@cr DB 0Dh, 0Ah, "$"
1   369	0FB9			     outCR endp
1   370
1   371				     ; ╨▓╤Л╨▓╨╛╨┤ ╤В╨╡╨║╤Б╤В╨░
1   372	0FB9			     outText proc
1   373	0FB9  B4 09			 mov ah,9	     ; DS:DX->'$'-terminated string
1   374	0FBB  CD 21			 int 21h	     ; (using pipe character">") or output to printer
1   375	0FBD  C3			 ret
1   376	0FBE			     outText endp
1   377
    378
    379					; BX - WP находится адрес исполняемого слова
    380					; SI - IP-регистр    должен сохраняться
    381					; DI - указатель области USER
    382					; BP - указатель стека возвратов
    383					; SP - указатель стека параметров
    384
    385						  HEAD	  87h,'EXECUT',305Q,EXEC	      ;
1   386	      =ARRAY:0FBE		 LINK$=$
1   387	0FBE  87			     DB	 87h  ;	NFA 7 бит равен	1.
1   388							 ; 6 - признак immediate. 5- слово не описано smudge
1   389	0FBF  45 58 45 43 55 54		     DB	 'EXECUT'
1   390	0FC5  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1   391	0FC6  0DB6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   392	      =ARRAY:0FBE		 LINK=LINK$
1   393	0FC8				 EXEC LABEL FAR	 ; CFA
1   394	0FC8  0FCAr			     DW	 $+2
    395					 ; в стеке адрес поля CFA (НЕ PFA)
    396	0FCA  5B				  POP	BX
    397	0FCB  FF 27				  JMP  WORD PTR	[ BX ]
    398
    399						  HEAD	  83h,'LI',324Q,LIT		      ;	LIT
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 8
forth.asm



1   400	      =ARRAY:0FCD		 LINK$=$
1   401	0FCD  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   402							 ; 6 - признак immediate. 5- слово не описано smudge
1   403	0FCE  4C 49			     DB	 'LI'
1   404	0FD0  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1   405	0FD1  0FBEr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   406	      =ARRAY:0FCD		 LINK=LINK$
1   407	0FD3				 LIT LABEL FAR	; CFA
1   408	0FD3  0FD5r			     DW	 $+2
    409	0FD5  AD				  LODSW
    410	0FD6  50				  PUSH	AX
    411						  NEXT
1   412	0FD7  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   413	0FD8  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   414					 ; ------ call debugger	--------
1   415	0FDA  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   416	0FDE  74 06			     jz	??0001
1   417	0FE0  E8 FF6E			     call printWORD
1   418	0FE3  E8 FE4D			     call pause
1   419	0FE6				   ??0001:
1   420					 ; -----------------------------
1   421	0FE6  FF 27			     JMP WORD PTR [BX]
    422
    423						  HEAD	  86h,'TERMO',316Q,TERMON	      ;	TERMON
1   424	      =ARRAY:0FE8		 LINK$=$
1   425	0FE8  86			     DB	 86h  ;	NFA 7 бит равен	1.
1   426							 ; 6 - признак immediate. 5- слово не описано smudge
1   427	0FE9  54 45 52 4D 4F		     DB	 'TERMO'
1   428	0FEE  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1   429	0FEF  0FCDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   430	      =ARRAY:0FE8		 LINK=LINK$
1   431	0FF1				 TERMON	LABEL FAR  ; CFA
1   432	0FF1  0FF3r			     DW	 $+2
    433					 ; NumLock, ScrollLock,	CapsLock, Ins. Состояние этих клавиш записывается
    434					 ; в область данных BIOS в два байта с адресами	0000h:0417h и 0000h:0418h
    435	0FF3  58				  POP	AX
    436	0FF4  06				  PUSH	ES
    437	0FF5  B9 0000				  MOV	CX, 0
    438	0FF8  8E C1				  MOV	ES, CX
    439	0FFA  26: A3 0417			  MOV	ES:417H,AX
    440	0FFE  07				  POP	ES
    441						  NEXT
1   442	0FFF  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   443	1000  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   444					 ; ------ call debugger	--------
1   445	1002  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   446	1006  74 06			     jz	??0002
1   447	1008  E8 FF46			     call printWORD
1   448	100B  E8 FE25			     call pause
1   449	100E				   ??0002:
1   450					 ; -----------------------------
1   451	100E  FF 27			     JMP WORD PTR [BX]
    452
    453						  HEAD	  87h,'?BRANC',310Q,ZBRAN	      ;	?BRANCH
1   454	      =ARRAY:1010		 LINK$=$
1   455	1010  87			     DB	 87h  ;	NFA 7 бит равен	1.
1   456							 ; 6 - признак immediate. 5- слово не описано smudge
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 9
forth.asm



1   457	1011  3F 42 52 41 4E 43		     DB	 '?BRANC'
1   458	1017  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1   459	1018  0FE8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   460	      =ARRAY:1010		 LINK=LINK$
1   461	101A				 ZBRAN LABEL FAR  ; CFA
1   462	101A  101Cr			     DW	 $+2
    463					 ; переход, если 0 в стеке (FALSE)
    464	101C  58				  POP	AX
    465	101D  3D 0000				  CMP	AX, 0
    466	1020  74 1F				  JE	CNT
    467	1022  83 C6 02				  ADD	SI, 2 ;	без перехода пропускаем	следующее слово	(адрес перехода)
    468						  NEXT
1   469	1025  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   470	1026  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   471					 ; ------ call debugger	--------
1   472	1028  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   473	102C  74 06			     jz	??0003
1   474	102E  E8 FF20			     call printWORD
1   475	1031  E8 FDFF			     call pause
1   476	1034				   ??0003:
1   477					 ; -----------------------------
1   478	1034  FF 27			     JMP WORD PTR [BX]
    479
    480						  HEAD	  86h,'BRANC',310Q,BRAN		      ;	BRANCH
1   481	      =ARRAY:1036		 LINK$=$
1   482	1036  86			     DB	 86h  ;	NFA 7 бит равен	1.
1   483							 ; 6 - признак immediate. 5- слово не описано smudge
1   484	1037  42 52 41 4E 43		     DB	 'BRANC'
1   485	103C  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1   486	103D  1010r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   487	      =ARRAY:1036		 LINK=LINK$
1   488	103F				 BRAN LABEL FAR	 ; CFA
1   489	103F  1041r			     DW	 $+2
    490					 ; безусловный переход.	SI указывает на	число инструкций,
    491					 ; которые нужно пропустить
    492	1041  03 34			CNT:	  ADD	SI,  [SI]  ; si	содержит число инструкций,
    493								 ; которые необходимо пропустить
    494						  NEXT
1   495	1043  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   496	1044  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   497					 ; ------ call debugger	--------
1   498	1046  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   499	104A  74 06			     jz	??0004
1   500	104C  E8 FF02			     call printWORD
1   501	104F  E8 FDE1			     call pause
1   502	1052				   ??0004:
1   503					 ; -----------------------------
1   504	1052  FF 27			     JMP WORD PTR [BX]
    505
    506						  HEAD	  84h,'(DO',251Q,XDO		      ;	(DO)
1   507	      =ARRAY:1054		 LINK$=$
1   508	1054  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   509							 ; 6 - признак immediate. 5- слово не описано smudge
1   510	1055  28 44 4F			     DB	 '(DO'
1   511	1058  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1   512	1059  1036r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   513	      =ARRAY:1054		 LINK=LINK$
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 10
forth.asm



1   514	105B				 XDO LABEL FAR	; CFA
1   515	105B  105Dr			     DW	 $+2
    516	105D  58				  POP	AX  ; в	стек данных начальное значение цикла
    517	105E  83 ED 02				  SUB	BP, 2
    518	1061  8F 46 00				  POP	[BP] ; конечное	значение цикла
    519	1064  83 ED 02				  SUB	BP, 2
    520	1067  89 46 00				  MOV	WORD PTR  [BP],AX ; в стек возвратов начальное значение	цикла
    521						 ; BP-4	- начальное значение
    522						 ; BP-2	- конечное значение цикла
    523						 ; BP  до входа	в слово. RS растет в сторону с меньшими	адресами
    524						  NEXT
1   525	106A  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   526	106B  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   527					 ; ------ call debugger	--------
1   528	106D  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   529	1071  74 06			     jz	??0005
1   530	1073  E8 FEDB			     call printWORD
1   531	1076  E8 FDBA			     call pause
1   532	1079				   ??0005:
1   533					 ; -----------------------------
1   534	1079  FF 27			     JMP WORD PTR [BX]
    535
    536						  HEAD	  86h,'(LOOP',251Q,XLOOP	      ;	(LOOP)
1   537	      =ARRAY:107B		 LINK$=$
1   538	107B  86			     DB	 86h  ;	NFA 7 бит равен	1.
1   539							 ; 6 - признак immediate. 5- слово не описано smudge
1   540	107C  28 4C 4F 4F 50		     DB	 '(LOOP'
1   541	1081  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1   542	1082  1054r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   543	      =ARRAY:107B		 LINK=LINK$
1   544	1084				 XLOOP LABEL FAR  ; CFA
1   545	1084  1086r			     DW	 $+2
    546					; Приращение индекса цикла LOOP	и может	быть  ветвление
    547	1086  FF 46 00				  INC	WORD PTR  [BP] ; начальное значение увеличиваем
    548	1089  8B 46 00			LOP:	  MOV	AX,  [BP]    ; индекс
    549	108C  3B 46 02				  CMP	AX,  [BP+2]  ; предел цикла
    550	108F  7C B0				  JL	CNT
    551	1091  83 C5 04			LV:	  ADD	BP,  4 ; удаляем параметры цикла
    552	1094  83 C6 02				  ADD	SI,  2 ; переход к следующеу слову
    553						  NEXT
1   554	1097  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   555	1098  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   556					 ; ------ call debugger	--------
1   557	109A  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   558	109E  74 06			     jz	??0006
1   559	10A0  E8 FEAE			     call printWORD
1   560	10A3  E8 FD8D			     call pause
1   561	10A6				   ??0006:
1   562					 ; -----------------------------
1   563	10A6  FF 27			     JMP WORD PTR [BX]
    564
    565						  HEAD	  87h,'(+LOOP',251Q,XPLOO	      ;	(+LOOP)
1   566	      =ARRAY:10A8		 LINK$=$
1   567	10A8  87			     DB	 87h  ;	NFA 7 бит равен	1.
1   568							 ; 6 - признак immediate. 5- слово не описано smudge
1   569	10A9  28 2B 4C 4F 4F 50		     DB	 '(+LOOP'
1   570	10AF  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 11
forth.asm



1   571	10B0  107Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   572	      =ARRAY:10A8		 LINK=LINK$
1   573	10B2				 XPLOO LABEL FAR  ; CFA
1   574	10B2  10B4r			     DW	 $+2
    575					 ; n  ---
    576	10B4  58				  POP	AX
    577	10B5  01 46 00				  ADD	[BP],	AX
    578	10B8  3D 0000				  CMP	AX, 0
    579	10BB  7C 02				  JL	$LESS
    580	10BD  EB CA				  JMP	LOP
    581	10BF  8B 4E 00			  $LESS:  MOV	CX, [BP]   ; Работа с отрицательными приращениями
    582	10C2  39 4E 02				  CMP	[BP]+2,	CX
    583	10C5  7E CA				  JLE	LV
    584	10C7  E9 FF77				  JMP	CNT
    585
    586						  HEAD	  86h,'(FIND',251Q,PFIND	      ;	PFIND
1   587	      =ARRAY:10CA		 LINK$=$
1   588	10CA  86			     DB	 86h  ;	NFA 7 бит равен	1.
1   589							 ; 6 - признак immediate. 5- слово не описано smudge
1   590	10CB  28 46 49 4E 44		     DB	 '(FIND'
1   591	10D0  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1   592	10D1  10A8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   593	      =ARRAY:10CA		 LINK=LINK$
1   594	10D3				 PFIND LABEL FAR  ; CFA
1   595	10D3  10D5r			     DW	 $+2
    596					     ;	addr1 addr2 ---	pfa b tf (ok) оператор поиска
    597					; Адрес	строки	NFA => PFA длина TRUE/FALSE (!реально СFA !)
    598	10D5  58				  POP	AX	 ; NFA последнего слова	в context словаре
    599	10D6  59				  POP	CX	 ; addr1 строка	для поиска. первый байт	длина образца
    600	10D7  55				  PUSH	BP	 ; сохранение содержимого регистров
    601	10D8  56				  PUSH	SI	 ; --
    602	10D9  57				  PUSH	DI	 ; --
    603	10DA  8B F1				  MOV	SI, CX	 ; адрес образца
    604	10DC  2B ED				  SUB	BP, BP	 ;
    605	10DE  8B F8				  MOV	DI, AX	 ; NFA	последнего слова в словаре
    606	10E0  8B 14				  MOV	DX,WORD	PTR [SI] ; длина строки	поиска и первый	символ
    607	10E2  81 E2 7F7F			  AND	DX, 77577Q ; 7F7f - сброс старших битов. кажется лишним
    608	10E6  FC				  CLD			 ; DF=0	(вперед)
    609	10E7  8B 0D			FAST:	  MOV	CX,WORD	PTR [DI] ;
    610	10E9  81 E1 7F3F			  AND	CX, 77477Q ; сброс 7-ых	и 6 бита в первом байте
    611	10ED  3B D1				  CMP	DX, CX	 ; сравним длину и первый символ
    612	10EF  74 14				  JE	SLOW	 ; если	равны, может то, что ищем
    613	10F1  83 3D 00			MATCH:	  CMP	WORD PTR [DI], 0 ; ищем	конец nfa
    614	10F4  78 03				  JS	$SIG	     ; BPL
    615	10F6  47				  INC	DI	     ; следующий символ	в слове
    616	10F7  EB F8				  JMP	MATCH
    617	10F9  83 C7 02			$SIG:	  ADD	DI, 2	     ; переход к полю LFA
    618	10FC  83 3D 00				  CMP	WORD PTR [DI],0	 ; список слов закончился
    619	10FF  74 34				  JE	FAIL		 ; LFA =0, поиск не удачен
    620	1101  8B 3D				  MOV	DI,WORD	PTR [DI] ; переход к другому слову в словаре
    621	1103  EB E2				  JMP	FAST
    622	1105  8B 2D			SLOW:	  MOV	BP,WORD	PTR [DI] ; длина и первый символ найденого слова
    623	1107  8B DE				  MOV	BX, SI		 ; адрес образца
    624	1109  EB 0D				  JMP	SLOW1
    625	110B  43			$LOOP:	  INC	BX		 ; перебор символов
    626	110C  8B 07				  MOV	AX,WORD	PTR [BX]
    627	110E  8B 0D				  MOV	CX,WORD	PTR [DI]
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 12
forth.asm



    628	1110  81 E1 7FFF			  AND	CX, 77777Q   ; 7FFFh
    629	1114  3B C1				  CMP	AX, CX
    630	1116  75 D9				  JNE	MATCH	     ; не совпало, переход на начало
    631	1118  47			SLOW1:	  INC	DI
    632	1119  F7 45 FF 8000			  TEST	WORD PTR -1[DI],100000Q	; 8000h
    633	111E  74 EB				  JZ	$LOOP	     ; переход,	если 7 бит РАВЕН 0
    634	1120  8B D5				  MOV	DX, BP	     ; длина слова
    635	1122  83 C7 05				  ADD	DI, 5	     ; PFA найденого слова
    636	1125  8B C7				  MOV	AX, DI
    637	1127  5F				  POP	DI	     ; восстановление содержимого регистров
    638	1128  5E				  POP	SI
    639	1129  5D				  POP	BP
    640	112A  2D 0002				  SUB	AX, 2	     ; CFA
    641	112D  50				  PUSH	AX
    642	112E  81 E2 00FF			  AND	DX, 377Q	; FFh выделяем байт длины и ФЛАГОВ
    643	1132  52				  PUSH	DX		; в стек
    644	1133  EB 4B				  JMP	TRUE		; Установка флага "Найдено"
    645	1135  5F			FAIL:	  POP	DI
    646	1136  5E				  POP	SI
    647	1137  5D				  POP	BP
    648	1138  EB 32				  JMP	FALSE
    649
    650						  HEAD	  85h,'DIGI',324Q,DIGIT		      ;	DIGIT
1   651	      =ARRAY:113A		 LINK$=$
1   652	113A  85			     DB	 85h  ;	NFA 7 бит равен	1.
1   653							 ; 6 - признак immediate. 5- слово не описано smudge
1   654	113B  44 49 47 49		     DB	 'DIGI'
1   655	113F  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1   656	1140  10CAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   657	      =ARRAY:113A		 LINK=LINK$
1   658	1142				 DIGIT LABEL FAR  ; CFA
1   659	1142  1144r			     DW	 $+2
    660					; ASCII-DIGIT BASE=>DIGIT-VALUE	TRUE (FALSE)
    661	1144  58				  POP	AX	; AX=BASE
    662	1145  59				  POP	CX
    663	1146  83 E9 30				  SUB	CX, 60Q	; VALID	DIGIT =	ASCII-60
    664	1149  7C 21				  JL	FALSE
    665	114B  83 F9 09				  CMP	CX, 9	; Если >9
    666	114E  7E 08				  JLE	M09
    667	1150  83 E9 07				  SUB	CX, 7
    668	1153  83 F9 0A				  CMP	CX, 10
    669	1156  7C 14				  JL	FALSE
    670	1158  3B C8			M09:	  CMP	CX, AX	; Если не меньше BASE, то ошибка
    671	115A  7D 10				  JGE	FALSE
    672	115C  51				  PUSH	CX	; Запись цифры в стек
    673	115D  EB 21				  JMP	TRUE	; "Успешный" выход
    674
    675					;	  **  Стандартные слова	 **
    676					;	  **  Условные операторы  **
    677
    678						  HEAD	  82h,'0',275Q,ZEQU		      ;	0=
1   679	      =ARRAY:115F		 LINK$=$
1   680	115F  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   681							 ; 6 - признак immediate. 5- слово не описано smudge
1   682	1160  30			     DB	 '0'
1   683	1161  BD			     DB	 275Q	; последний символ слова + 128 (7 бит =	1).
1   684	1162  113Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 13
forth.asm



1   685	      =ARRAY:115F		 LINK=LINK$
1   686	1164				 ZEQU LABEL FAR	 ; CFA
1   687	1164  1166r			     DW	 $+2
    688	1166  58				  POP	AX
    689	1167  3D 0000				  CMP	AX,  0
    690	116A  74 14				  JE	TRUE
    691	116C  2B C0			FALSE:	  SUB	AX,  AX
    692	116E  50			PUT:	  PUSH	AX
    693						  NEXT
1   694	116F  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   695	1170  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   696					 ; ------ call debugger	--------
1   697	1172  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   698	1176  74 06			     jz	??0007
1   699	1178  E8 FDD6			     call printWORD
1   700	117B  E8 FCB5			     call pause
1   701	117E				   ??0007:
1   702					 ; -----------------------------
1   703	117E  FF 27			     JMP WORD PTR [BX]
    704	1180  B8 0001			TRUE:	  MOV	AX,  1
    705	1183  EB E9				  JMP	PUT
    706
    707						  HEAD	  83h,'0<','>'+80h,NZEQ		      ;	0<>
1   708	      =ARRAY:1185		 LINK$=$
1   709	1185  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   710							 ; 6 - признак immediate. 5- слово не описано smudge
1   711	1186  30 3C			     DB	 '0<'
1   712	1188  BE			     DB	 '>'+80h   ; последний символ слова + 128 (7 бит = 1).
1   713	1189  115Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   714	      =ARRAY:1185		 LINK=LINK$
1   715	118B				 NZEQ LABEL FAR	 ; CFA
1   716	118B  118Dr			     DW	 $+2
    717	118D  58				  POP	AX
    718	118E  3D 0000				  CMP	AX,  0
    719	1191  75 ED				  JNE	 TRUE
    720	1193  EB D7				  JMP FALSE
    721
    722						  HEAD	  82h,'0',276Q,ZGRET		      ;	0>
1   723	      =ARRAY:1195		 LINK$=$
1   724	1195  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   725							 ; 6 - признак immediate. 5- слово не описано smudge
1   726	1196  30			     DB	 '0'
1   727	1197  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1   728	1198  1185r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   729	      =ARRAY:1195		 LINK=LINK$
1   730	119A				 ZGRET LABEL FAR  ; CFA
1   731	119A  119Cr			     DW	 $+2
    732	119C  58				  POP	AX
    733	119D  3D 0000				  CMP	AX, 0
    734	11A0  7F DE				  JG	TRUE
    735	11A2  EB C8				  JMP	FALSE
    736
    737						  HEAD	  83h,'0=',276Q,ZEQGR		       ; 0=>
1   738	      =ARRAY:11A4		 LINK$=$
1   739	11A4  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   740							 ; 6 - признак immediate. 5- слово не описано smudge
1   741	11A5  30 3D			     DB	 '0='
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 14
forth.asm



1   742	11A7  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1   743	11A8  1195r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   744	      =ARRAY:11A4		 LINK=LINK$
1   745	11AA				 ZEQGR LABEL FAR  ; CFA
1   746	11AA  11ACr			     DW	 $+2
    747	11AC  58				  POP	AX
    748	11AD  3D 0000				  CMP	AX, 0
    749	11B0  7D CE				  JGE	 TRUE
    750	11B2  EB B8				  JMP	FALSE
    751
    752						  HEAD	  82h,'0',274Q,ZLESS		      ;	0<
1   753	      =ARRAY:11B4		 LINK$=$
1   754	11B4  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   755							 ; 6 - признак immediate. 5- слово не описано smudge
1   756	11B5  30			     DB	 '0'
1   757	11B6  BC			     DB	 274Q	; последний символ слова + 128 (7 бит =	1).
1   758	11B7  11A4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   759	      =ARRAY:11B4		 LINK=LINK$
1   760	11B9				 ZLESS LABEL FAR  ; CFA
1   761	11B9  11BBr			     DW	 $+2
    762	11BB  58				  POP	AX
    763	11BC  3D 0000				  CMP	AX, 0
    764	11BF  78 BF				  JS	TRUE	     ; Если минус
    765	11C1  EB A9				  JMP	FALSE
    766
    767						  HEAD	  83h,'0=',274Q,ZEQLES		      ;	0=<
1   768	      =ARRAY:11C3		 LINK$=$
1   769	11C3  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   770							 ; 6 - признак immediate. 5- слово не описано smudge
1   771	11C4  30 3D			     DB	 '0='
1   772	11C6  BC			     DB	 274Q	; последний символ слова + 128 (7 бит =	1).
1   773	11C7  11B4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   774	      =ARRAY:11C3		 LINK=LINK$
1   775	11C9				 ZEQLES	LABEL FAR  ; CFA
1   776	11C9  11CBr			     DW	 $+2
    777	11CB  58				  POP	AX
    778	11CC  3D 0000				  CMP	AX, 0
    779	11CF  78 AF				  JS   TRUE	    ; Если минус
    780	11D1  74 AD				  JE   TRUE	     ; или ноль
    781	11D3  EB 97				  JMP	FALSE
    782
    783						  HEAD	  81h,,275Q,EQUAL		      ;	=
1   784	      =ARRAY:11D5		 LINK$=$
1   785	11D5  81			     DB	 81h  ;	NFA 7 бит равен	1.
1   786							 ; 6 - признак immediate. 5- слово не описано smudge
1   787	11D6  BD			     DB	 275Q	; последний символ слова + 128 (7 бит =	1).
1   788	11D7  11C3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   789	      =ARRAY:11D5		 LINK=LINK$
1   790	11D9				 EQUAL LABEL FAR  ; CFA
1   791	11D9  11DBr			     DW	 $+2
    792	11DB  58				  POP	AX
    793	11DC  59				  POP	CX
    794	11DD  3B C8				  CMP	CX, AX
    795	11DF  74 9F				  JE	TRUE
    796	11E1  EB 89				  JMP	FALSE
    797
    798						  HEAD	  82h,'<','>'+80h,NEQ		       ; <>
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 15
forth.asm



1   799	      =ARRAY:11E3		 LINK$=$
1   800	11E3  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   801							 ; 6 - признак immediate. 5- слово не описано smudge
1   802	11E4  3C			     DB	 '<'
1   803	11E5  BE			     DB	 '>'+80h   ; последний символ слова + 128 (7 бит = 1).
1   804	11E6  11D5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   805	      =ARRAY:11E3		 LINK=LINK$
1   806	11E8				 NEQ LABEL FAR	; CFA
1   807	11E8  11EAr			     DW	 $+2
    808	11EA  58				  POP	AX
    809	11EB  59				  POP	CX
    810	11EC  3B C8				  CMP	CX, AX
    811	11EE  74 5A				  JE	FALSE1
    812	11F0  EB 6C				  JMP	TRUE1
    813
    814						  HEAD	  82h,'U',274Q,ULESS		      ;	U<
1   815	      =ARRAY:11F2		 LINK$=$
1   816	11F2  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   817							 ; 6 - признак immediate. 5- слово не описано smudge
1   818	11F3  55			     DB	 'U'
1   819	11F4  BC			     DB	 274Q	; последний символ слова + 128 (7 бит =	1).
1   820	11F5  11E3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   821	      =ARRAY:11F2		 LINK=LINK$
1   822	11F7				 ULESS LABEL FAR  ; CFA
1   823	11F7  11F9r			     DW	 $+2
    824	11F9  58				  POP	AX
    825	11FA  59				  POP	CX
    826	11FB  3B C8				  CMP	CX, AX
    827	11FD  72 5F				  JB	TRUE1		; для чисел без	знака
    828	11FF  EB 49				  JMP	FALSE1
    829
    830						  HEAD	  81h,,274Q,LESS		      ;	<
1   831	      =ARRAY:1201		 LINK$=$
1   832	1201  81			     DB	 81h  ;	NFA 7 бит равен	1.
1   833							 ; 6 - признак immediate. 5- слово не описано smudge
1   834	1202  BC			     DB	 274Q	; последний символ слова + 128 (7 бит =	1).
1   835	1203  11F2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   836	      =ARRAY:1201		 LINK=LINK$
1   837	1205				 LESS LABEL FAR	 ; CFA
1   838	1205  1207r			     DW	 $+2
    839	1207  58				  POP	AX
    840	1208  59				  POP	CX
    841	1209  3B C1				  CMP	AX, CX
    842	120B  7F 51				  JG	TRUE1
    843	120D  EB 3B				  JMP	FALSE1
    844
    845						  HEAD	  82h,'=',274Q,EQLES			  ; =<
1   846	      =ARRAY:120F		 LINK$=$
1   847	120F  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   848							 ; 6 - признак immediate. 5- слово не описано smudge
1   849	1210  3D			     DB	 '='
1   850	1211  BC			     DB	 274Q	; последний символ слова + 128 (7 бит =	1).
1   851	1212  1201r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   852	      =ARRAY:120F		 LINK=LINK$
1   853	1214				 EQLES LABEL FAR  ; CFA
1   854	1214  1216r			     DW	 $+2
    855	1216  58				  POP	AX
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 16
forth.asm



    856	1217  59				  POP	CX
    857	1218  3B C1				  CMP	AX, CX
    858	121A  7D 42				  JGE	 TRUE1
    859	121C  EB 2C				  JMP	FALSE1
    860
    861						  HEAD	  81h,,276Q,GREAT		      ;	>
1   862	      =ARRAY:121E		 LINK$=$
1   863	121E  81			     DB	 81h  ;	NFA 7 бит равен	1.
1   864							 ; 6 - признак immediate. 5- слово не описано smudge
1   865	121F  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1   866	1220  120Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   867	      =ARRAY:121E		 LINK=LINK$
1   868	1222				 GREAT LABEL FAR  ; CFA
1   869	1222  1224r			     DW	 $+2
    870	1224  58				  POP	AX
    871	1225  59				  POP	CX
    872	1226  3B C1				  CMP	AX, CX
    873	1228  7C 34				      JL    TRUE1
    874	122A  EB 1E				  JMP	FALSE1
    875
    876						  HEAD	  82h,'=',276Q,EQGR			; =>
1   877	      =ARRAY:122C		 LINK$=$
1   878	122C  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   879							 ; 6 - признак immediate. 5- слово не описано smudge
1   880	122D  3D			     DB	 '='
1   881	122E  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1   882	122F  121Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   883	      =ARRAY:122C		 LINK=LINK$
1   884	1231				 EQGR LABEL FAR	 ; CFA
1   885	1231  1233r			     DW	 $+2
    886	1233  58				  POP	AX
    887	1234  59				  POP	CX
    888	1235  3B C1				  CMP	AX, CX
    889	1237  7E 25				      JLE    TRUE1
    890	1239  EB 0F				  JMP	FALSE1
    891
    892						 HEAD	  84h,'EVE', 'N'+80h, $EVEN	      ;	EVEN
1   893	      =ARRAY:123B		 LINK$=$
1   894	123B  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   895							 ; 6 - признак immediate. 5- слово не описано smudge
1   896	123C  45 56 45			     DB	 'EVE'
1   897	123F  CE			     DB	 'N'+80h   ; последний символ слова + 128 (7 бит = 1).
1   898	1240  122Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   899	      =ARRAY:123B		 LINK=LINK$
1   900	1242				 $EVEN LABEL FAR  ; CFA
1   901	1242  1244r			     DW	 $+2
    902					 ; проверка на четность
    903	1244  58				 pop ax
    904	1245  A9 0001				 test ax, 1 ; проверяем	младший	бит
    905	1248  74 14				 jz true1 ; если бит=0,	то число четное
    906	124A  2B C0			 FALSE1: SUB   AX,  AX
    907	124C  50			 PUT1:	 PUSH  AX
    908						 NEXT
1   909	124D  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   910	124E  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   911					 ; ------ call debugger	--------
1   912	1250  80 7D 42 00		     cmp byte ptr [di+102Q], 0
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 17
forth.asm



1   913	1254  74 06			     jz	??0008
1   914	1256  E8 FCF8			     call printWORD
1   915	1259  E8 FBD7			     call pause
1   916	125C				   ??0008:
1   917					 ; -----------------------------
1   918	125C  FF 27			     JMP WORD PTR [BX]
    919	125E  B8 0001			 TRUE1:	 MOV   AX,  1
    920	1261  EB E9				 JMP   PUT1
    921
    922					;	  ******************
    923
    924						  HEAD	  84h,'ENC',314Q,ENCL		      ;	ENCLOSE
1   925	      =ARRAY:1263		 LINK$=$
1   926	1263  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   927							 ; 6 - признак immediate. 5- слово не описано smudge
1   928	1264  45 4E 43			     DB	 'ENC'
1   929	1267  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1   930	1268  123Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   931	      =ARRAY:1263		 LINK=LINK$
1   932	126A				 ENCL LABEL FAR	 ; CFA
1   933	126A  126Cr			     DW	 $+2
    934					 ; addr1 c -- addr1 n1 n2 n3
    935	126C  58				  POP	AX	   ; разделитель
    936	126D  59				  POP	CX	   ; начальный адрес
    937	126E  8B D9				  MOV	BX, CX
    938	1270  38 07			A:	  CMP	BYTE PTR  [BX],	AL ; обход разделителей	в начале
    939	1272  75 03				  JNE	NOTEQ
    940	1274  43			AAA1:	  INC	BX
    941	1275  EB F9				  JMP	A
    942	1277  80 3F 0D			NOTEQ:	  CMP	BYTE PTR  [BX],	15Q ; обход перевода строки
    943	127A  74 F8				  JE	AAA1
    944	127C  80 3F 0A				  CMP	BYTE PTR  [BX],	12Q
    945	127F  74 F3				  JE	AAA1		     ; обход перевода строки
    946	1281  8B D3				  MOV	DX, BX		     ; начало лексемы
    947	1283  52				  PUSH	DX
    948	1284  80 3F 00			AA:	  CMP	BYTE PTR  [BX],	 0
    949	1287  74 21				  JE	ZZZ		     ; если нуль
    950	1289  38 07				  CMP	BYTE PTR  [BX],	AL   ; не нуль,	ищем конец лексемы
    951	128B  74 03				  JE	EQW
    952	128D  43				  INC	BX
    953	128E  EB F4				  JMP	AA
    954	1290  8B C3			EQW:	  MOV	AX, BX
    955	1292  2B DA				  SUB	BX, DX
    956	1294  53				  PUSH	BX
    957	1295  2B C1				  SUB	AX, CX
    958	1297  40				  INC	AX
    959	1298  50				  PUSH	AX
    960						  NEXT		     ; выход из	слова
1   961	1299  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   962	129A  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   963					 ; ------ call debugger	--------
1   964	129C  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   965	12A0  74 06			     jz	??0009
1   966	12A2  E8 FCAC			     call printWORD
1   967	12A5  E8 FB8B			     call pause
1   968	12A8				   ??0009:
1   969					 ; -----------------------------
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 18
forth.asm



1   970	12A8  FF 27			     JMP WORD PTR [BX]
    971
    972	12AA  3B DA			ZZZ:	  CMP	BX, DX
    973	12AC  75 E2				  JNE	EQW
    974	12AE  43				  INC	BX
    975	12AF  EB DF				  JMP	EQW
    976
    977					 ;	   ** Дисплей **
    978
    979						  HEAD	  84h,'PAG',305Q,$PAGE		      ;	PAGE
1   980	      =ARRAY:12B1		 LINK$=$
1   981	12B1  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   982							 ; 6 - признак immediate. 5- слово не описано smudge
1   983	12B2  50 41 47			     DB	 'PAG'
1   984	12B5  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1   985	12B6  1263r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   986	      =ARRAY:12B1		 LINK=LINK$
1   987	12B8				 $PAGE LABEL FAR  ; CFA
1   988	12B8  12BAr			     DW	 $+2
    989					 ; Установка активной страницы ( PAGE --)
    990	12BA  58				  POP	AX
    991					 ; вход:  AL = номер страницы (большинство программ использует страницу	0)
    992	12BB  B4 05				  MOV	AH, 5
    993	12BD  CD 10				  INT	10h
    994						  NEXT
1   995	12BF  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   996	12C0  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   997					 ; ------ call debugger	--------
1   998	12C2  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   999	12C6  74 06			     jz	??000A
1  1000	12C8  E8 FC86			     call printWORD
1  1001	12CB  E8 FB65			     call pause
1  1002	12CE				   ??000A:
1  1003					 ; -----------------------------
1  1004	12CE  FF 27			     JMP WORD PTR [BX]
   1005
   1006						  HEAD	  83h,'PI',330Q,PIX		      ;	PIX
1  1007	      =ARRAY:12D0		 LINK$=$
1  1008	12D0  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1009							 ; 6 - признак immediate. 5- слово не описано smudge
1  1010	12D1  50 49			     DB	 'PI'
1  1011	12D3  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  1012	12D4  12B1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1013	      =ARRAY:12D0		 LINK=LINK$
1  1014	12D6				 PIX LABEL FAR	; CFA
1  1015	12D6  12D8r			     DW	 $+2
   1016					 ; COLCOD ROW COLUMN -->  -    запись графической точки
   1017	12D8  59				  POP	CX		    ; колонка x?
   1018	12D9  5A				  POP	DX		    ; строка y?
   1019	12DA  58				  POP	AX		    ; код цветности
   1020						  ;PUSH	 DX		     ; сохранение DX
   1021						  ;MOV	 DX, BX		     ; BH = номер видео	страницы ??? где
   1022						  ;SUB	 DH, DH		     ; ошибка в	коде
   1023	12DB  50				  push	 ax
   1024	12DC  B4 0F				  MOV	AH, 0Fh		    ; Чтение текущей страницы
   1025	12DE  CD 10				  INT	10h		    ; в	BH
   1026	12E0  58				  pop	 ax		    ; код цветности
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 19
forth.asm



   1027	12E1  B4 0C				  MOV	AH, 0Ch		    ;
   1028	12E3  CD 10				  INT	10h		    ; запись графической точки
   1029						  ;POP	 DX		     ; восстановление DX
   1030						  NEXT
1  1031	12E5  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1032	12E6  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1033					 ; ------ call debugger	--------
1  1034	12E8  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1035	12EC  74 06			     jz	??000B
1  1036	12EE  E8 FC60			     call printWORD
1  1037	12F1  E8 FB3F			     call pause
1  1038	12F4				   ??000B:
1  1039					 ; -----------------------------
1  1040	12F4  FF 27			     JMP WORD PTR [BX]
   1041
   1042						  HEAD	  84h,'MOD','A'+80h,MODA		 ; MODA
1  1043	      =ARRAY:12F6		 LINK$=$
1  1044	12F6  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1045							 ; 6 - признак immediate. 5- слово не описано smudge
1  1046	12F7  4D 4F 44			     DB	 'MOD'
1  1047	12FA  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  1048	12FB  12D0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1049	      =ARRAY:12F6		 LINK=LINK$
1  1050	12FD				 MODA LABEL FAR	 ; CFA
1  1051	12FD  12FFr			     DW	 $+2
   1052					 ; установка режима. ( М --> - )
   1053	12FF  58				  POP	AX
   1054	1300  2A E4				  SUB	AH, AH	     ; 00H уст.	видео режим. Очистить экран
   1055								     ;	установить поля	BIOS, установить режим.
   1056	1302  CD 10				  INT	 10h
   1057						  NEXT
1  1058	1304  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1059	1305  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1060					 ; ------ call debugger	--------
1  1061	1307  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1062	130B  74 06			     jz	??000C
1  1063	130D  E8 FC41			     call printWORD
1  1064	1310  E8 FB20			     call pause
1  1065	1313				   ??000C:
1  1066					 ; -----------------------------
1  1067	1313  FF 27			     JMP WORD PTR [BX]
   1068
   1069						  HEAD	  83h,'EM',311Q,EMI$		      ;	EMI
1  1070	      =ARRAY:1315		 LINK$=$
1  1071	1315  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1072							 ; 6 - признак immediate. 5- слово не описано smudge
1  1073	1316  45 4D			     DB	 'EM'
1  1074	1318  C9			     DB	 311Q	; последний символ слова + 128 (7 бит =	1).
1  1075	1319  12F6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1076	      =ARRAY:1315		 LINK=LINK$
1  1077	131B				 EMI$ LABEL FAR	 ; CFA
1  1078	131B  131Dr			     DW	 $+2
   1079	131D  59				  POP	CX		; Число	символов
   1080	131E  58				  POP	AX		; Символ
   1081	131F  51				  PUSH	CX		; Сохранение содержимого CX
   1082	1320  50				  PUSH	AX		; Сохранение содержимого AХ
   1083	1321  8B 5D 1A				  MOV	BX, [DI+32Q]	; Установка атрибута
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 20
forth.asm



   1084	1324  B4 0F				  MOV	AH, 0Fh		; Чтение текущей страницы
   1085	1326  CD 10				  INT	10h		; в BH
   1086	1328  58				  POP	AX		; Восстановление содержимого AX
   1087	1329  B4 09				  MOV	AH, 9		; Запись строки	символов
   1088	132B  CD 10				  INT	10h
   1089	132D  B4 03				  MOV	AH, 3		; Чтение положения курсора
   1090	132F  CD 10				  INT	10h
   1091	1331  59				  POP	CX
   1092	1332  02 D1				  ADD	DL, CL		; DH,DL	= строка, колонка (считая от 0)
   1093	1334  B4 02				  MOV	AH, 2		; Установка положения курсора
   1094	1336  CD 10			$EM:	  INT	10h
   1095	1338  83 7D 22 00			  CMP	WORD PTR [DI+42Q], 0  ;	сброс флага печати
   1096	133C  75 25				  JNE	PRINT
   1097	133E				OK:	  NEXT
1  1098	133E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1099	133F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1100					 ; ------ call debugger	--------
1  1101	1341  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1102	1345  74 06			     jz	??000D
1  1103	1347  E8 FC07			     call printWORD
1  1104	134A  E8 FAE6			     call pause
1  1105	134D				   ??000D:
1  1106					 ; -----------------------------
1  1107	134D  FF 27			     JMP WORD PTR [BX]
   1108
   1109						  HEAD	  84h,'EMI',324Q,EMIT,$EMIT	      ;	EMIT
1  1110	      =ARRAY:134F		 LINK$=$
1  1111	134F  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1112							 ; 6 - признак immediate. 5- слово не описано smudge
1  1113	1350  45 4D 49			     DB	 'EMI'
1  1114	1353  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  1115	1354  1315r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1116	      =ARRAY:134F		 LINK=LINK$
1  1117	1356				 EMIT LABEL FAR	 ; CFA
1  1118	1356  1358r			     DW	$EMIT
   1119					 ; вывод текста	без атрибутов (по умолчанию)
   1120	1358				$EMIT	  LABEL	  FAR
   1121	1358  58				  POP	AX
   1122	1359  50			ENT$:	  PUSH	AX
   1123	135A  B4 0F				  MOV	AH, 15	     ; Чтение текущей страницы
   1124	135C  CD 10				  INT	10h
   1125	135E  58				  POP	AX
   1126	135F  B4 0E				  MOV	AH, 14	     ;
   1127	1361  EB D3				  JMP	$EM
   1128
   1129	1363  BA 0000			PRINT:	  MOV	DX, 0	; Установка номера принтера
   1130	1366  2A E4				  SUB	AH, AH
   1131	1368  CD 17				  INT	17h
   1132	136A  F6 C4 29				  TEST	 AH, 29h
   1133	136D  74 CF				  JE	OK
   1134	136F  8A C4			ERR4:	  MOV	AL, AH
   1135	1371  04 30				  ADD	AL, 60Q
   1136	1373  B4 0E				  MOV	AH, 14
   1137	1375  CD 10				  INT	10h
   1138	1377  BA 1380r				  MOV	DX, OFFSET ERMES4
   1139	137A  B4 09				  MOV	AH, 9H
   1140	137C  CD 21				  INT	21H
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 21
forth.asm



   1141	137E  EB 59				  JMP	TYPE$
   1142	1380  20 50 52 49 4E 54	45+	ERMES4	  DB   " PRINTER ERROR $" ;
   1143	      52 20 45 52 52 4F	52+
   1144	      20 24
   1145
   1146						  HEAD	  82h,'R',303Q,RC		      ;	RC
1  1147	      =ARRAY:1390		 LINK$=$
1  1148	1390  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1149							 ; 6 - признак immediate. 5- слово не описано smudge
1  1150	1391  52			     DB	 'R'
1  1151	1392  C3			     DB	 303Q	; последний символ слова + 128 (7 бит =	1).
1  1152	1393  134Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1153	      =ARRAY:1390		 LINK=LINK$
1  1154	1395				 RC LABEL FAR  ; CFA
1  1155	1395  1397r			     DW	 $+2
   1156	1397  B8 000D				  MOV	AX, 13
   1157	139A  EB BD				  JMP	ENT$
   1158
   1159						  HEAD	  82h,'I',314Q,IL		      ;	BELL
1  1160	      =ARRAY:139C		 LINK$=$
1  1161	139C  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1162							 ; 6 - признак immediate. 5- слово не описано smudge
1  1163	139D  49			     DB	 'I'
1  1164	139E  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  1165	139F  1390r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1166	      =ARRAY:139C		 LINK=LINK$
1  1167	13A1				 IL LABEL FAR  ; CFA
1  1168	13A1  13A3r			     DW	 $+2
   1169	13A3  B8 0007				  MOV	AX, 7
   1170	13A6  EB B1				  JMP	ENT$
   1171
   1172						  HEAD	  84h,'PRI',316Q,PRIN		  ; PRINT-FLAG
1  1173	      =ARRAY:13A8		 LINK$=$
1  1174	13A8  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1175							 ; 6 - признак immediate. 5- слово не описано smudge
1  1176	13A9  50 52 49			     DB	 'PRI'
1  1177	13AC  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  1178	13AD  139Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1179	      =ARRAY:13A8		 LINK=LINK$
1  1180	13AF				 PRIN LABEL FAR	 ; CFA
1  1181	13AF  13B1r			     DW	 $+2
   1182	13B1  FF 45 22				  INC	WORD PTR  [DI+42Q]
   1183	13B4  BA 0000				  MOV	DX,  0	     ; Установка номера	принтера
   1184	13B7  B4 01				  MOV	AH,  1	     ; Инициализация принтера
   1185	13B9  CD 17				  INT	17H
   1186	13BB  F6 C4 29				  TEST	AH,  29h
   1187	13BE  75 AF				  JNE	ERR4
   1188						  NEXT
1  1189	13C0  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1190	13C1  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1191					 ; ------ call debugger	--------
1  1192	13C3  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1193	13C7  74 06			     jz	??000E
1  1194	13C9  E8 FB85			     call printWORD
1  1195	13CC  E8 FA64			     call pause
1  1196	13CF				   ??000E:
1  1197					 ; -----------------------------
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 22
forth.asm



1  1198	13CF  FF 27			     JMP WORD PTR [BX]
   1199
   1200						  HEAD	  83h,'TT',331Q,TTY		 ; TERMI-FLAG
1  1201	      =ARRAY:13D1		 LINK$=$
1  1202	13D1  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1203							 ; 6 - признак immediate. 5- слово не описано smudge
1  1204	13D2  54 54			     DB	 'TT'
1  1205	13D4  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  1206	13D5  13A8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1207	      =ARRAY:13D1		 LINK=LINK$
1  1208	13D7				 TTY LABEL FAR	; CFA
1  1209	13D7  13D9r			     DW	 $+2
   1210	13D9  C7 45 22 0000		TYPE$:	  MOV	WORD PTR [DI+42Q],0
   1211						  NEXT
1  1212	13DE  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1213	13DF  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1214					 ; ------ call debugger	--------
1  1215	13E1  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1216	13E5  74 06			     jz	??000F
1  1217	13E7  E8 FB67			     call printWORD
1  1218	13EA  E8 FA46			     call pause
1  1219	13ED				   ??000F:
1  1220					 ; -----------------------------
1  1221	13ED  FF 27			     JMP WORD PTR [BX]
   1222
   1223						  HEAD	  83h,'SC',314Q,SCL		      ;	SCL
1  1224	      =ARRAY:13EF		 LINK$=$
1  1225	13EF  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1226							 ; 6 - признак immediate. 5- слово не описано smudge
1  1227	13F0  53 43			     DB	 'SC'
1  1228	13F2  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  1229	13F3  13D1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1230	      =ARRAY:13EF		 LINK=LINK$
1  1231	13F5				 SCL LABEL FAR	; CFA
1  1232	13F5  13F7r			     DW	 $+2
   1233					; SCREEN CLEAR
   1234						  ;MOV	 CX, 2048     ;	Загрузка счетчика
   1235						  ;MOV	 AH, 15
   1236						  ;INT	 10h	       ; Установка текущей страницы
   1237	13F7  2B D2				  SUB	DX, DX	     ;	DH,DL =	строка,	колонка	(считая	от 0)
   1238	13F9  2B C9				  SUB	CX, CX
   1239						  ;MOV	 AH, 2	      ;	Курсор в исходное положение
   1240						  ;INT	 10h
   1241	13FB  B7 07				  MOV	BH, 7	     ; атрибут
   1242					 ; 09H писать символ/атрибут в текущей позиции курсора
   1243	13FD  B8 0600			CLEAR:	  MOV	AX, 0600H    ; число пустых строк, вдвигаемых снизу (0=очистить	все окно)
   1244	1400  CD 10				  INT	10h
   1245						  NEXT
1  1246	1402  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1247	1403  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1248					 ; ------ call debugger	--------
1  1249	1405  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1250	1409  74 06			     jz	??0010
1  1251	140B  E8 FB43			     call printWORD
1  1252	140E  E8 FA22			     call pause
1  1253	1411				   ??0010:
1  1254					 ; -----------------------------
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 23
forth.asm



1  1255	1411  FF 27			     JMP WORD PTR [BX]
   1256
   1257						  HEAD	  83h,'FI',330Q,FIX		      ;	FIX
1  1258	      =ARRAY:1413		 LINK$=$
1  1259	1413  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1260							 ; 6 - признак immediate. 5- слово не описано smudge
1  1261	1414  46 49			     DB	 'FI'
1  1262	1416  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  1263	1417  13EFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1264	      =ARRAY:1413		 LINK=LINK$
1  1265	1419				 FIX LABEL FAR	; CFA
1  1266	1419  141Br			     DW	 $+2
   1267					; Позиционирование курсора: COL	ROW FIX
   1268	141B  B4 0F				  MOV	AH, 0Fh
   1269	141D  CD 10				  INT	10h	 ; Запись текущего номера страницы в BX
   1270	141F  5A				  POP	DX
   1271	1420  8A F2				  MOV	DH, DL	 ; строка
   1272	1422  58				  POP	AX
   1273
   1274	1423  8A D0				  MOV	DL, AL	 ; столбец
   1275	1425  B4 02				  MOV	AH, 2	 ; уст.	позицию	курсора. установка
   1276								 ; на строку 25	делает курсор невидимым.
   1277	1427  CD 10				  INT	10h	 ; Фиксация положения курсора
   1278						  NEXT
1  1279	1429  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1280	142A  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1281					 ; ------ call debugger	--------
1  1282	142C  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1283	1430  74 06			     jz	??0011
1  1284	1432  E8 FB1C			     call printWORD
1  1285	1435  E8 F9FB			     call pause
1  1286	1438				   ??0011:
1  1287					 ; -----------------------------
1  1288	1438  FF 27			     JMP WORD PTR [BX]
   1289
   1290						  HEAD	  84h,'DSP',314Q,DSPL		      ;	DSPL
1  1291	      =ARRAY:143A		 LINK$=$
1  1292	143A  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1293							 ; 6 - признак immediate. 5- слово не описано smudge
1  1294	143B  44 53 50			     DB	 'DSP'
1  1295	143E  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  1296	143F  1413r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1297	      =ARRAY:143A		 LINK=LINK$
1  1298	1441				 DSPL LABEL FAR	 ; CFA
1  1299	1441  1443r			     DW	 $+2
   1300					; LOAD GRAFBUFFER (b adr DSPL)
   1301					 ; записывает байт в графическую память
   1302	1443  5B				  POP	BX  ; адрес
   1303	1444  58				  POP	AX  ; байт
   1304	1445  06				  PUSH	ES  ; сохранение регистра сегмента
   1305	1446  B9 B000				  MOV	CX, 0B000H ; GRAFBUF
   1306	1449  8E C1				  MOV	ES, CX
   1307	144B  26: 88 07				  MOV	BYTE PTR ES:[BX], AL
   1308	144E  07				  POP	ES
   1309						  NEXT
1  1310	144F  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1311	1450  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 24
forth.asm



1  1312					 ; ------ call debugger	--------
1  1313	1452  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1314	1456  74 06			     jz	??0012
1  1315	1458  E8 FAF6			     call printWORD
1  1316	145B  E8 F9D5			     call pause
1  1317	145E				   ??0012:
1  1318					 ; -----------------------------
1  1319	145E  FF 27			     JMP WORD PTR [BX]
   1320
   1321					;	  ** Терминал **
   1322
   1323						  HEAD	  83h,'KE',331Q,KEY		      ;	KEY
1  1324	      =ARRAY:1460		 LINK$=$
1  1325	1460  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1326							 ; 6 - признак immediate. 5- слово не описано smudge
1  1327	1461  4B 45			     DB	 'KE'
1  1328	1463  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  1329	1464  143Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1330	      =ARRAY:1460		 LINK=LINK$
1  1331	1466				 KEY LABEL FAR	; CFA
1  1332	1466  1468r			     DW	 $+2
   1333					     ; читать (ожидать)	следующую нажатую клавишу
   1334					     ; выход: AL = ASCII символ	(если AL=0, AH содержит	расширенный код	ASCII )
   1335					     ; AH = сканкод  или расширенный код ASCII
   1336	1468  2A E4				  SUB	AH, AH
   1337	146A  CD 16				  INT	16h
   1338	146C  2A E4				  SUB	AH, AH
   1339	146E  50				  PUSH	AX
   1340						  NEXT
1  1341	146F  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1342	1470  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1343					 ; ------ call debugger	--------
1  1344	1472  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1345	1476  74 06			     jz	??0013
1  1346	1478  E8 FAD6			     call printWORD
1  1347	147B  E8 F9B5			     call pause
1  1348	147E				   ??0013:
1  1349					 ; -----------------------------
1  1350	147E  FF 27			     JMP WORD PTR [BX]
   1351
   1352						  HEAD	  86h,'EXPEC',324Q,EXPE		      ;	EXPECT
1  1353	      =ARRAY:1480		 LINK$=$
1  1354	1480  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  1355							 ; 6 - признак immediate. 5- слово не описано smudge
1  1356	1481  45 58 50 45 43		     DB	 'EXPEC'
1  1357	1486  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  1358	1487  1460r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1359	      =ARRAY:1480		 LINK=LINK$
1  1360	1489				 EXPE LABEL FAR	 ; CFA
1  1361	1489  148Br			     DW	 $+2
   1362					     ; adr count ->
   1363	148B  B4 0A				  MOV	AH, 0AH		     ;	ввод строки в буфер
   1364	148D  59				  POP	CX		     ; Число символов
   1365	148E  5B				  POP	BX		     ; Адрес буфера SS
   1366	148F  88 0F				  MOV	BYTE PTR [BX],	CL   ; Засылка ожидаемого числа
   1367	1491  8B D3				  MOV	DX, BX
   1368	1493  CD 21				  INT	21h
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 25
forth.asm



   1369
   1370	1495  8A 47 01				  MOV	AL, BYTE PTR [BX+1]  ; фактически введено символов
   1371	1498  2A E4				  SUB	AH, AH		     ;
   1372	149A  03 D8				  ADD	BX, AX		     ; адрес конца строки
   1373	149C  C7 47 02 0000			  MOV	WORD PTR [BX+2],0    ; +2, т.к.	в начале строки	мах длина
   1374									     ; и число введенных символов
   1375						  NEXT
1  1376	14A1  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1377	14A2  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1378					 ; ------ call debugger	--------
1  1379	14A4  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1380	14A8  74 06			     jz	??0014
1  1381	14AA  E8 FAA4			     call printWORD
1  1382	14AD  E8 F983			     call pause
1  1383	14B0				   ??0014:
1  1384					 ; -----------------------------
1  1385	14B0  FF 27			     JMP WORD PTR [BX]
   1386
   1387						  HEAD	  85h,'?TER',244Q,?TER$		      ;	?TER$
1  1388	      =ARRAY:14B2		 LINK$=$
1  1389	14B2  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  1390							 ; 6 - признак immediate. 5- слово не описано smudge
1  1391	14B3  3F 54 45 52		     DB	 '?TER'
1  1392	14B7  A4			     DB	 244Q	; последний символ слова + 128 (7 бит =	1).
1  1393	14B8  1480r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1394	      =ARRAY:14B2		 LINK=LINK$
1  1395	14BA				 ?TER$ LABEL FAR  ; CFA
1  1396	14BA  14BCr			     DW	 $+2
   1397	14BC  06				  PUSH	ES
   1398	14BD  2B C9				  SUB	CX, CX
   1399	14BF  8E C1				  MOV	ES, CX
   1400	14C1  26: 80 0E	0417 20			  OR	BYTE PTR ES:[417H],  40Q
   1401	14C7  B4 01			TER:	  MOV	AH, 1	 ; проверить готовность	символа	(и показать его, если так)
   1402								 ; выход: ZF = 1 если символ не	готов.
   1403								 ; ZF =	0 если символ готов.
   1404								 ; AX =	как для	подфункции 00H (но символ здесь	не
   1405								 ; удаляется из	очереди).
   1406	14C9  CD 16				  INT	16h
   1407	14CB  74 FA				  JZ	TER
   1408	14CD  2A E4				  SUB	AH, AH	 ; читать (ожидать) следующую нажатую клавишу
   1409	14CF  CD 16				  INT	16h
   1410	14D1  26: 80 26	0417 DF			  AND	BYTE PTR ES:[417H],337Q	 ; Сброс 'NUM LOCK'
   1411	14D7  07				  POP	ES		; Восстановление ES
   1412	14D8  50				  PUSH	AX		; Запись символа
   1413						  NEXT
1  1414	14D9  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1415	14DA  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1416					 ; ------ call debugger	--------
1  1417	14DC  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1418	14E0  74 06			     jz	??0015
1  1419	14E2  E8 FA6C			     call printWORD
1  1420	14E5  E8 F94B			     call pause
1  1421	14E8				   ??0015:
1  1422					 ; -----------------------------
1  1423	14E8  FF 27			     JMP WORD PTR [BX]
   1424
   1425					; ** Ввод/Вывод	**
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 26
forth.asm



   1426
   1427						  HEAD	  84h,'POR',324Q,PORT		      ;	PORT
1  1428	      =ARRAY:14EA		 LINK$=$
1  1429	14EA  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1430							 ; 6 - признак immediate. 5- слово не описано smudge
1  1431	14EB  50 4F 52			     DB	 'POR'
1  1432	14EE  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  1433	14EF  14B2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1434	      =ARRAY:14EA		 LINK=LINK$
1  1435	14F1				 PORT LABEL FAR	 ; CFA
1  1436	14F1  14F3r			     DW	 $+2
   1437	14F3  5A				  POP	DX
   1438	14F4  58				  POP	AX
   1439	14F5  EE				  OUT	DX, AL
   1440						  NEXT
1  1441	14F6  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1442	14F7  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1443					 ; ------ call debugger	--------
1  1444	14F9  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1445	14FD  74 06			     jz	??0016
1  1446	14FF  E8 FA4F			     call printWORD
1  1447	1502  E8 F92E			     call pause
1  1448	1505				   ??0016:
1  1449					 ; -----------------------------
1  1450	1505  FF 27			     JMP WORD PTR [BX]
   1451
   1452						  HEAD	  84h,'REA',304Q,READ		      ;	READ
1  1453	      =ARRAY:1507		 LINK$=$
1  1454	1507  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1455							 ; 6 - признак immediate. 5- слово не описано smudge
1  1456	1508  52 45 41			     DB	 'REA'
1  1457	150B  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  1458	150C  14EAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1459	      =ARRAY:1507		 LINK=LINK$
1  1460	150E				 READ LABEL FAR	 ; CFA
1  1461	150E  1510r			     DW	 $+2
   1462	1510  5A				  POP	DX
   1463	1511  EC				  IN	AL, DX
   1464	1512  2A E4				  SUB	AH, AH
   1465	1514  50				  PUSH	AX
   1466						  NEXT
1  1467	1515  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1468	1516  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1469					 ; ------ call debugger	--------
1  1470	1518  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1471	151C  74 06			     jz	??0017
1  1472	151E  E8 FA30			     call printWORD
1  1473	1521  E8 F90F			     call pause
1  1474	1524				   ??0017:
1  1475					 ; -----------------------------
1  1476	1524  FF 27			     JMP WORD PTR [BX]
   1477
   1478					;	  ** Арифметика	**
   1479
   1480						  HEAD	  82h,'1',253Q,ONEP		      ;	1+
1  1481	      =ARRAY:1526		 LINK$=$
1  1482	1526  82			     DB	 82h  ;	NFA 7 бит равен	1.
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 27
forth.asm



1  1483							 ; 6 - признак immediate. 5- слово не описано smudge
1  1484	1527  31			     DB	 '1'
1  1485	1528  AB			     DB	 253Q	; последний символ слова + 128 (7 бит =	1).
1  1486	1529  1507r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1487	      =ARRAY:1526		 LINK=LINK$
1  1488	152B				 ONEP LABEL FAR	 ; CFA
1  1489	152B  152Dr			     DW	 $+2
   1490	152D  58				  POP	AX
   1491	152E  40				  INC	AX
   1492	152F  50				  PUSH	AX
   1493						  NEXT
1  1494	1530  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1495	1531  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1496					 ; ------ call debugger	--------
1  1497	1533  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1498	1537  74 06			     jz	??0018
1  1499	1539  E8 FA15			     call printWORD
1  1500	153C  E8 F8F4			     call pause
1  1501	153F				   ??0018:
1  1502					 ; -----------------------------
1  1503	153F  FF 27			     JMP WORD PTR [BX]
   1504
   1505						  HEAD	  82h,'2',253Q,TWOP		      ;	2+
1  1506	      =ARRAY:1541		 LINK$=$
1  1507	1541  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1508							 ; 6 - признак immediate. 5- слово не описано smudge
1  1509	1542  32			     DB	 '2'
1  1510	1543  AB			     DB	 253Q	; последний символ слова + 128 (7 бит =	1).
1  1511	1544  1526r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1512	      =ARRAY:1541		 LINK=LINK$
1  1513	1546				 TWOP LABEL FAR	 ; CFA
1  1514	1546  1548r			     DW	 $+2
   1515	1548  58				  POP	AX
   1516	1549  05 0002				  ADD	AX, 2
   1517	154C  50				  PUSH	AX
   1518						  NEXT
1  1519	154D  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1520	154E  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1521					 ; ------ call debugger	--------
1  1522	1550  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1523	1554  74 06			     jz	??0019
1  1524	1556  E8 F9F8			     call printWORD
1  1525	1559  E8 F8D7			     call pause
1  1526	155C				   ??0019:
1  1527					 ; -----------------------------
1  1528	155C  FF 27			     JMP WORD PTR [BX]
   1529
   1530						  HEAD	  82h,'1',255Q,ONEM		      ;	1-
1  1531	      =ARRAY:155E		 LINK$=$
1  1532	155E  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1533							 ; 6 - признак immediate. 5- слово не описано smudge
1  1534	155F  31			     DB	 '1'
1  1535	1560  AD			     DB	 255Q	; последний символ слова + 128 (7 бит =	1).
1  1536	1561  1541r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1537	      =ARRAY:155E		 LINK=LINK$
1  1538	1563				 ONEM LABEL FAR	 ; CFA
1  1539	1563  1565r			     DW	 $+2
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 28
forth.asm



   1540	1565  58				  POP	AX
   1541	1566  48				  DEC	AX
   1542	1567  50				  PUSH	AX
   1543						  NEXT
1  1544	1568  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1545	1569  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1546					 ; ------ call debugger	--------
1  1547	156B  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1548	156F  74 06			     jz	??001A
1  1549	1571  E8 F9DD			     call printWORD
1  1550	1574  E8 F8BC			     call pause
1  1551	1577				   ??001A:
1  1552					 ; -----------------------------
1  1553	1577  FF 27			     JMP WORD PTR [BX]
   1554
   1555						  HEAD	  82h,'2',252Q,MUL2		      ;	2*
1  1556	      =ARRAY:1579		 LINK$=$
1  1557	1579  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1558							 ; 6 - признак immediate. 5- слово не описано smudge
1  1559	157A  32			     DB	 '2'
1  1560	157B  AA			     DB	 252Q	; последний символ слова + 128 (7 бит =	1).
1  1561	157C  155Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1562	      =ARRAY:1579		 LINK=LINK$
1  1563	157E				 MUL2 LABEL FAR	 ; CFA
1  1564	157E  1580r			     DW	 $+2
   1565	1580  58				  POP	AX
   1566	1581  D1 E0				  SAL	AX,  1
   1567	1583  50				  PUSH	AX
   1568						  NEXT
1  1569	1584  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1570	1585  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1571					 ; ------ call debugger	--------
1  1572	1587  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1573	158B  74 06			     jz	??001B
1  1574	158D  E8 F9C1			     call printWORD
1  1575	1590  E8 F8A0			     call pause
1  1576	1593				   ??001B:
1  1577					 ; -----------------------------
1  1578	1593  FF 27			     JMP WORD PTR [BX]
   1579
   1580						  HEAD	  82h,'2',257Q,DIV2		      ;	2/
1  1581	      =ARRAY:1595		 LINK$=$
1  1582	1595  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1583							 ; 6 - признак immediate. 5- слово не описано smudge
1  1584	1596  32			     DB	 '2'
1  1585	1597  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  1586	1598  1579r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1587	      =ARRAY:1595		 LINK=LINK$
1  1588	159A				 DIV2 LABEL FAR	 ; CFA
1  1589	159A  159Cr			     DW	 $+2
   1590	159C  58				  POP	AX
   1591	159D  D1 F8				  SAR	AX, 1
   1592	159F  50				  PUSH	AX
   1593						  NEXT
1  1594	15A0  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1595	15A1  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1596					 ; ------ call debugger	--------
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 29
forth.asm



1  1597	15A3  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1598	15A7  74 06			     jz	??001C
1  1599	15A9  E8 F9A5			     call printWORD
1  1600	15AC  E8 F884			     call pause
1  1601	15AF				   ??001C:
1  1602					 ; -----------------------------
1  1603	15AF  FF 27			     JMP WORD PTR [BX]
   1604
   1605						  HEAD	  82h, 'U', 252Q,USTAR		      ;	U*
1  1606	      =ARRAY:15B1		 LINK$=$
1  1607	15B1  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1608							 ; 6 - признак immediate. 5- слово не описано smudge
1  1609	15B2  55			     DB	 'U'
1  1610	15B3  AA			     DB	 252Q	; последний символ слова + 128 (7 бит =	1).
1  1611	15B4  1595r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1612	      =ARRAY:15B1		 LINK=LINK$
1  1613	15B6				 USTAR LABEL FAR  ; CFA
1  1614	15B6  15B8r			     DW	 $+2
   1615					 ; u1  u2  ---	ud
   1616	15B8  58				  POP	AX
   1617	15B9  59				  POP	CX
   1618	15BA  F7 E1				  MUL	CX
   1619	15BC  50				  PUSH	AX
   1620	15BD  52				  PUSH	DX
   1621						  NEXT
1  1622	15BE  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1623	15BF  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1624					 ; ------ call debugger	--------
1  1625	15C1  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1626	15C5  74 06			     jz	??001D
1  1627	15C7  E8 F987			     call printWORD
1  1628	15CA  E8 F866			     call pause
1  1629	15CD				   ??001D:
1  1630					 ; -----------------------------
1  1631	15CD  FF 27			     JMP WORD PTR [BX]
   1632
   1633						  HEAD	  82h,'U',257Q,USLAS		      ;	U/
1  1634	      =ARRAY:15CF		 LINK$=$
1  1635	15CF  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1636							 ; 6 - признак immediate. 5- слово не описано smudge
1  1637	15D0  55			     DB	 'U'
1  1638	15D1  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  1639	15D2  15B1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1640	      =ARRAY:15CF		 LINK=LINK$
1  1641	15D4				 USLAS LABEL FAR  ; CFA
1  1642	15D4  15D6r			     DW	 $+2
   1643					 ; ud u1 --- u2	u3
   1644	15D6  59				  POP	CX	    ; Делитель
   1645	15D7  5A				  POP	DX
   1646	15D8  58				  POP	AX
   1647	15D9  F7 F1				  DIV	CX
   1648	15DB  52				  PUSH	DX	    ; Остаток
   1649	15DC  50				  PUSH	AX	    ; Засылка  результата
   1650						  NEXT
1  1651	15DD  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1652	15DE  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1653					 ; ------ call debugger	--------
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 30
forth.asm



1  1654	15E0  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1655	15E4  74 06			     jz	??001E
1  1656	15E6  E8 F968			     call printWORD
1  1657	15E9  E8 F847			     call pause
1  1658	15EC				   ??001E:
1  1659					 ; -----------------------------
1  1660	15EC  FF 27			     JMP WORD PTR [BX]
   1661
   1662						  HEAD	  82h,'M',252Q,MSTAR		      ;	M*
1  1663	      =ARRAY:15EE		 LINK$=$
1  1664	15EE  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1665							 ; 6 - признак immediate. 5- слово не описано smudge
1  1666	15EF  4D			     DB	 'M'
1  1667	15F0  AA			     DB	 252Q	; последний символ слова + 128 (7 бит =	1).
1  1668	15F1  15CFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1669	      =ARRAY:15EE		 LINK=LINK$
1  1670	15F3				 MSTAR LABEL FAR  ; CFA
1  1671	15F3  15F5r			     DW	 $+2
   1672	15F5  58				  POP	AX
   1673	15F6  59				  POP	CX
   1674	15F7  F7 E9				  IMUL	CX
   1675	15F9  50				  PUSH	AX
   1676	15FA  52				  PUSH	DX
   1677						  NEXT
1  1678	15FB  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1679	15FC  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1680					 ; ------ call debugger	--------
1  1681	15FE  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1682	1602  74 06			     jz	??001F
1  1683	1604  E8 F94A			     call printWORD
1  1684	1607  E8 F829			     call pause
1  1685	160A				   ??001F:
1  1686					 ; -----------------------------
1  1687	160A  FF 27			     JMP WORD PTR [BX]
   1688
   1689						  HEAD	   86h,'DMINU',323Q,DMINU	      ;	DMINUS
1  1690	      =ARRAY:160C		 LINK$=$
1  1691	160C  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  1692							 ; 6 - признак immediate. 5- слово не описано smudge
1  1693	160D  44 4D 49 4E 55		     DB	 'DMINU'
1  1694	1612  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  1695	1613  15EEr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1696	      =ARRAY:160C		 LINK=LINK$
1  1697	1615				 DMINU LABEL FAR  ; CFA
1  1698	1615  1617r			     DW	 $+2
   1699					; Изменение знака числа	двойной	длины
   1700	1617  58				  POP  AX
   1701	1618  F7 D8			DMIN:	  NEG  AX
   1702	161A  59				  POP  CX
   1703	161B  F7 D9				  NEG  CX
   1704	161D  1D 0000				  SBB  AX, 0	   ; sub with borrow
   1705	1620  51				  PUSH CX
   1706	1621  50				  PUSH AX
   1707	1622				G$:	  NEXT
1  1708	1622  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1709	1623  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1710					 ; ------ call debugger	--------
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 31
forth.asm



1  1711	1625  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1712	1629  74 06			     jz	??0020
1  1713	162B  E8 F923			     call printWORD
1  1714	162E  E8 F802			     call pause
1  1715	1631				   ??0020:
1  1716					 ; -----------------------------
1  1717	1631  FF 27			     JMP WORD PTR [BX]
   1718
   1719						 HEAD	  84h,'DAB',323Q,DABS		      ;	DABS
1  1720	      =ARRAY:1633		 LINK$=$
1  1721	1633  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1722							 ; 6 - признак immediate. 5- слово не описано smudge
1  1723	1634  44 41 42			     DB	 'DAB'
1  1724	1637  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  1725	1638  160Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1726	      =ARRAY:1633		 LINK=LINK$
1  1727	163A				 DABS LABEL FAR	 ; CFA
1  1728	163A  163Cr			     DW	 $+2
   1729	163C  58				 POP   AX
   1730	163D  3D 0000				 CMP   AX, 0
   1731	1640  78 D6				 JS    DMIN
   1732	1642  50				 PUSH  AX
   1733						 NEXT
1  1734	1643  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1735	1644  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1736					 ; ------ call debugger	--------
1  1737	1646  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1738	164A  74 06			     jz	??0021
1  1739	164C  E8 F902			     call printWORD
1  1740	164F  E8 F7E1			     call pause
1  1741	1652				   ??0021:
1  1742					 ; -----------------------------
1  1743	1652  FF 27			     JMP WORD PTR [BX]
   1744
   1745						 HEAD	  82h,'M',257Q,MSLAS		      ;	M/
1  1746	      =ARRAY:1654		 LINK$=$
1  1747	1654  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1748							 ; 6 - признак immediate. 5- слово не описано smudge
1  1749	1655  4D			     DB	 'M'
1  1750	1656  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  1751	1657  1633r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1752	      =ARRAY:1654		 LINK=LINK$
1  1753	1659				 MSLAS LABEL FAR  ; CFA
1  1754	1659  165Br			     DW	 $+2
   1755	165B  59				 POP   CX	   ; Делимое
   1756	165C  5A				 POP   DX
   1757	165D  58				 POP   AX
   1758	165E  F7 F9				 IDIV  CX
   1759	1660  52				 PUSH  DX
   1760	1661  50				 PUSH  AX
   1761						 NEXT
1  1762	1662  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1763	1663  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1764					 ; ------ call debugger	--------
1  1765	1665  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1766	1669  74 06			     jz	??0022
1  1767	166B  E8 F8E3			     call printWORD
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 32
forth.asm



1  1768	166E  E8 F7C2			     call pause
1  1769	1671				   ??0022:
1  1770					 ; -----------------------------
1  1771	1671  FF 27			     JMP WORD PTR [BX]
   1772
   1773						 HEAD	  81h,,253Q,PLUS		      ;	+
1  1774	      =ARRAY:1673		 LINK$=$
1  1775	1673  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  1776							 ; 6 - признак immediate. 5- слово не описано smudge
1  1777	1674  AB			     DB	 253Q	; последний символ слова + 128 (7 бит =	1).
1  1778	1675  1654r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1779	      =ARRAY:1673		 LINK=LINK$
1  1780	1677				 PLUS LABEL FAR	 ; CFA
1  1781	1677  1679r			     DW	 $+2
   1782	1679  58				 POP  AX
   1783	167A  59				 POP  CX
   1784	167B  03 C1				 ADD  AX, CX
   1785	167D  50				 PUSH AX
   1786						 NEXT
1  1787	167E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1788	167F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1789					 ; ------ call debugger	--------
1  1790	1681  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1791	1685  74 06			     jz	??0023
1  1792	1687  E8 F8C7			     call printWORD
1  1793	168A  E8 F7A6			     call pause
1  1794	168D				   ??0023:
1  1795					 ; -----------------------------
1  1796	168D  FF 27			     JMP WORD PTR [BX]
   1797
   1798						 HEAD	  81h,,255Q,SUBB		       ; -
1  1799	      =ARRAY:168F		 LINK$=$
1  1800	168F  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  1801							 ; 6 - признак immediate. 5- слово не описано smudge
1  1802	1690  AD			     DB	 255Q	; последний символ слова + 128 (7 бит =	1).
1  1803	1691  1673r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1804	      =ARRAY:168F		 LINK=LINK$
1  1805	1693				 SUBB LABEL FAR	 ; CFA
1  1806	1693  1695r			     DW	 $+2
   1807					 ; n1 n2 -> n1-n2
   1808	1695  59				 POP  CX
   1809	1696  58				 POP  AX
   1810	1697  2B C1				 SUB  AX, CX
   1811	1699  50				 PUSH AX
   1812						 NEXT
1  1813	169A  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1814	169B  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1815					 ; ------ call debugger	--------
1  1816	169D  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1817	16A1  74 06			     jz	??0024
1  1818	16A3  E8 F8AB			     call printWORD
1  1819	16A6  E8 F78A			     call pause
1  1820	16A9				   ??0024:
1  1821					 ; -----------------------------
1  1822	16A9  FF 27			     JMP WORD PTR [BX]
   1823
   1824						 HEAD	  82h,'D',253Q,DPLUS		      ;	D+
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 33
forth.asm



1  1825	      =ARRAY:16AB		 LINK$=$
1  1826	16AB  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1827							 ; 6 - признак immediate. 5- слово не описано smudge
1  1828	16AC  44			     DB	 'D'
1  1829	16AD  AB			     DB	 253Q	; последний символ слова + 128 (7 бит =	1).
1  1830	16AE  168Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1831	      =ARRAY:16AB		 LINK=LINK$
1  1832	16B0				 DPLUS LABEL FAR  ; CFA
1  1833	16B0  16B2r			     DW	 $+2
   1834	16B2  58				 POP  AX
   1835	16B3  59				 POP  CX
   1836	16B4  8B DC				 MOV  BX, SP
   1837	16B6  36: 01 4F	02			 ADD  SS:[BX+2],  CX
   1838	16BA  36: 11 07				 ADC  SS:[BX],	  AX
   1839						 NEXT
1  1840	16BD  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1841	16BE  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1842					 ; ------ call debugger	--------
1  1843	16C0  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1844	16C4  74 06			     jz	??0025
1  1845	16C6  E8 F888			     call printWORD
1  1846	16C9  E8 F767			     call pause
1  1847	16CC				   ??0025:
1  1848					 ; -----------------------------
1  1849	16CC  FF 27			     JMP WORD PTR [BX]
   1850
   1851						 HEAD	  85h,'MINU',323Q,MINUS		      ;	MINUS
1  1852	      =ARRAY:16CE		 LINK$=$
1  1853	16CE  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  1854							 ; 6 - признак immediate. 5- слово не описано smudge
1  1855	16CF  4D 49 4E 55		     DB	 'MINU'
1  1856	16D3  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  1857	16D4  16ABr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1858	      =ARRAY:16CE		 LINK=LINK$
1  1859	16D6				 MINUS LABEL FAR  ; CFA
1  1860	16D6  16D8r			     DW	 $+2
   1861	16D8  58				 POP  AX
   1862	16D9  F7 D8				 NEG  AX
   1863	16DB  50				 PUSH AX
   1864						 NEXT
1  1865	16DC  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1866	16DD  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1867					 ; ------ call debugger	--------
1  1868	16DF  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1869	16E3  74 06			     jz	??0026
1  1870	16E5  E8 F869			     call printWORD
1  1871	16E8  E8 F748			     call pause
1  1872	16EB				   ??0026:
1  1873					 ; -----------------------------
1  1874	16EB  FF 27			     JMP WORD PTR [BX]
   1875
   1876						 HEAD	  84h,'SWA',302Q,SWAB		      ;	SWAB
1  1877	      =ARRAY:16ED		 LINK$=$
1  1878	16ED  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1879							 ; 6 - признак immediate. 5- слово не описано smudge
1  1880	16EE  53 57 41			     DB	 'SWA'
1  1881	16F1  C2			     DB	 302Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 34
forth.asm



1  1882	16F2  16CEr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1883	      =ARRAY:16ED		 LINK=LINK$
1  1884	16F4				 SWAB LABEL FAR	 ; CFA
1  1885	16F4  16F6r			     DW	 $+2
   1886					     ; обмен байтами слова в стеке
   1887	16F6  58				 POP  AX
   1888	16F7  86 C4				 XCHG AL, AH
   1889	16F9  50				 PUSH AX
   1890						 NEXT
1  1891	16FA  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1892	16FB  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1893					 ; ------ call debugger	--------
1  1894	16FD  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1895	1701  74 06			     jz	??0027
1  1896	1703  E8 F84B			     call printWORD
1  1897	1706  E8 F72A			     call pause
1  1898	1709				   ??0027:
1  1899					 ; -----------------------------
1  1900	1709  FF 27			     JMP WORD PTR [BX]
   1901
   1902						 HEAD	  83h,'AB',323Q,$ABS		       ; ABS
1  1903	      =ARRAY:170B		 LINK$=$
1  1904	170B  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1905							 ; 6 - признак immediate. 5- слово не описано smudge
1  1906	170C  41 42			     DB	 'AB'
1  1907	170E  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  1908	170F  16EDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1909	      =ARRAY:170B		 LINK=LINK$
1  1910	1711				 $ABS LABEL FAR	 ; CFA
1  1911	1711  1713r			     DW	 $+2
   1912	1713  58				 POP  AX
   1913	1714  3D 0000				 CMP  AX, 0
   1914	1717  79 02				 JNS  AB
   1915	1719  F7 D8				 NEG  AX
   1916	171B  50			AB:	 PUSH AX
   1917						 NEXT
1  1918	171C  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1919	171D  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1920					 ; ------ call debugger	--------
1  1921	171F  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1922	1723  74 06			     jz	??0028
1  1923	1725  E8 F829			     call printWORD
1  1924	1728  E8 F708			     call pause
1  1925	172B				   ??0028:
1  1926					 ; -----------------------------
1  1927	172B  FF 27			     JMP WORD PTR [BX]
   1928
   1929						 HEAD	  83h,'AN',304Q,$AND		      ;	AND
1  1930	      =ARRAY:172D		 LINK$=$
1  1931	172D  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1932							 ; 6 - признак immediate. 5- слово не описано smudge
1  1933	172E  41 4E			     DB	 'AN'
1  1934	1730  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  1935	1731  170Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1936	      =ARRAY:172D		 LINK=LINK$
1  1937	1733				 $AND LABEL FAR	 ; CFA
1  1938	1733  1735r			     DW	 $+2
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 35
forth.asm



   1939	1735  58				 POP  AX
   1940	1736  59				 POP  CX
   1941	1737  23 C1				 AND  AX,  CX
   1942	1739  50			ENDA:	 PUSH AX
   1943						 NEXT
1  1944	173A  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1945	173B  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1946					 ; ------ call debugger	--------
1  1947	173D  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1948	1741  74 06			     jz	??0029
1  1949	1743  E8 F80B			     call printWORD
1  1950	1746  E8 F6EA			     call pause
1  1951	1749				   ??0029:
1  1952					 ; -----------------------------
1  1953	1749  FF 27			     JMP WORD PTR [BX]
   1954
   1955						 HEAD	  82h,'O',322Q,$OR		      ;	OR
1  1956	      =ARRAY:174B		 LINK$=$
1  1957	174B  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1958							 ; 6 - признак immediate. 5- слово не описано smudge
1  1959	174C  4F			     DB	 'O'
1  1960	174D  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  1961	174E  172Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1962	      =ARRAY:174B		 LINK=LINK$
1  1963	1750				 $OR LABEL FAR	; CFA
1  1964	1750  1752r			     DW	 $+2
   1965	1752  58				 POP  AX
   1966	1753  59				 POP  CX
   1967	1754  0B C1				 OR   AX, CX
   1968	1756  EB E1				 JMP  ENDA
   1969
   1970						 HEAD	  83h,'XO',322Q,$XOR		      ;	XOR
1  1971	      =ARRAY:1758		 LINK$=$
1  1972	1758  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1973							 ; 6 - признак immediate. 5- слово не описано smudge
1  1974	1759  58 4F			     DB	 'XO'
1  1975	175B  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  1976	175C  174Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1977	      =ARRAY:1758		 LINK=LINK$
1  1978	175E				 $XOR LABEL FAR	 ; CFA
1  1979	175E  1760r			     DW	 $+2
   1980	1760  58				 POP  AX
   1981	1761  59				 POP  CX
   1982	1762  33 C1				 XOR  AX, CX
   1983	1764  EB D3				 JMP  ENDA
   1984
   1985						 HEAD	  84h,'S-#',304Q,STOD		      ;	S->D ; sds S->
1  1986	      =ARRAY:1766		 LINK$=$
1  1987	1766  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1988							 ; 6 - признак immediate. 5- слово не описано smudge
1  1989	1767  53 2D 23			     DB	 'S-#'
1  1990	176A  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  1991	176B  1758r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1992	      =ARRAY:1766		 LINK=LINK$
1  1993	176D				 STOD LABEL FAR	 ; CFA
1  1994	176D  176Fr			     DW	 $+2
   1995	176F  58				 POP  AX
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 36
forth.asm



   1996	1770  50				 PUSH AX
   1997	1771  8B CA				 MOV  CX, DX	       ; Сохранение содержимого	DX
   1998	1773  99				 CWD		       ; sign bit AX to	DX
   1999	1774  52				 PUSH  DX
   2000	1775  8B D1				 MOV  DX, CX	       ; Восстановление	DX
   2001						 NEXT
1  2002	1777  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2003	1778  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2004					 ; ------ call debugger	--------
1  2005	177A  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2006	177E  74 06			     jz	??002A
1  2007	1780  E8 F7CE			     call printWORD
1  2008	1783  E8 F6AD			     call pause
1  2009	1786				   ??002A:
1  2010					 ; -----------------------------
1  2011	1786  FF 27			     JMP WORD PTR [BX]
   2012
   2013						 HEAD	  83h,'MI',316Q,MIN		      ;	MIN
1  2014	      =ARRAY:1788		 LINK$=$
1  2015	1788  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2016							 ; 6 - признак immediate. 5- слово не описано smudge
1  2017	1789  4D 49			     DB	 'MI'
1  2018	178B  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  2019	178C  1766r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2020	      =ARRAY:1788		 LINK=LINK$
1  2021	178E				 MIN LABEL FAR	; CFA
1  2022	178E  1790r			     DW	 $+2
   2023	1790  58				 POP  AX
   2024	1791  59				 POP  CX
   2025	1792  3B C8				 CMP  CX,  AX
   2026	1794  7C 12				 JL  DEEP	     ;
   2027	1796  50			TOP:	 PUSH AX
   2028						 NEXT
1  2029	1797  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2030	1798  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2031					 ; ------ call debugger	--------
1  2032	179A  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2033	179E  74 06			     jz	??002B
1  2034	17A0  E8 F7AE			     call printWORD
1  2035	17A3  E8 F68D			     call pause
1  2036	17A6				   ??002B:
1  2037					 ; -----------------------------
1  2038	17A6  FF 27			     JMP WORD PTR [BX]
   2039	17A8  51			DEEP:	 PUSH CX
   2040						 NEXT
1  2041	17A9  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2042	17AA  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2043					 ; ------ call debugger	--------
1  2044	17AC  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2045	17B0  74 06			     jz	??002C
1  2046	17B2  E8 F79C			     call printWORD
1  2047	17B5  E8 F67B			     call pause
1  2048	17B8				   ??002C:
1  2049					 ; -----------------------------
1  2050	17B8  FF 27			     JMP WORD PTR [BX]
   2051
   2052						 HEAD	  83h,'MA',330Q,MAX		      ;	MAX
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 37
forth.asm



1  2053	      =ARRAY:17BA		 LINK$=$
1  2054	17BA  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2055							 ; 6 - признак immediate. 5- слово не описано smudge
1  2056	17BB  4D 41			     DB	 'MA'
1  2057	17BD  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  2058	17BE  1788r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2059	      =ARRAY:17BA		 LINK=LINK$
1  2060	17C0				 MAX LABEL FAR	; CFA
1  2061	17C0  17C2r			     DW	 $+2
   2062	17C2  58				 POP  AX
   2063	17C3  59				 POP  CX
   2064	17C4  3B C8				 CMP  CX, AX
   2065	17C6  7D E0				 JGE  DEEP
   2066	17C8  EB CC				 JMP  TOP
   2067
   2068						 HEAD	  83h,'SP',300Q,SPAT		      ;	SP@
1  2069	      =ARRAY:17CA		 LINK$=$
1  2070	17CA  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2071							 ; 6 - признак immediate. 5- слово не описано smudge
1  2072	17CB  53 50			     DB	 'SP'
1  2073	17CD  C0			     DB	 300Q	; последний символ слова + 128 (7 бит =	1).
1  2074	17CE  17BAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2075	      =ARRAY:17CA		 LINK=LINK$
1  2076	17D0				 SPAT LABEL FAR	 ; CFA
1  2077	17D0  17D2r			     DW	 $+2
   2078					     ; значение	текущего указателя регистра SP в стек
   2079	17D2  8B C4				 MOV  AX, SP
   2080	17D4  E9 FF62				 JMP  ENDA
   2081
   2082						 HEAD	  83h,'SP',241Q,SPSTO		      ;	SP!
1  2083	      =ARRAY:17D7		 LINK$=$
1  2084	17D7  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2085							 ; 6 - признак immediate. 5- слово не описано smudge
1  2086	17D8  53 50			     DB	 'SP'
1  2087	17DA  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  2088	17DB  17CAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2089	      =ARRAY:17D7		 LINK=LINK$
1  2090	17DD				 SPSTO LABEL FAR  ; CFA
1  2091	17DD  17DFr			     DW	 $+2
   2092	17DF  8B 65 06				 MOV  SP, [DI+6]			     ; 80h
   2093						 NEXT
1  2094	17E2  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2095	17E3  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2096					 ; ------ call debugger	--------
1  2097	17E5  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2098	17E9  74 06			     jz	??002D
1  2099	17EB  E8 F763			     call printWORD
1  2100	17EE  E8 F642			     call pause
1  2101	17F1				   ??002D:
1  2102					 ; -----------------------------
1  2103	17F1  FF 27			     JMP WORD PTR [BX]
   2104
   2105						 HEAD	  83h,'RP',241Q,RPSTO		      ;	RP!
1  2106	      =ARRAY:17F3		 LINK$=$
1  2107	17F3  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2108							 ; 6 - признак immediate. 5- слово не описано smudge
1  2109	17F4  52 50			     DB	 'RP'
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 38
forth.asm



1  2110	17F6  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  2111	17F7  17D7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2112	      =ARRAY:17F3		 LINK=LINK$
1  2113	17F9				 RPSTO LABEL FAR  ; CFA
1  2114	17F9  17FBr			     DW	 $+2
   2115	17FB  8B 2E 0DA2r			 MOV  BP, $RS				     ; ccch
   2116						 NEXT
1  2117	17FF  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2118	1800  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2119					 ; ------ call debugger	--------
1  2120	1802  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2121	1806  74 06			     jz	??002E
1  2122	1808  E8 F746			     call printWORD
1  2123	180B  E8 F625			     call pause
1  2124	180E				   ??002E:
1  2125					 ; -----------------------------
1  2126	180E  FF 27			     JMP WORD PTR [BX]
   2127
   2128						 HEAD	  82h,';',323Q,SEMI		      ;	;S
1  2129	      =ARRAY:1810		 LINK$=$
1  2130	1810  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2131							 ; 6 - признак immediate. 5- слово не описано smudge
1  2132	1811  3B			     DB	 ';'
1  2133	1812  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  2134	1813  17F3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2135	      =ARRAY:1810		 LINK=LINK$
1  2136	1815				 SEMI LABEL FAR	 ; CFA
1  2137	1815  1817r			     DW	 $+2
   2138					     ; переход на слово	по адресу в стеке возврата СЛОЖНО
   2139					     ; слово,которым заканчивается слова на форте
   2140	1817  8B 76 00				 MOV  SI, [BP] ; в RS хранится адрес следующего	слова,
   2141							     ; до перехода на исполнение слова,	которое	завершается
   2142	181A  83 C5 02				 ADD  BP, 2 ; удаляем из RS
   2143						 NEXT ;	 возврат на предыдущее слово
1  2144	181D  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2145	181E  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2146					 ; ------ call debugger	--------
1  2147	1820  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2148	1824  74 06			     jz	??002F
1  2149	1826  E8 F728			     call printWORD
1  2150	1829  E8 F607			     call pause
1  2151	182C				   ??002F:
1  2152					 ; -----------------------------
1  2153	182C  FF 27			     JMP WORD PTR [BX]
   2154
   2155					;	 ** Стек возвратов **
   2156
   2157						 HEAD	  85h, 'LEAV',305Q,LEAV		       ; LEAVE
1  2158	      =ARRAY:182E		 LINK$=$
1  2159	182E  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2160							 ; 6 - признак immediate. 5- слово не описано smudge
1  2161	182F  4C 45 41 56		     DB	 'LEAV'
1  2162	1833  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  2163	1834  1810r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2164	      =ARRAY:182E		 LINK=LINK$
1  2165	1836				 LEAV LABEL FAR	 ; CFA
1  2166	1836  1838r			     DW	 $+2
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 39
forth.asm



   2167					     ; надо смотреть дальше с хранением	адресов
   2168					     ; приравнивает значения индекса и предела
   2169	1838  8B 46 00				     MOV  AX, [BP]
   2170	183B  89 46 02				 MOV  [BP+2], AX
   2171						 NEXT
1  2172	183E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2173	183F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2174					 ; ------ call debugger	--------
1  2175	1841  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2176	1845  74 06			     jz	??0030
1  2177	1847  E8 F707			     call printWORD
1  2178	184A  E8 F5E6			     call pause
1  2179	184D				   ??0030:
1  2180					 ; -----------------------------
1  2181	184D  FF 27			     JMP WORD PTR [BX]
   2182
   2183						 HEAD	  82h, 62,322Q,TOR		      ;	>R sds
1  2184	      =ARRAY:184F		 LINK$=$
1  2185	184F  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2186							 ; 6 - признак immediate. 5- слово не описано smudge
1  2187	1850  3E			     DB	 62
1  2188	1851  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  2189	1852  182Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2190	      =ARRAY:184F		 LINK=LINK$
1  2191	1854				 TOR LABEL FAR	; CFA
1  2192	1854  1856r			     DW	 $+2
   2193					     ; пишем в стек возвратов
   2194					     ; слово из	стека данных
   2195	1856  83 ED 02				 SUB  BP, 2 ; заняли ячейку
   2196	1859  8F 46 00				 POP  [BP]   ; записали	значение
   2197						 NEXT
1  2198	185C  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2199	185D  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2200					 ; ------ call debugger	--------
1  2201	185F  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2202	1863  74 06			     jz	??0031
1  2203	1865  E8 F6E9			     call printWORD
1  2204	1868  E8 F5C8			     call pause
1  2205	186B				   ??0031:
1  2206					 ; -----------------------------
1  2207	186B  FF 27			     JMP WORD PTR [BX]
   2208
   2209						     HEAD     82h, 'R',276Q,FROMR		   ; R>
1  2210	      =ARRAY:186D		 LINK$=$
1  2211	186D  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2212							 ; 6 - признак immediate. 5- слово не описано smudge
1  2213	186E  52			     DB	 'R'
1  2214	186F  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1  2215	1870  184Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2216	      =ARRAY:186D		 LINK=LINK$
1  2217	1872				 FROMR LABEL FAR  ; CFA
1  2218	1872  1874r			     DW	 $+2
   2219					     ; в стек данных слово по адресу из	стека возвратов
   2220	1874  FF 76 00				     PUSH [BP] ; в стек	записали
   2221	1877  83 C5 02				 ADD  BP, 2 ; убрали
   2222						 NEXT
1  2223	187A  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 40
forth.asm



1  2224	187B  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2225					 ; ------ call debugger	--------
1  2226	187D  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2227	1881  74 06			     jz	??0032
1  2228	1883  E8 F6CB			     call printWORD
1  2229	1886  E8 F5AA			     call pause
1  2230	1889				   ??0032:
1  2231					 ; -----------------------------
1  2232	1889  FF 27			     JMP WORD PTR [BX]
   2233
   2234						 HEAD	  81h,,311Q,I			      ;	I R R@
1  2235	      =ARRAY:188B		 LINK$=$
1  2236	188B  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2237							 ; 6 - признак immediate. 5- слово не описано smudge
1  2238	188C  C9			     DB	 311Q	; последний символ слова + 128 (7 бит =	1).
1  2239	188D  186Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2240	      =ARRAY:188B		 LINK=LINK$
1  2241	188F				 I LABEL FAR  ;	CFA
1  2242	188F  1891r			     DW	 $+2
   2243					     ; Копирует	верхнее	число из стека возвратов
   2244					     ; и записывая в стек параметров
   2245	1891  FF 76 00		       RR$:	 PUSH [BP]
   2246	1894			       Z$:	 NEXT
1  2247	1894  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2248	1895  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2249					 ; ------ call debugger	--------
1  2250	1897  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2251	189B  74 06			     jz	??0033
1  2252	189D  E8 F6B1			     call printWORD
1  2253	18A0  E8 F590			     call pause
1  2254	18A3				   ??0033:
1  2255					 ; -----------------------------
1  2256	18A3  FF 27			     JMP WORD PTR [BX]
   2257
   2258						 HEAD	  81h,,322Q,R			      ;	R
1  2259	      =ARRAY:18A5		 LINK$=$
1  2260	18A5  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2261							 ; 6 - признак immediate. 5- слово не описано smudge
1  2262	18A6  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  2263	18A7  188Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2264	      =ARRAY:18A5		 LINK=LINK$
1  2265	18A9				 R LABEL FAR  ;	CFA
1  2266	18A9  18ABr			     DW	 $+2
   2267	18AB  EB E4				 JMP  RR$
   2268
   2269						 HEAD	  82h,'I',247Q,SRP		      ;	I'
1  2270	      =ARRAY:18AD		 LINK$=$
1  2271	18AD  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2272							 ; 6 - признак immediate. 5- слово не описано smudge
1  2273	18AE  49			     DB	 'I'
1  2274	18AF  A7			     DB	 247Q	; последний символ слова + 128 (7 бит =	1).
1  2275	18B0  18A5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2276	      =ARRAY:18AD		 LINK=LINK$
1  2277	18B2				 SRP LABEL FAR	; CFA
1  2278	18B2  18B4r			     DW	 $+2
   2279					     ; Копирует	второе сверху число из стека возвратов
   2280					     ; и записывает его	в стек параметров
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 41
forth.asm



   2281	18B4  FF 76 02				 PUSH [BP+2]
   2282	18B7  EB DB				 JMP  Z$
   2283
   2284					     HEAD     81h,,'J'+80h,J			; J
1  2285	      =ARRAY:18B9		 LINK$=$
1  2286	18B9  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2287							 ; 6 - признак immediate. 5- слово не описано smudge
1  2288	18BA  CA			     DB	 'J'+80h   ; последний символ слова + 128 (7 бит = 1).
1  2289	18BB  18ADr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2290	      =ARRAY:18B9		 LINK=LINK$
1  2291	18BD				 J LABEL FAR  ;	CFA
1  2292	18BD  18BFr			     DW	 $+2
   2293					     ; Копирует	третье сверху число из стека возвратов
   2294					     ; и записывает его	в стек параметров
   2295	18BF  FF 76 04				 PUSH [BP+4]
   2296	18C2  EB D0				 JMP  Z$
   2297
   2298					     HEAD     82h,'J',247Q,JT			 ; J'
1  2299	      =ARRAY:18C4		 LINK$=$
1  2300	18C4  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2301							 ; 6 - признак immediate. 5- слово не описано smudge
1  2302	18C5  4A			     DB	 'J'
1  2303	18C6  A7			     DB	 247Q	; последний символ слова + 128 (7 бит =	1).
1  2304	18C7  18B9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2305	      =ARRAY:18C4		 LINK=LINK$
1  2306	18C9				 JT LABEL FAR  ; CFA
1  2307	18C9  18CBr			     DW	 $+2
   2308					     ; Копирует	четвертое сверху число из стека	возвратов
   2309					     ; и записывает его	в стек параметров
   2310	18CB  FF 76 06				 PUSH [BP+6]
   2311	18CE  EB C4				 JMP  Z$
   2312
   2313					     HEAD     81h,,'K'+80h,K			; K
1  2314	      =ARRAY:18D0		 LINK$=$
1  2315	18D0  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2316							 ; 6 - признак immediate. 5- слово не описано smudge
1  2317	18D1  CB			     DB	 'K'+80h   ; последний символ слова + 128 (7 бит = 1).
1  2318	18D2  18C4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2319	      =ARRAY:18D0		 LINK=LINK$
1  2320	18D4				 K LABEL FAR  ;	CFA
1  2321	18D4  18D6r			     DW	 $+2
   2322					     ; Копирует	пятое сверху число из стека возвратов
   2323					     ; и записывает его	в стек параметров
   2324	18D6  FF 76 08				 PUSH [BP+8]
   2325	18D9  EB B9				 JMP  Z$
   2326
   2327					     HEAD     82h,'K',247Q,KT			 ; K'
1  2328	      =ARRAY:18DB		 LINK$=$
1  2329	18DB  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2330							 ; 6 - признак immediate. 5- слово не описано smudge
1  2331	18DC  4B			     DB	 'K'
1  2332	18DD  A7			     DB	 247Q	; последний символ слова + 128 (7 бит =	1).
1  2333	18DE  18D0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2334	      =ARRAY:18DB		 LINK=LINK$
1  2335	18E0				 KT LABEL FAR  ; CFA
1  2336	18E0  18E2r			     DW	 $+2
   2337					     ; Копирует	шестое сверху число из стека возвратов
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 42
forth.asm



   2338					     ; и записывает его	в стек параметров
   2339	18E2  FF 76 0A				 PUSH [BP+10]
   2340	18E5  EB AD				 JMP  Z$
   2341
   2342						 HEAD	  83h,'LE',326Q,LEV		      ;	LEV
1  2343	      =ARRAY:18E7		 LINK$=$
1  2344	18E7  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2345							 ; 6 - признак immediate. 5- слово не описано smudge
1  2346	18E8  4C 45			     DB	 'LE'
1  2347	18EA  D6			     DB	 326Q	; последний символ слова + 128 (7 бит =	1).
1  2348	18EB  18DBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2349	      =ARRAY:18E7		 LINK=LINK$
1  2350	18ED				 LEV LABEL FAR	; CFA
1  2351	18ED  18EFr			     DW	 $+2
   2352					     ; эквивалент R> DROP :) только быстрее
   2353					     ; для выхода из interpret
   2354	18EF  83 C5 02				 ADD  BP, 2
   2355						 NEXT
1  2356	18F2  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2357	18F3  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2358					 ; ------ call debugger	--------
1  2359	18F5  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2360	18F9  74 06			     jz	??0034
1  2361	18FB  E8 F653			     call printWORD
1  2362	18FE  E8 F532			     call pause
1  2363	1901				   ??0034:
1  2364					 ; -----------------------------
1  2365	1901  FF 27			     JMP WORD PTR [BX]
   2366
   2367						 ;** Операции со стеком	параметров **
   2368
   2369						 HEAD	  84h,'PIC',313Q,PICK		      ;	PICK
1  2370	      =ARRAY:1903		 LINK$=$
1  2371	1903  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2372							 ; 6 - признак immediate. 5- слово не описано smudge
1  2373	1904  50 49 43			     DB	 'PIC'
1  2374	1907  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  2375	1908  18E7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2376	      =ARRAY:1903		 LINK=LINK$
1  2377	190A				 PICK LABEL FAR	 ; CFA
1  2378	190A  190Cr			     DW	 $+2
   2379	190C  5B				 POP  BX
   2380	190D  83 FB 00				 CMP  BX,  0
   2381	1910  7E 08				 JLE  $GO
   2382	1912  4B				 DEC  BX
   2383	1913  D1 E3				 SAL  BX, 1
   2384	1915  03 DC				 ADD  BX, SP
   2385	1917  36: FF 37				 PUSH SS:[BX]
   2386	191A				$GO:	 NEXT
1  2387	191A  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2388	191B  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2389					 ; ------ call debugger	--------
1  2390	191D  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2391	1921  74 06			     jz	??0035
1  2392	1923  E8 F62B			     call printWORD
1  2393	1926  E8 F50A			     call pause
1  2394	1929				   ??0035:
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 43
forth.asm



1  2395					 ; -----------------------------
1  2396	1929  FF 27			     JMP WORD PTR [BX]
   2397
   2398						 HEAD	  84h,'OVE',322Q,OVER		      ;	OVER
1  2399	      =ARRAY:192B		 LINK$=$
1  2400	192B  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2401							 ; 6 - признак immediate. 5- слово не описано smudge
1  2402	192C  4F 56 45			     DB	 'OVE'
1  2403	192F  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  2404	1930  1903r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2405	      =ARRAY:192B		 LINK=LINK$
1  2406	1932				 OVER LABEL FAR	 ; CFA
1  2407	1932  1934r			     DW	 $+2
   2408	1934  8B DC				 MOV  BX, SP
   2409	1936  36: FF 77	02			     PUSH SS:[BX+2]
   2410						 NEXT
1  2411	193A  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2412	193B  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2413					 ; ------ call debugger	--------
1  2414	193D  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2415	1941  74 06			     jz	??0036
1  2416	1943  E8 F60B			     call printWORD
1  2417	1946  E8 F4EA			     call pause
1  2418	1949				   ??0036:
1  2419					 ; -----------------------------
1  2420	1949  FF 27			     JMP WORD PTR [BX]
   2421
   2422						 HEAD	  84h,'SWA',320Q,SWAP		      ;	SWAP
1  2423	      =ARRAY:194B		 LINK$=$
1  2424	194B  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2425							 ; 6 - признак immediate. 5- слово не описано smudge
1  2426	194C  53 57 41			     DB	 'SWA'
1  2427	194F  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2428	1950  192Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2429	      =ARRAY:194B		 LINK=LINK$
1  2430	1952				 SWAP LABEL FAR	 ; CFA
1  2431	1952  1954r			     DW	 $+2
   2432	1954  59				 POP  CX
   2433	1955  58				 POP  AX
   2434	1956  51				 PUSH CX
   2435	1957  50				 PUSH AX
   2436						 NEXT
1  2437	1958  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2438	1959  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2439					 ; ------ call debugger	--------
1  2440	195B  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2441	195F  74 06			     jz	??0037
1  2442	1961  E8 F5ED			     call printWORD
1  2443	1964  E8 F4CC			     call pause
1  2444	1967				   ??0037:
1  2445					 ; -----------------------------
1  2446	1967  FF 27			     JMP WORD PTR [BX]
   2447
   2448						 HEAD	  85h,'2SWA',320Q,DSWAP		      ;	2SWAP
1  2449	      =ARRAY:1969		 LINK$=$
1  2450	1969  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2451							 ; 6 - признак immediate. 5- слово не описано smudge
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 44
forth.asm



1  2452	196A  32 53 57 41		     DB	 '2SWA'
1  2453	196E  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2454	196F  194Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2455	      =ARRAY:1969		 LINK=LINK$
1  2456	1971				 DSWAP LABEL FAR  ; CFA
1  2457	1971  1973r			     DW	 $+2
   2458	1973  58				 POP  AX
   2459	1974  59				 POP  CX
   2460	1975  8B DC				 MOV  BX,  SP
   2461	1977  36: 8B 57	02			 MOV  DX,WORD PTR SS:[BX+2]
   2462	197B  52				 PUSH DX
   2463	197C  36: 8B 17				 MOV  DX,WORD PTR SS:[BX]
   2464	197F  52				 PUSH DX
   2465	1980  36: 89 07				 MOV  WORD  PTR	SS:[BX],AX
   2466	1983  36: 89 4F	02			 MOV  WORD  PTR	SS:[BX+2],CX
   2467						 NEXT
1  2468	1987  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2469	1988  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2470					 ; ------ call debugger	--------
1  2471	198A  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2472	198E  74 06			     jz	??0038
1  2473	1990  E8 F5BE			     call printWORD
1  2474	1993  E8 F49D			     call pause
1  2475	1996				   ??0038:
1  2476					 ; -----------------------------
1  2477	1996  FF 27			     JMP WORD PTR [BX]
   2478
   2479						 HEAD	  83h,'DU',320Q,DUBL		      ;	DUP
1  2480	      =ARRAY:1998		 LINK$=$
1  2481	1998  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2482							 ; 6 - признак immediate. 5- слово не описано smudge
1  2483	1999  44 55			     DB	 'DU'
1  2484	199B  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2485	199C  1969r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2486	      =ARRAY:1998		 LINK=LINK$
1  2487	199E				 DUBL LABEL FAR	 ; CFA
1  2488	199E  19A0r			     DW	 $+2
   2489	19A0  58				 POP  AX
   2490	19A1  50			DU:	 PUSH AX
   2491	19A2  50			C$:	 PUSH AX
   2492						 NEXT
1  2493	19A3  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2494	19A4  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2495					 ; ------ call debugger	--------
1  2496	19A6  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2497	19AA  74 06			     jz	??0039
1  2498	19AC  E8 F5A2			     call printWORD
1  2499	19AF  E8 F481			     call pause
1  2500	19B2				   ??0039:
1  2501					 ; -----------------------------
1  2502	19B2  FF 27			     JMP WORD PTR [BX]
   2503
   2504						 HEAD	  84h,'-DU',320Q,DDUP		      ;	-DUP
1  2505	      =ARRAY:19B4		 LINK$=$
1  2506	19B4  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2507							 ; 6 - признак immediate. 5- слово не описано smudge
1  2508	19B5  2D 44 55			     DB	 '-DU'
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 45
forth.asm



1  2509	19B8  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2510	19B9  1998r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2511	      =ARRAY:19B4		 LINK=LINK$
1  2512	19BB				 DDUP LABEL FAR	 ; CFA
1  2513	19BB  19BDr			     DW	 $+2
   2514					     ; DUP если	в стеке	не 0
   2515	19BD  58				 POP  AX
   2516	19BE  3D 0000				 CMP  AX,  0
   2517	19C1  75 DE				 JNE  DU
   2518	19C3  EB DD				 JMP  C$
   2519
   2520						 HEAD	  84h,'2DU',320Q,DUP2		      ;	2DUP
1  2521	      =ARRAY:19C5		 LINK$=$
1  2522	19C5  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2523							 ; 6 - признак immediate. 5- слово не описано smudge
1  2524	19C6  32 44 55			     DB	 '2DU'
1  2525	19C9  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2526	19CA  19B4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2527	      =ARRAY:19C5		 LINK=LINK$
1  2528	19CC				 DUP2 LABEL FAR	 ; CFA
1  2529	19CC  19CEr			     DW	 $+2
   2530	19CE  58				 POP  AX
   2531	19CF  59				 POP  CX
   2532	19D0  51				 PUSH CX
   2533	19D1  50				 PUSH AX
   2534	19D2  51				 PUSH CX
   2535	19D3  50				 PUSH AX
   2536						 NEXT
1  2537	19D4  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2538	19D5  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2539					 ; ------ call debugger	--------
1  2540	19D7  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2541	19DB  74 06			     jz	??003A
1  2542	19DD  E8 F571			     call printWORD
1  2543	19E0  E8 F450			     call pause
1  2544	19E3				   ??003A:
1  2545					 ; -----------------------------
1  2546	19E3  FF 27			     JMP WORD PTR [BX]
   2547
   2548						 HEAD	  83h,'RO',324Q,ROT		      ;	ROT
1  2549	      =ARRAY:19E5		 LINK$=$
1  2550	19E5  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2551							 ; 6 - признак immediate. 5- слово не описано smudge
1  2552	19E6  52 4F			     DB	 'RO'
1  2553	19E8  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  2554	19E9  19C5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2555	      =ARRAY:19E5		 LINK=LINK$
1  2556	19EB				 ROT LABEL FAR	; CFA
1  2557	19EB  19EDr			     DW	 $+2
   2558	19ED  58				 POP  AX
   2559	19EE  59				 POP  CX
   2560	19EF  5B				 POP  BX
   2561	19F0  51				 PUSH CX
   2562	19F1  50				 PUSH AX
   2563	19F2  53				 PUSH BX
   2564						 NEXT
1  2565	19F3  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 46
forth.asm



1  2566	19F4  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2567					 ; ------ call debugger	--------
1  2568	19F6  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2569	19FA  74 06			     jz	??003B
1  2570	19FC  E8 F552			     call printWORD
1  2571	19FF  E8 F431			     call pause
1  2572	1A02				   ??003B:
1  2573					 ; -----------------------------
1  2574	1A02  FF 27			     JMP WORD PTR [BX]
   2575
   2576						 HEAD	  84h,'-RO',324Q,MROT			; -ROT
1  2577	      =ARRAY:1A04		 LINK$=$
1  2578	1A04  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2579							 ; 6 - признак immediate. 5- слово не описано smudge
1  2580	1A05  2D 52 4F			     DB	 '-RO'
1  2581	1A08  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  2582	1A09  19E5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2583	      =ARRAY:1A04		 LINK=LINK$
1  2584	1A0B				 MROT LABEL FAR	 ; CFA
1  2585	1A0B  1A0Dr			     DW	 $+2
   2586	1A0D  58				 POP  AX
   2587	1A0E  59				 POP  CX
   2588	1A0F  5B				 POP  BX
   2589	1A10  50				 PUSH AX
   2590	1A11  53				 PUSH BX
   2591	1A12  51				 PUSH CX
   2592						 NEXT
1  2593	1A13  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2594	1A14  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2595					 ; ------ call debugger	--------
1  2596	1A16  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2597	1A1A  74 06			     jz	??003C
1  2598	1A1C  E8 F532			     call printWORD
1  2599	1A1F  E8 F411			     call pause
1  2600	1A22				   ??003C:
1  2601					 ; -----------------------------
1  2602	1A22  FF 27			     JMP WORD PTR [BX]
   2603
   2604						 HEAD	  85h,'2DRO',320Q,DDROP		      ;	2DROP
1  2605	      =ARRAY:1A24		 LINK$=$
1  2606	1A24  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2607							 ; 6 - признак immediate. 5- слово не описано smudge
1  2608	1A25  32 44 52 4F		     DB	 '2DRO'
1  2609	1A29  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2610	1A2A  1A04r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2611	      =ARRAY:1A24		 LINK=LINK$
1  2612	1A2C				 DDROP LABEL FAR  ; CFA
1  2613	1A2C  1A2Er			     DW	 $+2
   2614	1A2E  83 C4 04			DRO:	 ADD  SP, 4
   2615						 NEXT
1  2616	1A31  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2617	1A32  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2618					 ; ------ call debugger	--------
1  2619	1A34  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2620	1A38  74 06			     jz	??003D
1  2621	1A3A  E8 F514			     call printWORD
1  2622	1A3D  E8 F3F3			     call pause
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 47
forth.asm



1  2623	1A40				   ??003D:
1  2624					 ; -----------------------------
1  2625	1A40  FF 27			     JMP WORD PTR [BX]
   2626
   2627						 HEAD	  84h,'DRO',320Q,DROP		      ;	DROP
1  2628	      =ARRAY:1A42		 LINK$=$
1  2629	1A42  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2630							 ; 6 - признак immediate. 5- слово не описано smudge
1  2631	1A43  44 52 4F			     DB	 'DRO'
1  2632	1A46  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2633	1A47  1A24r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2634	      =ARRAY:1A42		 LINK=LINK$
1  2635	1A49				 DROP LABEL FAR	 ; CFA
1  2636	1A49  1A4Br			     DW	 $+2
   2637	1A4B  83 C4 02			DRP:	 ADD  SP, 2
   2638						 NEXT
1  2639	1A4E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2640	1A4F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2641					 ; ------ call debugger	--------
1  2642	1A51  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2643	1A55  74 06			     jz	??003E
1  2644	1A57  E8 F4F7			     call printWORD
1  2645	1A5A  E8 F3D6			     call pause
1  2646	1A5D				   ??003E:
1  2647					 ; -----------------------------
1  2648	1A5D  FF 27			     JMP WORD PTR [BX]
   2649
   2650					;	 ** Работа с памятью **
   2651
   2652						 HEAD	  85h,'CMOV',305Q,CMOV		     ; CMOVE
1  2653	      =ARRAY:1A5F		 LINK$=$
1  2654	1A5F  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2655							 ; 6 - признак immediate. 5- слово не описано smudge
1  2656	1A60  43 4D 4F 56		     DB	 'CMOV'
1  2657	1A64  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  2658	1A65  1A42r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2659	      =ARRAY:1A5F		 LINK=LINK$
1  2660	1A67				 CMOV LABEL FAR	 ; CFA
1  2661	1A67  1A69r			     DW	 $+2
   2662					     ; src dst cnt -> перенос области памяти
   2663	1A69  59				 POP  CX	 ; Счетчик
   2664	1A6A  83 F9 00				 CMP  CX,  0
   2665	1A6D  7E BF				 JLE  DRO	 ; выход, c сбросом двух параметров в стеке
   2666	1A6F  8B C7				 MOV  AX,  DI	  ; Сохранение содержимого DI,SI
   2667	1A71  8B DE				 MOV  BX,  SI
   2668	1A73  5F				 POP  DI	  ; Куда
   2669	1A74  5E				 POP  SI	  ; Откуда
   2670	1A75  F3> A4			REP	 MOVS  BYTE PTR	ES:[DI], BYTE PTR DS:[SI]
   2671	1A77  8B F8				 MOV  DI, AX	  ; Восстановление DI,SI
   2672	1A79  8B F3				 MOV  SI, BX
   2673						 NEXT
1  2674	1A7B  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2675	1A7C  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2676					 ; ------ call debugger	--------
1  2677	1A7E  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2678	1A82  74 06			     jz	??003F
1  2679	1A84  E8 F4CA			     call printWORD
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 48
forth.asm



1  2680	1A87  E8 F3A9			     call pause
1  2681	1A8A				   ??003F:
1  2682					 ; -----------------------------
1  2683	1A8A  FF 27			     JMP WORD PTR [BX]
   2684
   2685						 HEAD	  84h,'FIL',314Q,FILL		      ;	FILL
1  2686	      =ARRAY:1A8C		 LINK$=$
1  2687	1A8C  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2688							 ; 6 - признак immediate. 5- слово не описано smudge
1  2689	1A8D  46 49 4C			     DB	 'FIL'
1  2690	1A90  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  2691	1A91  1A5Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2692	      =ARRAY:1A8C		 LINK=LINK$
1  2693	1A93				 FILL LABEL FAR	 ; CFA
1  2694	1A93  1A95r			     DW	 $+2
   2695					 ; addr	cnt chr	-> заполнение области памяти
   2696	1A95  58				 POP  AX      ;	Символ
   2697	1A96  59			FLL:	 POP  CX      ;	Счетчик	символов
   2698	1A97  83 F9 00				 CMP  CX, 0
   2699	1A9A  7E AF				 JLE  DRP     ;
   2700	1A9C  5B				 POP  BX
   2701	1A9D  88 07			$REPE:	 MOV  BYTE PTR [BX],  AL
   2702	1A9F  43				 INC  BX
   2703	1AA0  E2 FB				 LOOP $REPE
   2704						 NEXT
1  2705	1AA2  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2706	1AA3  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2707					 ; ------ call debugger	--------
1  2708	1AA5  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2709	1AA9  74 06			     jz	??0040
1  2710	1AAB  E8 F4A3			     call printWORD
1  2711	1AAE  E8 F382			     call pause
1  2712	1AB1				   ??0040:
1  2713					 ; -----------------------------
1  2714	1AB1  FF 27			     JMP WORD PTR [BX]
   2715
   2716						 HEAD	  85h,'ERAS',305Q,ERASE		      ;	ERASE
1  2717	      =ARRAY:1AB3		 LINK$=$
1  2718	1AB3  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2719							 ; 6 - признак immediate. 5- слово не описано smudge
1  2720	1AB4  45 52 41 53		     DB	 'ERAS'
1  2721	1AB8  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  2722	1AB9  1A8Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2723	      =ARRAY:1AB3		 LINK=LINK$
1  2724	1ABB				 ERASE LABEL FAR  ; CFA
1  2725	1ABB  1ABDr			     DW	 $+2
   2726					     ; заполнение нулем
   2727	1ABD  2B C0				 SUB  AX, AX
   2728	1ABF  EB D5				 JMP  FLL
   2729
   2730						 HEAD	  86h,'BLANK',323Q,BLANK	      ;	BLANKS
1  2731	      =ARRAY:1AC1		 LINK$=$
1  2732	1AC1  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  2733							 ; 6 - признак immediate. 5- слово не описано smudge
1  2734	1AC2  42 4C 41 4E 4B		     DB	 'BLANK'
1  2735	1AC7  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  2736	1AC8  1AB3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 49
forth.asm



1  2737	      =ARRAY:1AC1		 LINK=LINK$
1  2738	1ACA				 BLANK LABEL FAR  ; CFA
1  2739	1ACA  1ACCr			     DW	 $+2
   2740					     ; заполнение  пробелом
   2741	1ACC  B8 0020				 MOV  AX, 32
   2742	1ACF  EB C5				 JMP  FLL
   2743
   2744						 HEAD	  84h,'HOL',304Q,HOLD		      ;	HOLD
1  2745	      =ARRAY:1AD1		 LINK$=$
1  2746	1AD1  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2747							 ; 6 - признак immediate. 5- слово не описано smudge
1  2748	1AD2  48 4F 4C			     DB	 'HOL'
1  2749	1AD5  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  2750	1AD6  1AC1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2751	      =ARRAY:1AD1		 LINK=LINK$
1  2752	1AD8				 HOLD LABEL FAR	 ; CFA
1  2753	1AD8  1ADAr			     DW	 $+2
   2754					     ; Вводит в	текущую	ячейку выходного буфера	символ,
   2755					     ; код которого в стеке. Должен использоваться между <# и #>
   2756					     ; уменьшает на 1 значение указателя HLD.
   2757	1ADA  FF 4D 38				 DEC  WORD PTR	[DI+70Q]
   2758	1ADD  58				 POP  AX
   2759	1ADE  8B 5D 38				 MOV  BX,  [DI+70Q]
   2760	1AE1  88 07				 MOV  BYTE PTR [BX], AL
   2761						 NEXT
1  2762	1AE3  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2763	1AE4  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2764					 ; ------ call debugger	--------
1  2765	1AE6  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2766	1AEA  74 06			     jz	??0041
1  2767	1AEC  E8 F462			     call printWORD
1  2768	1AEF  E8 F341			     call pause
1  2769	1AF2				   ??0041:
1  2770					 ; -----------------------------
1  2771	1AF2  FF 27			     JMP WORD PTR [BX]
   2772
   2773						 HEAD	  82h,'+',241Q,PSTOR		      ;	+!
1  2774	      =ARRAY:1AF4		 LINK$=$
1  2775	1AF4  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2776							 ; 6 - признак immediate. 5- слово не описано smudge
1  2777	1AF5  2B			     DB	 '+'
1  2778	1AF6  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  2779	1AF7  1AD1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2780	      =ARRAY:1AF4		 LINK=LINK$
1  2781	1AF9				 PSTOR LABEL FAR  ; CFA
1  2782	1AF9  1AFBr			     DW	 $+2
   2783	1AFB  5B				 POP  BX
   2784	1AFC  59				 POP  CX
   2785	1AFD  01 0F				 ADD  [BX], CX
   2786						 NEXT
1  2787	1AFF  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2788	1B00  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2789					 ; ------ call debugger	--------
1  2790	1B02  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2791	1B06  74 06			     jz	??0042
1  2792	1B08  E8 F446			     call printWORD
1  2793	1B0B  E8 F325			     call pause
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 50
forth.asm



1  2794	1B0E				   ??0042:
1  2795					 ; -----------------------------
1  2796	1B0E  FF 27			     JMP WORD PTR [BX]
   2797
   2798						 HEAD	  82h,'-',241Q,MSTOR		      ;	+!
1  2799	      =ARRAY:1B10		 LINK$=$
1  2800	1B10  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2801							 ; 6 - признак immediate. 5- слово не описано smudge
1  2802	1B11  2D			     DB	 '-'
1  2803	1B12  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  2804	1B13  1AF4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2805	      =ARRAY:1B10		 LINK=LINK$
1  2806	1B15				 MSTOR LABEL FAR  ; CFA
1  2807	1B15  1B17r			     DW	 $+2
   2808	1B17  5B				 POP  BX
   2809	1B18  59				 POP  CX
   2810	1B19  29 0F				 SUB  [BX], CX
   2811						 NEXT
1  2812	1B1B  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2813	1B1C  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2814					 ; ------ call debugger	--------
1  2815	1B1E  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2816	1B22  74 06			     jz	??0043
1  2817	1B24  E8 F42A			     call printWORD
1  2818	1B27  E8 F309			     call pause
1  2819	1B2A				   ??0043:
1  2820					 ; -----------------------------
1  2821	1B2A  FF 27			     JMP WORD PTR [BX]
   2822
   2823						 HEAD	  84h,'TOG',314Q,TOGL		      ;	TOGGLE
1  2824	      =ARRAY:1B2C		 LINK$=$
1  2825	1B2C  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2826							 ; 6 - признак immediate. 5- слово не описано smudge
1  2827	1B2D  54 4F 47			     DB	 'TOG'
1  2828	1B30  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  2829	1B31  1B10r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2830	      =ARRAY:1B2C		 LINK=LINK$
1  2831	1B33				 TOGL LABEL FAR	 ; CFA
1  2832	1B33  1B35r			     DW	 $+2
   2833					; адр-байта маска -> XOR в байт	памяти
   2834	1B35  59				 POP  CX	 ; Маска
   2835	1B36  5B				 POP  BX
   2836	1B37  30 0F				 XOR  BYTE PTR [BX],CL
   2837						 NEXT
1  2838	1B39  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2839	1B3A  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2840					 ; ------ call debugger	--------
1  2841	1B3C  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2842	1B40  74 06			     jz	??0044
1  2843	1B42  E8 F40C			     call printWORD
1  2844	1B45  E8 F2EB			     call pause
1  2845	1B48				   ??0044:
1  2846					 ; -----------------------------
1  2847	1B48  FF 27			     JMP WORD PTR [BX]
   2848
   2849						 HEAD	  81h,,300Q,AT			      ;	@
1  2850	      =ARRAY:1B4A		 LINK$=$
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 51
forth.asm



1  2851	1B4A  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2852							 ; 6 - признак immediate. 5- слово не описано smudge
1  2853	1B4B  C0			     DB	 300Q	; последний символ слова + 128 (7 бит =	1).
1  2854	1B4C  1B2Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2855	      =ARRAY:1B4A		 LINK=LINK$
1  2856	1B4E				 AT LABEL FAR  ; CFA
1  2857	1B4E  1B50r			     DW	 $+2
   2858					     ; addr -> n
   2859	1B50  5B				 POP  BX
   2860	1B51  FF 37				 PUSH [BX]
   2861						 NEXT
1  2862	1B53  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2863	1B54  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2864					 ; ------ call debugger	--------
1  2865	1B56  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2866	1B5A  74 06			     jz	??0045
1  2867	1B5C  E8 F3F2			     call printWORD
1  2868	1B5F  E8 F2D1			     call pause
1  2869	1B62				   ??0045:
1  2870					 ; -----------------------------
1  2871	1B62  FF 27			     JMP WORD PTR [BX]
   2872
   2873						 HEAD	  82h,'C',300Q,CAT		      ;	C@
1  2874	      =ARRAY:1B64		 LINK$=$
1  2875	1B64  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2876							 ; 6 - признак immediate. 5- слово не описано smudge
1  2877	1B65  43			     DB	 'C'
1  2878	1B66  C0			     DB	 300Q	; последний символ слова + 128 (7 бит =	1).
1  2879	1B67  1B4Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2880	      =ARRAY:1B64		 LINK=LINK$
1  2881	1B69				 CAT LABEL FAR	; CFA
1  2882	1B69  1B6Br			     DW	 $+2
   2883					     ; Извлекает байт информации из ячейки,
   2884					     ; адрес которой находится в стеке
   2885	1B6B  5B				 POP  BX
   2886	1B6C  8A 07				 MOV  AL, BYTE PTR [BX]
   2887	1B6E  2A E4				 SUB  AH, AH
   2888	1B70  50				 PUSH AX
   2889						 NEXT
1  2890	1B71  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2891	1B72  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2892					 ; ------ call debugger	--------
1  2893	1B74  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2894	1B78  74 06			     jz	??0046
1  2895	1B7A  E8 F3D4			     call printWORD
1  2896	1B7D  E8 F2B3			     call pause
1  2897	1B80				   ??0046:
1  2898					 ; -----------------------------
1  2899	1B80  FF 27			     JMP WORD PTR [BX]
   2900
   2901						 HEAD	  81h,,241Q,STORE		      ;	!
1  2902	      =ARRAY:1B82		 LINK$=$
1  2903	1B82  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2904							 ; 6 - признак immediate. 5- слово не описано smudge
1  2905	1B83  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  2906	1B84  1B64r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2907	      =ARRAY:1B82		 LINK=LINK$
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 52
forth.asm



1  2908	1B86				 STORE LABEL FAR  ; CFA
1  2909	1B86  1B88r			     DW	 $+2
   2910					     ; n addr ->
   2911	1B88  5B				 POP  BX
   2912	1B89  58				 POP  AX
   2913	1B8A  89 07				 MOV  [BX],   AX
   2914						 NEXT
1  2915	1B8C  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2916	1B8D  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2917					 ; ------ call debugger	--------
1  2918	1B8F  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2919	1B93  74 06			     jz	??0047
1  2920	1B95  E8 F3B9			     call printWORD
1  2921	1B98  E8 F298			     call pause
1  2922	1B9B				   ??0047:
1  2923					 ; -----------------------------
1  2924	1B9B  FF 27			     JMP WORD PTR [BX]
   2925
   2926						 HEAD	  82h,'C',241Q,CSTOR		     ; C!
1  2927	      =ARRAY:1B9D		 LINK$=$
1  2928	1B9D  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2929							 ; 6 - признак immediate. 5- слово не описано smudge
1  2930	1B9E  43			     DB	 'C'
1  2931	1B9F  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  2932	1BA0  1B82r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2933	      =ARRAY:1B9D		 LINK=LINK$
1  2934	1BA2				 CSTOR LABEL FAR  ; CFA
1  2935	1BA2  1BA4r			     DW	 $+2
   2936	1BA4  5B				 POP  BX
   2937	1BA5  58				 POP  AX
   2938	1BA6  88 07				 MOV  BYTE PTR [BX],  AL
   2939						 NEXT
1  2940	1BA8  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2941	1BA9  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2942					 ; ------ call debugger	--------
1  2943	1BAB  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2944	1BAF  74 06			     jz	??0048
1  2945	1BB1  E8 F39D			     call printWORD
1  2946	1BB4  E8 F27C			     call pause
1  2947	1BB7				   ??0048:
1  2948					 ; -----------------------------
1  2949	1BB7  FF 27			     JMP WORD PTR [BX]
   2950
   2951						 HEAD	  83h,'NF','A'+80h,NFA		     ; NFA
1  2952	      =ARRAY:1BB9		 LINK$=$
1  2953	1BB9  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2954							 ; 6 - признак immediate. 5- слово не описано smudge
1  2955	1BBA  4E 46			     DB	 'NF'
1  2956	1BBC  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  2957	1BBD  1B9Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2958	      =ARRAY:1BB9		 LINK=LINK$
1  2959	1BBF				 NFA LABEL FAR	; CFA
1  2960	1BBF  1BC1r			     DW	 $+2
   2961					 ; pfa -> nfa
   2962	1BC1  5B				 POP  BX
   2963	1BC2  83 EB 05				 SUB  BX, 5
   2964	1BC5  B9 FFFF				 MOV  CX, -1
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 53
forth.asm



   2965
   2966	1BC8  E9 00A0				 JMP  TRV
   2967
   2968						 HEAD	  83h,'LF','A'+80h,LFA		     ; LFA
1  2969	      =ARRAY:1BCB		 LINK$=$
1  2970	1BCB  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2971							 ; 6 - признак immediate. 5- слово не описано smudge
1  2972	1BCC  4C 46			     DB	 'LF'
1  2973	1BCE  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  2974	1BCF  1BB9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2975	      =ARRAY:1BCB		 LINK=LINK$
1  2976	1BD1				 LFA LABEL FAR	; CFA
1  2977	1BD1  1BD3r			     DW	 $+2
   2978	1BD3  58				 POP  AX
   2979	1BD4  2D 0004				 SUB  AX, 4
   2980	1BD7  50				 PUSH AX
   2981						 NEXT
1  2982	1BD8  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2983	1BD9  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2984					 ; ------ call debugger	--------
1  2985	1BDB  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2986	1BDF  74 06			     jz	??0049
1  2987	1BE1  E8 F36D			     call printWORD
1  2988	1BE4  E8 F24C			     call pause
1  2989	1BE7				   ??0049:
1  2990					 ; -----------------------------
1  2991	1BE7  FF 27			     JMP WORD PTR [BX]
   2992
   2993						 HEAD	  83h,'CF','A'+80h,CFA		     ; CFA
1  2994	      =ARRAY:1BE9		 LINK$=$
1  2995	1BE9  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2996							 ; 6 - признак immediate. 5- слово не описано smudge
1  2997	1BEA  43 46			     DB	 'CF'
1  2998	1BEC  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  2999	1BED  1BCBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3000	      =ARRAY:1BE9		 LINK=LINK$
1  3001	1BEF				 CFA LABEL FAR	; CFA
1  3002	1BEF  1BF1r			     DW	 $+2
   3003					 ; PFA -> CFA
   3004	1BF1  58				 POP  AX
   3005	1BF2  2D 0002				 SUB  AX, 2
   3006	1BF5  50				 PUSH AX
   3007						 NEXT
1  3008	1BF6  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3009	1BF7  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3010					 ; ------ call debugger	--------
1  3011	1BF9  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3012	1BFD  74 06			     jz	??004A
1  3013	1BFF  E8 F34F			     call printWORD
1  3014	1C02  E8 F22E			     call pause
1  3015	1C05				   ??004A:
1  3016					 ; -----------------------------
1  3017	1C05  FF 27			     JMP WORD PTR [BX]
   3018
   3019						 HEAD	  84h,'!CS',320Q,SCSP		      ;	!CSP
1  3020	      =ARRAY:1C07		 LINK$=$
1  3021	1C07  84			     DB	 84h  ;	NFA 7 бит равен	1.
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 54
forth.asm



1  3022							 ; 6 - признак immediate. 5- слово не описано smudge
1  3023	1C08  21 43 53			     DB	 '!CS'
1  3024	1C0B  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  3025	1C0C  1BE9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3026	      =ARRAY:1C07		 LINK=LINK$
1  3027	1C0E				 SCSP LABEL FAR	 ; CFA
1  3028	1C0E  1C10r			     DW	 $+2
   3029					 ; контролируют	сохранение указателя стека параметров
   3030					 ; в процессе интерпретации слова
   3031	1C10  89 65 34				 MOV  WORD PTR [DI]+64Q,SP
   3032						 NEXT
1  3033	1C13  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3034	1C14  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3035					 ; ------ call debugger	--------
1  3036	1C16  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3037	1C1A  74 06			     jz	??004B
1  3038	1C1C  E8 F332			     call printWORD
1  3039	1C1F  E8 F211			     call pause
1  3040	1C22				   ??004B:
1  3041					 ; -----------------------------
1  3042	1C22  FF 27			     JMP WORD PTR [BX]
   3043
   3044						 HEAD	  84h,'HER',305Q,HERE		      ;	HERE
1  3045	      =ARRAY:1C24		 LINK$=$
1  3046	1C24  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3047							 ; 6 - признак immediate. 5- слово не описано smudge
1  3048	1C25  48 45 52			     DB	 'HER'
1  3049	1C28  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3050	1C29  1C07r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3051	      =ARRAY:1C24		 LINK=LINK$
1  3052	1C2B				 HERE LABEL FAR	 ; CFA
1  3053	1C2B  1C2Dr			     DW	 $+2
   3054	1C2D  FF 75 12				 PUSH [DI+22Q]
   3055						 NEXT
1  3056	1C30  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3057	1C31  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3058					 ; ------ call debugger	--------
1  3059	1C33  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3060	1C37  74 06			     jz	??004C
1  3061	1C39  E8 F315			     call printWORD
1  3062	1C3C  E8 F1F4			     call pause
1  3063	1C3F				   ??004C:
1  3064					 ; -----------------------------
1  3065	1C3F  FF 27			     JMP WORD PTR [BX]
   3066
   3067						 HEAD	  85h,'ALLO',324Q,ALLOT		      ;	ALLOT
1  3068	      =ARRAY:1C41		 LINK$=$
1  3069	1C41  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3070							 ; 6 - признак immediate. 5- слово не описано smudge
1  3071	1C42  41 4C 4C 4F		     DB	 'ALLO'
1  3072	1C46  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3073	1C47  1C24r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3074	      =ARRAY:1C41		 LINK=LINK$
1  3075	1C49				 ALLOT LABEL FAR  ; CFA
1  3076	1C49  1C4Br			     DW	 $+2
   3077	1C4B  5B				 POP  BX
   3078	1C4C  01 5D 12				 ADD  [DI+22Q],BX	 ;
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 55
forth.asm



   3079						 NEXT
1  3080	1C4F  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3081	1C50  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3082					 ; ------ call debugger	--------
1  3083	1C52  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3084	1C56  74 06			     jz	??004D
1  3085	1C58  E8 F2F6			     call printWORD
1  3086	1C5B  E8 F1D5			     call pause
1  3087	1C5E				   ??004D:
1  3088					 ; -----------------------------
1  3089	1C5E  FF 27			     JMP WORD PTR [BX]
   3090
   3091						 HEAD	  84h,'TRA',326Q,TRAV		      ;	TRAVERSE
1  3092	      =ARRAY:1C60		 LINK$=$
1  3093	1C60  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3094							 ; 6 - признак immediate. 5- слово не описано smudge
1  3095	1C61  54 52 41			     DB	 'TRA'
1  3096	1C64  D6			     DB	 326Q	; последний символ слова + 128 (7 бит =	1).
1  3097	1C65  1C41r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3098	      =ARRAY:1C60		 LINK=LINK$
1  3099	1C67				 TRAV LABEL FAR	 ; CFA
1  3100	1C67  1C69r			     DW	 $+2
   3101						 ; Движение вперед/назад вдоль имени переменной	длины
   3102	1C69  59				 POP  CX     ; DELTA
   3103	1C6A  5B				 POP  BX     ; адрес строки
   3104	1C6B  03 D9			 TRV:	 ADD  BX, CX
   3105	1C6D  80 3F 00				 CMP  BYTE PTR [BX],  0
   3106	1C70  79 F9				 JNS  TRV    ; JUMP IF POSITIVE
   3107	1C72  53				 PUSH BX
   3108						 NEXT
1  3109	1C73  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3110	1C74  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3111					 ; ------ call debugger	--------
1  3112	1C76  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3113	1C7A  74 06			     jz	??004E
1  3114	1C7C  E8 F2D2			     call printWORD
1  3115	1C7F  E8 F1B1			     call pause
1  3116	1C82				   ??004E:
1  3117					 ; -----------------------------
1  3118	1C82  FF 27			     JMP WORD PTR [BX]
   3119
   3120						 HEAD	  301Q,,333Q,LBRAC		       ; [
1  3121	      =ARRAY:1C84		 LINK$=$
1  3122	1C84  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  3123							 ; 6 - признак immediate. 5- слово не описано smudge
1  3124	1C85  DB			     DB	 333Q	; последний символ слова + 128 (7 бит =	1).
1  3125	1C86  1C60r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3126	      =ARRAY:1C84		 LINK=LINK$
1  3127	1C88				 LBRAC LABEL FAR  ; CFA
1  3128	1C88  1C8Ar			     DW	 $+2
   3129						 ; Прекращение компил.,	начало исполн. (обнуление STATE)
   3130	1C8A  C7 45 2C 0000			 MOV  WORD PTR [DI+54Q],0
   3131						 NEXT
1  3132	1C8F  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3133	1C90  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3134					 ; ------ call debugger	--------
1  3135	1C92  80 7D 42 00		     cmp byte ptr [di+102Q], 0
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 56
forth.asm



1  3136	1C96  74 06			     jz	??004F
1  3137	1C98  E8 F2B6			     call printWORD
1  3138	1C9B  E8 F195			     call pause
1  3139	1C9E				   ??004F:
1  3140					 ; -----------------------------
1  3141	1C9E  FF 27			     JMP WORD PTR [BX]
   3142
   3143						 HEAD	  301Q,,335Q,RBRAC		       ; ]
1  3144	      =ARRAY:1CA0		 LINK$=$
1  3145	1CA0  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  3146							 ; 6 - признак immediate. 5- слово не описано smudge
1  3147	1CA1  DD			     DB	 335Q	; последний символ слова + 128 (7 бит =	1).
1  3148	1CA2  1C84r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3149	      =ARRAY:1CA0		 LINK=LINK$
1  3150	1CA4				 RBRAC LABEL FAR  ; CFA
1  3151	1CA4  1CA6r			     DW	 $+2
   3152	1CA6  C7 45 2C 00C0			 MOV  WORD PTR [DI+54Q],300Q   ; Начало	компиляции
   3153						 NEXT
1  3154	1CAB  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3155	1CAC  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3156					 ; ------ call debugger	--------
1  3157	1CAE  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3158	1CB2  74 06			     jz	??0050
1  3159	1CB4  E8 F29A			     call printWORD
1  3160	1CB7  E8 F179			     call pause
1  3161	1CBA				   ??0050:
1  3162					 ; -----------------------------
1  3163	1CBA  FF 27			     JMP WORD PTR [BX]
   3164
   3165						 HEAD	  83h,'HE',330Q,$HEX		      ;	HEX
1  3166	      =ARRAY:1CBC		 LINK$=$
1  3167	1CBC  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3168							 ; 6 - признак immediate. 5- слово не описано smudge
1  3169	1CBD  48 45			     DB	 'HE'
1  3170	1CBF  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  3171	1CC0  1CA0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3172	      =ARRAY:1CBC		 LINK=LINK$
1  3173	1CC2				 $HEX LABEL FAR	 ; CFA
1  3174	1CC2  1CC4r			     DW	 $+2
   3175	1CC4  C7 45 2E 0010			 MOV  WORD PTR [DI+56Q],16
   3176						 NEXT
1  3177	1CC9  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3178	1CCA  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3179					 ; ------ call debugger	--------
1  3180	1CCC  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3181	1CD0  74 06			     jz	??0051
1  3182	1CD2  E8 F27C			     call printWORD
1  3183	1CD5  E8 F15B			     call pause
1  3184	1CD8				   ??0051:
1  3185					 ; -----------------------------
1  3186	1CD8  FF 27			     JMP WORD PTR [BX]
   3187
   3188						 HEAD	  87h,'DECIMA',314Q,DECIMA	       ; DECIMAL
1  3189	      =ARRAY:1CDA		 LINK$=$
1  3190	1CDA  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  3191							 ; 6 - признак immediate. 5- слово не описано smudge
1  3192	1CDB  44 45 43 49 4D 41		     DB	 'DECIMA'
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 57
forth.asm



1  3193	1CE1  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3194	1CE2  1CBCr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3195	      =ARRAY:1CDA		 LINK=LINK$
1  3196	1CE4				 DECIMA	LABEL FAR  ; CFA
1  3197	1CE4  1CE6r			     DW	 $+2
   3198	1CE6  C7 45 2E 000A			 MOV  WORD PTR [DI+56Q],10
   3199						 NEXT
1  3200	1CEB  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3201	1CEC  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3202					 ; ------ call debugger	--------
1  3203	1CEE  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3204	1CF2  74 06			     jz	??0052
1  3205	1CF4  E8 F25A			     call printWORD
1  3206	1CF7  E8 F139			     call pause
1  3207	1CFA				   ??0052:
1  3208					 ; -----------------------------
1  3209	1CFA  FF 27			     JMP WORD PTR [BX]
   3210
   3211						 HEAD	  85h,'OCTA',314Q,OCTAL		      ;	OCTAL
1  3212	      =ARRAY:1CFC		 LINK$=$
1  3213	1CFC  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3214							 ; 6 - признак immediate. 5- слово не описано smudge
1  3215	1CFD  4F 43 54 41		     DB	 'OCTA'
1  3216	1D01  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3217	1D02  1CDAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3218	      =ARRAY:1CFC		 LINK=LINK$
1  3219	1D04				 OCTAL LABEL FAR  ; CFA
1  3220	1D04  1D06r			     DW	 $+2
   3221	1D06  C7 45 2E 0008			 MOV  WORD PTR [DI+56Q],  8
   3222	1D0B				Y$:	 NEXT
1  3223	1D0B  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3224	1D0C  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3225					 ; ------ call debugger	--------
1  3226	1D0E  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3227	1D12  74 06			     jz	??0053
1  3228	1D14  E8 F23A			     call printWORD
1  3229	1D17  E8 F119			     call pause
1  3230	1D1A				   ??0053:
1  3231					 ; -----------------------------
1  3232	1D1A  FF 27			     JMP WORD PTR [BX]
   3233
   3234						 HEAD	  86h,'LATES',324Q,LATES	      ;	LATEST
1  3235	      =ARRAY:1D1C		 LINK$=$
1  3236	1D1C  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  3237							 ; 6 - признак immediate. 5- слово не описано smudge
1  3238	1D1D  4C 41 54 45 53		     DB	 'LATES'
1  3239	1D22  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3240	1D23  1CFCr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3241	      =ARRAY:1D1C		 LINK=LINK$
1  3242	1D25				 LATES LABEL FAR  ; CFA
1  3243	1D25  1D27r			     DW	 $+2
   3244					     ; в стек данных NFA  последнего определенного слова
   3245					     ; в current словаре
   3246	1D27  8B 5D 2A				 MOV  BX, [DI+52Q]
   3247	1D2A  FF 37				 PUSH [BX]
   3248						 NEXT
1  3249	1D2C  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 58
forth.asm



1  3250	1D2D  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3251					 ; ------ call debugger	--------
1  3252	1D2F  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3253	1D33  74 06			     jz	??0054
1  3254	1D35  E8 F219			     call printWORD
1  3255	1D38  E8 F0F8			     call pause
1  3256	1D3B				   ??0054:
1  3257					 ; -----------------------------
1  3258	1D3B  FF 27			     JMP WORD PTR [BX]
   3259
   3260						 HEAD	  86h,'-TRAI',314Q,DTRAI	      ;	-TRAIL
1  3261	      =ARRAY:1D3D		 LINK$=$
1  3262	1D3D  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  3263							 ; 6 - признак immediate. 5- слово не описано smudge
1  3264	1D3E  2D 54 52 41 49		     DB	 '-TRAI'
1  3265	1D43  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3266	1D44  1D1Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3267	      =ARRAY:1D3D		 LINK=LINK$
1  3268	1D46				 DTRAI LABEL FAR  ; CFA
1  3269	1D46  1D48r			     DW	 $+2
   3270					 ; адр n1 --> адр n2 Убирает пробелы в конце строки
   3271	1D48  59				 POP  CX
   3272	1D49  5B				 POP  BX
   3273	1D4A  53				 PUSH BX
   3274	1D4B  03 D9				 ADD  BX, CX
   3275	1D4D  4B			COMPA:	 DEC  BX
   3276	1D4E  80 3F 20				 CMP  BYTE PTR [BX],  32  ; BLANK ?
   3277	1D51  75 02				 JNE  NO
   3278	1D53  E2 F8				 LOOP COMPA
   3279	1D55  51			NO:	 PUSH CX
   3280						 NEXT
1  3281	1D56  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3282	1D57  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3283					 ; ------ call debugger	--------
1  3284	1D59  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3285	1D5D  74 06			     jz	??0055
1  3286	1D5F  E8 F1EF			     call printWORD
1  3287	1D62  E8 F0CE			     call pause
1  3288	1D65				   ??0055:
1  3289					 ; -----------------------------
1  3290	1D65  FF 27			     JMP WORD PTR [BX]
   3291
   3292						 HEAD	  85h,'UPPE',322Q,UPPER		      ;	UPPER
1  3293	      =ARRAY:1D67		 LINK$=$
1  3294	1D67  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3295							 ; 6 - признак immediate. 5- слово не описано smudge
1  3296	1D68  55 50 50 45		     DB	 'UPPE'
1  3297	1D6C  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  3298	1D6D  1D3Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3299	      =ARRAY:1D67		 LINK=LINK$
1  3300	1D6F				 UPPER LABEL FAR  ; CFA
1  3301	1D6F  1D71r			     DW	 $+2
   3302	1D71  59				 POP  CX		 ; число символов
   3303	1D72  5B				 POP  BX		 ; строка
   3304	1D73  80 3F 61			$COMP:	 CMP  BYTE PTR [BX],  61h ; a
   3305	1D76  7C 08				 JL   OFLIM
   3306	1D78  80 3F 7A				 CMP  BYTE PTR [BX],  7Ah ; z
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 59
forth.asm



   3307	1D7B  7F 03				 JG   OFLIM
   3308	1D7D  83 27 DF				 AND  WORD PTR [BX], 177737Q ; FFDF
   3309	1D80  43			OFLIM:	 INC  BX
   3310	1D81  E2 F0				 LOOP $COMP
   3311						 NEXT
1  3312	1D83  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3313	1D84  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3314					 ; ------ call debugger	--------
1  3315	1D86  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3316	1D8A  74 06			     jz	??0056
1  3317	1D8C  E8 F1C2			     call printWORD
1  3318	1D8F  E8 F0A1			     call pause
1  3319	1D92				   ??0056:
1  3320					 ; -----------------------------
1  3321	1D92  FF 27			     JMP WORD PTR [BX]
   3322
   3323						 HEAD	  213Q,'DEFINITION',323Q,DEFIN	    ; DEFINITIONS
1  3324	      =ARRAY:1D94		 LINK$=$
1  3325	1D94  8B			     DB	 213Q  ; NFA 7 бит равен 1.
1  3326							 ; 6 - признак immediate. 5- слово не описано smudge
1  3327	1D95  44 45 46 49 4E 49	54+	     DB	 'DEFINITION'
   3328	      49 4F 4E
1  3329	1D9F  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  3330	1DA0  1D67r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3331	      =ARRAY:1D94		 LINK=LINK$
1  3332	1DA2				 DEFIN LABEL FAR  ; CFA
1  3333	1DA2  1DA4r			     DW	 $+2
   3334					 ; Контекстный словарь становится текущим, все последующие
   3335					 ; описания связаны с этим словарем
   3336	1DA4  8B 45 28				 MOV  AX, [DI+50Q]	 ; context
   3337	1DA7  89 45 2A				 MOV  [DI+52Q],AX	 ; current
   3338						 NEXT
1  3339	1DAA  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3340	1DAB  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3341					 ; ------ call debugger	--------
1  3342	1DAD  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3343	1DB1  74 06			     jz	??0057
1  3344	1DB3  E8 F19B			     call printWORD
1  3345	1DB6  E8 F07A			     call pause
1  3346	1DB9				   ??0057:
1  3347					 ; -----------------------------
1  3348	1DB9  FF 27			     JMP WORD PTR [BX]
   3349
   3350						 HEAD	  84h,'+BU',306Q,PBUF		      ;	+BUF
1  3351	      =ARRAY:1DBB		 LINK$=$
1  3352	1DBB  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3353							 ; 6 - признак immediate. 5- слово не описано smudge
1  3354	1DBC  2B 42 55			     DB	 '+BU'
1  3355	1DBF  C6			     DB	 306Q	; последний символ слова + 128 (7 бит =	1).
1  3356	1DC0  1D94r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3357	      =ARRAY:1DBB		 LINK=LINK$
1  3358	1DC2				 PBUF LABEL FAR	 ; CFA
1  3359	1DC2  1DC4r			     DW	 $+2
   3360					 ;
   3361	1DC4  8B DC				 MOV  BX, SP	     ;
   3362	1DC6  36: 81 07	0404			 ADD  SS:[BX],1028   ; адрес следующего	буфера
   3363	1DCB  36: 8B 07				 MOV  AX, SS:[BX]
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 60
forth.asm



   3364	1DCE  39 45 18				 CMP  [DI+30Q],AX    ; LIMIT
   3365	1DD1  75 06				 JNE  PB	     ; уперлись	в адрес	лимита,	значит буфер - последний
   3366	1DD3  8B 4D 16				 MOV  CX, [DI+26Q]   ; FIRST
   3367	1DD6  36: 89 0F				 MOV  SS:[BX],CX     ; переходим на первый буфер
   3368	1DD9  36: FF 37			PB:	 PUSH SS:[BX]	     ; полученный адрес	буфера в стек
   3369	1DDC  8B 4D 3C				 MOV  CX, [DI+74Q]   ; prev
   3370	1DDF  36: 29 4F	FE			 SUB  SS:[BX-2],CX   ; стек растет вниз. BX-2 сейчас  вершина стека
   3371								     ; если 0, значит адрес совпадает с	адресом	prev
   3372						 NEXT
1  3373	1DE3  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3374	1DE4  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3375					 ; ------ call debugger	--------
1  3376	1DE6  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3377	1DEA  74 06			     jz	??0058
1  3378	1DEC  E8 F162			     call printWORD
1  3379	1DEF  E8 F041			     call pause
1  3380	1DF2				   ??0058:
1  3381					 ; -----------------------------
1  3382	1DF2  FF 27			     JMP WORD PTR [BX]
   3383
   3384						 HEAD	  86h,'UPDAT',305Q,UPDAT	      ;	UPDATE
1  3385	      =ARRAY:1DF4		 LINK$=$
1  3386	1DF4  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  3387							 ; 6 - признак immediate. 5- слово не описано smudge
1  3388	1DF5  55 50 44 41 54		     DB	 'UPDAT'
1  3389	1DFA  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3390	1DFB  1DBBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3391	      =ARRAY:1DF4		 LINK=LINK$
1  3392	1DFD				 UPDAT LABEL FAR  ; CFA
1  3393	1DFD  1DFFr			     DW	 $+2
   3394	1DFF  8B 5D 3C				 MOV  BX, [DI+74Q]   ; prev buffer
   3395	1E02  0B DB				 OR BX,	BX	     ; если 0, буфер пустой
   3396	1E04  74 04				 jz $upd
   3397	1E06  81 0F 8000			 OR  WORD PTR [BX],   100000Q  ; ставим	бит
   3398	1E0A				 $upd:	 NEXT
1  3399	1E0A  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3400	1E0B  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3401					 ; ------ call debugger	--------
1  3402	1E0D  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3403	1E11  74 06			     jz	??0059
1  3404	1E13  E8 F13B			     call printWORD
1  3405	1E16  E8 F01A			     call pause
1  3406	1E19				   ??0059:
1  3407					 ; -----------------------------
1  3408	1E19  FF 27			     JMP WORD PTR [BX]
   3409
   3410						 HEAD	  81h,,330Q,X			      ;	X
1  3411	      =ARRAY:1E1B		 LINK$=$
1  3412	1E1B  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3413							 ; 6 - признак immediate. 5- слово не описано smudge
1  3414	1E1C  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  3415	1E1D  1DF4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3416	      =ARRAY:1E1B		 LINK=LINK$
1  3417	1E1F				 X LABEL FAR  ;	CFA
1  3418	1E1F  1E21r			     DW	 $+2
   3419					 ; сброс бита сохранения буфера
   3420	1E21  5B				 POP  BX
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 61
forth.asm



   3421	1E22  81 27 7FFF			 AND WORD PTR [BX],   77777Q   ;
   3422	1E26  FF 37				 PUSH [BX]
   3423						 NEXT
1  3424	1E28  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3425	1E29  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3426					 ; ------ call debugger	--------
1  3427	1E2B  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3428	1E2F  74 06			     jz	??005A
1  3429	1E31  E8 F11D			     call printWORD
1  3430	1E34  E8 EFFC			     call pause
1  3431	1E37				   ??005A:
1  3432					 ; -----------------------------
1  3433	1E37  FF 27			     JMP WORD PTR [BX]
   3434
   3435					;	 ** Управляющие	слова **
   3436
   3437						 HEAD	  301Q,,272Q,COLON,$COL		       ; :
1  3438	      =ARRAY:1E39		 LINK$=$
1  3439	1E39  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  3440							 ; 6 - признак immediate. 5- слово не описано smudge
1  3441	1E3A  BA			     DB	 272Q	; последний символ слова + 128 (7 бит =	1).
1  3442	1E3B  1E1Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3443	      =ARRAY:1E39		 LINK=LINK$
1  3444	1E3D				 COLON LABEL FAR  ; CFA
1  3445	1E3D  1E51r			     DW	$COL
   3446					     ; слово для создания новых	слов из	Форта
   3447	1E3F  215Fr 1C0Er 2046r	  +		 DW QEXEC,SCSP,CURR,AT,CONT,STORE,CREAT
   3448	      1B4Er 2038r 1B86r	  +
   3449	      2512r
   3450	1E4D  1CA4r 21E9r			 DW RBRAC,PSCOD	; после	этого слова SI указывает на следующий код,
   3451								; адрес, которого попадет в CFA	создаваемого слова
   3452	1E51				$COL	 LABEL	 FAR ; код для исполнения слов на форте	из этого исходника
   3453							     ; функция интерпретатора
   3454	1E51  83 C5 FE				 ADD  BP, -2 ; резервируем место в стеке возвратов
   3455	1E54  83 C3 02				 ADD  BX, 2  ; BX указывает на CFA здесь это $COL
   3456							     ; BX+2 будет указывать на адрес QEXEC
   3457	1E57  89 76 00				 MOV  [BP], SI ; сохраняем текущий указатель IP
   3458	1E5A  8B F3				 MOV  SI, BX ; исполняем слово QEXEC
   3459						 NEXT
1  3460	1E5C  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3461	1E5D  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3462					 ; ------ call debugger	--------
1  3463	1E5F  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3464	1E63  74 06			     jz	??005B
1  3465	1E65  E8 F0E9			     call printWORD
1  3466	1E68  E8 EFC8			     call pause
1  3467	1E6B				   ??005B:
1  3468					 ; -----------------------------
1  3469	1E6B  FF 27			     JMP WORD PTR [BX]
   3470
   3471						 HEAD	  301Q,,273Q,SMI,$COL		       ; ;
1  3472	      =ARRAY:1E6D		 LINK$=$
1  3473	1E6D  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  3474							 ; 6 - признак immediate. 5- слово не описано smudge
1  3475	1E6E  BB			     DB	 273Q	; последний символ слова + 128 (7 бит =	1).
1  3476	1E6F  1E39r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3477	      =ARRAY:1E6D		 LINK=LINK$
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 62
forth.asm



1  3478	1E71				 SMI LABEL FAR	; CFA
1  3479	1E71  1E51r			     DW	$COL
   3480					     ; слово для завершения новых слов из Форта
   3481	1E73  2188r 21BCr 1815r	  +		 DW QCSP,COMP,SEMI,SMUG,LBRAC,SEMI
   3482	      21D5r 1C88r 1815r
   3483
   3484						 HEAD	  88h,'CONSTAN',324Q,CON,$COL	      ;	CONSTANT
1  3485	      =ARRAY:1E7F		 LINK$=$
1  3486	1E7F  88			     DB	 88h  ;	NFA 7 бит равен	1.
1  3487							 ; 6 - признак immediate. 5- слово не описано smudge
1  3488	1E80  43 4F 4E 53 54 41	4E	     DB	 'CONSTAN'
1  3489	1E87  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3490	1E88  1E6Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3491	      =ARRAY:1E7F		 LINK=LINK$
1  3492	1E8A				 CON LABEL FAR	; CFA
1  3493	1E8A  1E51r			     DW	$COL
   3494	1E8C  2512r 21D5r 20E8r	  +		 DW CREAT,SMUG,COMMA,PSCOD		      ;
   3495	      21E9r
   3496	1E94				$CON	 LABEL	 FAR
   3497	1E94  83 C3 02				 ADD  BX, 2 ; аналогично переменной
   3498	1E97  FF 37				 PUSH [BX]  ; вместо адреса пишем значение по этому адресу PFA
   3499						 NEXT
1  3500	1E99  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3501	1E9A  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3502					 ; ------ call debugger	--------
1  3503	1E9C  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3504	1EA0  74 06			     jz	??005C
1  3505	1EA2  E8 F0AC			     call printWORD
1  3506	1EA5  E8 EF8B			     call pause
1  3507	1EA8				   ??005C:
1  3508					 ; -----------------------------
1  3509	1EA8  FF 27			     JMP WORD PTR [BX]
   3510
   3511						 HEAD	  88h, 'VARIABL',305Q,VAR,$COL	      ;	VARIABLE
1  3512	      =ARRAY:1EAA		 LINK$=$
1  3513	1EAA  88			     DB	 88h  ;	NFA 7 бит равен	1.
1  3514							 ; 6 - признак immediate. 5- слово не описано smudge
1  3515	1EAB  56 41 52 49 41 42	4C	     DB	 'VARIABL'
1  3516	1EB2  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3517	1EB3  1E7Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3518	      =ARRAY:1EAA		 LINK=LINK$
1  3519	1EB5				 VAR LABEL FAR	; CFA
1  3520	1EB5  1E51r			     DW	$COL
   3521	1EB7  1E8Ar 21E9r			 DW CON,PSCOD
   3522	1EBB				$VAR	 LABEL	 FAR
   3523	1EBB  83 C3 02				 ADD  BX, 2  ; BX указывает на CFA ($COL)
   3524							     ; BX+2 пропускает поле CFA
   3525	1EBE  53				 PUSH BX     ; в BX находится адрес переменной PFA (CON)
   3526						 NEXT
1  3527	1EBF  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3528	1EC0  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3529					 ; ------ call debugger	--------
1  3530	1EC2  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3531	1EC6  74 06			     jz	??005D
1  3532	1EC8  E8 F086			     call printWORD
1  3533	1ECB  E8 EF65			     call pause
1  3534	1ECE				   ??005D:
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 63
forth.asm



1  3535					 ; -----------------------------
1  3536	1ECE  FF 27			     JMP WORD PTR [BX]
   3537
   3538						 HEAD	  84h,'USE',322Q,USER, $COL	      ;	USER
1  3539	      =ARRAY:1ED0		 LINK$=$
1  3540	1ED0  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3541							 ; 6 - признак immediate. 5- слово не описано smudge
1  3542	1ED1  55 53 45			     DB	 'USE'
1  3543	1ED4  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  3544	1ED5  1EAAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3545	      =ARRAY:1ED0		 LINK=LINK$
1  3546	1ED7				 USER LABEL FAR	 ; CFA
1  3547	1ED7  1E51r			     DW	$COL
   3548	1ED9  1E8Ar 21E9r			 DW CON,PSCOD
   3549	1EDD				$USE	 LABEL	 FAR
   3550	1EDD  83 C3 02				 ADD  BX, 2
   3551	1EE0  8B 07				 MOV  AX, [BX] ; берем смещение	из PFA
   3552	1EE2  03 C7				 ADD  AX, DI  ;	вычисляем смещение
   3553	1EE4  50				 PUSH AX ; полученный адрес в стек
   3554						 NEXT
1  3555	1EE5  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3556	1EE6  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3557					 ; ------ call debugger	--------
1  3558	1EE8  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3559	1EEC  74 06			     jz	??005E
1  3560	1EEE  E8 F060			     call printWORD
1  3561	1EF1  E8 EF3F			     call pause
1  3562	1EF4				   ??005E:
1  3563					 ; -----------------------------
1  3564	1EF4  FF 27			     JMP WORD PTR [BX]
   3565
   3566						 HEAD	  85h,'DOES',276Q,DOES,$COL	      ;	DOES>
1  3567	      =ARRAY:1EF6		 LINK$=$
1  3568	1EF6  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3569							 ; 6 - признак immediate. 5- слово не описано smudge
1  3570	1EF7  44 4F 45 53		     DB	 'DOES'
1  3571	1EFB  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1  3572	1EFC  1ED0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3573	      =ARRAY:1EF6		 LINK=LINK$
1  3574	1EFE				 DOES LABEL FAR	 ; CFA
1  3575	1EFE  1E51r			     DW	$COL
   3576					 ; запись в адрес PFA слова в словаре адреса кода,
   3577					 ; который следует за DOES>. В CFA пишется адрес кода,
   3578					 ; следующего за PSCOD,	т.е. $DOE
   3579	1F00  1872r 1D25r 211Br	  +		 DW  FROMR,LATES,PFA,STORE,PSCOD
   3580	      1B86r 21E9r
   3581	1F0A				$DOE	 LABEL	 FAR ; здесь используется только в FORTH
   3582	1F0A  83 ED 02				 SUB  BP,  2   ; резервируем место в RS
   3583	1F0D  89 76 00				 MOV  [BP], SI ; сохраняем SI адрес следующего слова
   3584	1F10  83 C3 02				 ADD  BX, 2    ; BX+2 это PFA исполняемого слова (FORTH)
   3585	1F13  8B 37				 MOV  SI, [BX] ; там лежит адрес слова DOVOC
   3586	1F15  83 C3 02				 ADD  BX, 2    ; адрес параметра PFA+2 для DOVOC (120201Q)
   3587	1F18  53				 PUSH BX       ; в стек
   3588						 NEXT	       ; исполняется слово DOVOC (по адресу PFA)
1  3589	1F19  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3590	1F1A  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3591					 ; ------ call debugger	--------
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 64
forth.asm



1  3592	1F1C  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3593	1F20  74 06			     jz	??005F
1  3594	1F22  E8 F02C			     call printWORD
1  3595	1F25  E8 EF0B			     call pause
1  3596	1F28				   ??005F:
1  3597					 ; -----------------------------
1  3598	1F28  FF 27			     JMP WORD PTR [BX]
   3599
   3600						 HEAD	  83h,'BY','E'+80h,BYE			; BYE
1  3601	      =ARRAY:1F2A		 LINK$=$
1  3602	1F2A  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3603							 ; 6 - признак immediate. 5- слово не описано smudge
1  3604	1F2B  42 59			     DB	 'BY'
1  3605	1F2D  C5			     DB	 'E'+80h   ; последний символ слова + 128 (7 бит = 1).
1  3606	1F2E  1EF6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3607	      =ARRAY:1F2A		 LINK=LINK$
1  3608	1F30				 BYE LABEL FAR	; CFA
1  3609	1F30  1F32r			     DW	 $+2
   3610	1F32  B4 4C				 mov ah, 4ch
   3611	1F34  CD 21				 int 21h
   3612
   3613					;	 ** Константы **
   3614
   3615						 HEAD	  81h,,260Q,ZERO,$CON		      ;	0
1  3616	      =ARRAY:1F36		 LINK$=$
1  3617	1F36  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3618							 ; 6 - признак immediate. 5- слово не описано smudge
1  3619	1F37  B0			     DB	 260Q	; последний символ слова + 128 (7 бит =	1).
1  3620	1F38  1F2Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3621	      =ARRAY:1F36		 LINK=LINK$
1  3622	1F3A				 ZERO LABEL FAR	 ; CFA
1  3623	1F3A  1E94r			     DW	$CON
   3624	1F3C  0000				 DW 0
   3625
   3626						 HEAD	  81h,,261Q,ONE,$CON		      ;	1
1  3627	      =ARRAY:1F3E		 LINK$=$
1  3628	1F3E  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3629							 ; 6 - признак immediate. 5- слово не описано smudge
1  3630	1F3F  B1			     DB	 261Q	; последний символ слова + 128 (7 бит =	1).
1  3631	1F40  1F36r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3632	      =ARRAY:1F3E		 LINK=LINK$
1  3633	1F42				 ONE LABEL FAR	; CFA
1  3634	1F42  1E94r			     DW	$CON
   3635	1F44  0001				 DW 1
   3636
   3637						 HEAD	  81h,,262Q,TWO,$CON		      ;	2
1  3638	      =ARRAY:1F46		 LINK$=$
1  3639	1F46  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3640							 ; 6 - признак immediate. 5- слово не описано smudge
1  3641	1F47  B2			     DB	 262Q	; последний символ слова + 128 (7 бит =	1).
1  3642	1F48  1F3Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3643	      =ARRAY:1F46		 LINK=LINK$
1  3644	1F4A				 TWO LABEL FAR	; CFA
1  3645	1F4A  1E94r			     DW	$CON
   3646	1F4C  0002				 DW 2
   3647
   3648						 HEAD	  81h,,263Q,THREE,$CON		      ;	3
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 65
forth.asm



1  3649	      =ARRAY:1F4E		 LINK$=$
1  3650	1F4E  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3651							 ; 6 - признак immediate. 5- слово не описано smudge
1  3652	1F4F  B3			     DB	 263Q	; последний символ слова + 128 (7 бит =	1).
1  3653	1F50  1F46r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3654	      =ARRAY:1F4E		 LINK=LINK$
1  3655	1F52				 THREE LABEL FAR  ; CFA
1  3656	1F52  1E94r			     DW	$CON
   3657	1F54  0003				 DW 3
   3658
   3659						 HEAD	  81h,,270Q,EIGHT, $CON		      ;	8
1  3660	      =ARRAY:1F56		 LINK$=$
1  3661	1F56  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3662							 ; 6 - признак immediate. 5- слово не описано smudge
1  3663	1F57  B8			     DB	 270Q	; последний символ слова + 128 (7 бит =	1).
1  3664	1F58  1F4Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3665	      =ARRAY:1F56		 LINK=LINK$
1  3666	1F5A				 EIGHT LABEL FAR  ; CFA
1  3667	1F5A  1E94r			     DW	$CON
   3668	1F5C  0008				 DW 8
   3669
   3670						 HEAD	  82h,'B',314Q,BLAN,$CON	      ;	BL
1  3671	      =ARRAY:1F5E		 LINK$=$
1  3672	1F5E  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3673							 ; 6 - признак immediate. 5- слово не описано smudge
1  3674	1F5F  42			     DB	 'B'
1  3675	1F60  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3676	1F61  1F56r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3677	      =ARRAY:1F5E		 LINK=LINK$
1  3678	1F63				 BLAN LABEL FAR	 ; CFA
1  3679	1F63  1E94r			     DW	$CON
   3680	1F65  0020				 DW 32
   3681
   3682						 HEAD	  82h,'C',314Q,$CL,$CON		      ;	C/L
1  3683	      =ARRAY:1F67		 LINK$=$
1  3684	1F67  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3685							 ; 6 - признак immediate. 5- слово не описано smudge
1  3686	1F68  43			     DB	 'C'
1  3687	1F69  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3688	1F6A  1F5Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3689	      =ARRAY:1F67		 LINK=LINK$
1  3690	1F6C				 $CL LABEL FAR	; CFA
1  3691	1F6C  1E94r			     DW	$CON
   3692	1F6E  0040				 DW 64	 ;CHAR#	PER LINE
   3693
   3694						 HEAD	  82h,'1',313Q,BBUF,$CON	      ;	BBUF
1  3695	      =ARRAY:1F70		 LINK$=$
1  3696	1F70  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3697							 ; 6 - признак immediate. 5- слово не описано smudge
1  3698	1F71  31			     DB	 '1'
1  3699	1F72  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  3700	1F73  1F67r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3701	      =ARRAY:1F70		 LINK=LINK$
1  3702	1F75				 BBUF LABEL FAR	 ; CFA
1  3703	1F75  1E94r			     DW	$CON
   3704	1F77  0400				 DW 1024 ; длина буфера
   3705
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 66
forth.asm



   3706						 ;** USER-переменные **
   3707
   3708						 HEAD	  82h,'S',260Q,SZERO,$USE	      ;	SO
1  3709	      =ARRAY:1F79		 LINK$=$
1  3710	1F79  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3711							 ; 6 - признак immediate. 5- слово не описано smudge
1  3712	1F7A  53			     DB	 'S'
1  3713	1F7B  B0			     DB	 260Q	; последний символ слова + 128 (7 бит =	1).
1  3714	1F7C  1F70r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3715	      =ARRAY:1F79		 LINK=LINK$
1  3716	1F7E				 SZERO LABEL FAR  ; CFA
1  3717	1F7E  1EDDr			     DW	$USE
   3718	1F80  0006				 DW 6 ;	Указатель начала стека параметров
   3719
   3720						 HEAD	  82h,'R',260Q,RZERO,$USE	      ;	RO
1  3721	      =ARRAY:1F82		 LINK$=$
1  3722	1F82  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3723							 ; 6 - признак immediate. 5- слово не описано smudge
1  3724	1F83  52			     DB	 'R'
1  3725	1F84  B0			     DB	 260Q	; последний символ слова + 128 (7 бит =	1).
1  3726	1F85  1F79r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3727	      =ARRAY:1F82		 LINK=LINK$
1  3728	1F87				 RZERO LABEL FAR  ; CFA
1  3729	1F87  1EDDr			     DW	$USE
   3730	1F89  0008				 DW 8  ; Указатель начала стека	возврата
   3731
   3732						 HEAD	  83h, 'TI',302Q,TIB,$USE	      ;	TIB
1  3733	      =ARRAY:1F8B		 LINK$=$
1  3734	1F8B  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3735							 ; 6 - признак immediate. 5- слово не описано smudge
1  3736	1F8C  54 49			     DB	 'TI'
1  3737	1F8E  C2			     DB	 302Q	; последний символ слова + 128 (7 бит =	1).
1  3738	1F8F  1F82r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3739	      =ARRAY:1F8B		 LINK=LINK$
1  3740	1F91				 TIB LABEL FAR	; CFA
1  3741	1F91  1EDDr			     DW	$USE
   3742	1F93  000A				 DW 12Q	 ;Входной буфер	терминала 10
   3743
   3744						 HEAD	  85h,'WIDT',310Q,$WIDTH,$USE	      ;	WIDTH
1  3745	      =ARRAY:1F95		 LINK$=$
1  3746	1F95  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3747							 ; 6 - признак immediate. 5- слово не описано smudge
1  3748	1F96  57 49 44 54		     DB	 'WIDT'
1  3749	1F9A  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1  3750	1F9B  1F8Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3751	      =ARRAY:1F95		 LINK=LINK$
1  3752	1F9D				 $WIDTH	LABEL FAR  ; CFA
1  3753	1F9D  1EDDr			     DW	$USE
   3754	1F9F  000C				 DW 14Q	; Определяет максимальную длину	имени в	словаре
   3755
   3756						 HEAD	  87h,'WARNIN',307Q,$WARN,$USE	      ;	WARNING
1  3757	      =ARRAY:1FA1		 LINK$=$
1  3758	1FA1  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  3759							 ; 6 - признак immediate. 5- слово не описано smudge
1  3760	1FA2  57 41 52 4E 49 4E		     DB	 'WARNIN'
1  3761	1FA8  C7			     DB	 307Q	; последний символ слова + 128 (7 бит =	1).
1  3762	1FA9  1F95r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 67
forth.asm



1  3763	      =ARRAY:1FA1		 LINK=LINK$
1  3764	1FAB				 $WARN LABEL FAR  ; CFA
1  3765	1FAB  1EDDr			     DW	$USE
   3766	1FAD  000E				 DW 16Q	 ;  при	0 только код ошибки выводится
   3767
   3768						 HEAD	  85h,'FENC',305Q,FENCE,$USE	      ;	FENCE
1  3769	      =ARRAY:1FAF		 LINK$=$
1  3770	1FAF  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3771							 ; 6 - признак immediate. 5- слово не описано smudge
1  3772	1FB0  46 45 4E 43		     DB	 'FENC'
1  3773	1FB4  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3774	1FB5  1FA1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3775	      =ARRAY:1FAF		 LINK=LINK$
1  3776	1FB7				 FENCE LABEL FAR  ; CFA
1  3777	1FB7  1EDDr			     DW	$USE
   3778	1FB9  0010				 DW 20Q	; FENCE	указывает верхний край базового	словаря
   3779						 ; FENCE  (ограда) служит  для	защиты	базового словаря
   3780						 ; от стирания с помощью оператора FORGET,  указывает адрес,
   3781						 ; предшествующий первой  свободной  ячейке  в словаре сразу
   3782						 ; после загрузки системы Форт,	т.е. при этом FENCE @ равно HERE-2
   3783
   3784						 HEAD	  82h,'D',320Q,$DP,$USE		      ;	DP
1  3785	      =ARRAY:1FBB		 LINK$=$
1  3786	1FBB  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3787							 ; 6 - признак immediate. 5- слово не описано smudge
1  3788	1FBC  44			     DB	 'D'
1  3789	1FBD  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  3790	1FBE  1FAFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3791	      =ARRAY:1FBB		 LINK=LINK$
1  3792	1FC0				 $DP LABEL FAR	; CFA
1  3793	1FC0  1EDDr			     DW	$USE
   3794	1FC2  0012				 DW 22Q	; указывает на первую свободную	ячейку словаря (DP @ = HERE)
   3795
   3796						 HEAD	  84h,'VOC',314Q,VOCL,$USE	      ;	VOCL
1  3797	      =ARRAY:1FC4		 LINK$=$
1  3798	1FC4  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3799							 ; 6 - признак immediate. 5- слово не описано smudge
1  3800	1FC5  56 4F 43			     DB	 'VOC'
1  3801	1FC8  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3802	1FC9  1FBBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3803	      =ARRAY:1FC4		 LINK=LINK$
1  3804	1FCB				 VOCL LABEL FAR	 ; CFA
1  3805	1FCB  1EDDr			     DW	$USE
   3806						 ; хранится адрес XVOC
   3807	1FCD  0014				 DW 24Q	; переменная  связи контекстных	словарей.
   3808
   3809						 HEAD	  85h,'FIRS',324Q,FIRST,$USE	      ;	FIRST
1  3810	      =ARRAY:1FCF		 LINK$=$
1  3811	1FCF  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3812							 ; 6 - признак immediate. 5- слово не описано smudge
1  3813	1FD0  46 49 52 53		     DB	 'FIRS'
1  3814	1FD4  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3815	1FD5  1FC4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3816	      =ARRAY:1FCF		 LINK=LINK$
1  3817	1FD7				 FIRST LABEL FAR  ; CFA
1  3818	1FD7  1EDDr			     DW	$USE
   3819	1FD9  0016				 DW 26Q	; адрес	первого	байта экранных буферов
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 68
forth.asm



   3820
   3821						 HEAD	  85h,'LIMI',324Q,LIMIT,$USE	      ;	LIMIT
1  3822	      =ARRAY:1FDB		 LINK$=$
1  3823	1FDB  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3824							 ; 6 - признак immediate. 5- слово не описано smudge
1  3825	1FDC  4C 49 4D 49		     DB	 'LIMI'
1  3826	1FE0  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3827	1FE1  1FCFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3828	      =ARRAY:1FDB		 LINK=LINK$
1  3829	1FE3				 LIMIT LABEL FAR  ; CFA
1  3830	1FE3  1EDDr			     DW	$USE
   3831	1FE5  0018				 DW 30Q	; указатель конца экранных буферов и некоторые другие
   3832
   3833						 HEAD	  83h,'AT',322Q,ATR,$USE	      ;	ATR
1  3834	      =ARRAY:1FE7		 LINK$=$
1  3835	1FE7  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3836							 ; 6 - признак immediate. 5- слово не описано smudge
1  3837	1FE8  41 54			     DB	 'AT'
1  3838	1FEA  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  3839	1FEB  1FDBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3840	      =ARRAY:1FE7		 LINK=LINK$
1  3841	1FED				 ATR LABEL FAR	; CFA
1  3842	1FED  1EDDr			     DW	$USE
   3843	1FEF  001A				 DW 32Q		 ;Атрибут
   3844
   3845						 HEAD	  82h,'P',307Q,PG,$USE		      ;	PG
1  3846	      =ARRAY:1FF1		 LINK$=$
1  3847	1FF1  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3848							 ; 6 - признак immediate. 5- слово не описано smudge
1  3849	1FF2  50			     DB	 'P'
1  3850	1FF3  C7			     DB	 307Q	; последний символ слова + 128 (7 бит =	1).
1  3851	1FF4  1FE7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3852	      =ARRAY:1FF1		 LINK=LINK$
1  3853	1FF6				 PG LABEL FAR  ; CFA
1  3854	1FF6  1EDDr			     DW	$USE
   3855	1FF8  001C				 DW 34Q		 ; Текущая страница
   3856
   3857						 HEAD	  83h,'BL',313Q,BLK,$USE	      ;	BLK
1  3858	      =ARRAY:1FFA		 LINK$=$
1  3859	1FFA  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3860							 ; 6 - признак immediate. 5- слово не описано smudge
1  3861	1FFB  42 4C			     DB	 'BL'
1  3862	1FFD  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  3863	1FFE  1FF1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3864	      =ARRAY:1FFA		 LINK=LINK$
1  3865	2000				 BLK LABEL FAR	; CFA
1  3866	2000  1EDDr			     DW	$USE
   3867	2002  001E				 DW 36Q	; 0  для  входного  буфера  и  номеру экрана
   3868							; в противном  случае
   3869
   3870						 HEAD	  82h,'I',316Q,$IN,$USE		      ;	IN
1  3871	      =ARRAY:2004		 LINK$=$
1  3872	2004  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3873							 ; 6 - признак immediate. 5- слово не описано smudge
1  3874	2005  49			     DB	 'I'
1  3875	2006  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  3876	2007  1FFAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 69
forth.asm



1  3877	      =ARRAY:2004		 LINK=LINK$
1  3878	2009				 $IN LABEL FAR	; CFA
1  3879	2009  1EDDr			     DW	$USE
   3880	200B  0020				 DW 40Q	; внутренний   указатель   входного   буфера
   3881
   3882						 HEAD	  83h,'PN',324Q,PNT,$USE	      ;	PNT
1  3883	      =ARRAY:200D		 LINK$=$
1  3884	200D  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3885							 ; 6 - признак immediate. 5- слово не описано smudge
1  3886	200E  50 4E			     DB	 'PN'
1  3887	2010  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3888	2011  2004r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3889	      =ARRAY:200D		 LINK=LINK$
1  3890	2013				 PNT LABEL FAR	; CFA
1  3891	2013  1EDDr			     DW	$USE
   3892	2015  0022				 DW 42Q		 ;Флаг-печати
   3893
   3894						 HEAD	  83h,'SC',322Q,SCR,$USE	      ;	SCR
1  3895	      =ARRAY:2017		 LINK$=$
1  3896	2017  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3897							 ; 6 - признак immediate. 5- слово не описано smudge
1  3898	2018  53 43			     DB	 'SC'
1  3899	201A  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  3900	201B  200Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3901	      =ARRAY:2017		 LINK=LINK$
1  3902	201D				 SCR LABEL FAR	; CFA
1  3903	201D  1EDDr			     DW	$USE
   3904	201F  0024				 DW 44Q	; для хранения текущего	значения номера	экрана
   3905							 ; только в list
   3906
   3907						 HEAD	  86h,'OFFSE',324Q,OFSET,$USE	     ; OFFSET
1  3908	      =ARRAY:2021		 LINK$=$
1  3909	2021  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  3910							 ; 6 - признак immediate. 5- слово не описано smudge
1  3911	2022  4F 46 46 53 45		     DB	 'OFFSE'
1  3912	2027  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3913	2028  2017r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3914	      =ARRAY:2021		 LINK=LINK$
1  3915	202A				 OFSET LABEL FAR  ; CFA
1  3916	202A  1EDDr			     DW	$USE
   3917	202C  0026				 DW 46Q	; Диагностические сообщения обычно размещаются
   3918						     ; на экранах 4 и 5. Если это не так, задачу можно решить,
   3919						     ; поменяв значение	OFFSET или исправив число, стоящее
   3920						     ; перед OFFSET в описании MESSAGE
   3921
   3922						 HEAD	  87h,'CONTEX',324Q,CONT,$USE	      ;	CONTEXT
1  3923	      =ARRAY:202E		 LINK$=$
1  3924	202E  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  3925							 ; 6 - признак immediate. 5- слово не описано smudge
1  3926	202F  43 4F 4E 54 45 58		     DB	 'CONTEX'
1  3927	2035  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3928	2036  2021r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3929	      =ARRAY:202E		 LINK=LINK$
1  3930	2038				 CONT LABEL FAR	 ; CFA
1  3931	2038  1EDDr			     DW	$USE
   3932					 ; Пребывание в	том  или ином  словаре	контролируется системной переменной
   3933					 ; CONTEXT,  в которой хранится	 ссылка	 на  адрес  последнего	слова,
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 70
forth.asm



   3934					 ; описанного  в  данном (контекстном) словаре.
   3935	203A  0028				 DW 50Q	; Указатель, с какого словаря следует начинать просмотр
   3936							; при интерпретации
   3937
   3938						 HEAD	 87h, 'CURREN',324Q,CURR,$USE	     ; CURRENT
1  3939	      =ARRAY:203C		 LINK$=$
1  3940	203C  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  3941							 ; 6 - признак immediate. 5- слово не описано smudge
1  3942	203D  43 55 52 52 45 4E		     DB	 'CURREN'
1  3943	2043  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3944	2044  202Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3945	      =ARRAY:203C		 LINK=LINK$
1  3946	2046				 CURR LABEL FAR	 ; CFA
1  3947	2046  1EDDr			     DW	$USE
   3948	2048  002A				 DW 52Q	 ; хранящая ссылку в слове Словаря на последнее	слово,
   3949							 ; описанное в текущем Словаре.	очевидно, что
   3950							 ; текущий Словарь может не совпадать с	контекстным
   3951							 ; это же адрес	latest
   3952
   3953						 HEAD	  85h,'STAT',305Q,STATE,$USE	      ;	STATE
1  3954	      =ARRAY:204A		 LINK$=$
1  3955	204A  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3956							 ; 6 - признак immediate. 5- слово не описано smudge
1  3957	204B  53 54 41 54		     DB	 'STAT'
1  3958	204F  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3959	2050  203Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3960	      =ARRAY:204A		 LINK=LINK$
1  3961	2052				 STATE LABEL FAR  ; CFA
1  3962	2052  1EDDr			     DW	$USE
   3963	2054  002C				 DW 54Q	 ; 0=> Исполнение
   3964
   3965						 HEAD	  84h,'BAS',305Q,BASE,$USE	      ;	BASE
1  3966	      =ARRAY:2056		 LINK$=$
1  3967	2056  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3968							 ; 6 - признак immediate. 5- слово не описано smudge
1  3969	2057  42 41 53			     DB	 'BAS'
1  3970	205A  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3971	205B  204Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3972	      =ARRAY:2056		 LINK=LINK$
1  3973	205D				 BASE LABEL FAR	 ; CFA
1  3974	205D  1EDDr			     DW	$USE
   3975	205F  002E				 DW 56Q	 ; система исчисления
   3976
   3977						 HEAD	  83h,'DP',314Q,DPL,$USE	      ;	DPL
1  3978	      =ARRAY:2061		 LINK$=$
1  3979	2061  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3980							 ; 6 - признак immediate. 5- слово не описано smudge
1  3981	2062  44 50			     DB	 'DP'
1  3982	2064  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3983	2065  2056r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3984	      =ARRAY:2061		 LINK=LINK$
1  3985	2067				 DPL LABEL FAR	; CFA
1  3986	2067  1EDDr			     DW	$USE
   3987	2069  0030				 DW 60Q	; DPL определяет положение десятичной запятой (во входном
   3988							; представлении	это точка), для	чисел одинарной	длины DPL=-1.
   3989
   3990						 HEAD	  83h,'CS',320Q,CSP,$USE	      ;	CSP
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 71
forth.asm



1  3991	      =ARRAY:206B		 LINK$=$
1  3992	206B  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3993							 ; 6 - признак immediate. 5- слово не описано smudge
1  3994	206C  43 53			     DB	 'CS'
1  3995	206E  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  3996	206F  2061r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3997	      =ARRAY:206B		 LINK=LINK$
1  3998	2071				 CSP LABEL FAR	; CFA
1  3999	2071  1EDDr			     DW	$USE
   4000	2073  0034				 DW 64Q
   4001
   4002						 HEAD	  82h,'R',243Q,RNUM,$USE	      ;	R#
1  4003	      =ARRAY:2075		 LINK$=$
1  4004	2075  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4005							 ; 6 - признак immediate. 5- слово не описано smudge
1  4006	2076  52			     DB	 'R'
1  4007	2077  A3			     DB	 243Q	; последний символ слова + 128 (7 бит =	1).
1  4008	2078  206Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4009	      =ARRAY:2075		 LINK=LINK$
1  4010	207A				 RNUM LABEL FAR	 ; CFA
1  4011	207A  1EDDr			     DW	$USE
   4012	207C  0036				 DW 66Q	; указатель  положения	курсора	 на  экране
   4013
   4014						 HEAD	  83h,'HL',304Q,HLD,$USE	      ;	HLD
1  4015	      =ARRAY:207E		 LINK$=$
1  4016	207E  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4017							 ; 6 - признак immediate. 5- слово не описано smudge
1  4018	207F  48 4C			     DB	 'HL'
1  4019	2081  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4020	2082  2075r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4021	      =ARRAY:207E		 LINK=LINK$
1  4022	2084				 HLD LABEL FAR	; CFA
1  4023	2084  1EDDr			     DW	$USE
   4024	2086  0038				 DW 70Q	; которая является указателем позиции
   4025							; в выходном буфере (обычно PAD)
   4026
   4027						 HEAD	  83h,'US',305Q,USE,$USE	      ;	USE
1  4028	      =ARRAY:2088		 LINK$=$
1  4029	2088  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4030							 ; 6 - признак immediate. 5- слово не описано smudge
1  4031	2089  55 53			     DB	 'US'
1  4032	208B  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4033	208C  207Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4034	      =ARRAY:2088		 LINK=LINK$
1  4035	208E				 USE LABEL FAR	; CFA
1  4036	208E  1EDDr			     DW	$USE
   4037	2090  003A				 DW 72Q	;
   4038						 ; A variable containing the address of	the block buffer to use	next,
   4039						 ; as the least	recently written.
   4040
   4041						 HEAD	  84h,'PRE',326Q,PREV,$USE	      ;	PREV
1  4042	      =ARRAY:2092		 LINK$=$
1  4043	2092  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4044							 ; 6 - признак immediate. 5- слово не описано smudge
1  4045	2093  50 52 45			     DB	 'PRE'
1  4046	2096  D6			     DB	 326Q	; последний символ слова + 128 (7 бит =	1).
1  4047	2097  2088r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 72
forth.asm



1  4048	      =ARRAY:2092		 LINK=LINK$
1  4049	2099				 PREV LABEL FAR	 ; CFA
1  4050	2099  1EDDr			     DW	$USE
   4051	209B  003C				 DW 74Q	; адрес	экранного блока
   4052						 ; A variable containing the address of	the disc buffer	most recently
   4053						 ; referenced. The UPDATE command marks	this buffer to be later	written
   4054						 ; to disc.
   4055
   4056						 HEAD	  83h,'$E',330Q,$EX,$USE	      ;	EXP
1  4057	      =ARRAY:209D		 LINK$=$
1  4058	209D  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4059							 ; 6 - признак immediate. 5- слово не описано smudge
1  4060	209E  24 45			     DB	 '$E'
1  4061	20A0  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  4062	20A1  2092r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4063	      =ARRAY:209D		 LINK=LINK$
1  4064	20A3				 $EX LABEL FAR	; CFA
1  4065	20A3  1EDDr			     DW	$USE
   4066	20A5  003E				 DW 76Q	 ; целочисленное значение  порядка  числа,
   4067							 ; который  следует  за	признаком Е
   4068
   4069						 HEAD	  83h,'ER',302Q,ERB,$USE	      ;	ERB
1  4070	      =ARRAY:20A7		 LINK$=$
1  4071	20A7  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4072							 ; 6 - признак immediate. 5- слово не описано smudge
1  4073	20A8  45 52			     DB	 'ER'
1  4074	20AA  C2			     DB	 302Q	; последний символ слова + 128 (7 бит =	1).
1  4075	20AB  209Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4076	      =ARRAY:20A7		 LINK=LINK$
1  4077	20AD				 ERB LABEL FAR	; CFA
1  4078	20AD  1EDDr			     DW	$USE
   4079	20AF  0040				 DW 100Q ; 64d 40h
   4080						 ; Если	ERB=0,	ERROR  работает	 обычным  образом,  в противном	случае
   4081						 ; переменная ERB обнуляется,  а уход из  программы  в	Форт  через  QUIT
   4082						 ; блокируется.
   4083
   4084						 HEAD	  83h,'DE','B'+80h,DEB,$USE		 ; DEB
1  4085	      =ARRAY:20B1		 LINK$=$
1  4086	20B1  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4087							 ; 6 - признак immediate. 5- слово не описано smudge
1  4088	20B2  44 45			     DB	 'DE'
1  4089	20B4  C2			     DB	 'B'+80h   ; последний символ слова + 128 (7 бит = 1).
1  4090	20B5  20A7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4091	      =ARRAY:20B1		 LINK=LINK$
1  4092	20B7				 DEB LABEL FAR	; CFA
1  4093	20B7  1EDDr			     DW	$USE
   4094	20B9  0042				 DW 102Q  ; признак отладки  66d
   4095							 ;
   4096
   4097					     ;** Слова высокого	уровня **
   4098
   4099						 HEAD	  85h,'?TER',315Q,?TERM,$COL	      ;	?TERM
1  4100	      =ARRAY:20BB		 LINK$=$
1  4101	20BB  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4102							 ; 6 - признак immediate. 5- слово не описано smudge
1  4103	20BC  3F 54 45 52		     DB	 '?TER'
1  4104	20C0  CD			     DB	 315Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 73
forth.asm



1  4105	20C1  20B1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4106	      =ARRAY:20BB		 LINK=LINK$
1  4107	20C3				 ?TERM LABEL FAR  ; CFA
1  4108	20C3  1E51r			     DW	$COL
   4109					 ; вывод в стек	кода символа из	буфера клавиатуры без ожидания нажатия
   4110	20C5  14BAr 0FD3r 00FF	  +		 DW ?TER$,LIT,377Q,$AND,SEMI
   4111	      1733r 1815r
   4112
   4113						 HEAD	  82h,'C',322Q,CR,$COL		      ;	CR
1  4114	      =ARRAY:20CF		 LINK$=$
1  4115	20CF  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4116							 ; 6 - признак immediate. 5- слово не описано smudge
1  4117	20D0  43			     DB	 'C'
1  4118	20D1  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4119	20D2  20BBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4120	      =ARRAY:20CF		 LINK=LINK$
1  4121	20D4				 CR LABEL FAR  ; CFA
1  4122	20D4  1E51r			     DW	$COL
   4123					 ; вывод символов 0D 0A
   4124	20D6  0FD3r 000D 1356r	  +		 DW LIT,15Q,EMIT,LIT,12Q,EMIT,SEMI
   4125	      0FD3r 000A 1356r	  +
   4126	      1815r
   4127
   4128						 HEAD	  81h,,254Q,COMMA,$COL		      ;	,
1  4129	      =ARRAY:20E4		 LINK$=$
1  4130	20E4  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  4131							 ; 6 - признак immediate. 5- слово не описано smudge
1  4132	20E5  AC			     DB	 254Q	; последний символ слова + 128 (7 бит =	1).
1  4133	20E6  20CFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4134	      =ARRAY:20E4		 LINK=LINK$
1  4135	20E8				 COMMA LABEL FAR  ; CFA
1  4136	20E8  1E51r			     DW	$COL
   4137					 ; в  свободную	ячейку словаря помещяем	число из стека и
   4138					 ;  занимаем эту ячейку	(смещаем указатель here)
   4139	20EA  1C2Br 1B86r 1F4Ar	  +		 DW HERE,STORE,TWO,ALLOT,SEMI
   4140	      1C49r 1815r
   4141
   4142						 HEAD	  82h,'C',254Q,CCOM,$COL	      ;	C,
1  4143	      =ARRAY:20F4		 LINK$=$
1  4144	20F4  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4145							 ; 6 - признак immediate. 5- слово не описано smudge
1  4146	20F5  43			     DB	 'C'
1  4147	20F6  AC			     DB	 254Q	; последний символ слова + 128 (7 бит =	1).
1  4148	20F7  20E4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4149	      =ARRAY:20F4		 LINK=LINK$
1  4150	20F9				 CCOM LABEL FAR	 ; CFA
1  4151	20F9  1E51r			     DW	$COL
   4152	20FB  1C2Br 1BA2r 1F42r	  +		 DW HERE,CSTOR,ONE,ALLOT,SEMI
   4153	      1C49r 1815r
   4154
   4155						 HEAD	   85h,'SPAC',305Q,SPACE,$COL	      ;	SPACE
1  4156	      =ARRAY:2105		 LINK$=$
1  4157	2105  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4158							 ; 6 - признак immediate. 5- слово не описано smudge
1  4159	2106  53 50 41 43		     DB	 'SPAC'
1  4160	210A  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4161	210B  20F4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 74
forth.asm



1  4162	      =ARRAY:2105		 LINK=LINK$
1  4163	210D				 SPACE LABEL FAR  ; CFA
1  4164	210D  1E51r			     DW	$COL
   4165	210F  1F63r 1356r 1815r			 DW BLAN,EMIT,SEMI
   4166
   4167						  HEAD	  83h,'PF','A'+80h,PFA,$COL	      ;	PFA
1  4168	      =ARRAY:2115		 LINK$=$
1  4169	2115  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4170							 ; 6 - признак immediate. 5- слово не описано smudge
1  4171	2116  50 46			     DB	 'PF'
1  4172	2118  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  4173	2119  2105r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4174	      =ARRAY:2115		 LINK=LINK$
1  4175	211B				 PFA LABEL FAR	; CFA
1  4176	211B  1E51r			     DW	$COL
   4177					 ; NFA -> PFA
   4178	211D  1F42r 1C67r 0FD3r	  +		  DW  ONE,TRAV,LIT,5,PLUS,SEMI
   4179	      0005 1677r 1815r
   4180
   4181						  HEAD	  83h,'?E',322Q,QERR,$COL	      ;	?ER
1  4182	      =ARRAY:2129		 LINK$=$
1  4183	2129  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4184							 ; 6 - признак immediate. 5- слово не описано smudge
1  4185	212A  3F 45			     DB	 '?E'
1  4186	212C  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4187	212D  2115r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4188	      =ARRAY:2129		 LINK=LINK$
1  4189	212F				 QERR LABEL FAR	 ; CFA
1  4190	212F  1E51r			     DW	$COL
   4191					 ; f errorcode -> если f=0, то без ошибок
   4192	2131  1952r 101Ar 0006	  +		  DW  SWAP,ZBRAN,TTT-$,ERROR,SEMI
   4193	      24CDr 1815r
   4194	213B  1A49r 1815r		TTT:	  DW  DROP,SEMI
   4195
   4196						  HEAD	  85h,'?COM',320Q,QCOMP,$COL	      ;	?COMP
1  4197	      =ARRAY:213F		 LINK$=$
1  4198	213F  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4199							 ; 6 - признак immediate. 5- слово не описано smudge
1  4200	2140  3F 43 4F 4D		     DB	 '?COM'
1  4201	2144  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  4202	2145  2129r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4203	      =ARRAY:213F		 LINK=LINK$
1  4204	2147				 QCOMP LABEL FAR  ; CFA
1  4205	2147  1E51r			     DW	$COL
   4206					     ; проверка	режима работы. система в режиме	компиляции?
   4207	2149  2052r 1B4Er 1164r	  +		  DW  STATE,AT,ZEQU,LIT,21Q,QERR,SEMI	     ; 17
   4208	      0FD3r 0011 212Fr	  +
   4209	      1815r
   4210
   4211						  HEAD	  85h,'?EXE',303Q,QEXEC,$COL	      ;	?EXEC
1  4212	      =ARRAY:2157		 LINK$=$
1  4213	2157  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4214							 ; 6 - признак immediate. 5- слово не описано smudge
1  4215	2158  3F 45 58 45		     DB	 '?EXE'
1  4216	215C  C3			     DB	 303Q	; последний символ слова + 128 (7 бит =	1).
1  4217	215D  213Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4218	      =ARRAY:2157		 LINK=LINK$
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 75
forth.asm



1  4219	215F				 QEXEC LABEL FAR  ; CFA
1  4220	215F  1E51r			     DW	$COL
   4221					     ; проверка	режима исполнения    0=> Исполнение
   4222	2161  2052r 1B4Er 0FD3r	  +		  DW  STATE,AT,LIT,22Q,QERR,SEMI	     ; 18
   4223	      0012 212Fr 1815r
   4224
   4225						  HEAD	  85h,'?PAI',322Q,QPAIR,$COL	      ;	?PAIR
1  4226	      =ARRAY:216D		 LINK$=$
1  4227	216D  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4228							 ; 6 - признак immediate. 5- слово не описано smudge
1  4229	216E  3F 50 41 49		     DB	 '?PAI'
1  4230	2172  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4231	2173  2157r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4232	      =ARRAY:216D		 LINK=LINK$
1  4233	2175				 QPAIR LABEL FAR  ; CFA
1  4234	2175  1E51r			     DW	$COL
   4235	2177  1693r 0FD3r 0013	  +		  DW  SUBB,LIT,23Q,QERR,SEMI
   4236	      212Fr 1815r
   4237
   4238						  HEAD	  84h,'?CS',320Q,QCSP,$COL	      ;	?CSP
1  4239	      =ARRAY:2181		 LINK$=$
1  4240	2181  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4241							 ; 6 - признак immediate. 5- слово не описано smudge
1  4242	2182  3F 43 53			     DB	 '?CS'
1  4243	2185  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  4244	2186  216Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4245	      =ARRAY:2181		 LINK=LINK$
1  4246	2188				 QCSP LABEL FAR	 ; CFA
1  4247	2188  1E51r			     DW	$COL
   4248					     ; контролируют сохранение указателя
   4249					     ; стека параметров	в процессе интерпретации слова
   4250					     ; текущее и сохраненное значение стека должны быть	равны
   4251	218A  17D0r 2071r 1B4Er	  +		  DW  SPAT,CSP,AT,SUBB,LIT,24Q,QERR,SEMI
   4252	      1693r 0FD3r 0014	  +
   4253	      212Fr 1815r
   4254
   4255						  HEAD	  85h,'?LOA',304Q,QLOAD,$COL	      ;	?LOAD
1  4256	      =ARRAY:219A		 LINK$=$
1  4257	219A  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4258							 ; 6 - признак immediate. 5- слово не описано smudge
1  4259	219B  3F 4C 4F 41		     DB	 '?LOA'
1  4260	219F  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4261	21A0  2181r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4262	      =ARRAY:219A		 LINK=LINK$
1  4263	21A2				 QLOAD LABEL FAR  ; CFA
1  4264	21A2  1E51r			     DW	$COL
   4265					     ; ошибка, если не вовремя загрузки
   4266	21A4  2000r 1B4Er 1164r	  +		  DW  BLK,AT,ZEQU,LIT,26Q,QERR,SEMI	 ; 22
   4267	      0FD3r 0016 212Fr	  +
   4268	      1815r
   4269
   4270						  HEAD	  87h,'COMPIL',305Q,COMP,$COL	      ;	COMPILE
1  4271	      =ARRAY:21B2		 LINK$=$
1  4272	21B2  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  4273							 ; 6 - признак immediate. 5- слово не описано smudge
1  4274	21B3  43 4F 4D 50 49 4C		     DB	 'COMPIL'
1  4275	21B9  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 76
forth.asm



1  4276	21BA  219Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4277	      =ARRAY:21B2		 LINK=LINK$
1  4278	21BC				 COMP LABEL FAR	 ; CFA
1  4279	21BC  1E51r			     DW	$COL
   4280					 ; Компиляция исполнительного адреса, следующего за оператором
   4281	21BE  2147r 188Fr 1872r	  +		  DW  QCOMP,I,FROMR,TWOP,TOR,AT,COMMA,SEMI
   4282	      1546r 1854r 1B4Er	  +
   4283	      20E8r 1815r
   4284
   4285						  HEAD	  84h,'SMU',307Q,SMUG,$COL	      ;	SMUDGE
1  4286	      =ARRAY:21CE		 LINK$=$
1  4287	21CE  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4288							 ; 6 - признак immediate. 5- слово не описано smudge
1  4289	21CF  53 4D 55			     DB	 'SMU'
1  4290	21D2  C7			     DB	 307Q	; последний символ слова + 128 (7 бит =	1).
1  4291	21D3  21B2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4292	      =ARRAY:21CE		 LINK=LINK$
1  4293	21D5				 SMUG LABEL FAR	 ; CFA
1  4294	21D5  1E51r			     DW	$COL
   4295					     ; сбрасывает 5-й бит первого байта	 описания  и  тем  самым
   4296					     ; делает	данное	 слово	полноправным  членом  текущего	словаря
   4297	21D7  1D25r 1F63r 1B33r	  +		  DW  LATES,BLAN,TOGL,SEMI
   4298	      1815r
   4299
   4300						  HEAD	  87h,'(;CODE',251Q,PSCOD,$COL	      ;	(;CODE)
1  4301	      =ARRAY:21DF		 LINK$=$
1  4302	21DF  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  4303							 ; 6 - признак immediate. 5- слово не описано smudge
1  4304	21E0  28 3B 43 4F 44 45		     DB	 '(;CODE'
1  4305	21E6  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1  4306	21E7  21CEr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4307	      =ARRAY:21DF		 LINK=LINK$
1  4308	21E9				 PSCOD LABEL FAR  ; CFA
1  4309	21E9  1E51r			     DW	$COL
   4310					     ; адрес из	стека возвратов	(там находится адрес начала кода на ассемблере)
   4311					     ; пишем в CFA последнего определенного слова
   4312					     ; таким образом в CFA будет свой код интерпретатора на ассемблере
   4313	21EB  1872r 1D25r 211Br	  +		  DW  FROMR,LATES,PFA,CFA,STORE,SEMI
   4314	      1BEFr 1B86r 1815r
   4315
   4316						  HEAD	  87h,'#BUILD',323Q,BUILD,$COL	      ;	<BUILDS	;
1  4317	      =ARRAY:21F7		 LINK$=$
1  4318	21F7  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  4319							 ; 6 - признак immediate. 5- слово не описано smudge
1  4320	21F8  23 42 55 49 4C 44		     DB	 '#BUILD'
1  4321	21FE  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  4322	21FF  21DFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4323	      =ARRAY:21F7		 LINK=LINK$
1  4324	2201				 BUILD LABEL FAR  ; CFA
1  4325	2201  1E51r			     DW	$COL
   4326					     ; формирует в словаре описание константы равной 0 с именем	XXX
   4327	2203  1F3Ar 1E8Ar 1815r			  DW  ZERO,CON,SEMI
   4328
   4329						  HEAD	  85h,'COUN',324Q,COUNT,$COL	      ;	COUNT
1  4330	      =ARRAY:2209		 LINK$=$
1  4331	2209  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4332							 ; 6 - признак immediate. 5- слово не описано smudge
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 77
forth.asm



1  4333	220A  43 4F 55 4E		     DB	 'COUN'
1  4334	220E  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4335	220F  21F7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4336	      =ARRAY:2209		 LINK=LINK$
1  4337	2211				 COUNT LABEL FAR  ; CFA
1  4338	2211  1E51r			     DW	$COL
   4339					     ; addr1 --- addr2 n
   4340					     ; адрес HERE+1 (это адрес первого байта слова)
   4341					     ; и число символов	в  слове  (HERE	 C@)
   4342	2213  199Er				  DW  DUBL	     ; addr1 addr1
   4343	2215  152Br 1952r			  DW  ONEP,SWAP	     ; addr1+1 addr1
   4344	2219  1B69r 1815r			  DW  CAT,SEMI	     ; addr1+1 u8(addr1)
   4345
   4346						  HEAD	  84h,'TYP',305Q,$TYPE,$COL	      ;	TYPE
1  4347	      =ARRAY:221D		 LINK$=$
1  4348	221D  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4349							 ; 6 - признак immediate. 5- слово не описано smudge
1  4350	221E  54 59 50			     DB	 'TYP'
1  4351	2221  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4352	2222  2209r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4353	      =ARRAY:221D		 LINK=LINK$
1  4354	2224				 $TYPE LABEL FAR  ; CFA
1  4355	2224  1E51r			     DW	$COL
   4356					 ; адр count ->	вывод строки на	экран
   4357	2226  19BBr 101Ar 001C	  +		  DW  DDUP,ZBRAN,TC1-$,ZERO,XDO
   4358	      1F3Ar 105Br
   4359	2230  199Er 188Fr 1677r	  +	TC0:	  DW  DUBL,I,PLUS,CAT,LIT,177Q,$AND
   4360	      1B69r 0FD3r 007F	  +
   4361	      1733r
   4362	223E  1F42r 131Br 1084r	  +		  DW  ONE,EMI$,XLOOP,TC0-$
   4363	      FFEC
   4364	2246  1A49r 1815r		TC1:	  DW  DROP,SEMI
   4365
   4366						  HEAD	  84h,'(."',251Q,PDOTQ,$COL	      ;	(.")
1  4367	      =ARRAY:224A		 LINK$=$
1  4368	224A  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4369							 ; 6 - признак immediate. 5- слово не описано smudge
1  4370	224B  28 2E 22			     DB	 '(."'
1  4371	224E  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1  4372	224F  221Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4373	      =ARRAY:224A		 LINK=LINK$
1  4374	2251				 PDOTQ LABEL FAR  ; CFA
1  4375	2251  1E51r			     DW	$COL
   4376	2253  188Fr				  DW  I	     ; при исполнении следующее	число -
   4377							     ; число символов сохраняется в RS
   4378	2255  2211r 199Er 152Br			  DW COUNT,DUBL,ONEP
   4379	225B  1872r 1677r 1854r	  +		  DW  FROMR,PLUS,TOR,$TYPE,SEMI
   4380	      2224r 1815r
   4381
   4382						  HEAD	  302Q,'.',242Q,D0TQ,$COL	       ; ."
1  4383	      =ARRAY:2265		 LINK$=$
1  4384	2265  C2			     DB	 302Q  ; NFA 7 бит равен 1.
1  4385							 ; 6 - признак immediate. 5- слово не описано smudge
1  4386	2266  2E			     DB	 '.'
1  4387	2267  A2			     DB	 242Q	; последний символ слова + 128 (7 бит =	1).
1  4388	2268  224Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4389	      =ARRAY:2265		 LINK=LINK$
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 78
forth.asm



1  4390	226A				 D0TQ LABEL FAR	 ; CFA
1  4391	226A  1E51r			     DW	$COL
   4392	226C  0FD3r 0022 2052r	  +		  DW  LIT,34,STATE,AT,ZBRAN,XT-$
   4393	      1B4Er 101Ar 0012
   4394	2278  21BCr 2251r 22EBr	  +		  DW  COMP,PDOTQ,$WORD,HERE,CAT,ONEP
   4395	      1C2Br 1B69r 152Br
   4396	2284  1C49r 1815r			  DW  ALLOT, SEMI
   4397	2288  22EBr 1C2Br 2211r	  +	XT:	  DW  $WORD,HERE,COUNT,$TYPE,SEMI
   4398	      2224r 1815r
   4399
   4400						  HEAD	  85h,'QUER',331Q,QUERY,$COL	      ;	QUERY
1  4401	      =ARRAY:2292		 LINK$=$
1  4402	2292  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4403							 ; 6 - признак immediate. 5- слово не описано smudge
1  4404	2293  51 55 45 52		     DB	 'QUER'
1  4405	2297  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  4406	2298  2265r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4407	      =ARRAY:2292		 LINK=LINK$
1  4408	229A				 QUERY LABEL FAR  ; CFA
1  4409	229A  1E51r			     DW	$COL
   4410					 ; входной буфер,  адрес которого хранится в системной переменной
   4411					 ; по имени TIB	(Terminal Input	Buffer).  Ввод	в  этот	 буфер
   4412					 ; осуществляется оператором QUERY
   4413	229C  1F91r 1B4Er 1BEFr	  +		  DW  TIB,AT,CFA,LIT,120Q,EXPE
   4414	      0FD3r 0050 1489r
   4415	22A8  1F3Ar 2009r 1B86r	  +		  DW  ZERO,$IN,STORE,CR,SEMI
   4416	      20D4r 1815r
   4417
   4418						  HEAD	  301Q,,200Q,NULL,$COL		       ; NULL
1  4419	      =ARRAY:22B2		 LINK$=$
1  4420	22B2  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  4421							 ; 6 - признак immediate. 5- слово не описано smudge
1  4422	22B3  80			     DB	 200Q	; последний символ слова + 128 (7 бит =	1).
1  4423	22B4  2292r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4424	      =ARRAY:22B2		 LINK=LINK$
1  4425	22B6				 NULL LABEL FAR	 ; CFA
1  4426	22B6  1E51r			     DW	$COL
   4427					 ; немедленного	исполнения. исполняется, если встретился 0 в коде
   4428					 ; прерывает бесконечное испольнение INTERPRET
   4429	22B8  2000r 1B4Er 101Ar	  +		  DW  BLK,AT,ZBRAN,NUL-$	 ; если	пультовый режим
   4430	      0010
   4431	22C0  1F42r 2000r 1AF9r	  +		  DW  ONE,BLK,PSTOR,ZERO,$IN,STORE,QEXEC
   4432	      1F3Ar 2009r 1B86r	  +
   4433	      215Fr
   4434	22CE  18EDr 1815r		NUL:	  DW  LEV,SEMI
   4435
   4436						  HEAD	  83h,'PA',304Q,PAD,$COL	      ;	PAD
1  4437	      =ARRAY:22D2		 LINK$=$
1  4438	22D2  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4439							 ; 6 - признак immediate. 5- слово не описано smudge
1  4440	22D3  50 41			     DB	 'PA'
1  4441	22D5  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4442	22D6  22B2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4443	      =ARRAY:22D2		 LINK=LINK$
1  4444	22D8				 PAD LABEL FAR	; CFA
1  4445	22D8  1E51r			     DW	$COL
   4446					     ; Многие операции	 выдачи	  результатов	и   сообщений	на   экран
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 79
forth.asm



   4447					     ; производятся   через   специальный   буфер,   адрес   которого  смещен
   4448					     ; относительно HERE.  В базовом словаре имеется  оператор	PAD,  который
   4449					     ; выдает в	стек адрес КОНЦА этого буфера:
   4450	22DA  1C2Br 0FD3r 0044	  +		  DW  HERE,LIT,104Q,PLUS,SEMI
   4451	      1677r 1815r
   4452
   4453						  HEAD	  84h,'WOR',304Q,$WORD,$COL	      ;	WORD
1  4454	      =ARRAY:22E4		 LINK$=$
1  4455	22E4  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4456							 ; 6 - признак immediate. 5- слово не описано smudge
1  4457	22E5  57 4F 52			     DB	 'WOR'
1  4458	22E8  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4459	22E9  22D2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4460	      =ARRAY:22E4		 LINK=LINK$
1  4461	22EB				 $WORD LABEL FAR  ; CFA
1  4462	22EB  1E51r			     DW	$COL
   4463					     ; разделитель -> число_символов строка по адресу here
   4464	22ED  2000r 1B4Er 19BBr	  +		  DW  BLK,AT,DDUP,ZBRAN,WD1-$; ввод с клавиатуры
   4465	      101Ar 0008
   4466	22F7  27F8r 103Fr 0006			  DW  BLOCK,BRAN,WD2-$	     ; адрес буфера из переменной BLK
   4467	22FD  1F91r 1B4Er		WD1:	  DW  TIB,AT		     ; адрес входного терминала
   4468	2301  2009r 1B4Er 1677r	  +	WD2:	  DW  $IN,AT,PLUS,SWAP,ENCL,HERE,BLAN,BLANK,$IN
   4469	      1952r 126Ar 1C2Br	  +
   4470	      1F63r 1ACAr 2009r
   4471	2313  1AF9r 1854r 188Fr	  +		  DW  PSTOR,TOR,I,HERE,CSTOR
   4472	      1C2Br 1BA2r
   4473	231D  1C2Br 152Br 1872r	  +		  DW  HERE,ONEP,FROMR,CMOV,SEMI
   4474	      1A67r 1815r
   4475
   4476						  HEAD	  88h,'(NUMBER',251Q,PNUMB,$COL	      ;	(NUMBER)
1  4477	      =ARRAY:2327		 LINK$=$
1  4478	2327  88			     DB	 88h  ;	NFA 7 бит равен	1.
1  4479							 ; 6 - признак immediate. 5- слово не описано smudge
1  4480	2328  28 4E 55 4D 42 45	52	     DB	 '(NUMBER'
1  4481	232F  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1  4482	2330  22E4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4483	      =ARRAY:2327		 LINK=LINK$
1  4484	2332				 PNUMB LABEL FAR  ; CFA
1  4485	2332  1E51r			     DW	$COL
   4486	2334  152Br 1854r 188Fr	  +	BN:	  DW  ONEP,TOR,I,CAT,BASE,AT,DIGIT,ZBRAN,MMO-$
   4487	      1B69r 205Dr 1B4Er	  +
   4488	      1142r 101Ar 002C
   4489	2346  1952r 205Dr 1B4Er	  +		  DW  SWAP,BASE,AT,USTAR,DROP,ROT,BASE,AT,USTAR
   4490	      15B6r 1A49r 19EBr	  +
   4491	      205Dr 1B4Er 15B6r
   4492	2358  16B0r 2067r 1B4Er	  +		  DW  DPLUS,DPL,AT,ONEP,ZBRAN,BN1-$,ONE,DPL,PSTOR
   4493	      152Br 101Ar 0008	  +
   4494	      1F42r 2067r 1AF9r
   4495	236A  1872r 103Fr FFC6		BN1:	  DW  FROMR,BRAN,BN-$
   4496	2370  1872r 1815r		MMO:	  DW  FROMR,SEMI
   4497
   4498						  HEAD	  85h,'-FIN',304Q,DFIND,$COL	      ;	-FIND
1  4499	      =ARRAY:2374		 LINK$=$
1  4500	2374  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4501							 ; 6 - признак immediate. 5- слово не описано smudge
1  4502	2375  2D 46 49 4E		     DB	 '-FIN'
1  4503	2379  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 80
forth.asm



1  4504	237A  2327r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4505	      =ARRAY:2374		 LINK=LINK$
1  4506	237C				 DFIND LABEL FAR  ; CFA
1  4507	237C  1E51r			     DW	$COL
   4508					     ; Поиск слова в словаре, которое следует следующим	в тексте программы
   4509	237E  1F63r 22EBr 1C2Br	  +		  DW  BLAN,$WORD,HERE,COUNT,UPPER,HERE
   4510	      2211r 1D6Fr 1C2Br
   4511	238A  2038r 1B4Er 1B4Er			  DW  CONT,AT,AT ; поиска в контекстном	словаре
   4512	2390  10D3r 19BBr 1164r	  +		  DW  PFIND,DDUP,ZEQU,ZBRAN,FIN-$,HERE,LATES,PFIND
   4513	      101Ar 0008 1C2Br	  +
   4514	      1D25r 10D3r
   4515	23A0  1815r			FIN:	  DW  SEMI
   4516
   4517						  HEAD	  86h,'NUMBE',322Q,NUMB,$COL	      ;	NUMBER
1  4518	      =ARRAY:23A2		 LINK$=$
1  4519	23A2  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  4520							 ; 6 - признак immediate. 5- слово не описано smudge
1  4521	23A3  4E 55 4D 42 45		     DB	 'NUMBE'
1  4522	23A8  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4523	23A9  2374r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4524	      =ARRAY:23A2		 LINK=LINK$
1  4525	23AB				 NUMB LABEL FAR	 ; CFA
1  4526	23AB  1E51r			     DW	$COL
   4527	23AD  1F3Ar 20A3r 1B86r	  +		  DW  ZERO,$EX,STORE,BASE,AT,ZERO,ROT
   4528	      205Dr 1B4Er 1F3Ar	  +
   4529	      19EBr
   4530	23BB  152Br 199Er 1B69r	  +		  DW  ONEP,DUBL,CAT,DUBL,LIT,53Q,EQUAL
   4531	      199Er 0FD3r 002B	  +
   4532	      11D9r
   4533	23C9  101Ar 000A 1CE4r	  +		  DW  ZBRAN,NH1-$,DECIMA,DROP,BRAN,NH4-$
   4534	      1A49r 103Fr 002E
   4535	23D5  199Er 0FD3r 002D	  +	NH1:	  DW  DUBL,LIT,55Q,EQUAL,ZBRAN,NH2-$,DROP,DECIMA
   4536	      11D9r 101Ar 0012	  +
   4537	      1A49r 1CE4r
   4538	23E5  1952r 1A49r 1F42r	  +		  DW  SWAP,DROP,ONE,SWAP,BRAN,NH4-$
   4539	      1952r 103Fr 0012
   4540	23F1  0FD3r 0027 11D9r	  +	NH2:	  DW  LIT,47Q,EQUAL,ZBRAN,NH3-$,OCTAL,ONEP
   4541	      101Ar 0006 1D04r	  +
   4542	      152Br
   4543	23FF  1563r			NH3:	  DW  ONEM
   4544	2401  0FD3r FFFF 2067r	  +	NH4:	  DW  LIT,-1,DPL,STORE,ZERO,ZERO,ROT,PNUMB,DUBL
   4545	      1B86r 1F3Ar 1F3Ar	  +
   4546	      19EBr 2332r 199Er
   4547	2413  1B69r 1F63r 1693r	  +		  DW  CAT,BLAN,SUBB,ZBRAN,NH6-$
   4548	      101Ar 0088
   4549	241D  199Er 1B69r 0FD3r	  +		  DW  DUBL,CAT,LIT,56Q,EQUAL,ZBRAN,EXP-$
   4550	      002E 11D9r 101Ar	  +
   4551	      0016
   4552	242B  1F3Ar 2067r 1B86r	  +		  DW  ZERO,DPL,STORE,PNUMB,DUBL,CAT,BLAN,SUBB,ZBRAN,NH6-$
   4553	      2332r 199Er 1B69r	  +
   4554	      1F63r 1693r 101Ar	  +
   4555	      0066
   4556	243F  2067r 1B4Er 1952r	  +	EXP:	  DW  DPL,AT,SWAP,DUBL,CAT,LIT
   4557	      199Er 1B69r 0FD3r
   4558	244B  0045 11D9r 101Ar	  +		  DW  105Q,EQUAL,ZBRAN,ER1-$,ONEP,DUBL,CAT
   4559	      0068 152Br 199Er	  +
   4560	      1B69r
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 81
forth.asm



   4561	2459  0FD3r 002D 11D9r	  +		  DW  LIT,55Q,EQUAL,ZBRAN,NEMI-$,ONE,BRAN,NH0-$
   4562	      101Ar 0008 1F42r	  +
   4563	      103Fr 0014
   4564	2469  199Er 1B69r 0FD3r	  +	NEMI:	  DW  DUBL,CAT,LIT,53Q,SUBB,ZBRAN,PLU-$,ONEM
   4565	      002B 1693r 101Ar	  +
   4566	      0004 1563r
   4567	2479  1F3Ar			PLU:	  DW  ZERO
   4568	247B  1952r 1F3Ar 1F3Ar	  +	NH0:	  DW  SWAP,ZERO,ZERO,ROT,PNUMB,CAT,BLAN,EQUAL,ZBRAN,ER-$
   4569	      19EBr 2332r 1B69r	  +
   4570	      1F63r 11D9r 101Ar	  +
   4571	      0028
   4572	248F  1A49r 1952r 101Ar	  +		  DW  DROP,SWAP,ZBRAN,NH5-$,MINUS
   4573	      0004 16D6r
   4574	2499  20A3r 1B86r 2067r	  +	NH5:	  DW  $EX,STORE,DPL,STORE,ZERO
   4575	      1B86r 1F3Ar
   4576	24A3  1A49r 19EBr 101Ar	  +	NH6:	  DW  DROP,ROT,ZBRAN,NH7-$,DMINU
   4577	      0004 1615r
   4578	24AD  19EBr 205Dr 1B86r	  +	NH7:	  DW  ROT,BASE,STORE,SEMI
   4579	      1815r
   4580	24B5  1A2Cr 1A49r		ER:	  DW  DDROP,DROP
   4581	24B9  1A2Cr 1A2Cr 1A49r	  +	ER1:	  DW  DDROP,DDROP,DROP,ZERO,ERROR,SEMI
   4582	      1F3Ar 24CDr 1815r
   4583
   4584						  HEAD	  85h,'ERRO',322Q,ERROR,$COL	      ;	ERROR
1  4585	      =ARRAY:24C5		 LINK$=$
1  4586	24C5  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4587							 ; 6 - признак immediate. 5- слово не описано smudge
1  4588	24C6  45 52 52 4F		     DB	 'ERRO'
1  4589	24CA  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4590	24CB  23A2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4591	      =ARRAY:24C5		 LINK=LINK$
1  4592	24CD				 ERROR LABEL FAR  ; CFA
1  4593	24CD  1E51r			     DW	$COL
   4594	24CF  1C2Br 2211r 2224r	  +		  DW  HERE,COUNT,$TYPE,PDOTQ
   4595	      2251r
   4596	24D7  03 20 3F 20			  DB  3	, ' ? '
   4597	24DB  20ADr 1B4Er 101Ar	  +		  DW  ERB,AT,ZBRAN,XER-$
   4598	      000C
   4599	24E3  1F3Ar 20ADr 1B86r	  +		  DW  ZERO,ERB,STORE,DROP,SEMI
   4600	      1A49r 1815r
   4601	24ED  2872r 17DDr 2680r		XER:	  DW  MESS,SPSTO,QUIT
   4602
   4603						  HEAD	  83h,'ID',256Q,IDDOT,$COL	      ;	ID.
1  4604	      =ARRAY:24F3		 LINK$=$
1  4605	24F3  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4606							 ; 6 - признак immediate. 5- слово не описано smudge
1  4607	24F4  49 44			     DB	 'ID'
1  4608	24F6  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  4609	24F7  24C5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4610	      =ARRAY:24F3		 LINK=LINK$
1  4611	24F9				 IDDOT LABEL FAR  ; CFA
1  4612	24F9  1E51r			     DW	$COL
   4613					     ; печатает	  имя	слова
   4614	24FB  2211r 0FD3r 001F	  +		  DW  COUNT,LIT,37Q,$AND,$TYPE,SPACE,SEMI
   4615	      1733r 2224r 210Dr	  +
   4616	      1815r
   4617
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 82
forth.asm



   4618						  HEAD	  86h,'CREAT',305Q,CREAT,$COL	      ;	CREATE	- --> адр XXX (I, C)
1  4619	      =ARRAY:2509		 LINK$=$
1  4620	2509  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  4621							 ; 6 - признак immediate. 5- слово не описано smudge
1  4622	250A  43 52 45 41 54		     DB	 'CREAT'
1  4623	250F  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4624	2510  24F3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4625	      =ARRAY:2509		 LINK=LINK$
1  4626	2512				 CREAT LABEL FAR  ; CFA
1  4627	2512  1E51r			     DW	$COL
   4628					     ; формирование новых слов - описателей.
   4629					     ; (CREATE XXX DOES>) XXX исполняется на этапе компиляции,
   4630					     ; текст программы,	следующий за DOES>, адрес которого
   4631					     ; помещается в PFA	- на этапе исполнения.
   4632	2514  237Cr 101Ar 0010	  +		  DW  DFIND,ZBRAN,CRE-$,DROP,TWOP,NFA,IDDOT
   4633	      1A49r 1546r 1BBFr	  +
   4634	      24F9r
   4635	2522  0FD3r 0004 2872r			  DW  LIT,4,MESS	     ; сообщение о повторном определении слова
   4636	2528  1C2Br 199Er 1B69r	  +	CRE:	  DW  HERE,DUBL,CAT,$WIDTH,AT,MIN,ONEP,ALLOT ; here указывает на число символов	слова
   4637	      1F9Dr 1B4Er 178Er	  +
   4638	      152Br 1C49r
   4639										     ; сдвигаем	here на	длину слова + сам байт длины
   4640	2538  199Er 0FD3r 00A0	  +		  DW  DUBL,LIT,240Q,TOGL,HERE,ONEM   ; выключаем из поиска
   4641	      1B33r 1C2Br 1563r
   4642										     ; 240Q = 10100000
   4643	2544  0FD3r 0080 1B33r	  +		  DW  LIT,200Q,TOGL,LATES,COMMA,CURR,AT,STORE ;	в последней букве слова	включаем 7  +
   4644	      1D25r 20E8r 2046r	  +  бит
   4645	      1B4Er 1B86r
   4646										 ; ссылка на пред слово	и сохраняем ссылку на вновь
   4647										 ; созданное слово
   4648	2554  1C2Br 1546r 20E8r	  +		  DW  HERE,TWOP,COMMA,SEMI	 ; в словарь адрес here
   4649	      1815r
   4650
   4651						  HEAD	  311Q,'[COMPILE',335Q,BCOM,$COL       ; [COMPILE]
1  4652	      =ARRAY:255C		 LINK$=$
1  4653	255C  C9			     DB	 311Q  ; NFA 7 бит равен 1.
1  4654							 ; 6 - признак immediate. 5- слово не описано smudge
1  4655	255D  5B 43 4F 4D 50 49	4C+	     DB	 '[COMPILE'
   4656	      45
1  4657	2565  DD			     DB	 335Q	; последний символ слова + 128 (7 бит =	1).
1  4658	2566  2509r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4659	      =ARRAY:255C		 LINK=LINK$
1  4660	2568				 BCOM LABEL FAR	 ; CFA
1  4661	2568  1E51r			     DW	$COL
   4662					     ; Используется в описании типа двоеточия и	служит для
   4663						     ; компиляции слова	немедленного действия XXX, как если бы оно
   4664					     ; не было таким. Слово XXX	будет исполнено	тогда, когда будет
   4665					     ; исполнено слово,	в котором использована комбинация [COMPILE] XXX
   4666					     ; кладет в	словарь	CFA компилируемого слова
   4667	256A  237Cr 1164r 1F3Ar	  +		  DW  DFIND,ZEQU,ZERO,QERR,DROP,COMMA,SEMI
   4668	      212Fr 1A49r 20E8r	  +
   4669	      1815r
   4670
   4671						 HEAD	 307Q,'LITERA',314Q,LITER,$COL	      ;	LITERAL
1  4672	      =ARRAY:2578		 LINK$=$
1  4673	2578  C7			     DB	 307Q  ; NFA 7 бит равен 1.
1  4674							 ; 6 - признак immediate. 5- слово не описано smudge
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 83
forth.asm



1  4675	2579  4C 49 54 45 52 41		     DB	 'LITERA'
1  4676	257F  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  4677	2580  255Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4678	      =ARRAY:2578		 LINK=LINK$
1  4679	2582				 LITER LABEL FAR  ; CFA
1  4680	2582  1E51r			     DW	$COL
   4681					 ; компилирует число в словарь
   4682	2584  2052r 1B4Er 101Ar	  +		 DW  STATE,AT,ZBRAN,LIL-$	; в режиме исполнения ничего не	делает
   4683	      0008
   4684	258C  21BCr 0FD3r 20E8r			 DW  COMP,LIT,COMMA
   4685	2592  1815r			 LIL:	 DW  SEMI
   4686
   4687						  HEAD	  310Q,'DLITERA',314Q,DLITE,$COL       ; DLITERAL
1  4688	      =ARRAY:2594		 LINK$=$
1  4689	2594  C8			     DB	 310Q  ; NFA 7 бит равен 1.
1  4690							 ; 6 - признак immediate. 5- слово не описано smudge
1  4691	2595  44 4C 49 54 45 52	41	     DB	 'DLITERA'
1  4692	259C  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  4693	259D  2578r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4694	      =ARRAY:2594		 LINK=LINK$
1  4695	259F				 DLITE LABEL FAR  ; CFA
1  4696	259F  1E51r			     DW	$COL
   4697					 ; компилирует в словарь двойное число
   4698	25A1  2052r 1B4Er 101Ar	  +		  DW  STATE,AT,ZBRAN,DLI-$
   4699	      0008
   4700	25A9  1952r 2582r 2582r			 DW  SWAP,LITER,LITER
   4701	25AF  1815r			DLI:	  DW  SEMI
   4702
   4703						  HEAD	  86h,'?STAC',313Q,QSTAC,$COL	      ;	?STACK
1  4704	      =ARRAY:25B1		 LINK$=$
1  4705	25B1  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  4706							 ; 6 - признак immediate. 5- слово не описано smudge
1  4707	25B2  3F 53 54 41 43		     DB	 '?STAC'
1  4708	25B7  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  4709	25B8  2594r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4710	      =ARRAY:25B1		 LINK=LINK$
1  4711	25BA				 QSTAC LABEL FAR  ; CFA
1  4712	25BA  1E51r			     DW	$COL
   4713					 ; -> f	, true если значение указателя стека в пределах	допусков
   4714	25BC  1F7Er 1B4Er 1BEFr	  +		  DW  SZERO,AT,CFA,SPAT,ULESS,ONE,QERR
   4715	      17D0r 11F7r 1F42r	  +
   4716	      212Fr
   4717	25CA  0FD3r FF80 17D0r	  +		  DW  LIT,-200Q,SPAT,ULESS,TWO
   4718	      11F7r 1F4Ar
   4719	25D4  212Fr 1815r			  DW  QERR, SEMI
   4720
   4721						  HEAD	  211Q,'INTERPRE',324Q,INTER,$COL      ; INTERPRET
1  4722	      =ARRAY:25D8		 LINK$=$
1  4723	25D8  89			     DB	 211Q  ; NFA 7 бит равен 1.
1  4724							 ; 6 - признак immediate. 5- слово не описано smudge
1  4725	25D9  49 4E 54 45 52 50	52+	     DB	 'INTERPRE'
   4726	      45
1  4727	25E1  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4728	25E2  25B1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4729	      =ARRAY:25D8		 LINK=LINK$
1  4730	25E4				 INTER LABEL FAR  ; CFA
1  4731	25E4  1E51r			     DW	$COL
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 84
forth.asm



   4732	25E6  237Cr 101Ar 0018		IT1:	  DW  DFIND,ZBRAN,IT3-$	; переход если не найдено
   4733	25EC  2052r 1B4Er 1205r	  +		  DW  STATE,AT,LESS, ZBRAN,IT2-$ ; выполнить
   4734	      101Ar 0008
   4735	25F6  20E8r 103Fr 0020			  DW  COMMA,BRAN,IT5-$
   4736	25FC  0FC8r 103Fr 001A		IT2:	  DW  EXEC,BRAN,IT5-$
   4737	2602  1C2Br 23ABr 2067r	  +	IT3:	  DW  HERE,NUMB,DPL,AT,ONEP,ZBRAN,IT4-$
   4738	      1B4Er 152Br 101Ar	  +
   4739	      0008
   4740	2610  259Fr 103Fr 0006			  DW  DLITE,BRAN,IT5-$
   4741	2616  1A49r 2582r		IT4:	  DW  DROP,LITER
   4742	261A  25BAr 103Fr FFC8		IT5:	  DW  QSTAC,BRAN,IT1-$
   4743
   4744						  HEAD	  211Q,'IMMEDIAT',305Q,IMMED,$COL      ; IMMEDIATE
1  4745	      =ARRAY:2620		 LINK$=$
1  4746	2620  89			     DB	 211Q  ; NFA 7 бит равен 1.
1  4747							 ; 6 - признак immediate. 5- слово не описано smudge
1  4748	2621  49 4D 4D 45 44 49	41+	     DB	 'IMMEDIAT'
   4749	      54
1  4750	2629  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4751	262A  25D8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4752	      =ARRAY:2620		 LINK=LINK$
1  4753	262C				 IMMED LABEL FAR  ; CFA
1  4754	262C  1E51r			     DW	$COL
   4755					 ; отмечает последнее слово признаком
   4756	262E  1D25r 1F6Cr 1B33r	  +		  DW  LATES,$CL,TOGL,SEMI	 ; cl -	6 бит
   4757	      1815r
   4758
   4759						 HEAD	 212Q,'VOCABULAR',331Q,VOCAB,$COL     ;	VOCABULARY
1  4760	      =ARRAY:2636		 LINK$=$
1  4761	2636  8A			     DB	 212Q  ; NFA 7 бит равен 1.
1  4762							 ; 6 - признак immediate. 5- слово не описано smudge
1  4763	2637  56 4F 43 41 42 55	4C+	     DB	 'VOCABULAR'
   4764	      41 52
1  4765	2640  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  4766	2641  2620r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4767	      =ARRAY:2636		 LINK=LINK$
1  4768	2643				 VOCAB LABEL FAR  ; CFA
1  4769	2643  1E51r			     DW	$COL
   4770					 ; создание нового словаря
   4771	2645  2201r 0FD3r A081	  +		 DW  BUILD,LIT,120201Q,COMMA ;
   4772	      20E8r
   4773	264D  2046r 1B4Er 1BEFr	  +		 DW  CURR,AT,CFA,COMMA
   4774	      20E8r
   4775	2655  1C2Br 1FCBr 1B4Er	  +		 DW  HERE,VOCL,AT,COMMA,VOCL,STORE,DOES
   4776	      20E8r 1FCBr 1B86r	  +
   4777	      1EFEr
   4778	2663				 DOVOC	 LABEL	  FAR
   4779	2663  1546r 2038r 1B86r	  +		 DW  TWOP,CONT,STORE,SEMI ; этот код будет в PFA нового	словаря
   4780	      1815r
   4781									  ; в CFA словаря попадет код $DOE, который
   4782									  ; передает управлению	коду по	адресу PFA
   4783									  ; в стек кладет адрес	PFA+2
   4784
   4785
   4786						  HEAD	  301Q,,250Q,PAREN,$COL		       ; (
1  4787	      =ARRAY:266B		 LINK$=$
1  4788	266B  C1			     DB	 301Q  ; NFA 7 бит равен 1.
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 85
forth.asm



1  4789							 ; 6 - признак immediate. 5- слово не описано smudge
1  4790	266C  A8			     DB	 250Q	; последний символ слова + 128 (7 бит =	1).
1  4791	266D  2636r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4792	      =ARRAY:266B		 LINK=LINK$
1  4793	266F				 PAREN LABEL FAR  ; CFA
1  4794	266F  1E51r			     DW	$COL
   4795					     ; пропуск до следующей )
   4796	2671  0FD3r 0029 22EBr	  +		  DW  LIT,29h,$WORD,SEMI
   4797	      1815r
   4798
   4799						  HEAD	  84h,'QUI',324Q,QUIT,$COL	      ;	QUIT
1  4800	      =ARRAY:2679		 LINK$=$
1  4801	2679  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4802							 ; 6 - признак immediate. 5- слово не описано smudge
1  4803	267A  51 55 49			     DB	 'QUI'
1  4804	267D  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4805	267E  266Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4806	      =ARRAY:2679		 LINK=LINK$
1  4807	2680				 QUIT LABEL FAR	 ; CFA
1  4808	2680  1E51r			     DW	$COL
   4809					 ; Очищает оба стека и возвращает управление терминалу.
   4810					 ; Не выдается никаких сообщений
   4811	2682  1F3Ar 2000r 1B86r	  +		  DW  ZERO,BLK,STORE,LBRAC
   4812	      1C88r
   4813	268A  17F9r 20D4r 229Ar	  +	QUI:	  DW  RPSTO,CR,QUERY,INTER,STATE,AT
   4814	      25E4r 2052r 1B4Er
   4815	2696  1164r 101Ar FFF0	  +		  DW  ZEQU,ZBRAN,QUI-$,PDOTQ
   4816	      2251r
   4817	269E  03 20 4F 4B			  DB  3,' OK'
   4818	26A2  103Fr FFE6			  DW  BRAN,QUI-$
   4819
   4820						  HEAD	  85h,'ABOR',324Q,ABORT,$COL	      ;	ABORT
1  4821	      =ARRAY:26A6		 LINK$=$
1  4822	26A6  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4823							 ; 6 - признак immediate. 5- слово не описано smudge
1  4824	26A7  41 42 4F 52		     DB	 'ABOR'
1  4825	26AB  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4826	26AC  2679r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4827	      =ARRAY:26A6		 LINK=LINK$
1  4828	26AE				 ABORT LABEL FAR  ; CFA
1  4829	26AE  1E51r			     DW	$COL
   4830					 ; Прерывает исполнение, делает	словарь	Форт контекстным,
   4831					 ; выполняет QUIT. Распечатывает версию	интерпретатора
   4832	26B0  17DDr 1CE4r 20D4r	  +		  DW  SPSTO,DECIMA,CR,PDOTQ
   4833	      2251r
   4834	26B8  11 46 4F 52 54 48	2D+		  DB  17,'FORTH-PC IS HERE '
   4835	      50 43 20 49 53 20	48+
   4836	      45 52 45 20
   4837	26CA  2E56r 1DA2r 2680r			  DW  FORTH,DEFIN,QUIT
   4838
   4839						  HEAD	  82h,'S',256Q,SPOT,$COL	      ;	S.
1  4840	      =ARRAY:26D0		 LINK$=$
1  4841	26D0  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4842							 ; 6 - признак immediate. 5- слово не описано smudge
1  4843	26D1  53			     DB	 'S'
1  4844	26D2  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  4845	26D3  26A6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 86
forth.asm



1  4846	      =ARRAY:26D0		 LINK=LINK$
1  4847	26D5				 SPOT LABEL FAR	 ; CFA
1  4848	26D5  1E51r			     DW	$COL
   4849					 ; печать верхнего значения со стека без его изменения
   4850	26D7  199Er 2B50r 1815r			  DW  DUBL,UDOT,SEMI
   4851
   4852						  HEAD	  81h,,252Q,STAR,$COL		      ;	*
1  4853	      =ARRAY:26DD		 LINK$=$
1  4854	26DD  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  4855							 ; 6 - признак immediate. 5- слово не описано smudge
1  4856	26DE  AA			     DB	 252Q	; последний символ слова + 128 (7 бит =	1).
1  4857	26DF  26D0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4858	      =ARRAY:26DD		 LINK=LINK$
1  4859	26E1				 STAR LABEL FAR	 ; CFA
1  4860	26E1  1E51r			     DW	$COL
   4861	26E3  15F3r 1A49r 1815r			  DW  MSTAR,DROP,SEMI
   4862
   4863						  HEAD	  84h,'/MO',304Q,SLMOD,$COL	      ;	/MOD
1  4864	      =ARRAY:26E9		 LINK$=$
1  4865	26E9  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4866							 ; 6 - признак immediate. 5- слово не описано smudge
1  4867	26EA  2F 4D 4F			     DB	 '/MO'
1  4868	26ED  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4869	26EE  26DDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4870	      =ARRAY:26E9		 LINK=LINK$
1  4871	26F0				 SLMOD LABEL FAR  ; CFA
1  4872	26F0  1E51r			     DW	$COL
   4873	26F2  1854r 176Dr 1872r	  +		  DW  TOR,STOD,FROMR,MSLAS,SEMI
   4874	      1659r 1815r
   4875
   4876						  HEAD	  81h,,257Q,SLASH,$COL		      ;	/
1  4877	      =ARRAY:26FC		 LINK$=$
1  4878	26FC  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  4879							 ; 6 - признак immediate. 5- слово не описано smudge
1  4880	26FD  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  4881	26FE  26E9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4882	      =ARRAY:26FC		 LINK=LINK$
1  4883	2700				 SLASH LABEL FAR  ; CFA
1  4884	2700  1E51r			     DW	$COL
   4885	2702  26F0r 1952r 1A49r	  +		  DW  SLMOD,SWAP,DROP,SEMI
   4886	      1815r
   4887
   4888						  HEAD	  83h,'MO',304Q,$MOD,$COL	      ;	MOD
1  4889	      =ARRAY:270A		 LINK$=$
1  4890	270A  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4891							 ; 6 - признак immediate. 5- слово не описано smudge
1  4892	270B  4D 4F			     DB	 'MO'
1  4893	270D  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4894	270E  26FCr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4895	      =ARRAY:270A		 LINK=LINK$
1  4896	2710				 $MOD LABEL FAR	 ; CFA
1  4897	2710  1E51r			     DW	$COL
   4898	2712  26F0r 1A49r 1815r			  DW  SLMOD,DROP,SEMI
   4899
   4900						  HEAD	  85h,'*/MO',304Q,SSMOD,$COL	      ;. */MOD
1  4901	      =ARRAY:2718		 LINK$=$
1  4902	2718  85			     DB	 85h  ;	NFA 7 бит равен	1.
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 87
forth.asm



1  4903							 ; 6 - признак immediate. 5- слово не описано smudge
1  4904	2719  2A 2F 4D 4F		     DB	 '*/MO'
1  4905	271D  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4906	271E  270Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4907	      =ARRAY:2718		 LINK=LINK$
1  4908	2720				 SSMOD LABEL FAR  ; CFA
1  4909	2720  1E51r			     DW	$COL
   4910					 ; u1 u2 u3 -->	u-rem u-result
   4911					 ; u1*u2/u3 - остаток и	частное, u1 u2 - 32-разрядное число
   4912
   4913	2722  1854r 15F3r 1872r	  +		  DW  TOR,MSTAR,FROMR,MSLAS,SEMI
   4914	      1659r 1815r
   4915
   4916						  HEAD	  82h,'*',257Q,SSLA,$COL	      ;	*/
1  4917	      =ARRAY:272C		 LINK$=$
1  4918	272C  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4919							 ; 6 - признак immediate. 5- слово не описано smudge
1  4920	272D  2A			     DB	 '*'
1  4921	272E  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  4922	272F  2718r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4923	      =ARRAY:272C		 LINK=LINK$
1  4924	2731				 SSLA LABEL FAR	 ; CFA
1  4925	2731  1E51r			     DW	$COL
   4926	2733  2720r 1952r 1A49r	  +		  DW  SSMOD,SWAP,DROP,SEMI
   4927	      1815r
   4928
   4929						  HEAD	  85h,'M/MO',304Q,MSMOD,$COL	      ;	M/MOD
1  4930	      =ARRAY:273B		 LINK$=$
1  4931	273B  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4932							 ; 6 - признак immediate. 5- слово не описано smudge
1  4933	273C  4D 2F 4D 4F		     DB	 'M/MO'
1  4934	2740  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4935	2741  272Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4936	      =ARRAY:273B		 LINK=LINK$
1  4937	2743				 MSMOD LABEL FAR  ; CFA
1  4938	2743  1E51r			     DW	$COL
   4939	2745  1854r 1F3Ar 188Fr	  +		  DW  TOR,ZERO,I,USLAS,FROMR,SWAP,TOR,USLAS
   4940	      15D4r 1872r 1952r	  +
   4941	      1854r 15D4r
   4942	2755  1872r 1815r		$MO:	  DW  FROMR,SEMI
   4943
   4944						  HEAD	  215Q,'EMPTY-BUFFER',323Q,MTBUF,$COL  ;EMPTY-BUFFERS
1  4945	      =ARRAY:2759		 LINK$=$
1  4946	2759  8D			     DB	 215Q  ; NFA 7 бит равен 1.
1  4947							 ; 6 - признак immediate. 5- слово не описано smudge
1  4948	275A  45 4D 50 54 59 2D	42+	     DB	 'EMPTY-BUFFER'
   4949	      55 46 46 45 52
1  4950	2766  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  4951	2767  273Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4952	      =ARRAY:2759		 LINK=LINK$
1  4953	2769				 MTBUF LABEL FAR  ; CFA
1  4954	2769  1E51r			     DW	$COL
   4955	276B  1FD7r 1B4Er 0FD3r	  +		  DW  FIRST,AT,LIT,0C12h,ERASE,SEMI   ;	3084 было
   4956	      0C12 1ABBr 1815r
   4957
   4958						  HEAD	  85h,'FLUS',310Q,FLUSH,$COL	      ;	FLUSH
1  4959	      =ARRAY:2777		 LINK$=$
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 88
forth.asm



1  4960	2777  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4961							 ; 6 - признак immediate. 5- слово не описано smudge
1  4962	2778  46 4C 55 53		     DB	 'FLUS'
1  4963	277C  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1  4964	277D  2759r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4965	      =ARRAY:2777		 LINK=LINK$
1  4966	277F				 FLUSH LABEL FAR  ; CFA
1  4967	277F  1E51r			     DW	$COL
   4968					 ; запись буферов на диск
   4969	2781  1FE3r 1B4Er 1FD7r	  +		  DW  LIMIT,AT,FIRST,AT,XDO
   4970	      1B4Er 105Br
   4971	278B  188Fr 1B4Er 11B9r	  +	FLU:	  DW  I,AT,ZLESS,ZBRAN,FL1-$
   4972	      101Ar 000E
   4973	2795  188Fr 1546r 188Fr	  +		  DW  I,TWOP,I,X,ZERO, RW
   4974	      1E1Fr 1F3Ar 2DB4r
   4975	27A1  0FD3r 0404 10B2r	  +	FL1:	  DW  LIT,1028,XPLOO,FLU-$,MTBUF,SEMI
   4976	      FFE4 2769r 1815r
   4977
   4978						  HEAD	  86h,'BUFFE',322Q,BUFFE,$COL	      ;	BUFFER
1  4979	      =ARRAY:27AD		 LINK$=$
1  4980	27AD  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  4981							 ; 6 - признак immediate. 5- слово не описано smudge
1  4982	27AE  42 55 46 46 45		     DB	 'BUFFE'
1  4983	27B3  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4984	27B4  2777r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4985	      =ARRAY:27AD		 LINK=LINK$
1  4986	27B6				 BUFFE LABEL FAR  ; CFA
1  4987	27B6  1E51r			     DW	$COL
   4988					 ; u --> адр  Резервирует блок в памяти, приписывает ему
   4989					 ; номер u, но никакого	чтения с носителя не производится
   4990	27B8  208Er 1B4Er 1854r	  +		  DW  USE,AT,TOR,I	 ; адрес буфера	в стеках
   4991	      188Fr
   4992	27C0  1DC2r 101Ar FFFC		BR1:	  DW  PBUF,ZBRAN,BR1-$	 ; ищем	свободный буфер
   4993	27C6  208Er 1B86r			 DW USE,STORE		 ; полученный адрес сохранить в	USE
   4994	27CA  188Fr 1B4Er 11B9r	  +		  DW  I,AT,ZLESS,ZBRAN,BR2-$ ; если buffer изменен,
   4995	      101Ar 000E
   4996	27D4  188Fr 1546r 188Fr	  +		  DW  I,TWOP,I,X,ZERO, RW    ; то запись его на	диск
   4997	      1E1Fr 1F3Ar 2DB4r
   4998	27E0  188Fr 1B86r 188Fr	  +	BR2:	  DW  I,STORE,I,PREV,STORE   ; номер буфера записать и адрес сохранить в PREV
   4999	      2099r 1B86r
   5000	27EA  1872r 1546r 1815r			 DW FROMR,TWOP,SEMI	     ; возвращаемое значение
   5001
   5002						  HEAD	  85h,'BLOC',313Q,BLOCK,$COL	      ;	BLOCK
1  5003	      =ARRAY:27F0		 LINK$=$
1  5004	27F0  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5005							 ; 6 - признак immediate. 5- слово не описано smudge
1  5006	27F1  42 4C 4F 43		     DB	 'BLOC'
1  5007	27F5  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  5008	27F6  27ADr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5009	      =ARRAY:27F0		 LINK=LINK$
1  5010	27F8				 BLOCK LABEL FAR  ; CFA
1  5011	27F8  1E51r			     DW	$COL
   5012					 ;   u --> адр	Записывает в стек адрес	первого	байта в	блоке с
   5013					 ;   номером u.	Если блок не находится в памяти, он переносится	с носителя
   5014	27FA  202Ar 1B4Er 1677r	  +		  DW  OFSET,AT,PLUS,TOR
   5015	      1854r
   5016	2802  2099r 1B4Er 199Er	  +		  DW  PREV,AT,DUBL,X,I,SUBB,ZBRAN,BLC-$
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 89
forth.asm



   5017	      1E1Fr 188Fr 1693r	  +
   5018	      101Ar 002E
   5019	2812  1DC2r 1164r 101Ar	  +	BLO:	  DW  PBUF,ZEQU,ZBRAN,BCK-$
   5020	      0012
   5021	281A  1A49r 188Fr 27B6r	  +		  DW  DROP,I,BUFFE,DUBL,I,ONE,RW,CFA
   5022	      199Er 188Fr 1F42r	  +
   5023	      2DB4r 1BEFr
   5024	282A  199Er 1E1Fr 188Fr	  +	BCK:	  DW  DUBL,X,I,SUBB,ZEQU
   5025	      1693r 1164r
   5026	2834  101Ar FFDC 199Er	  +		  DW  ZBRAN,BLO-$,DUBL,PREV,STORE
   5027	      2099r 1B86r
   5028	283E  1872r 1A49r 1546r	  +	BLC:	  DW  FROMR,DROP,TWOP,SEMI
   5029	      1815r
   5030
   5031						  HEAD	  85h,'.LIN',305Q,DLINE,$COL	      ;	.LINE
1  5032	      =ARRAY:2846		 LINK$=$
1  5033	2846  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5034							 ; 6 - признак immediate. 5- слово не описано smudge
1  5035	2847  2E 4C 49 4E		     DB	 '.LIN'
1  5036	284B  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  5037	284C  27F0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5038	      =ARRAY:2846		 LINK=LINK$
1  5039	284E				 DLINE LABEL FAR  ; CFA
1  5040	284E  1E51r			     DW	$COL
   5041					 ; строка номер_экрана -- печать строки	из экрана
   5042	2850  1854r 1F6Cr 1F75r	  +		  DW  TOR,$CL,BBUF,SSMOD ; строка*64/1024
   5043	      2720r
   5044	2858  1872r 1677r 27F8r			  DW  FROMR,PLUS,BLOCK	 ; номер_экрана	+ частное
   5045	285E  1677r				  DW  PLUS	     ; остаток+	адрес_блока (нужная строка)
   5046	2860  1F6Cr 1D46r 2224r	  +		  DW  $CL,DTRAI,$TYPE,SEMI ; 64	- число	пробелов (число	символов в строке)
   5047	      1815r
   5048
   5049						  HEAD	  87h,'MESSAG',305Q,MESS,$COL	      ;	MESSAGE
1  5050	      =ARRAY:2868		 LINK$=$
1  5051	2868  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  5052							 ; 6 - признак immediate. 5- слово не описано smudge
1  5053	2869  4D 45 53 53 41 47		     DB	 'MESSAG'
1  5054	286F  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  5055	2870  2846r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5056	      =ARRAY:2868		 LINK=LINK$
1  5057	2872				 MESS LABEL FAR	 ; CFA
1  5058	2872  1E51r			     DW	$COL
   5059	2874  2009r 1B4Er 207Ar	  +		  DW  $IN,AT,RNUM,STORE	; сохранить значение $in
   5060	      1B86r
   5061	287C  1FABr 1B4Er 101Ar	  +		  DW  $WARN,AT,ZBRAN,MS1-$ ; нужен ли текст сообщения
   5062	      0016
   5063	2884  19BBr 101Ar 000E			  DW  DDUP,ZBRAN,MES-$
   5064	288A  0FD3r 0004 202Ar	  +		  DW  LIT,4,OFSET,AT,SUBB,DLINE	; текстовые сообщения на 4 экране
   5065	      1B4Er 1693r 284Er
   5066	2896  1815r			MES:	  DW  SEMI
   5067	2898  2251r			MS1:	  DW  PDOTQ
   5068	289A  06 4D 53 47 20 23	20		  DB  6,'MSG # '
   5069	28A1  2B37r 1815r			  DW $DOT,SEMI
   5070
   5071						  HEAD	  84h,'LOA',304Q,LOA,$COL	     ; LOAD
1  5072	      =ARRAY:28A5		 LINK$=$
1  5073	28A5  84			     DB	 84h  ;	NFA 7 бит равен	1.
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 90
forth.asm



1  5074							 ; 6 - признак immediate. 5- слово не описано smudge
1  5075	28A6  4C 4F 41			     DB	 'LOA'
1  5076	28A9  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  5077	28AA  2868r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5078	      =ARRAY:28A5		 LINK=LINK$
1  5079	28AC				 LOA LABEL FAR	; CFA
1  5080	28AC  1E51r			     DW	$COL
   5081					 ; n ->	номер экрана
   5082	28AE  2000r 1B4Er 2009r	  +		  DW  BLK,AT,$IN,AT,ZERO,$IN,STORE,ROT,BLK
   5083	      1B4Er 1F3Ar 2009r	  +
   5084	      1B86r 19EBr 2000r
   5085	28C0  1B86r 25E4r 2009r	  +		  DW  STORE,INTER,$IN,STORE,BLK,STORE,SEMI
   5086	      1B86r 2000r 1B86r	  +
   5087	      1815r
   5088
   5089						  HEAD	  303Q,'--',276Q,ARROW,$COL	       ; -->
1  5090	      =ARRAY:28CE		 LINK$=$
1  5091	28CE  C3			     DB	 303Q  ; NFA 7 бит равен 1.
1  5092							 ; 6 - признак immediate. 5- слово не описано smudge
1  5093	28CF  2D 2D			     DB	 '--'
1  5094	28D1  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1  5095	28D2  28A5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5096	      =ARRAY:28CE		 LINK=LINK$
1  5097	28D4				 ARROW LABEL FAR  ; CFA
1  5098	28D4  1E51r			     DW	$COL
   5099					 ; згрузка следующего экрана
   5100	28D6  21A2r 1F3Ar 2009r	  +		  DW  QLOAD,ZERO,$IN,STORE,ONE
   5101	      1B86r 1F42r
   5102	28E0  2000r 1AF9r 1815r			  DW  BLK,PSTOR,SEMI
   5103
   5104						  HEAD	  301Q,,247Q,TICK,$COL		       ; '
1  5105	      =ARRAY:28E6		 LINK$=$
1  5106	28E6  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  5107							 ; 6 - признак immediate. 5- слово не описано smudge
1  5108	28E7  A7			     DB	 247Q	; последний символ слова + 128 (7 бит =	1).
1  5109	28E8  28CEr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5110	      =ARRAY:28E6		 LINK=LINK$
1  5111	28EA				 TICK LABEL FAR	 ; CFA
1  5112	28EA  1E51r			     DW	$COL
   5113					 ; Ищет	слово XXX в словаре и записывает в стек	его PFA
   5114	28EC  237Cr 1164r 1F3Ar	  +		  DW  DFIND,ZEQU,ZERO,QERR,DROP,TWOP,LITER,SEMI
   5115	      212Fr 1A49r 1546r	  +
   5116	      2582r 1815r
   5117
   5118						  HEAD	  86h,'FORGE',324Q,FORGE,$COL	      ;	FORGET
1  5119	      =ARRAY:28FC		 LINK$=$
1  5120	28FC  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  5121							 ; 6 - признак immediate. 5- слово не описано smudge
1  5122	28FD  46 4F 52 47 45		     DB	 'FORGE'
1  5123	2902  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  5124	2903  28E6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5125	      =ARRAY:28FC		 LINK=LINK$
1  5126	2905				 FORGE LABEL FAR  ; CFA
1  5127	2905  1E51r			     DW	$COL
   5128	2907  2046r 1B4Er 2038r	  +		  DW  CURR,AT,CONT,AT,SUBB,LIT,30Q,QERR	    ; 24 ошибка	не описана
   5129	      1B4Er 1693r 0FD3r	  +
   5130	      0018 212Fr
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 91
forth.asm



   5131											     ; ошибка если CURRENT = CONTEXT
   5132	2917  28EAr 199Er 1FB7r	  +		  DW  TICK,DUBL,FENCE,AT,ULESS,LIT,25Q,QERR  ; 21 слово	защищено
   5133	      1B4Er 11F7r 0FD3r	  +
   5134	      0015 212Fr
   5135	2927  199Er 1BBFr 1FC0r	  +		  DW  DUBL,NFA,$DP,STORE		    ; словарь свободен до указаного слова
   5136	      1B86r
   5137	292F  1BD1r 1B4Er 2038r	  +		  DW  LFA,AT,CONT,AT,STORE,SEMI		    ; в	переменную context пишем адрес
   5138	      1B4Er 1B86r 1815r
   5139										     ; значение	LFA забываемого	слова
   5140
   5141						  HEAD	  84h,'BAC',313Q,BACK,$COL	      ;	BACK
1  5142	      =ARRAY:293B		 LINK$=$
1  5143	293B  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5144							 ; 6 - признак immediate. 5- слово не описано smudge
1  5145	293C  42 41 43			     DB	 'BAC'
1  5146	293F  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  5147	2940  28FCr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5148	      =ARRAY:293B		 LINK=LINK$
1  5149	2942				 BACK LABEL FAR	 ; CFA
1  5150	2942  1E51r			     DW	$COL
   5151					 ; HERE	- , ; (компилирует в описание слова адрес возврата)
   5152	2944  1C2Br 1693r 20E8r	  +		  DW  HERE,SUBB,COMMA,SEMI
   5153	      1815r
   5154
   5155						  HEAD	  305Q,'BEGI',316Q,BEGIN,$COL	       ; BEGIN
1  5156	      =ARRAY:294C		 LINK$=$
1  5157	294C  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  5158							 ; 6 - признак immediate. 5- слово не описано smudge
1  5159	294D  42 45 47 49		     DB	 'BEGI'
1  5160	2951  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  5161	2952  293Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5162	      =ARRAY:294C		 LINK=LINK$
1  5163	2954				 BEGIN LABEL FAR  ; CFA
1  5164	2954  1E51r			     DW	$COL
   5165					 ; BEGIN ... UNTIL
   5166					 ; BEGIN ... AGAIN
   5167					 ; BEGIN ... WHILE ... REPEAT
   5168	2956  2147r 1C2Br 1F42r	  +		  DW  QCOMP,HERE,ONE,SEMI
   5169	      1815r
   5170
   5171						  HEAD	  302Q,'D',317Q,$DO,$COL	       ; DO
1  5172	      =ARRAY:295E		 LINK$=$
1  5173	295E  C2			     DB	 302Q  ; NFA 7 бит равен 1.
1  5174							 ; 6 - признак immediate. 5- слово не описано smudge
1  5175	295F  44			     DB	 'D'
1  5176	2960  CF			     DB	 317Q	; последний символ слова + 128 (7 бит =	1).
1  5177	2961  294Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5178	      =ARRAY:295E		 LINK=LINK$
1  5179	2963				 $DO LABEL FAR	; CFA
1  5180	2963  1E51r			     DW	$COL
   5181	2965  21BCr 105Br 1C2Br	  +		  DW  COMP,XDO,HERE,THREE,SEMI
   5182	      1F52r 1815r
   5183
   5184						  HEAD	  304Q,'LOO',320Q,LOO,$COL	      ;	LOOP
1  5185	      =ARRAY:296F		 LINK$=$
1  5186	296F  C4			     DB	 304Q  ; NFA 7 бит равен 1.
1  5187							 ; 6 - признак immediate. 5- слово не описано smudge
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 92
forth.asm



1  5188	2970  4C 4F 4F			     DB	 'LOO'
1  5189	2973  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  5190	2974  295Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5191	      =ARRAY:296F		 LINK=LINK$
1  5192	2976				 LOO LABEL FAR	; CFA
1  5193	2976  1E51r			     DW	$COL
   5194	2978  1F52r 2175r 21BCr	  +		  DW  THREE,QPAIR,COMP,XLOOP,BACK,SEMI
   5195	      1084r 2942r 1815r
   5196
   5197						  HEAD	  305Q,'+LOO',320Q,PLOOP,$COL	       ; +LOOP
1  5198	      =ARRAY:2984		 LINK$=$
1  5199	2984  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  5200							 ; 6 - признак immediate. 5- слово не описано smudge
1  5201	2985  2B 4C 4F 4F		     DB	 '+LOO'
1  5202	2989  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  5203	298A  296Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5204	      =ARRAY:2984		 LINK=LINK$
1  5205	298C				 PLOOP LABEL FAR  ; CFA
1  5206	298C  1E51r			     DW	$COL
   5207	298E  1F52r 2175r 21BCr	  +		  DW  THREE,QPAIR,COMP,XPLOO,BACK,SEMI
   5208	      10B2r 2942r 1815r
   5209
   5210						  HEAD	  305Q,'UNTI',314Q,UNTIL,$COL	       ; UNTIL
1  5211	      =ARRAY:299A		 LINK$=$
1  5212	299A  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  5213							 ; 6 - признак immediate. 5- слово не описано smudge
1  5214	299B  55 4E 54 49		     DB	 'UNTI'
1  5215	299F  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  5216	29A0  2984r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5217	      =ARRAY:299A		 LINK=LINK$
1  5218	29A2				 UNTIL LABEL FAR  ; CFA
1  5219	29A2  1E51r			     DW	$COL
   5220	29A4  1F42r 2175r 21BCr	  +		  DW  ONE,QPAIR,COMP,ZBRAN,BACK,SEMI
   5221	      101Ar 2942r 1815r
   5222
   5223						 HEAD	 305Q,'AGAI','N'+80h,AGAIN,$COL	       ; AGAIN sds
1  5224	      =ARRAY:29B0		 LINK$=$
1  5225	29B0  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  5226							 ; 6 - признак immediate. 5- слово не описано smudge
1  5227	29B1  41 47 41 49		     DB	 'AGAI'
1  5228	29B5  CE			     DB	 'N'+80h   ; последний символ слова + 128 (7 бит = 1).
1  5229	29B6  299Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5230	      =ARRAY:29B0		 LINK=LINK$
1  5231	29B8				 AGAIN LABEL FAR  ; CFA
1  5232	29B8  1E51r			     DW	$COL
   5233	29BA  1F42r 2175r 21BCr	  +		 DW  ONE,QPAIR,COMP,BRAN,BACK,SEMI
   5234	      103Fr 2942r 1815r
   5235
   5236						  HEAD	  305Q,'WHIL',305Q,$WHILE,$COL	       ; WHILE
1  5237	      =ARRAY:29C6		 LINK$=$
1  5238	29C6  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  5239							 ; 6 - признак immediate. 5- слово не описано smudge
1  5240	29C7  57 48 49 4C		     DB	 'WHIL'
1  5241	29CB  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  5242	29CC  29B0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5243	      =ARRAY:29C6		 LINK=LINK$
1  5244	29CE				 $WHILE	LABEL FAR  ; CFA
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 93
forth.asm



1  5245	29CE  1E51r			     DW	$COL
   5246	29D0  29F6r 1815r			  DW  $IF,SEMI
   5247
   5248						  HEAD	  306Q,'REPEA',324Q,REPEA,$COL	      ;	REPEAT
1  5249	      =ARRAY:29D4		 LINK$=$
1  5250	29D4  C6			     DB	 306Q  ; NFA 7 бит равен 1.
1  5251							 ; 6 - признак immediate. 5- слово не описано smudge
1  5252	29D5  52 45 50 45 41		     DB	 'REPEA'
1  5253	29DA  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  5254	29DB  29C6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5255	      =ARRAY:29D4		 LINK=LINK$
1  5256	29DD				 REPEA LABEL FAR  ; CFA
1  5257	29DD  1E51r			     DW	$COL
   5258	29DF  19EBr 1F42r 2175r	  +		  DW  ROT,ONE,QPAIR,ROT,COMP,BRAN,BACK
   5259	      19EBr 21BCr 103Fr	  +
   5260	      2942r
   5261	29ED  2A2Er 1815r			  DW  THEN,SEMI
   5262
   5263						  HEAD	  302Q,'I',306Q,$IF,$COL	       ; IF
1  5264	      =ARRAY:29F1		 LINK$=$
1  5265	29F1  C2			     DB	 302Q  ; NFA 7 бит равен 1.
1  5266							 ; 6 - признак immediate. 5- слово не описано smudge
1  5267	29F2  49			     DB	 'I'
1  5268	29F3  C6			     DB	 306Q	; последний символ слова + 128 (7 бит =	1).
1  5269	29F4  29D4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5270	      =ARRAY:29F1		 LINK=LINK$
1  5271	29F6				 $IF LABEL FAR	; CFA
1  5272	29F6  1E51r			     DW	$COL
   5273	29F8  21BCr 101Ar 1C2Br	  +		  DW  COMP,ZBRAN,HERE,ZERO,COMMA,TWO,SEMI
   5274	      1F3Ar 20E8r 1F4Ar	  +
   5275	      1815r
   5276
   5277						  HEAD	  304Q,'ELS',305Q,$ELSE,$COL	       ; ELSE
1  5278	      =ARRAY:2A06		 LINK$=$
1  5279	2A06  C4			     DB	 304Q  ; NFA 7 бит равен 1.
1  5280							 ; 6 - признак immediate. 5- слово не описано smudge
1  5281	2A07  45 4C 53			     DB	 'ELS'
1  5282	2A0A  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  5283	2A0B  29F1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5284	      =ARRAY:2A06		 LINK=LINK$
1  5285	2A0D				 $ELSE LABEL FAR  ; CFA
1  5286	2A0D  1E51r			     DW	$COL
   5287	2A0F  1F4Ar 2175r 21BCr			  DW  TWO,QPAIR,COMP
   5288	2A15  103Fr 1C2Br 1F3Ar	  +		  DW  BRAN,HERE,ZERO,COMMA   ; если исполнение пришло к	этому BRAN
   5289	      20E8r
   5290									     ; значит была выполнена ветка TRUE	и
   5291									     ; надо перепрыгнуть ветку FALSE (безусловно)
   5292	2A1D  1952r 1F4Ar 2A2Er	  +		  DW  SWAP,TWO,THEN,TWO,SEMI ; адреса переходов	меняем местами,	т.к.
   5293	      1F4Ar 1815r
   5294									     ; по условию FALSE	должен выполниться
   5295									     ; код после слова ELSE, воспользуемся
   5296									     ; для этого словом	THEN
   5297
   5298						  HEAD	  304Q,'THE',316Q,THEN,$COL	       ; THEN
1  5299	      =ARRAY:2A27		 LINK$=$
1  5300	2A27  C4			     DB	 304Q  ; NFA 7 бит равен 1.
1  5301							 ; 6 - признак immediate. 5- слово не описано smudge
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 94
forth.asm



1  5302	2A28  54 48 45			     DB	 'THE'
1  5303	2A2B  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  5304	2A2C  2A06r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5305	      =ARRAY:2A27		 LINK=LINK$
1  5306	2A2E				 THEN LABEL FAR	 ; CFA
1  5307	2A2E  1E51r			     DW	$COL
   5308	2A30  2147r 1F4Ar 2175r	  +		  DW  QCOMP,TWO,QPAIR,HERE,OVER,SUBB,SWAP,STORE,SEMI
   5309	      1C2Br 1932r 1693r	  +
   5310	      1952r 1B86r 1815r
   5311					 ; if -	step	  cond if true else false then
   5312					     ; DICT:  ?BRANCH 0
   5313					     ; STACK:  adr_if
   5314					 ; else	- step получается слишком много	кода...	Вроде разобрался! :)
   5315					     ; ?BRANCH 0     BRANCH 0
   5316					     ;	adr_else adr_if
   5317					 ; then	- step
   5318					     ;1	DICT:  ?BRANCH 0
   5319					     ;1	STACK:	adr_if
   5320					     ;2	STACK:	adr_if adr_then
   5321					     ;3	STACK:	adr_if adr_then	 adr_if
   5322					     ;4	STACK:	adr_if (adr_if-adr_then)
   5323					     ;4	STACK:	(adr_if-adr_then) adr_if
   5324					     ;5	DICT:  ?BRANCH [adr_if]=(adr_if-adr_then)
   5325					     ;5	STACK:
   5326
   5327						  HEAD	  86h,'SPACE',323Q,SPACS,$COL	      ;	SPACES
1  5328	      =ARRAY:2A42		 LINK$=$
1  5329	2A42  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  5330							 ; 6 - признак immediate. 5- слово не описано smudge
1  5331	2A43  53 50 41 43 45		     DB	 'SPACE'
1  5332	2A48  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  5333	2A49  2A27r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5334	      =ARRAY:2A42		 LINK=LINK$
1  5335	2A4B				 SPACS LABEL FAR  ; CFA
1  5336	2A4B  1E51r			     DW	$COL
   5337	2A4D  1F3Ar 17C0r 19BBr	  +		  DW  ZERO,MAX,DDUP,ZBRAN,SP1-$,ZERO,XDO
   5338	      101Ar 000C 1F3Ar	  +
   5339	      105Br
   5340	2A5B  210Dr 1084r FFFC		SPA:	  DW  SPACE,XLOOP,SPA-$
   5341	2A61  1815r			SP1:	  DW  SEMI
   5342
   5343						  HEAD	  82h,'#',243Q,BDIGS,$COL	      ;	<# ; sds replace
1  5344	      =ARRAY:2A63		 LINK$=$
1  5345	2A63  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5346							 ; 6 - признак immediate. 5- слово не описано smudge
1  5347	2A64  23			     DB	 '#'
1  5348	2A65  A3			     DB	 243Q	; последний символ слова + 128 (7 бит =	1).
1  5349	2A66  2A42r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5350	      =ARRAY:2A63		 LINK=LINK$
1  5351	2A68				 BDIGS LABEL FAR  ; CFA
1  5352	2A68  1E51r			     DW	$COL
   5353					 ; Начинает процесс преобразования числа в последовательность кодов ASCII.
   5354					 ; Исходное число в стеке должно быть двойной длины без	знака
   5355	2A6A  22D8r 2084r 1B86r	  +		  DW  PAD,HLD,STORE,SEMI
   5356	      1815r
   5357
   5358						  HEAD	  82h,'#',276Q,EDIGS,$COL	      ;	#>
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 95
forth.asm



1  5359	      =ARRAY:2A72		 LINK$=$
1  5360	2A72  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5361							 ; 6 - признак immediate. 5- слово не описано smudge
1  5362	2A73  23			     DB	 '#'
1  5363	2A74  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1  5364	2A75  2A63r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5365	      =ARRAY:2A72		 LINK=LINK$
1  5366	2A77				 EDIGS LABEL FAR  ; CFA
1  5367	2A77  1E51r			     DW	$COL
   5368					 ; Завершает преобразование числа. В стеке остается число
   5369					 ; полученных символов и адрес,	как это	требуется для
   5370					 ; оператора TYPE
   5371	2A79  1A2Cr 2084r 1B4Er	  +		  DW  DDROP,HLD,AT,PAD,OVER,SUBB,SEMI
   5372	      22D8r 1932r 1693r	  +
   5373	      1815r
   5374
   5375						  HEAD	  84h,'SIG',316Q,SIGN,$COL	      ;	SIGN
1  5376	      =ARRAY:2A87		 LINK$=$
1  5377	2A87  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5378							 ; 6 - признак immediate. 5- слово не описано smudge
1  5379	2A88  53 49 47			     DB	 'SIG'
1  5380	2A8B  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  5381	2A8C  2A72r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5382	      =ARRAY:2A87		 LINK=LINK$
1  5383	2A8E				 SIGN LABEL FAR	 ; CFA
1  5384	2A8E  1E51r			     DW	$COL
   5385					 ; Вводит знак "минус" в выходной буфер
   5386	2A90  19EBr 11B9r 101Ar	  +		  DW  ROT,ZLESS,ZBRAN,SIG-$,LIT,55Q,HOLD
   5387	      0008 0FD3r 002D	  +
   5388	      1AD8r
   5389	2A9E  1815r			SIG:	  DW  SEMI
   5390
   5391						  HEAD	  81h,,243Q,DIG,$COL		      ;	#
1  5392	      =ARRAY:2AA0		 LINK$=$
1  5393	2AA0  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  5394							 ; 6 - признак immediate. 5- слово не описано smudge
1  5395	2AA1  A3			     DB	 243Q	; последний символ слова + 128 (7 бит =	1).
1  5396	2AA2  2A87r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5397	      =ARRAY:2AA0		 LINK=LINK$
1  5398	2AA4				 DIG LABEL FAR	; CFA
1  5399	2AA4  1E51r			     DW	$COL
   5400					 ; Преобразует одну цифру и записывает ее в выходной буфер (PAD),
   5401					 ; выдает цифру	всегда,	если преобразовывать нечего, записывается 0
   5402	2AA6  205Dr 1B4Er 2743r	  +		  DW  BASE,AT,MSMOD,ROT,LIT,11Q,OVER,LESS
   5403	      19EBr 0FD3r 0009	  +
   5404	      1932r 1205r
   5405	2AB6  101Ar 0008 0FD3r	  +		  DW  ZBRAN,DIGI-$,LIT,7,PLUS
   5406	      0007 1677r
   5407	2AC0  0FD3r 0030 1677r	  +	DIGI:	  DW  LIT,60Q,PLUS,HOLD,SEMI
   5408	      1AD8r 1815r
   5409
   5410						  HEAD	  82h,'#',323Q,DIGS,$COL	      ;	#S
1  5411	      =ARRAY:2ACA		 LINK$=$
1  5412	2ACA  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5413							 ; 6 - признак immediate. 5- слово не описано smudge
1  5414	2ACB  23			     DB	 '#'
1  5415	2ACC  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 96
forth.asm



1  5416	2ACD  2AA0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5417	      =ARRAY:2ACA		 LINK=LINK$
1  5418	2ACF				 DIGS LABEL FAR	 ; CFA
1  5419	2ACF  1E51r			     DW	$COL
   5420					 ; Преобразует число до	тех пор, пока не будет получен 0.
   5421					 ; Одна	цифра выдается в любом случае (0)
   5422	2AD1  2AA4r 19CCr 1750r	  +	DIS:	  DW  DIG,DUP2,$OR,ZEQU,ZBRAN,DIS-$,SEMI
   5423	      1164r 101Ar FFF6	  +
   5424	      1815r
   5425
   5426						  HEAD	  83h,'D.',322Q,DDOTR,$COL	      ;	D.R
1  5427	      =ARRAY:2ADF		 LINK$=$
1  5428	2ADF  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  5429							 ; 6 - признак immediate. 5- слово не описано smudge
1  5430	2AE0  44 2E			     DB	 'D.'
1  5431	2AE2  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  5432	2AE3  2ACAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5433	      =ARRAY:2ADF		 LINK=LINK$
1  5434	2AE5				 DDOTR LABEL FAR  ; CFA
1  5435	2AE5  1E51r			     DW	$COL
   5436					 ; s width -> печать двойного числа со знаком с	выравниваем вправо
   5437	2AE7  1854r 1952r 1932r	  +		  DW  TOR,SWAP,OVER,DABS,BDIGS,DIGS,SIGN,EDIGS
   5438	      163Ar 2A68r 2ACFr	  +
   5439	      2A8Er 2A77r
   5440	2AF7  1872r 1932r 1693r	  +		  DW  FROMR,OVER,SUBB,SPACS,$TYPE,SEMI
   5441	      2A4Br 2224r 1815r
   5442
   5443						  HEAD	  82h,'.',322Q,DOTR,$COL	      ;	.R
1  5444	      =ARRAY:2B03		 LINK$=$
1  5445	2B03  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5446							 ; 6 - признак immediate. 5- слово не описано smudge
1  5447	2B04  2E			     DB	 '.'
1  5448	2B05  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  5449	2B06  2ADFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5450	      =ARRAY:2B03		 LINK=LINK$
1  5451	2B08				 DOTR LABEL FAR	 ; CFA
1  5452	2B08  1E51r			     DW	$COL
   5453					 ; s width -> печать числа со знаком с выравниваем вправо
   5454	2B0A  1854r 176Dr 1872r	  +		  DW  TOR,STOD,FROMR,DDOTR,SEMI
   5455	      2AE5r 1815r
   5456
   5457						  HEAD	  83h,'U.',322Q,UDOTR,$COL	      ;	U.R
1  5458	      =ARRAY:2B14		 LINK$=$
1  5459	2B14  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  5460							 ; 6 - признак immediate. 5- слово не описано smudge
1  5461	2B15  55 2E			     DB	 'U.'
1  5462	2B17  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  5463	2B18  2B03r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5464	      =ARRAY:2B14		 LINK=LINK$
1  5465	2B1A				 UDOTR LABEL FAR  ; CFA
1  5466	2B1A  1E51r			     DW	$COL
   5467					 ; u width -> печать числа без знака с выравниваем вправо
   5468	2B1C  1F3Ar 1952r 2AE5r	  +		  DW  ZERO,SWAP,DDOTR,SEMI
   5469	      1815r
   5470
   5471						  HEAD	  82h,'D',256Q,DDOT,$COL	      ;	D.
1  5472	      =ARRAY:2B24		 LINK$=$
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 97
forth.asm



1  5473	2B24  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5474							 ; 6 - признак immediate. 5- слово не описано smudge
1  5475	2B25  44			     DB	 'D'
1  5476	2B26  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  5477	2B27  2B14r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5478	      =ARRAY:2B24		 LINK=LINK$
1  5479	2B29				 DDOT LABEL FAR	 ; CFA
1  5480	2B29  1E51r			     DW	$COL
   5481					 ; печать двойных чисел
   5482	2B2B  1F3Ar 2AE5r 210Dr	  +		  DW  ZERO,DDOTR,SPACE,SEMI
   5483	      1815r
   5484
   5485						  HEAD	  81h,,256Q,$DOT,$COL		      ;	.
1  5486	      =ARRAY:2B33		 LINK$=$
1  5487	2B33  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  5488							 ; 6 - признак immediate. 5- слово не описано smudge
1  5489	2B34  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  5490	2B35  2B24r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5491	      =ARRAY:2B33		 LINK=LINK$
1  5492	2B37				 $DOT LABEL FAR	 ; CFA
1  5493	2B37  1E51r			     DW	$COL
   5494	2B39  176Dr 2B29r 1815r			  DW  STOD,DDOT,SEMI
   5495
   5496						  HEAD	  81h,,277Q,QUEST,$COL		      ;	?
1  5497	      =ARRAY:2B3F		 LINK$=$
1  5498	2B3F  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  5499							 ; 6 - признак immediate. 5- слово не описано smudge
1  5500	2B40  BF			     DB	 277Q	; последний символ слова + 128 (7 бит =	1).
1  5501	2B41  2B33r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5502	      =ARRAY:2B3F		 LINK=LINK$
1  5503	2B43				 QUEST LABEL FAR  ; CFA
1  5504	2B43  1E51r			     DW	$COL
   5505					 ; печать содержимого по адресу	в стеке
   5506	2B45  1B4Er 2B37r 1815r			  DW  AT,$DOT,SEMI
   5507
   5508						  HEAD	  82h,'U',256Q,UDOT,$COL	      ;	U.
1  5509	      =ARRAY:2B4B		 LINK$=$
1  5510	2B4B  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5511							 ; 6 - признак immediate. 5- слово не описано smudge
1  5512	2B4C  55			     DB	 'U'
1  5513	2B4D  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  5514	2B4E  2B3Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5515	      =ARRAY:2B4B		 LINK=LINK$
1  5516	2B50				 UDOT LABEL FAR	 ; CFA
1  5517	2B50  1E51r			     DW	$COL
   5518					 ; печать числа	без знака
   5519	2B52  1F3Ar 2B29r 1815r			  DW  ZERO,DDOT,SEMI
   5520
   5521					 ;	   ** Вспомогательные процедуры	**
   5522
   5523						  HEAD	  84h,'LIS',324Q,$LIST,$COL	      ;	LIST
1  5524	      =ARRAY:2B58		 LINK$=$
1  5525	2B58  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5526							 ; 6 - признак immediate. 5- слово не описано smudge
1  5527	2B59  4C 49 53			     DB	 'LIS'
1  5528	2B5C  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  5529	2B5D  2B4Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 98
forth.asm



1  5530	      =ARRAY:2B58		 LINK=LINK$
1  5531	2B5F				 $LIST LABEL FAR  ; CFA
1  5532	2B5F  1E51r			     DW	$COL
   5533					 ; n ->	вывод содержимого экрана
   5534	2B61  1CE4r 20D4r 199Er	  +		  DW  DECIMA,CR,DUBL,SCR,STORE,PDOTQ
   5535	      201Dr 1B86r 2251r
   5536	2B6D  03 53 23 20			  DB  3,'S# '
   5537	2B71  2B37r				  DW  $DOT
   5538	2B73  0FD3r 0010 1F3Ar	  +		  DW  LIT,20Q,ZERO,XDO
   5539	      105Br
   5540	2B7B  20D4r 188Fr 1F52r	  +	LSTI:	  DW  CR,I,THREE,DOTR,SPACE
   5541	      2B08r 210Dr
   5542	2B85  188Fr 201Dr 1B4Er	  +		  DW  I,SCR,AT,DLINE
   5543	      284Er
   5544	2B8D  1084r FFEC 20D4r	  +		  DW XLOOP,LSTI-$,CR,SEMI
   5545	      1815r
   5546
   5547						  HEAD	  85h,'INDE',330Q,INDEX,$COL	      ;	INDEX
1  5548	      =ARRAY:2B95		 LINK$=$
1  5549	2B95  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5550							 ; 6 - признак immediate. 5- слово не описано smudge
1  5551	2B96  49 4E 44 45		     DB	 'INDE'
1  5552	2B9A  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  5553	2B9B  2B58r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5554	      =ARRAY:2B95		 LINK=LINK$
1  5555	2B9D				 INDEX LABEL FAR  ; CFA
1  5556	2B9D  1E51r			     DW	$COL
   5557					 ; n1 n2 -> выводит первую строку экранов с n1 по n2
   5558	2B9F  152Br 1952r 105Br			  DW  ONEP,SWAP,XDO
   5559	2BA5  20D4r 188Fr 1F52r	  +	INDX:	  DW  CR,I,THREE,DOTR,SPACE,ZERO,I,DLINE
   5560	      2B08r 210Dr 1F3Ar	  +
   5561	      188Fr 284Er
   5562	2BB5  1084r FFEE 1815r			  DW  XLOOP,INDX-$,SEMI
   5563
   5564						  HEAD	  84h,'TRI',317Q,TRIO,$COL	      ;	TRIO
1  5565	      =ARRAY:2BBB		 LINK$=$
1  5566	2BBB  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5567							 ; 6 - признак immediate. 5- слово не описано smudge
1  5568	2BBC  54 52 49			     DB	 'TRI'
1  5569	2BBF  CF			     DB	 317Q	; последний символ слова + 128 (7 бит =	1).
1  5570	2BC0  2B95r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5571	      =ARRAY:2BBB		 LINK=LINK$
1  5572	2BC2				 TRIO LABEL FAR	 ; CFA
1  5573	2BC2  1E51r			     DW	$COL
   5574					 ; При документировании	текстов	программ оказывается удобным размещать
   5575					 ; тексты экранов по три на странице
   5576	2BC4  0FD3r 000C 1356r			  DW  LIT,14Q,EMIT
   5577	2BCA  1F52r 1932r 1677r	  +		  DW  THREE,OVER,PLUS,SWAP,XDO
   5578	      1952r 105Br
   5579	2BD4  188Fr 2B5Fr 1084r	  +	TRI:	  DW  I,$LIST,XLOOP,TRI-$,SEMI
   5580	      FFFA 1815r
   5581
   5582						  HEAD	  85h,'VLIS',324Q,VLIST,$COL	      ;	VLIST
1  5583	      =ARRAY:2BDE		 LINK$=$
1  5584	2BDE  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5585							 ; 6 - признак immediate. 5- слово не описано smudge
1  5586	2BDF  56 4C 49 53		     DB	 'VLIS'
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 99
forth.asm



1  5587	2BE3  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  5588	2BE4  2BBBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5589	      =ARRAY:2BDE		 LINK=LINK$
1  5590	2BE6				 VLIST LABEL FAR  ; CFA
1  5591	2BE6  1E51r			     DW	$COL
   5592					 ; список слов в контекстном словаре
   5593	2BE8  2038r 1B4Er 1B4Er			  DW  CONT,AT,AT
   5594	2BEE  20D4r 1F52r 1F3Ar	  +	VL0:	  DW  CR,THREE,ZERO,XDO
   5595	      105Br
   5596	2BF6  199Er 24F9r 0FD3r	  +	VL1:	  DW  DUBL,IDDOT,LIT,15Q,OVER,CAT,LIT,37Q,$AND,SUBB
   5597	      000D 1932r 1B69r	  +
   5598	      0FD3r 001F 1733r	  +
   5599	      1693r
   5600	2C0A  2A4Br 211Br 199Er	  +		  DW  SPACS,PFA,DUBL,LIT,6,UDOTR,SPACE,LIT,41Q
   5601	      0FD3r 0006 2B1Ar	  +
   5602	      210Dr 0FD3r 0021
   5603	2C1C  1356r 210Dr 1BD1r	  +		  DW  EMIT,SPACE,   LFA,AT,DUBL,ZEQU,ZBRAN,VL2-$
   5604	      1B4Er 199Er 1164r	  +
   5605	      101Ar 0004
   5606	2C2C  1836r				  DW  LEAV ; добавил паузу
   5607	2C2E  1084r FFC6 1466r	  +	VL2:	  DW  XLOOP,VL1-$, KEY,	DROP
   5608	      1A49r
   5609	2C36  19BBr 1164r 101Ar	  +		  DW  DDUP,ZEQU,ZBRAN,VL0-$,SEMI
   5610	      FFB2 1815r
   5611
   5612						  HEAD	  83h,'LC',314Q,LCL,$COL	      ;	LCL
1  5613	      =ARRAY:2C40		 LINK$=$
1  5614	2C40  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  5615							 ; 6 - признак immediate. 5- слово не описано smudge
1  5616	2C41  4C 43			     DB	 'LC'
1  5617	2C43  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  5618	2C44  2BDEr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5619	      =ARRAY:2C40		 LINK=LINK$
1  5620	2C46				 LCL LABEL FAR	; CFA
1  5621	2C46  1E51r			     DW	$COL
   5622					 ; очистка командной строки
   5623	2C48  1F3Ar 1F3Ar 1419r	  +		  DW  ZERO,ZERO,FIX,$CL,SPACS,RC,SEMI
   5624	      1F6Cr 2A4Br 1395r	  +
   5625	      1815r
   5626
   5627						  HEAD	  82h,'H',324Q,HT,$COL		      ;	HT HOME?
1  5628	      =ARRAY:2C56		 LINK$=$
1  5629	2C56  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5630							 ; 6 - признак immediate. 5- слово не описано smudge
1  5631	2C57  48			     DB	 'H'
1  5632	2C58  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  5633	2C59  2C40r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5634	      =ARRAY:2C56		 LINK=LINK$
1  5635	2C5B				 HT LABEL FAR  ; CFA
1  5636	2C5B  1E51r			     DW	$COL
   5637					 ; курсор в начало экрана
   5638	2C5D  1F3Ar 1F3Ar 1419r	  +		  DW  ZERO,ZERO,FIX,SEMI
   5639	      1815r
   5640
   5641						  HEAD	  84h,'COP',331Q,COPY,$COL	      ;	COPY
1  5642	      =ARRAY:2C65		 LINK$=$
1  5643	2C65  84			     DB	 84h  ;	NFA 7 бит равен	1.
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 100
forth.asm



1  5644							 ; 6 - признак immediate. 5- слово не описано smudge
1  5645	2C66  43 4F 50			     DB	 'COP'
1  5646	2C69  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  5647	2C6A  2C56r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5648	      =ARRAY:2C65		 LINK=LINK$
1  5649	2C6C				 COPY LABEL FAR	 ; CFA
1  5650	2C6C  1E51r			     DW	$COL
   5651					 ; копия экрана
   5652	2C6E  1952r 27F8r 1BEFr	  +		  DW  SWAP,BLOCK,CFA,STORE,UPDAT,FLUSH,SEMI
   5653	      1B86r 1DFDr 277Fr	  +
   5654	      1815r
   5655
   5656						  HEAD	  82h,'T',331Q,TY$$,$COL	      ;	TY
1  5657	      =ARRAY:2C7C		 LINK$=$
1  5658	2C7C  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5659							 ; 6 - признак immediate. 5- слово не описано smudge
1  5660	2C7D  54			     DB	 'T'
1  5661	2C7E  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  5662	2C7F  2C65r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5663	      =ARRAY:2C7C		 LINK=LINK$
1  5664	2C81				 TY$$ LABEL FAR	 ; CFA
1  5665	2C81  1E51r			     DW	$COL
   5666					 ; adr n ->  дамп памяти
   5667	2C83  1F3Ar 105Br			  DW  ZERO,XDO
   5668	2C87  188Fr 1F5Ar 2710r	  +	TY4:	  DW  I,EIGHT,$MOD,ZEQU,ZBRAN,TY5-$
   5669	      1164r 101Ar 000C
   5670	2C93  20D4r 199Er 0FD3r	  +		  DW  CR,DUBL,LIT,7,UDOTR
   5671	      0007 2B1Ar
   5672	2C9D  199Er 1B4Er 0FD3r	  +	TY5:	  DW  DUBL,AT,LIT,7,UDOTR,TWOP,XLOOP,TY4-$,SEMI
   5673	      0007 2B1Ar 1546r	  +
   5674	      1084r FFDC 1815r
   5675
   5676						  HEAD	  85h,'DEPT',310Q,DEPTH,$COL	      ;	DEPTH
1  5677	      =ARRAY:2CAF		 LINK$=$
1  5678	2CAF  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5679							 ; 6 - признак immediate. 5- слово не описано smudge
1  5680	2CB0  44 45 50 54		     DB	 'DEPT'
1  5681	2CB4  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1  5682	2CB5  2C7Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5683	      =ARRAY:2CAF		 LINK=LINK$
1  5684	2CB7				 DEPTH LABEL FAR  ; CFA
1  5685	2CB7  1E51r			     DW	$COL
   5686					 ; число элементов в стеке
   5687	2CB9  1F7Er 1B4Er 17D0r	  +		  DW  SZERO,AT,SPAT,TWOP,SUBB,DIV2,SEMI
   5688	      1546r 1693r 159Ar	  +
   5689	      1815r
   5690
   5691						  HEAD	  84h,'DUM',320Q,DUMP,$COL	      ;	DUMP
1  5692	      =ARRAY:2CC7		 LINK$=$
1  5693	2CC7  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5694							 ; 6 - признак immediate. 5- слово не описано smudge
1  5695	2CC8  44 55 4D			     DB	 'DUM'
1  5696	2CCB  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  5697	2CCC  2CAFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5698	      =ARRAY:2CC7		 LINK=LINK$
1  5699	2CCE				 DUMP LABEL FAR	 ; CFA
1  5700	2CCE  1E51r			     DW	$COL
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 101
forth.asm



   5701					 ; адр u --> - Отображает u байт памяти	начиная	с адр
   5702	2CD0  1F3Ar 105Br			  DW  ZERO,XDO
   5703	2CD4  199Er 0FD3r 0007	  +	DMP:	  DW  DUBL,LIT,7,UDOTR,SPACE,EIGHT,ZERO,XDO
   5704	      2B1Ar 210Dr 1F5Ar	  +
   5705	      1F3Ar 105Br
   5706	2CE4  199Er 188Fr 1677r	  +	DP1:	  DW  DUBL,I,PLUS,CAT,LIT,5,DOTR,XLOOP,DP1-$
   5707	      1B69r 0FD3r 0005	  +
   5708	      2B08r 1084r FFF0
   5709	2CF6  0FD3r 0004 2A4Br	  +		  DW  LIT,4,SPACS,EIGHT,ZERO,XDO
   5710	      1F5Ar 1F3Ar 105Br
   5711	2D02  199Er 188Fr 1677r	  +	DP2:	  DW  DUBL,I,PLUS,CAT,LIT,177Q,$AND,DUBL,BLAN
   5712	      1B69r 0FD3r 007F	  +
   5713	      1733r 199Er 1F63r
   5714	2D14  1205r 101Ar 0008	  +		  DW  LESS,ZBRAN,DP3-$,DROP,LIT,56Q
   5715	      1A49r 0FD3r 002E
   5716	2D20  1356r 1084r FFDE	  +	DP3:	  DW  EMIT,XLOOP,DP2-$,CR,EIGHT,PLUS,EIGHT
   5717	      20D4r 1F5Ar 1677r	  +
   5718	      1F5Ar
   5719	2D2E  10B2r FFA4 1A49r	  +		  DW  XPLOO,DMP-$,DROP,SEMI
   5720	      1815r
   5721
   5722						  HEAD	  84h,'SWA',323Q,SWAS,$COL	      ;	SWAS
1  5723	      =ARRAY:2D36		 LINK$=$
1  5724	2D36  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5725							 ; 6 - признак immediate. 5- слово не описано smudge
1  5726	2D37  53 57 41			     DB	 'SWA'
1  5727	2D3A  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  5728	2D3B  2CC7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5729	      =ARRAY:2D36		 LINK=LINK$
1  5730	2D3D				 SWAS LABEL FAR	 ; CFA
1  5731	2D3D  1E51r			     DW	$COL
   5732					     ; перемены	 мест экранов М	и N
   5733	2D3F  1854r 27F8r 1BEFr	  +		  DW  TOR,BLOCK,CFA,DUBL,AT,I,BLOCK,CFA,STORE,UPDAT
   5734	      199Er 1B4Er 188Fr	  +
   5735	      27F8r 1BEFr 1B86r	  +
   5736	      1DFDr
   5737	2D53  1872r 0FD3r 8000	  +		  DW  FROMR,LIT,100000Q,$OR,SWAP,STORE,FLUSH,SEMI
   5738	      1750r 1952r 1B86r	  +
   5739	      277Fr 1815r
   5740
   5741						  HEAD	  83h,'ST',331Q,STY,$COL	      ;	STY
1  5742	      =ARRAY:2D63		 LINK$=$
1  5743	2D63  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  5744							 ; 6 - признак immediate. 5- слово не описано smudge
1  5745	2D64  53 54			     DB	 'ST'
1  5746	2D66  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  5747	2D67  2D36r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5748	      =ARRAY:2D63		 LINK=LINK$
1  5749	2D69				 STY LABEL FAR	; CFA
1  5750	2D69  1E51r			     DW	$COL
   5751					     ; печать стека
   5752	2D6B  2CB7r 19BBr 101Ar	  +		  DW  DEPTH,DDUP,ZBRAN,STY3-$,ZERO,XDO
   5753	      0024 1F3Ar 105Br
   5754	2D77  188Fr 1F5Ar 2710r	  +	STY1:	  DW  I,EIGHT,$MOD,ZEQU,ZBRAN,STY2-$,CR
   5755	      1164r 101Ar 0004	  +
   5756	      20D4r
   5757	2D85  188Fr 152Br 190Ar	  +	STY2:	  DW  I,ONEP,PICK,LIT,7,UDOTR,XLOOP,STY1-$
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 102
forth.asm



   5758	      0FD3r 0007 2B1Ar	  +
   5759	      1084r FFE4
   5760	2D95  1815r			STY3:	  DW  SEMI
   5761
   5762						  HEAD	  82h,'O',256Q,ODOT,$COL	      ;	O.
1  5763	      =ARRAY:2D97		 LINK$=$
1  5764	2D97  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5765							 ; 6 - признак immediate. 5- слово не описано smudge
1  5766	2D98  4F			     DB	 'O'
1  5767	2D99  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  5768	2D9A  2D63r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5769	      =ARRAY:2D97		 LINK=LINK$
1  5770	2D9C				 ODOT LABEL FAR	 ; CFA
1  5771	2D9C  1E51r			     DW	$COL
   5772					     ; тоже что	и S. в octal системе
   5773	2D9E  205Dr 1B4Er 1932r	  +		  DW  BASE,AT,OVER,OCTAL,UDOT,BASE,STORE,SEMI
   5774	      1D04r 2B50r 205Dr	  +
   5775	      1B86r 1815r
   5776
   5777						  HEAD	  83h,'R/',327Q,RW		      ;	R/W
1  5778	      =ARRAY:2DAE		 LINK$=$
1  5779	2DAE  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  5780							 ; 6 - признак immediate. 5- слово не описано smudge
1  5781	2DAF  52 2F			     DB	 'R/'
1  5782	2DB1  D7			     DB	 327Q	; последний символ слова + 128 (7 бит =	1).
1  5783	2DB2  2D97r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5784	      =ARRAY:2DAE		 LINK=LINK$
1  5785	2DB4				 RW LABEL FAR  ; CFA
1  5786	2DB4  2DB6r			     DW	 $+2
   5787					; Открытие файла
   5788	2DB6  BA 2E6Dr				  MOV	DX, OFFSET file
   5789						  ;MOV	 AH, 0FH      ;	open file
   5790	2DB9  B4 3D				  MOV	AH, 3dh
   5791	2DBB  B0 02				  mov	al, 2
   5792	2DBD  CD 21				  INT	21H
   5793						  ;CMP	 AL, 0FFH
   5794						  ;JE	 ERR0
   5795	2DBF  72 5F				  jc ERR0
   5796	2DC1  A3 2E6Br				  mov	 handle, ax
   5797	2DC4  5B				  POP	BX  ; R/W - флаг
   5798	2DC5  58				  POP	AX  ; Номер блока
   5799	2DC6  5A				  POP	DX  ; Адрес буфера
   5800	2DC7  48				  DEC	AX
   5801	2DC8  B1 0A				  MOV	CL, 10 ; 3 было
   5802	2DCA  D3 E0				  SAL	AX, CL	; (BLOCK#-1)*8 ; теперь	на 1024	байт
   5803						  ;MOV	 RANDREC,AX
   5804						  ;MOV	 RANDREC+2,0
   5805	2DCC  53				  push	 bx
   5806	2DCD  52				  push	 dx
   5807	2DCE  8B D0				  mov	 dx, ax
   5808	2DD0  B9 0000				  mov	 cx, 0
   5809	2DD3  B8 4200				  mov	 ax, 4200h
   5810	2DD6  8B 1E 2E6Br			  mov bx, handle
   5811	2DDA  CD 21				  int 21h
   5812	2DDC  72 42				  jc ERR0
   5813	2DDE  5A				  pop	 dx
   5814	2DDF  5B				  pop	 bx
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 103
forth.asm



   5815	2DE0  83 FB 00				  CMP	BX, 0 ;	режим
   5816	2DE3  75 0F				  JNE	RED
   5817					; WRITE
   5818						  ;MOV	 BX, DX
   5819						  ;MOV	 CX, 8	    ; Номер записи
   5820	2DE5				WR:	  ;MOV	 DX, BX
   5821						  ;MOV	 AH,1AH	    ; Запись адреса буфера (Set	disk transfer address)
   5822						  ;INT	 21H
   5823						  ;MOV	 DX,OFFSET FCB
   5824						  ;MOV	 AH, 22H    ; Запись RECORD (Random write)
   5825						  ;INT	 21H
   5826	2DE5  B4 40				  MOV	AH, 40H
   5827	2DE7  B9 0400				  MOV	CX, 1024
   5828	2DEA  8B 1E 2E6Br			  mov	 bx, handle
   5829	2DEE  CD 21				  INT	21H
   5830						  ;CMP	 AL, 0
   5831						  ;JNE	 ERR1
   5832	2DF0  72 33				  jc err1
   5833						  ;INC	 RANDREC    ; Коррекция	адреса буфера
   5834						  ;ADD	 BX, 80H
   5835						  ;LOOP	 WR
   5836	2DF2  EB 11				  JMP  OUT1
   5837
   5838	2DF4				 RED:	  ;MOV	 CX, 8
   5839						  ;MOV	 BX, DX
   5840					 ;RD:	  ;MOV	 DX, BX	      ;	адрес буфера
   5841						  ;MOV	 AH, 1AH     ; Запись адреса буфера
   5842	2DF4  B4 3F				  MOV	AH, 3fH
   5843	2DF6  B9 0400				  MOV	CX, 1024
   5844	2DF9  8B 1E 2E6Br			  mov	 bx, handle
   5845	2DFD  CD 21				  INT	21H
   5846	2DFF  72 2E				  jc ERR3
   5847	2E01  3B C1				  cmp ax,cx
   5848	2E03  75 2A				  jne err3
   5849						  ;MOV	 DX, OFFSET  FCB
   5850						  ;MOV	 AH, 21H      ;	Random read
   5851						  ;INT	 21H
   5852						  ;CMP	 AL, 0
   5853						  ;JNE	 ERR3
   5854						  ;INC	 RANDREC     ; Коррекция адреса
   5855						  ;ADD	 BX, 80H
   5856						 ; LOOP	  RD
   5857
   5858	2E05				OUT1:	  ;MOV	 DX, OFFSET  FCB  ; Закрытие файла
   5859	2E05  8B 1E 2E6Br			  mov bx, handle
   5860						  ;MOV	 AH, 10H
   5861	2E09  B4 3E				  mov ah, 3eh
   5862	2E0B  CD 21				  INT	21H
   5863						  ;CMP	 AL, 0
   5864						  ;JNE	 ERR2
   5865	2E0D  72 1B				  jc ERR2
   5866	2E0F				EXIT:	  NEXT
1  5867	2E0F  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  5868	2E10  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  5869					 ; ------ call debugger	--------
1  5870	2E12  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  5871	2E16  74 06			     jz	??0060
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 104
forth.asm



1  5872	2E18  E8 E136			     call printWORD
1  5873	2E1B  E8 E015			     call pause
1  5874	2E1E				   ??0060:
1  5875					 ; -----------------------------
1  5876	2E1E  FF 27			     JMP WORD PTR [BX]
   5877	2E20  BA 2E9Er			ERR0:	  MOV	DX, OFFSET  ERMES0
   5878	2E23  EB 0D				  JMP	DONE
   5879	2E25  BA 2EAFr			ERR1:	  MOV	DX, OFFSET  ERMES1
   5880	2E28  EB 08				  JMP	DONE
   5881	2E2A  BA 2EC0r			ERR2:	  MOV	DX, OFFSET  ERMES2
   5882	2E2D  EB 03				  JMP	DONE
   5883	2E2F  BA 2ED1r			ERR3:	  MOV	DX, OFFSET  ERMES3
   5884	2E32  B4 09			DONE:	  MOV	AH, 9H ; вывод сообщения
   5885	2E34  CD 21				  INT	21H
   5886	2E36  EB D7				  JMP	EXIT
   5887
   5888						  HEAD	  305Q,';COD','E'+80h,SEMIC,$COL	  ; ;CODE
1  5889	      =ARRAY:2E38		 LINK$=$
1  5890	2E38  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  5891							 ; 6 - признак immediate. 5- слово не описано smudge
1  5892	2E39  3B 43 4F 44		     DB	 ';COD'
1  5893	2E3D  C5			     DB	 'E'+80h   ; последний символ слова + 128 (7 бит = 1).
1  5894	2E3E  2DAEr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5895	      =ARRAY:2E38		 LINK=LINK$
1  5896	2E40				 SEMIC LABEL FAR  ; CFA
1  5897	2E40  1E51r			     DW	$COL
   5898					 ; для определения в форт программе слов на ассемблере
   5899	2E42  2188r 21BCr 21E9r	  +		  DW  QCSP,COMP,PSCOD,LBRAC,SMUG,SEMI
   5900	      1C88r 21D5r 1815r
   5901
   5902						  HEAD	  305Q,'FORT','H'+80h,FORTH,$DOE	  ; FORTH
1  5903	      =ARRAY:2E4E		 LINK$=$
1  5904	2E4E  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  5905							 ; 6 - признак immediate. 5- слово не описано smudge
1  5906	2E4F  46 4F 52 54		     DB	 'FORT'
1  5907	2E53  C8			     DB	 'H'+80h   ; последний символ слова + 128 (7 бит = 1).
1  5908	2E54  2E38r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5909	      =ARRAY:2E4E		 LINK=LINK$
1  5910	2E56				 FORTH LABEL FAR  ; CFA
1  5911	2E56  1F0Ar			     DW	$DOE
   5912					 ; Делает словарь Форт контекстным.
   5913					 ; см. FORTH DIMENSION
   5914	2E58  2663r				 DW  DOVOC   ; PFA
   5915	2E5A  A081				 DW 120201Q  ; = A0 81 мнимый заголовок	слова для связи	словарей
   5916	2E5C  2E60r				 DW TASK-7   ; PFA+4 NFA(TASK) последнее слово в этом словаре
   5917	2E5E				 XVOC	 LABEL	 FAR ; VOC-LINK
   5918	2E5E  0000				 DW  0	     ; ссылка на предыдущий словарь
   5919							     ; для чего	так и не нашел.	похоже,	здесь не используется
   5920					 ; VOC-LINK ---	addr U
   5921					 ;    A	user variable containing the address of	a field	in the definition
   5922					 ;    of the most recently created vocabulary. All vocabulary names are
   5923					 ;    linked by	these fields to	allow control for FORGETting thru multiple
   5924					 ;    vocabularies.
   5925
   5926						  HEAD	  84h,'TAS','K'+80h,TASK,$COL		 ; TASK
1  5927	      =ARRAY:2E60		 LINK$=$
1  5928	2E60  84			     DB	 84h  ;	NFA 7 бит равен	1.
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 105
forth.asm



1  5929							 ; 6 - признак immediate. 5- слово не описано smudge
1  5930	2E61  54 41 53			     DB	 'TAS'
1  5931	2E64  CB			     DB	 'K'+80h   ; последний символ слова + 128 (7 бит = 1).
1  5932	2E65  2E4Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5933	      =ARRAY:2E60		 LINK=LINK$
1  5934	2E67				 TASK LABEL FAR	 ; CFA
1  5935	2E67  1E51r			     DW	$COL
   5936					     ; пустое определение. последнее слово в словаре FORTH
   5937	2E69  1815r				  DW  SEMI
   5938
   5939	2E6B  0000			handle	 dw 0
   5940	2E6D  66 6F 72 74 68 2E	64+	file	 db "forth.dat", 0
   5941	      61 74 00
   5942					; FCB not used now
   5943	2E77				FCB	  LABEL	WORD
   5944	2E77  00			DRIVE	  DB	0
   5945	2E78  46 4F 52 54 48 20	20+	FN	  DB	'FORTH	 '
   5946	      20
   5947	2E80  44 41 54			EXT	  DB	'DAT'
   5948	2E83  0000			CURBLK	  DW	0	   ; Относительное начало файла
   5949	2E85  0080			RECSIZE	  DW	80H	   ; размер логичю записи
   5950	2E87  1388 0000			FILESIZE  DW	5000,0	   ; размер файла
   5951	2E8B  0000 0000			DATE	  DW	0,0
   5952	2E8F  00 00 00 00 00 00	00+		  DB	0,0,0,0,0, 0,0,0,0,0 ; REZERV
   5953	      00 00 00
   5954	2E99  00			CURREC	  DB	0	    ; запись с текущего	блока
   5955	2E9A  0000 0000			RANDREC	  DW	0,0	    ; номер записи
   5956
   5957	2E9E  45 52 52 20 4F 50	45+	ERMES0	  DB	'ERR OPENING FILE$'
   5958	      4E 49 4E 47 20 46	49+
   5959	      4C 45 24
   5960	2EAF  45 52 52 20 57 52	49+	ERMES1	  DB	'ERR WRITING FILE$'
   5961	      54 49 4E 47 20 46	49+
   5962	      4C 45 24
   5963	2EC0  45 52 52 20 43 4C	4F+	ERMES2	  DB	'ERR CLOSING FILE$'
   5964	      53 49 4E 47 20 46	49+
   5965	      4C 45 24
   5966	2ED1  45 52 52 20 52 45	41+	ERMES3	  DB	'ERR READING FILE$'
   5967	      44 49 4E 47 20 46	49+
   5968	      4C 45 24
   5969
   5970
   5971	2EE2  3E80*(0000)		XDP	DW  16000 DUP(0)	   ; DICTIONARY
   5972
   5973	0000				STCK   SEGMENT STACK		  ; Стек параметров
   5974	0000  40*(????)				DW  64 DUP (?)
   5975	0080				XS0	LABEL	WORD
   5976	0080  0000 0000				DW  0,0	  ; STACK
   5977	0084				STCK   ENDS
   5978
   5979	ABE2				ARRAY	   ENDS
   5980					END	   $INI
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 106
Symbol Table




Symbol Name			  Type	 Value

$ABS				  Far	 ARRAY:1711
$AND				  Far	 ARRAY:1733
$BUF				  Word	 ARRAY:0DB0
$CL				  Far	 ARRAY:1F6C
$COL				  Far	 ARRAY:1E51
$COMP				  Near	 ARRAY:1D73
$CON				  Far	 ARRAY:1E94
$DATE				  Word	 ARRAY:0004
$DO				  Far	 ARRAY:2963
$DOE				  Far	 ARRAY:1F0A
$DOT				  Far	 ARRAY:2B37
$DP				  Far	 ARRAY:1FC0
$ELSE				  Far	 ARRAY:2A0D
$EM				  Near	 ARRAY:1336
$EMIT				  Far	 ARRAY:1358
$EVEN				  Far	 ARRAY:1242
$EX				  Far	 ARRAY:20A3
$GO				  Near	 ARRAY:191A
$HEX				  Far	 ARRAY:1CC2
$IF				  Far	 ARRAY:29F6
$IN				  Far	 ARRAY:2009
$INI				  Far	 ARRAY:0DB4
$LESS				  Near	 ARRAY:10BF
$LIST				  Far	 ARRAY:2B5F
$LOOP				  Near	 ARRAY:110B
$MO				  Near	 ARRAY:2755
$MOD				  Far	 ARRAY:2710
$OR				  Far	 ARRAY:1750
$PAGE				  Far	 ARRAY:12B8
$REPE				  Near	 ARRAY:1A9D
$RS				  Word	 ARRAY:0DA2
$SIG				  Near	 ARRAY:10F9
$STI				  Word	 ARRAY:0D9C
$STK				  Word	 ARRAY:0DA0
$TIME				  Word	 ARRAY:0000
$TYPE				  Far	 ARRAY:2224
$UPD				  Near	 ARRAY:1E0A
$US				  Word	 ARRAY:0D9E
$USE				  Far	 ARRAY:1EDD
$VAR				  Far	 ARRAY:1EBB
$WARN				  Far	 ARRAY:1FAB
$WHILE				  Far	 ARRAY:29CE
$WIDTH				  Far	 ARRAY:1F9D
$WORD				  Far	 ARRAY:22EB
$XOR				  Far	 ARRAY:175E
??0000				  Near	 ARRAY:0E23
??0001				  Near	 ARRAY:0FE6
??0002				  Near	 ARRAY:100E
??0003				  Near	 ARRAY:1034
??0004				  Near	 ARRAY:1052
??0005				  Near	 ARRAY:1079
??0006				  Near	 ARRAY:10A6
??0007				  Near	 ARRAY:117E
??0008				  Near	 ARRAY:125C
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 107
Symbol Table



??0009				  Near	 ARRAY:12A8
??000A				  Near	 ARRAY:12CE
??000B				  Near	 ARRAY:12F4
??000C				  Near	 ARRAY:1313
??000D				  Near	 ARRAY:134D
??000E				  Near	 ARRAY:13CF
??000F				  Near	 ARRAY:13ED
??0010				  Near	 ARRAY:1411
??0011				  Near	 ARRAY:1438
??0012				  Near	 ARRAY:145E
??0013				  Near	 ARRAY:147E
??0014				  Near	 ARRAY:14B0
??0015				  Near	 ARRAY:14E8
??0016				  Near	 ARRAY:1505
??0017				  Near	 ARRAY:1524
??0018				  Near	 ARRAY:153F
??0019				  Near	 ARRAY:155C
??001A				  Near	 ARRAY:1577
??001B				  Near	 ARRAY:1593
??001C				  Near	 ARRAY:15AF
??001D				  Near	 ARRAY:15CD
??001E				  Near	 ARRAY:15EC
??001F				  Near	 ARRAY:160A
??0020				  Near	 ARRAY:1631
??0021				  Near	 ARRAY:1652
??0022				  Near	 ARRAY:1671
??0023				  Near	 ARRAY:168D
??0024				  Near	 ARRAY:16A9
??0025				  Near	 ARRAY:16CC
??0026				  Near	 ARRAY:16EB
??0027				  Near	 ARRAY:1709
??0028				  Near	 ARRAY:172B
??0029				  Near	 ARRAY:1749
??002A				  Near	 ARRAY:1786
??002B				  Near	 ARRAY:17A6
??002C				  Near	 ARRAY:17B8
??002D				  Near	 ARRAY:17F1
??002E				  Near	 ARRAY:180E
??002F				  Near	 ARRAY:182C
??0030				  Near	 ARRAY:184D
??0031				  Near	 ARRAY:186B
??0032				  Near	 ARRAY:1889
??0033				  Near	 ARRAY:18A3
??0034				  Near	 ARRAY:1901
??0035				  Near	 ARRAY:1929
??0036				  Near	 ARRAY:1949
??0037				  Near	 ARRAY:1967
??0038				  Near	 ARRAY:1996
??0039				  Near	 ARRAY:19B2
??003A				  Near	 ARRAY:19E3
??003B				  Near	 ARRAY:1A02
??003C				  Near	 ARRAY:1A22
??003D				  Near	 ARRAY:1A40
??003E				  Near	 ARRAY:1A5D
??003F				  Near	 ARRAY:1A8A
??0040				  Near	 ARRAY:1AB1
??0041				  Near	 ARRAY:1AF2
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 108
Symbol Table



??0042				  Near	 ARRAY:1B0E
??0043				  Near	 ARRAY:1B2A
??0044				  Near	 ARRAY:1B48
??0045				  Near	 ARRAY:1B62
??0046				  Near	 ARRAY:1B80
??0047				  Near	 ARRAY:1B9B
??0048				  Near	 ARRAY:1BB7
??0049				  Near	 ARRAY:1BE7
??004A				  Near	 ARRAY:1C05
??004B				  Near	 ARRAY:1C22
??004C				  Near	 ARRAY:1C3F
??004D				  Near	 ARRAY:1C5E
??004E				  Near	 ARRAY:1C82
??004F				  Near	 ARRAY:1C9E
??0050				  Near	 ARRAY:1CBA
??0051				  Near	 ARRAY:1CD8
??0052				  Near	 ARRAY:1CFA
??0053				  Near	 ARRAY:1D1A
??0054				  Near	 ARRAY:1D3B
??0055				  Near	 ARRAY:1D65
??0056				  Near	 ARRAY:1D92
??0057				  Near	 ARRAY:1DB9
??0058				  Near	 ARRAY:1DF2
??0059				  Near	 ARRAY:1E19
??005A				  Near	 ARRAY:1E37
??005B				  Near	 ARRAY:1E6B
??005C				  Near	 ARRAY:1EA8
??005D				  Near	 ARRAY:1ECE
??005E				  Near	 ARRAY:1EF4
??005F				  Near	 ARRAY:1F28
??0060				  Near	 ARRAY:2E1E
??DATE				  Text	 "04/28/20"
??FILENAME			  Text	 "forth	  "
??TIME				  Text	 "17:15:46"
??VERSION			  Number 030A
?TER$				  Far	 ARRAY:14BA
?TERM				  Far	 ARRAY:20C3
@32BIT				  Text	 0
@@1				  Near	 ARRAY:0F28
@@2				  Near	 ARRAY:0F40
@@ASCII				  Byte	 ARRAY:0E9E
@@ASCII				  Byte	 ARRAY:0EEB
@@ASCII				  Byte	 ARRAY:0F1F
@@CAPTION			  Byte	 ARRAY:0E91
@@CAPTION			  Byte	 ARRAY:0EE5
@@CAPTION			  Byte	 ARRAY:0F16
@@CR				  Byte	 ARRAY:0FB6
@@L				  Near	 ARRAY:0EB1
@@R				  Near	 ARRAY:0EDD
@@R				  Near	 ARRAY:0F0E
@@R				  Near	 ARRAY:0EC2
@CODE				  Text	 _TEXT
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 ARRAY
@D				  Near	 ARRAY:0E6F
@DATA				  Text	 DGROUP
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 109
Symbol Table



@DATASIZE			  Text	 0
@E				  Near	 ARRAY:0E5C
@FILENAME			  Text	 FORTH
@INTERFACE			  Text	 00H
@MODEL				  Text	 2
@R				  Near	 ARRAY:0E74
@RS				  Near	 ARRAY:0E65
@S				  Near	 ARRAY:0E6A
@STACK				  Text	 DGROUP
@START				  Near	 ARRAY:0E33
@V				  Near	 ARRAY:0E60
@WORDSIZE			  Text	 2
A				  Near	 ARRAY:1270
AA				  Near	 ARRAY:1284
AAA1				  Near	 ARRAY:1274
AB				  Near	 ARRAY:171B
ABORT				  Far	 ARRAY:26AE
AGAIN				  Far	 ARRAY:29B8
ALLOT				  Far	 ARRAY:1C49
ARROW				  Far	 ARRAY:28D4
ASCII				  Byte	 ARRAY:0F91
AT				  Far	 ARRAY:1B4E
ATR				  Far	 ARRAY:1FED
BACK				  Far	 ARRAY:2942
BASE				  Far	 ARRAY:205D
BBUF				  Far	 ARRAY:1F75
BCK				  Near	 ARRAY:282A
BCOM				  Far	 ARRAY:2568
BDIGS				  Far	 ARRAY:2A68
BEGIN				  Far	 ARRAY:2954
BLAN				  Far	 ARRAY:1F63
BLANK				  Far	 ARRAY:1ACA
BLANKBUFFER			  Near	 ARRAY:0F49
BLC				  Near	 ARRAY:283E
BLK				  Far	 ARRAY:2000
BLO				  Near	 ARRAY:2812
BLOCK				  Far	 ARRAY:27F8
BN				  Near	 ARRAY:2334
BN1				  Near	 ARRAY:236A
BR1				  Near	 ARRAY:27C0
BR2				  Near	 ARRAY:27E0
BRAN				  Far	 ARRAY:103F
BUFFE				  Far	 ARRAY:27B6
BUILD				  Far	 ARRAY:2201
BYE				  Far	 ARRAY:1F30
C$				  Near	 ARRAY:19A2
CAT				  Far	 ARRAY:1B69
CCOM				  Far	 ARRAY:20F9
CFA				  Far	 ARRAY:1BEF
CLEAR				  Near	 ARRAY:13FD
CMOV				  Far	 ARRAY:1A67
CNT				  Near	 ARRAY:1041
COLON				  Far	 ARRAY:1E3D
COMMA				  Far	 ARRAY:20E8
COMP				  Far	 ARRAY:21BC
COMPA				  Near	 ARRAY:1D4D
CON				  Far	 ARRAY:1E8A
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 110
Symbol Table



CONT				  Far	 ARRAY:2038
COPY				  Far	 ARRAY:2C6C
COUNT				  Far	 ARRAY:2211
CR				  Far	 ARRAY:20D4
CRE				  Near	 ARRAY:2528
CREAT				  Far	 ARRAY:2512
CSP				  Far	 ARRAY:2071
CSTOR				  Far	 ARRAY:1BA2
CURBLK				  Word	 ARRAY:2E83
CURR				  Far	 ARRAY:2046
CURREC				  Byte	 ARRAY:2E99
D0TQ				  Far	 ARRAY:226A
DABS				  Far	 ARRAY:163A
DATE				  Word	 ARRAY:2E8B
DDOT				  Far	 ARRAY:2B29
DDOTR				  Far	 ARRAY:2AE5
DDROP				  Far	 ARRAY:1A2C
DDUP				  Far	 ARRAY:19BB
DEB				  Far	 ARRAY:20B7
DEBUG				  Number 0001
DECIMA				  Far	 ARRAY:1CE4
DEEP				  Near	 ARRAY:17A8
DEFIN				  Far	 ARRAY:1DA2
DEPTH				  Far	 ARRAY:2CB7
DFIND				  Far	 ARRAY:237C
DIG				  Far	 ARRAY:2AA4
DIGI				  Near	 ARRAY:2AC0
DIGIT				  Far	 ARRAY:1142
DIGS				  Far	 ARRAY:2ACF
DIS				  Near	 ARRAY:2AD1
DIV2				  Far	 ARRAY:159A
DLI				  Near	 ARRAY:25AF
DLINE				  Far	 ARRAY:284E
DLITE				  Far	 ARRAY:259F
DMIN				  Near	 ARRAY:1618
DMINU				  Far	 ARRAY:1615
DMP				  Near	 ARRAY:2CD4
DOES				  Far	 ARRAY:1EFE
DONE				  Near	 ARRAY:2E32
DOTR				  Far	 ARRAY:2B08
DOVOC				  Far	 ARRAY:2663
DP1				  Near	 ARRAY:2CE4
DP2				  Near	 ARRAY:2D02
DP3				  Near	 ARRAY:2D20
DPL				  Far	 ARRAY:2067
DPLUS				  Far	 ARRAY:16B0
DRIVE				  Byte	 ARRAY:2E77
DRO				  Near	 ARRAY:1A2E
DROP				  Far	 ARRAY:1A49
DRP				  Near	 ARRAY:1A4B
DSKBUF				  Word	 ARRAY:0006
DSPL				  Far	 ARRAY:1441
DSWAP				  Far	 ARRAY:1971
DTRAI				  Far	 ARRAY:1D46
DU				  Near	 ARRAY:19A1
DUBL				  Far	 ARRAY:199E
DUMP				  Far	 ARRAY:2CCE
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 111
Symbol Table



DUP2				  Far	 ARRAY:19CC
EDIGS				  Far	 ARRAY:2A77
EIGHT				  Far	 ARRAY:1F5A
EMI$				  Far	 ARRAY:131B
EMIT				  Far	 ARRAY:1356
ENCL				  Far	 ARRAY:126A
ENDA				  Near	 ARRAY:1739
ENDBUF				  Word	 ARRAY:0C12
ENT				  Near	 ARRAY:0DBE
ENT$				  Near	 ARRAY:1359
EQGR				  Far	 ARRAY:1231
EQLES				  Far	 ARRAY:1214
EQUAL				  Far	 ARRAY:11D9
EQW				  Near	 ARRAY:1290
ER				  Near	 ARRAY:24B5
ER1				  Near	 ARRAY:24B9
ERASE				  Far	 ARRAY:1ABB
ERB				  Far	 ARRAY:20AD
ERMES0				  Byte	 ARRAY:2E9E
ERMES1				  Byte	 ARRAY:2EAF
ERMES2				  Byte	 ARRAY:2EC0
ERMES3				  Byte	 ARRAY:2ED1
ERMES4				  Byte	 ARRAY:1380
ERR0				  Near	 ARRAY:2E20
ERR1				  Near	 ARRAY:2E25
ERR2				  Near	 ARRAY:2E2A
ERR3				  Near	 ARRAY:2E2F
ERR4				  Near	 ARRAY:136F
ERROR				  Far	 ARRAY:24CD
EXEC				  Far	 ARRAY:0FC8
EXIT				  Near	 ARRAY:2E0F
EXP				  Near	 ARRAY:243F
EXPE				  Far	 ARRAY:1489
EXT				  Byte	 ARRAY:2E80
FAIL				  Near	 ARRAY:1135
FALSE				  Near	 ARRAY:116C
FALSE1				  Near	 ARRAY:124A
FAST				  Near	 ARRAY:10E7
FCB				  Word	 ARRAY:2E77
FENCE				  Far	 ARRAY:1FB7
FILE				  Byte	 ARRAY:2E6D
FILESIZE			  Word	 ARRAY:2E87
FILL				  Far	 ARRAY:1A93
FIN				  Near	 ARRAY:23A0
FIRST				  Far	 ARRAY:1FD7
FIX				  Far	 ARRAY:1419
FL1				  Near	 ARRAY:27A1
FLL				  Near	 ARRAY:1A96
FLU				  Near	 ARRAY:278B
FLUSH				  Far	 ARRAY:277F
FN				  Byte	 ARRAY:2E78
FORGE				  Far	 ARRAY:2905
FORTH				  Far	 ARRAY:2E56
FROMR				  Far	 ARRAY:1872
G$				  Near	 ARRAY:1622
GO$				  Near	 ARRAY:0E25
GREAT				  Far	 ARRAY:1222
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 112
Symbol Table



HANDLE				  Word	 ARRAY:2E6B
HERE				  Far	 ARRAY:1C2B
HLD				  Far	 ARRAY:2084
HOLD				  Far	 ARRAY:1AD8
HT				  Far	 ARRAY:2C5B
I				  Far	 ARRAY:188F
IDDOT				  Far	 ARRAY:24F9
IL				  Far	 ARRAY:13A1
IMMED				  Far	 ARRAY:262C
INDEX				  Far	 ARRAY:2B9D
INDX				  Near	 ARRAY:2BA5
INIT				  Far	 ARRAY:0DBC
INTER				  Far	 ARRAY:25E4
IT1				  Near	 ARRAY:25E6
IT2				  Near	 ARRAY:25FC
IT3				  Near	 ARRAY:2602
IT4				  Near	 ARRAY:2616
IT5				  Near	 ARRAY:261A
J				  Far	 ARRAY:18BD
JT				  Far	 ARRAY:18C9
K				  Far	 ARRAY:18D4
KEY				  Far	 ARRAY:1466
KT				  Far	 ARRAY:18E0
LATES				  Far	 ARRAY:1D25
LBRAC				  Far	 ARRAY:1C88
LCL				  Far	 ARRAY:2C46
LEAV				  Far	 ARRAY:1836
LESS				  Far	 ARRAY:1205
LEV				  Far	 ARRAY:18ED
LFA				  Far	 ARRAY:1BD1
LIL				  Near	 ARRAY:2592
LIMIT				  Far	 ARRAY:1FE3
LINK				  Number ARRAY:2E60
LINK$				  Number ARRAY:2E60
LIT				  Far	 ARRAY:0FD3
LITER				  Far	 ARRAY:2582
LOA				  Far	 ARRAY:28AC
LOO				  Far	 ARRAY:2976
LOP				  Near	 ARRAY:1089
LSTI				  Near	 ARRAY:2B7B
LV				  Near	 ARRAY:1091
M09				  Near	 ARRAY:1158
MATCH				  Near	 ARRAY:10F1
MAX				  Far	 ARRAY:17C0
MES				  Near	 ARRAY:2896
MESS				  Far	 ARRAY:2872
MIN				  Far	 ARRAY:178E
MINUS				  Far	 ARRAY:16D6
MM				  Near	 ARRAY:0F72
MMM1				  Near	 ARRAY:0F7D
MMO				  Near	 ARRAY:2370
MODA				  Far	 ARRAY:12FD
MROT				  Far	 ARRAY:1A0B
MS1				  Near	 ARRAY:2898
MSLAS				  Far	 ARRAY:1659
MSMOD				  Far	 ARRAY:2743
MSTAR				  Far	 ARRAY:15F3
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 113
Symbol Table



MSTOR				  Far	 ARRAY:1B15
MTBUF				  Far	 ARRAY:2769
MUL2				  Far	 ARRAY:157E
NEMI				  Near	 ARRAY:2469
NEQ				  Far	 ARRAY:11E8
NFA				  Far	 ARRAY:1BBF
NH0				  Near	 ARRAY:247B
NH1				  Near	 ARRAY:23D5
NH2				  Near	 ARRAY:23F1
NH3				  Near	 ARRAY:23FF
NH4				  Near	 ARRAY:2401
NH5				  Near	 ARRAY:2499
NH6				  Near	 ARRAY:24A3
NH7				  Near	 ARRAY:24AD
NO				  Near	 ARRAY:1D55
NOTEQ				  Near	 ARRAY:1277
NUL				  Near	 ARRAY:22CE
NULL				  Far	 ARRAY:22B6
NUMB				  Far	 ARRAY:23AB
NZEQ				  Far	 ARRAY:118B
OCTAL				  Far	 ARRAY:1D04
ODOT				  Far	 ARRAY:2D9C
OFLIM				  Near	 ARRAY:1D80
OFSET				  Far	 ARRAY:202A
OK				  Near	 ARRAY:133E
ONE				  Far	 ARRAY:1F42
ONEM				  Far	 ARRAY:1563
ONEP				  Far	 ARRAY:152B
OUT1				  Near	 ARRAY:2E05
OUTCR				  Near	 ARRAY:0FAE
OUTTEXT				  Near	 ARRAY:0FB9
OVER				  Far	 ARRAY:1932
PAD				  Far	 ARRAY:22D8
PAREN				  Far	 ARRAY:266F
PAUSE				  Near	 ARRAY:0E33
PB				  Near	 ARRAY:1DD9
PBUF				  Far	 ARRAY:1DC2
PDOTQ				  Far	 ARRAY:2251
PFA				  Far	 ARRAY:211B
PFIND				  Far	 ARRAY:10D3
PG				  Far	 ARRAY:1FF6
PICK				  Far	 ARRAY:190A
PIX				  Far	 ARRAY:12D6
PLOOP				  Far	 ARRAY:298C
PLU				  Near	 ARRAY:2479
PLUS				  Far	 ARRAY:1677
PNT				  Far	 ARRAY:2013
PNUMB				  Far	 ARRAY:2332
PORT				  Far	 ARRAY:14F1
PREV				  Far	 ARRAY:2099
PRIN				  Far	 ARRAY:13AF
PRINT				  Near	 ARRAY:1363
PRINTWORD			  Near	 ARRAY:0F51
PSCOD				  Far	 ARRAY:21E9
PSTOR				  Far	 ARRAY:1AF9
PUT				  Near	 ARRAY:116E
PUT1				  Near	 ARRAY:124C
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 114
Symbol Table



QCOMP				  Far	 ARRAY:2147
QCSP				  Far	 ARRAY:2188
QERR				  Far	 ARRAY:212F
QEXEC				  Far	 ARRAY:215F
QLOAD				  Far	 ARRAY:21A2
QPAIR				  Far	 ARRAY:2175
QSTAC				  Far	 ARRAY:25BA
QUERY				  Far	 ARRAY:229A
QUEST				  Far	 ARRAY:2B43
QUI				  Near	 ARRAY:268A
QUIT				  Far	 ARRAY:2680
R				  Far	 ARRAY:18A9
RANDREC				  Word	 ARRAY:2E9A
RBRAC				  Far	 ARRAY:1CA4
RC				  Far	 ARRAY:1395
READ				  Far	 ARRAY:150E
RECSIZE				  Word	 ARRAY:2E85
RED				  Near	 ARRAY:2DF4
REPEA				  Far	 ARRAY:29DD
RNUM				  Far	 ARRAY:207A
ROT				  Far	 ARRAY:19EB
RPSTO				  Far	 ARRAY:17F9
RR$				  Near	 ARRAY:1891
RW				  Far	 ARRAY:2DB4
RZERO				  Far	 ARRAY:1F87
SCL				  Far	 ARRAY:13F5
SCR				  Far	 ARRAY:201D
SCSP				  Far	 ARRAY:1C0E
SEMI				  Far	 ARRAY:1815
SEMIC				  Far	 ARRAY:2E40
SHOWRS				  Near	 ARRAY:0EC3
SHOWSTACK			  Near	 ARRAY:0EF1
SHOWSTDUMP			  Near	 ARRAY:0EA7
SHOWWD				  Near	 ARRAY:0E75
SIG				  Near	 ARRAY:2A9E
SIGN				  Far	 ARRAY:2A8E
SLASH				  Far	 ARRAY:2700
SLMOD				  Far	 ARRAY:26F0
SLOW				  Near	 ARRAY:1105
SLOW1				  Near	 ARRAY:1118
SMI				  Far	 ARRAY:1E71
SMUG				  Far	 ARRAY:21D5
SP1				  Near	 ARRAY:2A61
SPA				  Near	 ARRAY:2A5B
SPACE				  Far	 ARRAY:210D
SPACS				  Far	 ARRAY:2A4B
SPAT				  Far	 ARRAY:17D0
SPOT				  Far	 ARRAY:26D5
SPSTO				  Far	 ARRAY:17DD
SRP				  Far	 ARRAY:18B2
SSLA				  Far	 ARRAY:2731
SSMOD				  Far	 ARRAY:2720
STAR				  Far	 ARRAY:26E1
STATE				  Far	 ARRAY:2052
STOD				  Far	 ARRAY:176D
STORE				  Far	 ARRAY:1B86
STY				  Far	 ARRAY:2D69
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 115
Symbol Table



STY1				  Near	 ARRAY:2D77
STY2				  Near	 ARRAY:2D85
STY3				  Near	 ARRAY:2D95
SUBB				  Far	 ARRAY:1693
SWAB				  Far	 ARRAY:16F4
SWAP				  Far	 ARRAY:1952
SWAS				  Far	 ARRAY:2D3D
SZERO				  Far	 ARRAY:1F7E
TASK				  Far	 ARRAY:2E67
TC0				  Near	 ARRAY:2230
TC1				  Near	 ARRAY:2246
TER				  Near	 ARRAY:14C7
TERMON				  Far	 ARRAY:0FF1
THEN				  Far	 ARRAY:2A2E
THREE				  Far	 ARRAY:1F52
TIB				  Far	 ARRAY:1F91
TICK				  Far	 ARRAY:28EA
TOGL				  Far	 ARRAY:1B33
TOHEX				  Near	 ARRAY:0F25
TOP				  Near	 ARRAY:1796
TOR				  Far	 ARRAY:1854
TRAV				  Far	 ARRAY:1C67
TRI				  Near	 ARRAY:2BD4
TRIO				  Far	 ARRAY:2BC2
TRUE				  Near	 ARRAY:1180
TRUE1				  Near	 ARRAY:125E
TRV				  Near	 ARRAY:1C6B
TTT				  Near	 ARRAY:213B
TTY				  Far	 ARRAY:13D7
TWO				  Far	 ARRAY:1F4A
TWOP				  Far	 ARRAY:1546
TY$$				  Far	 ARRAY:2C81
TY4				  Near	 ARRAY:2C87
TY5				  Near	 ARRAY:2C9D
TYPE$				  Near	 ARRAY:13D9
UDOT				  Far	 ARRAY:2B50
UDOTR				  Far	 ARRAY:2B1A
ULESS				  Far	 ARRAY:11F7
UNTIL				  Far	 ARRAY:29A2
UPDAT				  Far	 ARRAY:1DFD
UPPER				  Far	 ARRAY:1D6F
USE				  Far	 ARRAY:208E
USER				  Far	 ARRAY:1ED7
USLAS				  Far	 ARRAY:15D4
USTAR				  Far	 ARRAY:15B6
VAR				  Far	 ARRAY:1EB5
VL0				  Near	 ARRAY:2BEE
VL1				  Near	 ARRAY:2BF6
VL2				  Near	 ARRAY:2C2E
VLIST				  Far	 ARRAY:2BE6
VOCAB				  Far	 ARRAY:2643
VOCL				  Far	 ARRAY:1FCB
WD1				  Near	 ARRAY:22FD
WD2				  Near	 ARRAY:2301
WR				  Near	 ARRAY:2DE5
X				  Far	 ARRAY:1E1F
XDO				  Far	 ARRAY:105B
Turbo Assembler	 Version 3.1	    04/28/20 17:15:56	    Page 116
Symbol Table



XDP				  Word	 ARRAY:2EE2
XER				  Near	 ARRAY:24ED
XLOOP				  Far	 ARRAY:1084
XPLOO				  Far	 ARRAY:10B2
XR0				  Word	 ARRAY:0CCC
XS0				  Word	 STCK:0080
XT				  Near	 ARRAY:2288
XTIB				  Word	 ARRAY:0C14
XUP				  Word	 ARRAY:0CD0
XVOC				  Far	 ARRAY:2E5E
XXX				  Near	 ARRAY:0DD4
Y$				  Near	 ARRAY:1D0B
Z$				  Near	 ARRAY:1894
ZBRAN				  Far	 ARRAY:101A
ZEQGR				  Far	 ARRAY:11AA
ZEQLES				  Far	 ARRAY:11C9
ZEQU				  Far	 ARRAY:1164
ZERO				  Far	 ARRAY:1F3A
ZGRET				  Far	 ARRAY:119A
ZLESS				  Far	 ARRAY:11B9
ZZZ				  Near	 ARRAY:12AA

Macro Name

HEAD
NEXT

Groups & Segments		  Bit Size Align  Combine Class

ARRAY				  16  ABE2 Para	  none
DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
STCK				  16  0084 Para	  Stack
_TEXT				  16  0000 Word	  Public  CODE
