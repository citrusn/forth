Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 1
forth.asm



      1				     ; 253 слова head
      2				     ; 103 слова используют $col
      3				     ; 9 слова использует $con
      4				     ; 29 слова	использует $use
      5				     ; 1 слово forth
      6
      7				     masm
      8				     .8086
      9	0000			     .MODEL SMALL
     10				     LOCALS
     11	      =0000		     LINK=0
     12					 ; Макроопределения
     13					 ; Описание примитивов и слов высокого уровня
     14
     15					 HEAD  MACRO length, name, lchar, labl,	code
     16					     LINK$=$
     17					     DB	 length	 ; NFA 7 бит равен 1.
     18							 ; 6 - признак immediate. 5- слово не описано smudge
     19					     IFNB <name>
     20					     DB	 name
     21					     ENDIF
     22					     DB	 lchar	 ; последний символ слова + 128	(7 бит = 1).
     23
     24					     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
     25					     LINK=LINK$
     26
     27					     labl LABEL	FAR  ; CFA
     28					     IFNB <code> ;
     29					     DW	code
     30					     ELSE
     31					     DW	 $+2
     32					     ENDIF
     33					 ENDM
     34					 HEAD2	MACRO length, name, lchar, labl, code
     35					     LINK$=$
     36					     DB	 length	 ; NFA 7 бит равен 1.
     37							 ; 6 - признак immediate. 5- слово не описано smudge
     38					     IFNB <name>
     39					     DB	 '&name','>'
     40					     ENDIF
     41					     DB	 lchar	 ; последний символ слова + 128	(7 бит = 1).
     42
     43					     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
     44					     LINK=LINK$
     45
     46					     labl LABEL	FAR  ; CFA
     47					     IFNB <code> ;
     48					     DW	code
     49					     ELSE
     50					     DW	 $+2
     51					     ENDIF
     52					 ENDM
     53
     54	      =0001			 debug equ 1
     55					 NEXT MACRO   ;	переход	к исполнению следующего	слова
     56					     local m1
     57					     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 2
forth.asm



     58					     MOV  BX, AX     ; BX равен	CFA  следующего	слова
     59					 ; ------ call debugger	--------
     60					 IF debug
     61					     cmp byte ptr [di+102Q], 0
     62					     jz	m1
     63					     call printWORD
     64					     call pause
     65					   m1:
     66					 ENDIF
     67					 ; -----------------------------
     68					     JMP WORD PTR [BX]
     69					 ENDM
     70
     71
     72	0000				ARRAY	SEGMENT
     73	0000  0000 0000			$TIME	DW  0,0			    ; TIMER COUNTER
     74	0004  0000			$DATE	DW  0			    ; DATE
     75
     76					;  Сегмент стека и словарь пользователя	размещен в конце текста
     77					;  интерпретатора. Для версии, записываемой в ПЗУ, их нужно
     78					;  разместить здесь.
     79
     80	0006  03*(0000 0200*(0000)+	DSKBUF	DW  3 DUP(0,512	DUP(0),0)   ; Экранные буферы на 1024 байта
     81	      0000)
     82	0C12  0000			ENDBUF	DW  0	     ; 6 1034 (40Ah) 2062(80Eh)	адреса буферов
     83
     84	0C14  5C*(0000)			XTIB	DW  92 DUP(0)		    ; Входной буфер
     85	0CCC  0000 0000			XR0	DW  0,0			    ; Стек возвратов  растет в область
     86									    ; меньших адресов.	ADD BP - убрать	данные
     87	0CD0  66*(0000)			XUP	DW  102	DUP(0)		    ; USER-область на нее указывает DI
     88
     89	0D9C  2FB1r			$STI	DW  TASK-7  ;		    ; Стартовая	таблица	PFA слова TASK
     90	0D9E  0CD0r			$US	DW  XUP	    ;		    ; адрес user области
     91					;    переменные
     92	0DA0  0080r			$STK	DW  XS0	    ;+6		     ; SO
     93	0DA2  0CCCr			$RS	DW  XR0	    ;+8		     ; RO стек возвратов
     94	0DA4  0C14r				DW  XTIB    ;+10	     ; входной буфер
     95	0DA6  001F				DW  1Fh	    ;+12	     ; WIDTH 31	буква
     96	0DA8  0000				DW  0	    ;+14	     ; WARNING
     97	0DAA  3033r				DW  XDP	    ;+16	     ; словарь FENCE (забор)
     98	0DAC  3033r				DW  XDP	    ;+18	     ; DP
     99	0DAE  2FAFr				DW  XVOC    ;+20	     ; словарь VOCL в слове Forth
    100	0DB0  0006r			$BUF	DW  DSKBUF  ;+22	     ; экранный	буфер FIRST
    101	0DB2  0C12r				DW  ENDBUF  ;+24 или 30Q     ; LIMIT
    102
    103					ASSUME	CS:ARRAY, DS:ARRAY, ES:ARRAY, SS:STCK
    104
    105
    106	0DB4				$INI	  PROC	  FAR
    107	0DB4  EB 09 90				  JMP  ENT
    108					; ** PRIMITIVES	**
    109						  HEAD	  83h,'IN',311Q,INIT		      ;INI
1   110	      =ARRAY:0DB7		     LINK$=$
1   111	0DB7  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   112							 ; 6 - признак immediate. 5- слово не описано smudge
1   113	0DB8  49 4E			     DB	 'IN'
1   114	0DBA  C9			     DB	 311Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 3
forth.asm



1   115
1   116	0DBB  0000			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   117	      =ARRAY:0DB7		     LINK=LINK$
1   118
1   119	0DBD				     INIT LABEL	FAR  ; CFA
1   120	0DBD  0DBFr			     DW	 $+2
    121	0DBF  B9 0000s			ENT:	  MOV	CX, ARRAY
    122	0DC2  8E D9				  MOV	DS, CX		; Установка DX
    123	0DC4  8E C1				  MOV	ES, CX
    124	0DC6  A1 0D9Cr				  MOV	AX, $STI	; Восстановление словаря (PFA слова TASK)
    125	0DC9  BE 2FADr				  LEA	SI, FORTH+6	; Адрес	места нахождения в PFA forth
    126	0DCC  89 04				  MOV	[SI], AX	;
    127	0DCE  8B 36 0DB0r			  MOV	SI, $BUF
    128	0DD2  B9 06CB				  MOV	CX, 1739	; Установка счетчика 1730
    129	0DD5  C7 04 0000		XXX:	  MOV	WORD PTR [SI],0	; Обнуление массивов
    130	0DD9  83 C6 02				  ADD	SI, 2
    131	0DDC  E2 F7				  LOOP	XXX
    132
    133					; INIT 'OFFSET,	USE, PREV
    134	0DDE  8B 1E 0D9Er			  MOV	BX, $US		 ; xup
    135	0DE2  8B 0E 0DB0r			  MOV	CX, $BUF	 ; TO 'USE'
    136	0DE6  89 4F 3A				  MOV	[BX]+72Q,CX	 ; USE ? адрес блока
    137	0DE9  89 4F 3C				  MOV	[BX]+74Q,CX	 ; PREV	? адрес	блока
    138	0DEC  C7 47 42 0000			  MOV	word ptr [BX]+102Q,00h	    ; отладка выключена
    139	0DF1  B9 000A				  MOV	CX, 10		 ; Установка счетчика USER (14Q	надо на	2 меньше уже)
    140	0DF4  8B 3E 0D9Er			  MOV	DI, $US		 ; Запись адреса области USER
    141	0DF8  83 C7 06				  ADD	DI, 6		 ; почему 6....	? User переменные начинаются с 6 адреса
    142	0DFB  BE 0DA0r				  LEA	SI, $STK	 ; Запись начального адреса
    143						  ; заполняем начальные	значения переменых
    144	0DFE  F3> A5			REP	  MOVS	WORD PTR ES:[DI], WORD PTR DS:[SI]
    145	0E00  8B 2E 0DA2r			  MOV	BP, $RS		 ; Установка начального	значения
    146									 ; указателя стека возвратов
    147									 ; пересекается	с областью TIB
    148									 ; RS растет в область с меньшими адресами
    149	0E04  8B 3E 0D9Er			  MOV	DI, $US
    150	0E08  C7 45 1A 0007			  MOV	WORD PTR [DI+32Q],7  ; Установка цвета вывода текста
    151	0E0D  C7 45 22 0000			  MOV	WORD PTR [DI+42Q],0  ; Сброс флага печати
    152	0E12  BE 0E26r				  LEA	SI, GO$
    153						  NEXT
1   154	0E15  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   155	0E16  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   156					 ; ------ call debugger	--------
1   157	0E18  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   158	0E1C  74 06			     jz	??0000
1   159	0E1E  E8 0131			     call printWORD
1   160	0E21  E8 0010			     call pause
1   161	0E24				   ??0000:
1   162					 ; -----------------------------
1   163	0E24  FF 27			     JMP WORD PTR [BX]
    164						  ; здесь инструкции языка форт. указатель на них в SI
    165	0E26  18A3r 1E06r 2FA7r	  +	GO$:	  DW SPSTO,DECIMA,FORTH,DEFIN, ONE,LOA,	quit; загрузка первого экрана
    166	      1EC4r 2064r 29F9r	  +
    167	      27CDr
    168	0E34			     $INI      ENDP
    169
    170				     include debug.asm
1   171				     ; ╨╛╨▒╤А╨░╨▒╨╛╤В╨║╨░ ╨╜╨░╨╢╨░╤В╨╕╤П ╨║╨╗╨░╨▓╨╕╤И
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 4
forth.asm



1   172	0E34			     pause proc
1   173	0E34				 @start:
1   174	0E34  33 C0			     xor ax, ax
1   175	0E36  CD 16			     int 16h ; AL = ASCII ╤Б╨╕╨╝╨▓╨╛╨╗ (╨╡╤Б╨╗╨╕ AL=0, AH ╤Б╨╛╨┤╨╡╤А╨╢╨╕╤В		    +
    176				     ╤А╨░╤Б╤И╨╕╤А╨╡╨╜╨╜╤Л╨╣ ╨║╨╛╨┤ ASCII )
1   177						     ; AH = ╤Б╨║╨░╨╜╨║╨╛╨┤  ╨╕╨╗╨╕ ╤А╨░╤Б╤И╨╕╤А╨╡╨╜╨╜╤Л╨╣ ╨║╨╛╨┤ ASCII
1   178	0E38  80 FC 10			     cmp ah, 10h ; ╨║╨╗╨░╨▓╨╕╤И╨░ Q (quit)
1   179	0E3B  74 20			     je	@e
1   180	0E3D  80 FC 20			     cmp ah, 20h ; ╨║╨╗╨░╨▓╨╕╤И╨░ D (debug off)
1   181	0E40  74 2E			     je	@d
1   182	0E42  80 FC 1F			     cmp ah, 1Fh ; ╨║╨╗╨░╨▓╨╕╤И╨░ S (show parameters stack)
1   183	0E45  74 24			     je	@s
1   184	0E47  80 FC 13			     cmp ah, 13h ; ╨║╨╗╨░╨▓╨╕╤И╨░ R (show return stack)
1   185	0E4A  74 1A			     je	@rs
1   186	0E4C  80 FC 31			     cmp ah, 31h ; ╨║╨╗╨░╨▓╨╕╤И╨░ N (next step)
1   187	0E4F  74 24			     je	@r
1   188	0E51  80 FC 39			     cmp ah, 39h ; ╨║╨╗╨░╨▓╨╕╤И╨░ SPACE	(next step)
1   189	0E54  74 1F			     je	@r
1   190	0E56  80 FC 11			     cmp ah, 11h ; ╨║╨╗╨░╨▓╨╕╤И╨░ W(next word from dict)
1   191	0E59  74 06			     je	@v
1   192	0E5B  EB D7			     jmp @start
1   193	0E5D  B4 4C			 @e: mov ah, 4Ch ; ╨▓╤Л╤Е╨╛╨┤ ╨╕╨╖ ╨┐╤А╨╛╨│╤А╨░╨╝╨╝╤Л
1   194	0E5F  CD 21			     int 21h
1   195	0E61  E8 0012			 @v: call showWD
1   196	0E64  EB CE			     jmp @start
1   197	0E66  E8 005B			 @rs: call showRS
1   198	0E69  EB C9			     jmp @start
1   199	0E6B  E8 0084			 @s: call showStack
1   200	0E6E  EB C4			     jmp @start
1   201	0E70  C7 45 42 0000		 @d: mov word ptr [DI]+102Q,00h	 ; ╨╛╤В╨╗╨░╨┤╨║╨░ ╨▓╤Л╨║╨╗╤О╤З╨╡╨╜╨░
1   202					     ;jmp @start
1   203	0E75  C3			 @r: ret
1   204	0E76			     pause endp
1   205
1   206	0E76			     proc showWD
1   207	0E76  57			 push di
1   208	0E77  53			 push bx
1   209	0E78  BA 0E92r			 mov dx, offset	@@caption
1   210	0E7B  E8 013C			 call outText
1   211	0E7E  BF 0E9Fr			 mov di,OFFSET @@ASCII ;
1   212	0E81  8B 04			 mov ax, [si]
1   213	0E83  E8 00A0			 call toHex
1   214	0E86  BA 0E9Fr			 mov dx, offset	@@ASCII
1   215	0E89  E8 012E			 call outText
1   216	0E8C  E8 0120			 call outCR
1   217	0E8F  5B			 pop bx
1   218	0E90  5F			 pop di
1   219	0E91  C3			 ret
1   220	0E92  4E 45 58 54 20 57	4F+	 @@caption DB "NEXT WORD:  $"
    221	      52 44 3A 20 20 24
1   222	0E9F  30 30 30 30 20 20	20+	 @@ASCII DB "0000    $"
    223	      20 24
1   224	0EA8			     showWD endp
1   225
1   226				     ; ╨┐╨╡╤З╨░╤В╤М ╨┤╨░╨╝╨┐╨░ ╨┐╨░╨╝╤П╤В╨╕ ╨▓ ╨┐╨╛╤А╤П╨┤╨║╨╡ ╤Б╤В╨╡╨║╨░
1   227				     ; c╤Е - ╤З╨╕╤Б╨╗╨╛	╨▒╨░╨╣╤В
1   228				     ; bx - ╨░╨┤╤А╨╡╤Б ╨┐╨░╨╝╤П╤В╨╕
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 5
forth.asm



1   229				     ; dx - ╨░╨┤╤А╨╡╤Б ╤Б╤В╤А╨╛╨║╨╕
1   230	0EA8			     showStDump	proc
1   231	0EA8  D1 E9			 shr cx, 1   ; ╨▒╨░╨╣╤В╤Л ╨▓ ╤Б╨╗╨╛╨▓╨░
1   232	0EAA  0B C9			 or cx , cx
1   233	0EAC  74 15			 jz @@r
1   234	0EAE  8C D0			 mov ax, ss
1   235	0EB0  8E C0			 mov es, ax
1   236	0EB2			       @@l:
1   237	0EB2  4B			 dec bx
1   238	0EB3  4B			 dec bx
1   239	0EB4  26: 8B 07			 mov ax, es:[bx]
1   240	0EB7  53			 push bx
1   241	0EB8  8B FA			 mov di, dx
1   242	0EBA  E8 0069			 call toHex
1   243					 ;mov dx, offset @@ASCII
1   244	0EBD  E8 00FA			 call outText
1   245	0EC0  5B			 pop bx
1   246	0EC1  E2 EF			 loop @@l
1   247	0EC3			       @@r:
1   248	0EC3  C3			 ret
1   249	0EC4			     showStDump	endP
1   250
1   251				     ; ╤Б╤В╨╡╨║	╨▓╨╛╨╖╨▓╤А╨░╤В╨╛╨▓
1   252	0EC4			     showRS proc
1   253	0EC4  57			 push di
1   254	0EC5  56			 push si
1   255	0EC6  06			 push es
1   256	0EC7  53			 push bx
1   257	0EC8  BA 0EE6r			 mov dx, offset	@@caption
1   258	0ECB  E8 00EC			 call outText
1   259	0ECE  B9 0CCCr			 mov cx, offset	XR0
1   260	0ED1  8B DD			 mov bx, BP
1   261	0ED3  2B CB			 sub cx, bx
1   262	0ED5  BA 0EECr			 mov dx, offset	@@ASCII
1   263	0ED8  BB 0CCCr			 mov bx, offset	XR0
1   264	0EDB  E8 FFCA			 call showStDump
1   265	0EDE			       @@r:
1   266	0EDE  E8 00CE			 call outCR
1   267	0EE1  5B			 pop bx
1   268	0EE2  07			 pop es
1   269	0EE3  5E			 pop si
1   270	0EE4  5F			 pop di
1   271	0EE5  C3			 ret
1   272	0EE6  52 53 3A 20 20 24		 @@caption DB "RS:  $"
1   273	0EEC  30 30 30 30 20 24		 @@ASCII DB "0000 $"
1   274	0EF2			     showRS endP
1   275
1   276				     ; ╤Б╤В╨╡╨║	╨┐╨░╤А╨░╨╝╨╡╤В╤А╨╛╨▓
1   277	0EF2			     showStack proc
1   278	0EF2  57			 push di
1   279	0EF3  56			 push si
1   280	0EF4  06			 push es
1   281	0EF5  53			 push bx
1   282	0EF6  BA 0F17r			 mov dx, offset	@@caption
1   283	0EF9  E8 00BE			 call outText
1   284	0EFC  B9 0080			 mov cx, 80h
1   285	0EFF  8B DC			 mov bx, SP
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 6
forth.asm



1   286	0F01  83 C3 0C			 add bx, 2*6   ; ╤Б╤В╨╛╨╗╤М╨║╨╛	╨╗╨╕╤И╨╜╨╕╤Е ╤Н╨╗╨╡╨╝╨╡╨╜╤В╨╛╨▓	╤Б╤В╨╡╨║╨╡
1   287	0F04  2B CB			 sub cx, bx
1   288	0F06  BB 0080			 mov bx, 80h
1   289	0F09  BA 0F20r			 mov dx, offset	@@ASCII
1   290	0F0C  E8 FF99			 call showStDump
1   291	0F0F			       @@r:
1   292	0F0F  E8 009D			 call outCR
1   293	0F12  5B			 pop bx
1   294	0F13  07			 pop es
1   295	0F14  5E			 pop si
1   296	0F15  5F			 pop di
1   297	0F16  C3			 ret
1   298	0F17  53 54 41 43 4B 3A	20+	 @@caption DB "STACK:  $"
    299	      20 24
1   300	0F20  30 30 30 30 20 24		 @@ASCII DB "0000 $"
1   301	0F26			     showStack endP
1   302
1   303				     ; AX- ╨╖╨╜╨░╤З╨╡╨╜╨╕╨╡ ╨┤╨╗╤П ╨┐╨╡╤З╨░╤В╨╕	╨▓ 16 ╨▓╨╕╨┤╨╡
1   304				     ; di - ╨░╨┤╤А╨╡╤Б ╤Б╤В╤А╨╛╨║╨╕ ╨┤╨╗╤П ╨▓╤Л╨▓╨╛╨┤╨░
1   305	0F26			     toHex PROC
1   306	0F26  51			 push cx
1   307	0F27  B1 04			 mov cl,4	     ; number of ASCII
1   308	0F29  D1 C0 D1 C0 D1 C0	D1+  @@1: rol ax,4	     ; 1 Nibble	(start with highest byte)
    309	      C0
1   310	0F31  8A D8			 mov bl,al
1   311	0F33  80 E3 0F			 and bl,0Fh	     ; only low-Nibble
1   312	0F36  80 C3 30			 add bl,30h	     ; convert to ASCII
1   313	0F39  80 FB 39			 cmp bl,39h	     ; above 9?
1   314	0F3C  76 03			 jna short @@2
1   315	0F3E  80 C3 07			 add bl,7	     ; "A" to "F"
1   316	0F41  88 1D		     @@2: mov [di],bl	      ;	store ASCII in buffer
1   317	0F43  47			 inc di		     ; increase	target address
1   318	0F44  FE C9			 dec cl		     ; decrease	loop counter
1   319	0F46  75 E1			 jnz @@1	      ;	jump if	cl is not equal	0 (zeroflag is not set)
1   320	0F48  59			 pop cx
1   321	0F49  C3			 ret
1   322	0F4A			     toHex endP
1   323
1   324				     ; di- ╨░╨┤╤А╨╡╤Б ╨▒╤Г╤Д╨╡╤А╨░
1   325				     ; cx - ╤З╨╕╤Б╨╗╨╛ ╤Б╨╕╨╝╨▓╨╛╨╗╨╛╨▓
1   326				     ; ╨╖╨░╨┐╨╛╨╗╨╜╨╡╨╜╨╕╨╡ ╨┐╤А╨╛╨▒╨╡╨╗╨╛╨╝
1   327	0F4A			     blankBuffer proc
1   328	0F4A  57			 push di
1   329	0F4B  FC			 cld
1   330	0F4C  B0 20			 mov al, 32
1   331	0F4E  F3> AA			 rep stosb
1   332	0F50  5F			 pop di
1   333	0F51  C3			 ret
1   334	0F52			     blankBuffer endp
1   335
1   336				     ; ╨▓╤Л╨▓╨╛╨┤ ╨░╨┤╤А╨╡╤Б╨░ ╨╕ ╨╕╨╝╨╡╨╜╨╕ ╤Б╨╗╨╛╨▓╨░
1   337				     ; AX- ╨╖╨╜╨░╤З╨╡╨╜╨╕╨╡ ╨░╨┤╤А╨╡╤Б╨░
1   338	0F52			     printWORD proc
1   339	0F52  57			 push di
1   340	0F53  56			 push si
1   341	0F54  53			 push bx
1   342	0F55  50			 push ax
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 7
forth.asm



1   343	0F56  BF 0F92r			 mov di,OFFSET ASCII ; get the offset address
1   344	0F59  B9 0019			 mov cx, 25
1   345	0F5C  E8 FFEB			 call blankBuffer
1   346					 ; ╨┐╨╡╤З╨░╤В╤М	╨░╨┤╤А╨╡╤Б╨░ ╤Б╨╗╨╛╨▓╨░
1   347	0F5F  8B C6			 mov ax, si
1   348	0F61  2D 0002			 sub ax, 2
1   349	0F64  E8 FFBF			 call toHex
1   350	0F67  47			 inc di
1   351	0F68  47			 inc di
1   352					 ; ╨┐╨╡╤З╨░╤В╤М	CFA ╤Б╨╗╨╛╨▓╨░
1   353	0F69  58			 pop ax
1   354	0F6A  50			 push ax
1   355	0F6B  E8 FFB8			 call toHex
1   356	0F6E  47			 inc di	 ; ╨▓╤Л╨▓╨╛╨┤ ╨╕╨╝╨╡╨╜╨╕ ╤Б╨╗╨╛╨▓╨░ ╨┐╨╛╤Б╨╗╨╡ ╨╡╨│╨╛ ╨░╨┤╤А╨╡╤Б╨░
1   357	0F6F  5B			 pop bx	; ╨░╨┤╤А╨╡╤Б ╤Б╨╗╨╛╨▓╨░	CFA?
1   358					 ;mov al, byte ptr [bx-3] ; ╨┐╨╛╤Б╨╗╨╡╨┤╨╜╨╕╨╣ ╤Б╨╕╨╝╨▓╨╛╨╗ ╤Б╨╗╨╛╨▓╨░
1   359	0F70  83 EB 03			 SUB bx, 3   ;
1   360	0F73				 mm:	      ;	╨╕╤Й╨╡╨╝ ╨┐╨╛╨╗╨╡ ╨┤╨╗╨╕╨╜╤Л
1   361	0F73  4B			 dec bx
1   362	0F74  80 3F 00			 CMP  BYTE PTR [bx],  0
1   363	0F77  79 FA			 JNS  mm     ; JUMP IF POSITIVE
1   364	0F79  8B 0F			 mov cx, [bx] ;	╨┤╨╗╨╕╨╜╨░ ╤Б╨╗╨╛╨▓╨░ +	╨▓╤Б╤П╨║╨╕╨╡  ╤Б╨╗╤Г╨╢.	╨┐╨╛╨╗╤П
1   365	0F7B  83 E1 3F			 and cx, 003Fh
1   366	0F7E				 mmm1:
1   367	0F7E  43			 inc bx
1   368	0F7F  8A 07			 mov al, byte ptr [bx]
1   369	0F81  24 7F			 and al, 7Fh ;	 ╨┐╨╛╤Б╨╗╨╡╨┤╨╜╨╕╨╣ ╤Б╨╕╨╝╨▓╨╛╨╗ ╤Г╨▓╨╡╨╗╨╕╤З╨╡╨╜ ╨╜╨░ 80h
1   370	0F83  88 05			 mov [di],al
1   371	0F85  47			 inc di
1   372	0F86  E2 F6			 loop mmm1
1   373					 ; Print string
1   374	0F88  BA 0F92r			 mov dx,OFFSET ASCII ; DOS 1+ WRITE STRING TO STANDARD OUTPUT
1   375	0F8B  E8 002C			 call outText
1   376	0F8E  5B			 pop bx
1   377	0F8F  5E			 pop si
1   378	0F90  5F			 pop di
1   379	0F91  C3			 ret
1   380	0F92  30 30 30 30 3A 20	30+	 ASCII DB "0000: 0000		     ",0Dh,0Ah,"$" ; buffer for	ASCII string
    381	      30 30 30 20 20 20	20+
    382	      20 20 20 20 20 20	20+
    383	      20 20 20 20 20 0D	0A+
    384	      24
1   385	0FAF			     printWORD endP
1   386
1   387	0FAF			     outCR proc
1   388	0FAF  B4 09			 mov ah,9	     ; DS:DX->'$'-terminated string
1   389	0FB1  BA 0FB7r			 lea dx, @@cr
1   390	0FB4  CD 21			 int 21h	     ; (using pipe character">") or output to printer
1   391	0FB6  C3			 ret
1   392	0FB7  0D 0A 24			 @@cr DB 0Dh, 0Ah, "$"
1   393	0FBA			     outCR endp
1   394
1   395				     ; ╨▓╤Л╨▓╨╛╨┤ ╤В╨╡╨║╤Б╤В╨░
1   396	0FBA			     outText proc
1   397	0FBA  B4 09			 mov ah,9	     ; DS:DX->'$'-terminated string
1   398	0FBC  CD 21			 int 21h	     ; (using pipe character">") or output to printer
1   399	0FBE  C3			 ret
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 8
forth.asm



1   400	0FBF			     outText endp
1   401
    402
    403					; BX - WP находится адрес исполняемого слова
    404					; SI - IP-регистр    должен сохраняться
    405					; DI - указатель области USER
    406					; BP - указатель стека возвратов
    407					; SP - указатель стека параметров
    408
    409						  HEAD	  87h,'EXECUT',305Q,EXEC	      ;
1   410	      =ARRAY:0FBF		     LINK$=$
1   411	0FBF  87			     DB	 87h  ;	NFA 7 бит равен	1.
1   412							 ; 6 - признак immediate. 5- слово не описано smudge
1   413	0FC0  45 58 45 43 55 54		     DB	 'EXECUT'
1   414	0FC6  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1   415
1   416	0FC7  0DB7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   417	      =ARRAY:0FBF		     LINK=LINK$
1   418
1   419	0FC9				     EXEC LABEL	FAR  ; CFA
1   420	0FC9  0FCBr			     DW	 $+2
    421					 ; в стеке адрес поля CFA (НЕ PFA)
    422	0FCB  5B				  POP	BX
    423	0FCC  FF 27				  JMP  WORD PTR	[ BX ]
    424
    425						  HEAD	  83h,'LI',324Q,LIT		      ;	LIT
1   426	      =ARRAY:0FCE		     LINK$=$
1   427	0FCE  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   428							 ; 6 - признак immediate. 5- слово не описано smudge
1   429	0FCF  4C 49			     DB	 'LI'
1   430	0FD1  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1   431
1   432	0FD2  0FBFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   433	      =ARRAY:0FCE		     LINK=LINK$
1   434
1   435	0FD4				     LIT LABEL FAR  ; CFA
1   436	0FD4  0FD6r			     DW	 $+2
    437	0FD6  AD				  LODSW
    438	0FD7  50				  PUSH	AX
    439						  NEXT
1   440	0FD8  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   441	0FD9  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   442					 ; ------ call debugger	--------
1   443	0FDB  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   444	0FDF  74 06			     jz	??0001
1   445	0FE1  E8 FF6E			     call printWORD
1   446	0FE4  E8 FE4D			     call pause
1   447	0FE7				   ??0001:
1   448					 ; -----------------------------
1   449	0FE7  FF 27			     JMP WORD PTR [BX]
    450
    451						  HEAD	  86h,'TERMO',316Q,TERMON	      ;	TERMON
1   452	      =ARRAY:0FE9		     LINK$=$
1   453	0FE9  86			     DB	 86h  ;	NFA 7 бит равен	1.
1   454							 ; 6 - признак immediate. 5- слово не описано smudge
1   455	0FEA  54 45 52 4D 4F		     DB	 'TERMO'
1   456	0FEF  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 9
forth.asm



1   457
1   458	0FF0  0FCEr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   459	      =ARRAY:0FE9		     LINK=LINK$
1   460
1   461	0FF2				     TERMON LABEL FAR  ; CFA
1   462	0FF2  0FF4r			     DW	 $+2
    463					 ; NumLock, ScrollLock,	CapsLock, Ins. Состояние этих клавиш записывается
    464					 ; в область данных BIOS в два байта с адресами	0000h:0417h и 0000h:0418h
    465	0FF4  58				  POP	AX
    466	0FF5  06				  PUSH	ES
    467	0FF6  B9 0000				  MOV	CX, 0
    468	0FF9  8E C1				  MOV	ES, CX
    469	0FFB  26: A3 0417			  MOV	ES:417H,AX
    470	0FFF  07				  POP	ES
    471						  NEXT
1   472	1000  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   473	1001  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   474					 ; ------ call debugger	--------
1   475	1003  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   476	1007  74 06			     jz	??0002
1   477	1009  E8 FF46			     call printWORD
1   478	100C  E8 FE25			     call pause
1   479	100F				   ??0002:
1   480					 ; -----------------------------
1   481	100F  FF 27			     JMP WORD PTR [BX]
    482
    483						  HEAD	  87h,'?BRANC',310Q,ZBRAN	      ;	?BRANCH
1   484	      =ARRAY:1011		     LINK$=$
1   485	1011  87			     DB	 87h  ;	NFA 7 бит равен	1.
1   486							 ; 6 - признак immediate. 5- слово не описано smudge
1   487	1012  3F 42 52 41 4E 43		     DB	 '?BRANC'
1   488	1018  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1   489
1   490	1019  0FE9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   491	      =ARRAY:1011		     LINK=LINK$
1   492
1   493	101B				     ZBRAN LABEL FAR  ;	CFA
1   494	101B  101Dr			     DW	 $+2
    495					 ; переход, если 0 в стеке (FALSE)
    496	101D  58				  POP	AX
    497	101E  3D 0000				  CMP	AX, 0
    498	1021  74 1F				  JE	CNT
    499	1023  83 C6 02				  ADD	SI, 2 ;	без перехода пропускаем	следующее слово	(адрес перехода)
    500						  NEXT
1   501	1026  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   502	1027  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   503					 ; ------ call debugger	--------
1   504	1029  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   505	102D  74 06			     jz	??0003
1   506	102F  E8 FF20			     call printWORD
1   507	1032  E8 FDFF			     call pause
1   508	1035				   ??0003:
1   509					 ; -----------------------------
1   510	1035  FF 27			     JMP WORD PTR [BX]
    511
    512						  HEAD	  86h,'BRANC',310Q,BRAN		      ;	BRANCH
1   513	      =ARRAY:1037		     LINK$=$
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 10
forth.asm



1   514	1037  86			     DB	 86h  ;	NFA 7 бит равен	1.
1   515							 ; 6 - признак immediate. 5- слово не описано smudge
1   516	1038  42 52 41 4E 43		     DB	 'BRANC'
1   517	103D  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1   518
1   519	103E  1011r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   520	      =ARRAY:1037		     LINK=LINK$
1   521
1   522	1040				     BRAN LABEL	FAR  ; CFA
1   523	1040  1042r			     DW	 $+2
    524					 ; безусловный переход.	SI указывает на	число инструкций,
    525					 ; которые нужно пропустить
    526	1042  03 34			CNT:	  ADD	SI,  [SI]  ; si	содержит число инструкций,
    527								 ; которые необходимо пропустить
    528						  NEXT
1   529	1044  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   530	1045  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   531					 ; ------ call debugger	--------
1   532	1047  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   533	104B  74 06			     jz	??0004
1   534	104D  E8 FF02			     call printWORD
1   535	1050  E8 FDE1			     call pause
1   536	1053				   ??0004:
1   537					 ; -----------------------------
1   538	1053  FF 27			     JMP WORD PTR [BX]
    539
    540						  HEAD	  84h,'(DO',251Q,XDO		      ;	(DO)
1   541	      =ARRAY:1055		     LINK$=$
1   542	1055  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   543							 ; 6 - признак immediate. 5- слово не описано smudge
1   544	1056  28 44 4F			     DB	 '(DO'
1   545	1059  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1   546
1   547	105A  1037r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   548	      =ARRAY:1055		     LINK=LINK$
1   549
1   550	105C				     XDO LABEL FAR  ; CFA
1   551	105C  105Er			     DW	 $+2
    552	105E  58				  POP	AX  ; в	стек данных начальное значение цикла
    553	105F  83 ED 02				  SUB	BP, 2
    554	1062  8F 46 00				  POP	[BP] ; конечное	значение цикла
    555	1065  83 ED 02				  SUB	BP, 2
    556	1068  89 46 00				  MOV	WORD PTR  [BP],AX ; в стек возвратов начальное значение	цикла
    557						 ; RS растет в сторону с меньшими адресами
    558						 ; BP  до входа	в слово.
    559						 ; BP-2	- конечное значение цикла
    560						 ; BP-4	- начальное значение
    561						  NEXT
1   562	106B  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   563	106C  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   564					 ; ------ call debugger	--------
1   565	106E  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   566	1072  74 06			     jz	??0005
1   567	1074  E8 FEDB			     call printWORD
1   568	1077  E8 FDBA			     call pause
1   569	107A				   ??0005:
1   570					 ; -----------------------------
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 11
forth.asm



1   571	107A  FF 27			     JMP WORD PTR [BX]
    572
    573						  HEAD	  86h,'(LOOP',251Q,XLOOP	      ;	(LOOP)
1   574	      =ARRAY:107C		     LINK$=$
1   575	107C  86			     DB	 86h  ;	NFA 7 бит равен	1.
1   576							 ; 6 - признак immediate. 5- слово не описано smudge
1   577	107D  28 4C 4F 4F 50		     DB	 '(LOOP'
1   578	1082  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1   579
1   580	1083  1055r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   581	      =ARRAY:107C		     LINK=LINK$
1   582
1   583	1085				     XLOOP LABEL FAR  ;	CFA
1   584	1085  1087r			     DW	 $+2
    585					; Приращение индекса цикла LOOP	и может	быть  ветвление
    586	1087  FF 46 00				  INC	WORD PTR  [BP] ; начальное значение увеличиваем
    587	108A  8B 46 00			LOP:	  MOV	AX,  [BP]    ; индекс
    588	108D  3B 46 02				  CMP	AX,  [BP+2]  ; предел цикла
    589	1090  7C B0				  JL	CNT
    590	1092  83 C5 04			LV:	  ADD	BP,  4 ; удаляем параметры цикла
    591	1095  83 C6 02				  ADD	SI,  2 ; переход к следующеу слову
    592						  NEXT
1   593	1098  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   594	1099  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   595					 ; ------ call debugger	--------
1   596	109B  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   597	109F  74 06			     jz	??0006
1   598	10A1  E8 FEAE			     call printWORD
1   599	10A4  E8 FD8D			     call pause
1   600	10A7				   ??0006:
1   601					 ; -----------------------------
1   602	10A7  FF 27			     JMP WORD PTR [BX]
    603
    604						  HEAD	  87h,'(+LOOP',251Q,XPLOO	      ;	(+LOOP)
1   605	      =ARRAY:10A9		     LINK$=$
1   606	10A9  87			     DB	 87h  ;	NFA 7 бит равен	1.
1   607							 ; 6 - признак immediate. 5- слово не описано smudge
1   608	10AA  28 2B 4C 4F 4F 50		     DB	 '(+LOOP'
1   609	10B0  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1   610
1   611	10B1  107Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   612	      =ARRAY:10A9		     LINK=LINK$
1   613
1   614	10B3				     XPLOO LABEL FAR  ;	CFA
1   615	10B3  10B5r			     DW	 $+2
    616					 ; n  ---
    617	10B5  58				  POP	AX
    618	10B6  01 46 00				  ADD	[BP],	AX
    619	10B9  3D 0000				  CMP	AX, 0
    620	10BC  7C 02				  JL	$LESS
    621	10BE  EB CA				  JMP	LOP
    622	10C0  8B 4E 00			  $LESS:  MOV	CX, [BP]   ; Работа с отрицательными приращениями
    623	10C3  39 4E 02				  CMP	[BP]+2,	CX
    624	10C6  7E CA				  JLE	LV
    625	10C8  E9 FF77				  JMP	CNT
    626
    627						  HEAD	  86h,'(FIND',251Q,PFIND	      ;	PFIND
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 12
forth.asm



1   628	      =ARRAY:10CB		     LINK$=$
1   629	10CB  86			     DB	 86h  ;	NFA 7 бит равен	1.
1   630							 ; 6 - признак immediate. 5- слово не описано smudge
1   631	10CC  28 46 49 4E 44		     DB	 '(FIND'
1   632	10D1  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1   633
1   634	10D2  10A9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   635	      =ARRAY:10CB		     LINK=LINK$
1   636
1   637	10D4				     PFIND LABEL FAR  ;	CFA
1   638	10D4  10D6r			     DW	 $+2
    639					     ;	addr1 addr2 ---	pfa b tf (ok) оператор поиска
    640					; Адрес	строки	NFA => PFA длина TRUE/FALSE (!реально СFA !)
    641	10D6  58				  POP	AX	 ; NFA последнего слова	в context словаре
    642	10D7  59				  POP	CX	 ; addr1 строка	для поиска. первый байт	длина образца
    643	10D8  55				  PUSH	BP	 ; сохранение содержимого регистров
    644	10D9  56				  PUSH	SI	 ; --
    645	10DA  57				  PUSH	DI	 ; --
    646	10DB  8B F1				  MOV	SI, CX	 ; адрес образца
    647	10DD  2B ED				  SUB	BP, BP	 ;
    648	10DF  8B F8				  MOV	DI, AX	 ; NFA	последнего слова в словаре
    649	10E1  8B 14				  MOV	DX,WORD	PTR [SI] ; длина строки	поиска и первый	символ
    650	10E3  81 E2 7F7F			  AND	DX, 77577Q ; 7F7f - сброс старших битов. кажется лишним
    651	10E7  FC				  CLD			 ; DF=0	(вперед)
    652	10E8  8B 0D			FAST:	  MOV	CX,WORD	PTR [DI] ;
    653	10EA  81 E1 7F3F			  AND	CX, 77477Q ; сброс 7-ых	и 6 бита в первом байте
    654	10EE  3B D1				  CMP	DX, CX	 ; сравним длину и первый символ
    655	10F0  74 14				  JE	SLOW	 ; если	равны, может то, что ищем
    656	10F2  83 3D 00			MATCH:	  CMP	WORD PTR [DI], 0 ; ищем	конец nfa
    657	10F5  78 03				  JS	$SIG	     ; BPL
    658	10F7  47				  INC	DI	     ; следующий символ	в слове
    659	10F8  EB F8				  JMP	MATCH
    660	10FA  83 C7 02			$SIG:	  ADD	DI, 2	     ; переход к полю LFA
    661	10FD  83 3D 00				  CMP	WORD PTR [DI],0	 ; список слов закончился
    662	1100  74 36				  JE	FAIL		 ; LFA =0, поиск не удачен
    663	1102  8B 3D				  MOV	DI,WORD	PTR [DI] ; переход к другому слову в словаре
    664	1104  EB E2				  JMP	FAST
    665	1106  8B 2D			SLOW:	  MOV	BP,WORD	PTR [DI] ; длина и первый символ найденого слова
    666	1108  8B DE				  MOV	BX, SI		 ; адрес образца
    667	110A  EB 0E 90				  JMP	SLOW1
    668	110D  43			$LOOP:	  INC	BX		 ; перебор символов
    669	110E  8B 07				  MOV	AX,WORD	PTR [BX]
    670	1110  8B 0D				  MOV	CX,WORD	PTR [DI]
    671	1112  81 E1 7FFF			  AND	CX, 77777Q   ; 7FFFh
    672	1116  3B C1				  CMP	AX, CX
    673	1118  75 D8				  JNE	MATCH	     ; не совпало, переход на начало
    674	111A  47			SLOW1:	  INC	DI
    675	111B  F7 45 FF 8000			  TEST	WORD PTR -1[DI],100000Q	; 8000h
    676	1120  74 EB				  JZ	$LOOP	     ; переход,	если 7 бит РАВЕН 0
    677	1122  8B D5				  MOV	DX, BP	     ; длина слова
    678	1124  83 C7 05				  ADD	DI, 5	     ; PFA найденого слова
    679	1127  8B C7				  MOV	AX, DI
    680	1129  5F				  POP	DI	     ; восстановление содержимого регистров
    681	112A  5E				  POP	SI
    682	112B  5D				  POP	BP
    683	112C  2D 0002				  SUB	AX, 2	     ; CFA
    684	112F  50				  PUSH	AX
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 13
forth.asm



    685	1130  81 E2 00FF			  AND	DX, 377Q	; FFh выделяем байт длины и ФЛАГОВ
    686	1134  52				  PUSH	DX		; в стек
    687	1135  EB 4E 90				  JMP	TRUE		; Установка флага "Найдено"
    688	1138  5F			FAIL:	  POP	DI
    689	1139  5E				  POP	SI
    690	113A  5D				  POP	BP
    691	113B  EB 34 90				  JMP	FALSE
    692
    693						  HEAD	  85h,'DIGI',324Q,DIGIT		      ;	DIGIT
1   694	      =ARRAY:113E		     LINK$=$
1   695	113E  85			     DB	 85h  ;	NFA 7 бит равен	1.
1   696							 ; 6 - признак immediate. 5- слово не описано smudge
1   697	113F  44 49 47 49		     DB	 'DIGI'
1   698	1143  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1   699
1   700	1144  10CBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   701	      =ARRAY:113E		     LINK=LINK$
1   702
1   703	1146				     DIGIT LABEL FAR  ;	CFA
1   704	1146  1148r			     DW	 $+2
    705					; ASCII-DIGIT BASE=>DIGIT-VALUE	TRUE (FALSE)
    706	1148  58				  POP	AX	; AX=BASE
    707	1149  59				  POP	CX
    708	114A  83 E9 30				  SUB	CX, 60Q	; VALID	DIGIT =	ASCII-60
    709	114D  7C 22				  JL	FALSE
    710	114F  83 F9 09				  CMP	CX, 9	; Если >9
    711	1152  7E 08				  JLE	M09
    712	1154  83 E9 07				  SUB	CX, 7
    713	1157  83 F9 0A				  CMP	CX, 10
    714	115A  7C 15				  JL	FALSE
    715	115C  3B C8			M09:	  CMP	CX, AX	; Если не меньше BASE, то ошибка
    716	115E  7D 11				  JGE	FALSE
    717	1160  51				  PUSH	CX	; Запись цифры в стек
    718	1161  EB 22 90				  JMP	TRUE	; "Успешный" выход
    719
    720					;	  **  Стандартные слова	 **
    721					;	  **  Условные операторы  **
    722
    723						  HEAD	  82h,'0',275Q,ZEQU		      ;	0=
1   724	      =ARRAY:1164		     LINK$=$
1   725	1164  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   726							 ; 6 - признак immediate. 5- слово не описано smudge
1   727	1165  30			     DB	 '0'
1   728	1166  BD			     DB	 275Q	; последний символ слова + 128 (7 бит =	1).
1   729
1   730	1167  113Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   731	      =ARRAY:1164		     LINK=LINK$
1   732
1   733	1169				     ZEQU LABEL	FAR  ; CFA
1   734	1169  116Br			     DW	 $+2
    735	116B  58				  POP	AX
    736	116C  3D 0000				  CMP	AX,  0
    737	116F  74 14				  JE	TRUE
    738	1171  2B C0			FALSE:	  SUB	AX,  AX
    739	1173  50			PUT:	  PUSH	AX
    740						  NEXT
1   741	1174  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 14
forth.asm



1   742	1175  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   743					 ; ------ call debugger	--------
1   744	1177  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   745	117B  74 06			     jz	??0007
1   746	117D  E8 FDD2			     call printWORD
1   747	1180  E8 FCB1			     call pause
1   748	1183				   ??0007:
1   749					 ; -----------------------------
1   750	1183  FF 27			     JMP WORD PTR [BX]
    751	1185  B8 0001			TRUE:	  MOV	AX,  1
    752	1188  EB E9				  JMP	PUT
    753
    754						  HEAD	  83h,'0<','>'+80h,NZEQ		      ;	0<>
1   755	      =ARRAY:118A		     LINK$=$
1   756	118A  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   757							 ; 6 - признак immediate. 5- слово не описано smudge
1   758	118B  30 3C			     DB	 '0<'
1   759	118D  BE			     DB	 '>'+80h   ; последний символ слова + 128 (7 бит = 1).
1   760
1   761	118E  1164r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   762	      =ARRAY:118A		     LINK=LINK$
1   763
1   764	1190				     NZEQ LABEL	FAR  ; CFA
1   765	1190  1192r			     DW	 $+2
    766	1192  58				  POP	AX
    767	1193  3D 0000				  CMP	AX,  0
    768	1196  75 ED				  JNE	 TRUE
    769	1198  EB D7				  JMP FALSE
    770
    771						  HEAD	  82h,'0',276Q,ZGRET		      ;	0>
1   772	      =ARRAY:119A		     LINK$=$
1   773	119A  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   774							 ; 6 - признак immediate. 5- слово не описано smudge
1   775	119B  30			     DB	 '0'
1   776	119C  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1   777
1   778	119D  118Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   779	      =ARRAY:119A		     LINK=LINK$
1   780
1   781	119F				     ZGRET LABEL FAR  ;	CFA
1   782	119F  11A1r			     DW	 $+2
    783	11A1  58				  POP	AX
    784	11A2  3D 0000				  CMP	AX, 0
    785	11A5  7F DE				  JG	TRUE
    786	11A7  EB C8				  JMP	FALSE
    787
    788						  HEAD	  83h,'0=',276Q,ZEQGR		       ; 0=>
1   789	      =ARRAY:11A9		     LINK$=$
1   790	11A9  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   791							 ; 6 - признак immediate. 5- слово не описано smudge
1   792	11AA  30 3D			     DB	 '0='
1   793	11AC  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1   794
1   795	11AD  119Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   796	      =ARRAY:11A9		     LINK=LINK$
1   797
1   798	11AF				     ZEQGR LABEL FAR  ;	CFA
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 15
forth.asm



1   799	11AF  11B1r			     DW	 $+2
    800	11B1  58				  POP	AX
    801	11B2  3D 0000				  CMP	AX, 0
    802	11B5  7D CE				  JGE	 TRUE
    803	11B7  EB B8				  JMP	FALSE
    804
    805						  HEAD	  82h,'0',274Q,ZLESS		      ;	0<
1   806	      =ARRAY:11B9		     LINK$=$
1   807	11B9  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   808							 ; 6 - признак immediate. 5- слово не описано smudge
1   809	11BA  30			     DB	 '0'
1   810	11BB  BC			     DB	 274Q	; последний символ слова + 128 (7 бит =	1).
1   811
1   812	11BC  11A9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   813	      =ARRAY:11B9		     LINK=LINK$
1   814
1   815	11BE				     ZLESS LABEL FAR  ;	CFA
1   816	11BE  11C0r			     DW	 $+2
    817	11C0  58				  POP	AX
    818	11C1  3D 0000				  CMP	AX, 0
    819	11C4  78 BF				  JS	TRUE	     ; Если минус
    820	11C6  EB A9				  JMP	FALSE
    821
    822						  HEAD	  83h,'0=',274Q,ZEQLES		      ;	0=<
1   823	      =ARRAY:11C8		     LINK$=$
1   824	11C8  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   825							 ; 6 - признак immediate. 5- слово не описано smudge
1   826	11C9  30 3D			     DB	 '0='
1   827	11CB  BC			     DB	 274Q	; последний символ слова + 128 (7 бит =	1).
1   828
1   829	11CC  11B9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   830	      =ARRAY:11C8		     LINK=LINK$
1   831
1   832	11CE				     ZEQLES LABEL FAR  ; CFA
1   833	11CE  11D0r			     DW	 $+2
    834	11D0  58				  POP	AX
    835	11D1  3D 0000				  CMP	AX, 0
    836	11D4  78 AF				  JS   TRUE	    ; Если минус
    837	11D6  74 AD				  JE   TRUE	     ; или ноль
    838	11D8  EB 97				  JMP	FALSE
    839
    840						  HEAD	  81h,,275Q,EQUAL		      ;	=
1   841	      =ARRAY:11DA		     LINK$=$
1   842	11DA  81			     DB	 81h  ;	NFA 7 бит равен	1.
1   843							 ; 6 - признак immediate. 5- слово не описано smudge
1   844	11DB  BD			     DB	 275Q	; последний символ слова + 128 (7 бит =	1).
1   845
1   846	11DC  11C8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   847	      =ARRAY:11DA		     LINK=LINK$
1   848
1   849	11DE				     EQUAL LABEL FAR  ;	CFA
1   850	11DE  11E0r			     DW	 $+2
    851	11E0  58				  POP	AX
    852	11E1  59				  POP	CX
    853	11E2  3B C8				  CMP	CX, AX
    854	11E4  74 9F				  JE	TRUE
    855	11E6  EB 89				  JMP	FALSE
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 16
forth.asm



    856
    857						  HEAD	  82h,'<','>'+80h,NEQ		       ; <>
1   858	      =ARRAY:11E8		     LINK$=$
1   859	11E8  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   860							 ; 6 - признак immediate. 5- слово не описано smudge
1   861	11E9  3C			     DB	 '<'
1   862	11EA  BE			     DB	 '>'+80h   ; последний символ слова + 128 (7 бит = 1).
1   863
1   864	11EB  11DAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   865	      =ARRAY:11E8		     LINK=LINK$
1   866
1   867	11ED				     NEQ LABEL FAR  ; CFA
1   868	11ED  11EFr			     DW	 $+2
    869	11EF  58				  POP	AX
    870	11F0  59				  POP	CX
    871	11F1  3B C8				  CMP	CX, AX
    872	11F3  74 60				  JE	FALSE1
    873	11F5  EB 72 90				  JMP	TRUE1
    874
    875						  HEAD	  82h,'U',274Q,ULESS		      ;	U<
1   876	      =ARRAY:11F8		     LINK$=$
1   877	11F8  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   878							 ; 6 - признак immediate. 5- слово не описано smudge
1   879	11F9  55			     DB	 'U'
1   880	11FA  BC			     DB	 274Q	; последний символ слова + 128 (7 бит =	1).
1   881
1   882	11FB  11E8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   883	      =ARRAY:11F8		     LINK=LINK$
1   884
1   885	11FD				     ULESS LABEL FAR  ;	CFA
1   886	11FD  11FFr			     DW	 $+2
    887	11FF  58				  POP	AX
    888	1200  59				  POP	CX
    889	1201  3B C8				  CMP	CX, AX
    890	1203  72 64				  JB	TRUE1		; для чисел без	знака
    891	1205  EB 4E 90				  JMP	FALSE1
    892
    893						  HEAD	  81h,,274Q,LESS		      ;	<
1   894	      =ARRAY:1208		     LINK$=$
1   895	1208  81			     DB	 81h  ;	NFA 7 бит равен	1.
1   896							 ; 6 - признак immediate. 5- слово не описано smudge
1   897	1209  BC			     DB	 274Q	; последний символ слова + 128 (7 бит =	1).
1   898
1   899	120A  11F8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   900	      =ARRAY:1208		     LINK=LINK$
1   901
1   902	120C				     LESS LABEL	FAR  ; CFA
1   903	120C  120Er			     DW	 $+2
    904	120E  58				  POP	AX
    905	120F  59				  POP	CX
    906	1210  3B C1				  CMP	AX, CX
    907	1212  7F 55				  JG	TRUE1
    908	1214  EB 3F 90				  JMP	FALSE1
    909
    910						  HEAD	  82h,'=',274Q,EQLES		      ;	=<
1   911	      =ARRAY:1217		     LINK$=$
1   912	1217  82			     DB	 82h  ;	NFA 7 бит равен	1.
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 17
forth.asm



1   913							 ; 6 - признак immediate. 5- слово не описано smudge
1   914	1218  3D			     DB	 '='
1   915	1219  BC			     DB	 274Q	; последний символ слова + 128 (7 бит =	1).
1   916
1   917	121A  1208r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   918	      =ARRAY:1217		     LINK=LINK$
1   919
1   920	121C				     EQLES LABEL FAR  ;	CFA
1   921	121C  121Er			     DW	 $+2
    922	121E  58				  POP	AX
    923	121F  59				  POP	CX
    924	1220  3B C1				  CMP	AX, CX
    925	1222  7D 45				  JGE	 TRUE1
    926	1224  EB 2F 90				  JMP	FALSE1
    927
    928						  HEAD	  81h,,276Q,GREAT		      ;	>
1   929	      =ARRAY:1227		     LINK$=$
1   930	1227  81			     DB	 81h  ;	NFA 7 бит равен	1.
1   931							 ; 6 - признак immediate. 5- слово не описано smudge
1   932	1228  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1   933
1   934	1229  1217r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   935	      =ARRAY:1227		     LINK=LINK$
1   936
1   937	122B				     GREAT LABEL FAR  ;	CFA
1   938	122B  122Dr			     DW	 $+2
    939	122D  58				  POP	AX
    940	122E  59				  POP	CX
    941	122F  3B C1				  CMP	AX, CX
    942	1231  7C 36				      JL    TRUE1
    943	1233  EB 20 90				  JMP	FALSE1
    944
    945						  HEAD	  82h,'=',276Q,EQGR			; =>
1   946	      =ARRAY:1236		     LINK$=$
1   947	1236  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   948							 ; 6 - признак immediate. 5- слово не описано smudge
1   949	1237  3D			     DB	 '='
1   950	1238  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1   951
1   952	1239  1227r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   953	      =ARRAY:1236		     LINK=LINK$
1   954
1   955	123B				     EQGR LABEL	FAR  ; CFA
1   956	123B  123Dr			     DW	 $+2
    957	123D  58				  POP	AX
    958	123E  59				  POP	CX
    959	123F  3B C1				  CMP	AX, CX
    960	1241  7E 26				      JLE    TRUE1
    961	1243  EB 10 90				  JMP	FALSE1
    962
    963						 HEAD	  84h,'EVE', 'N'+80h, $EVEN	      ;	EVEN
1   964	      =ARRAY:1246		     LINK$=$
1   965	1246  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   966							 ; 6 - признак immediate. 5- слово не описано smudge
1   967	1247  45 56 45			     DB	 'EVE'
1   968	124A  CE			     DB	 'N'+80h   ; последний символ слова + 128 (7 бит = 1).
1   969
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 18
forth.asm



1   970	124B  1236r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   971	      =ARRAY:1246		     LINK=LINK$
1   972
1   973	124D				     $EVEN LABEL FAR  ;	CFA
1   974	124D  124Fr			     DW	 $+2
    975					 ; проверка на четность
    976	124F  58				 pop ax
    977	1250  A9 0001				 test ax, 1 ; проверяем	младший	бит
    978	1253  74 14				 jz true1 ; если бит=0,	то число четное
    979	1255  2B C0			 FALSE1: SUB   AX,  AX
    980	1257  50			 PUT1:	 PUSH  AX
    981						 NEXT
1   982	1258  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   983	1259  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   984					 ; ------ call debugger	--------
1   985	125B  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   986	125F  74 06			     jz	??0008
1   987	1261  E8 FCEE			     call printWORD
1   988	1264  E8 FBCD			     call pause
1   989	1267				   ??0008:
1   990					 ; -----------------------------
1   991	1267  FF 27			     JMP WORD PTR [BX]
    992	1269  B8 0001			 TRUE1:	 MOV   AX,  1
    993	126C  EB E9				 JMP   PUT1
    994
    995					;	  ******************
    996
    997						  HEAD	  84h,'ENC',314Q,ENCL		      ;	ENCLOSE
1   998	      =ARRAY:126E		     LINK$=$
1   999	126E  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1000							 ; 6 - признак immediate. 5- слово не описано smudge
1  1001	126F  45 4E 43			     DB	 'ENC'
1  1002	1272  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  1003
1  1004	1273  1246r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1005	      =ARRAY:126E		     LINK=LINK$
1  1006
1  1007	1275				     ENCL LABEL	FAR  ; CFA
1  1008	1275  1277r			     DW	 $+2
   1009					 ; addr1 c -- addr1 n1 n2 n3
   1010	1277  58				  POP	AX	   ; разделитель
   1011	1278  59				  POP	CX	   ; начальный адрес
   1012	1279  8B D9				  MOV	BX, CX
   1013	127B  38 07			A:	  CMP	BYTE PTR  [BX],	AL ; обход разделителей	в начале
   1014	127D  75 03				  JNE	NOTEQ
   1015	127F  43			AAA1:	  INC	BX
   1016	1280  EB F9				  JMP	A
   1017	1282  80 3F 0D			NOTEQ:	  CMP	BYTE PTR  [BX],	15Q ; обход перевода строки
   1018	1285  74 F8				  JE	AAA1
   1019	1287  80 3F 0A				  CMP	BYTE PTR  [BX],	12Q
   1020	128A  74 F3				  JE	AAA1		     ; обход перевода строки
   1021	128C  8B D3				  MOV	DX, BX		     ; начало лексемы
   1022	128E  52				  PUSH	DX
   1023	128F  80 3F 00			AA:	  CMP	BYTE PTR  [BX],	 0
   1024	1292  74 21				  JE	ZZZ		     ; если нуль
   1025	1294  38 07				  CMP	BYTE PTR  [BX],	AL   ; не нуль,	ищем конец лексемы
   1026	1296  74 03				  JE	EQW
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 19
forth.asm



   1027	1298  43				  INC	BX
   1028	1299  EB F4				  JMP	AA
   1029	129B  8B C3			EQW:	  MOV	AX, BX
   1030	129D  2B DA				  SUB	BX, DX
   1031	129F  53				  PUSH	BX
   1032	12A0  2B C1				  SUB	AX, CX
   1033	12A2  40				  INC	AX
   1034	12A3  50				  PUSH	AX
   1035						  NEXT		     ; выход из	слова
1  1036	12A4  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1037	12A5  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1038					 ; ------ call debugger	--------
1  1039	12A7  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1040	12AB  74 06			     jz	??0009
1  1041	12AD  E8 FCA2			     call printWORD
1  1042	12B0  E8 FB81			     call pause
1  1043	12B3				   ??0009:
1  1044					 ; -----------------------------
1  1045	12B3  FF 27			     JMP WORD PTR [BX]
   1046
   1047	12B5  3B DA			ZZZ:	  CMP	BX, DX
   1048	12B7  75 E2				  JNE	EQW
   1049	12B9  43				  INC	BX
   1050	12BA  EB DF				  JMP	EQW
   1051
   1052					 ;	   ** Дисплей **
   1053
   1054						  HEAD	  84h,'PAG',305Q,$PAGE		      ;	PAGE
1  1055	      =ARRAY:12BC		     LINK$=$
1  1056	12BC  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1057							 ; 6 - признак immediate. 5- слово не описано smudge
1  1058	12BD  50 41 47			     DB	 'PAG'
1  1059	12C0  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  1060
1  1061	12C1  126Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1062	      =ARRAY:12BC		     LINK=LINK$
1  1063
1  1064	12C3				     $PAGE LABEL FAR  ;	CFA
1  1065	12C3  12C5r			     DW	 $+2
   1066					 ; Установка активной страницы ( PAGE --)
   1067	12C5  58				  POP	AX
   1068					 ; вход:  AL = номер страницы (большинство программ использует страницу	0)
   1069	12C6  B4 05				  MOV	AH, 5
   1070	12C8  CD 10				  INT	10h
   1071						  NEXT
1  1072	12CA  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1073	12CB  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1074					 ; ------ call debugger	--------
1  1075	12CD  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1076	12D1  74 06			     jz	??000A
1  1077	12D3  E8 FC7C			     call printWORD
1  1078	12D6  E8 FB5B			     call pause
1  1079	12D9				   ??000A:
1  1080					 ; -----------------------------
1  1081	12D9  FF 27			     JMP WORD PTR [BX]
   1082
   1083						 HEAD	 85h,'PIX1','3'+80h,PIX13	      ;	pixel 13h mode
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 20
forth.asm



1  1084	      =ARRAY:12DB		     LINK$=$
1  1085	12DB  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  1086							 ; 6 - признак immediate. 5- слово не описано smudge
1  1087	12DC  50 49 58 31		     DB	 'PIX1'
1  1088	12E0  B3			     DB	 '3'+80h   ; последний символ слова + 128 (7 бит = 1).
1  1089
1  1090	12E1  12BCr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1091	      =ARRAY:12DB		     LINK=LINK$
1  1092
1  1093	12E3				     PIX13 LABEL FAR  ;	CFA
1  1094	12E3  12E5r			     DW	 $+2
   1095					     ; color y x ->
   1096	12E5  5B				 pop bx
   1097	12E6  58				 pop ax
   1098	12E7  BA 0140				 mov dx, 320
   1099	12EA  F7 E2				 mul dx
   1100	12EC  03 C3				 add ax, bx
   1101	12EE  BB A000				 mov bx, 0a000h
   1102	12F1  59				 pop cx
   1103	12F2  06				 push es
   1104	12F3  8E C3				 mov es, bx
   1105	12F5  8B D8				 mov bx, ax
   1106	12F7  26: 88 0F				 mov es:[bx], cl
   1107	12FA  07				 pop es
   1108						 NEXT
1  1109	12FB  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1110	12FC  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1111					 ; ------ call debugger	--------
1  1112	12FE  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1113	1302  74 06			     jz	??000B
1  1114	1304  E8 FC4B			     call printWORD
1  1115	1307  E8 FB2A			     call pause
1  1116	130A				   ??000B:
1  1117					 ; -----------------------------
1  1118	130A  FF 27			     JMP WORD PTR [BX]
   1119
   1120						 HEAD	 85h,'PIX1','2'+80h,PIX12	      ;	pixel 12h mode
1  1121	      =ARRAY:130C		     LINK$=$
1  1122	130C  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  1123							 ; 6 - признак immediate. 5- слово не описано smudge
1  1124	130D  50 49 58 31		     DB	 'PIX1'
1  1125	1311  B2			     DB	 '2'+80h   ; последний символ слова + 128 (7 бит = 1).
1  1126
1  1127	1312  12DBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1128	      =ARRAY:130C		     LINK=LINK$
1  1129
1  1130	1314				     PIX12 LABEL FAR  ;	CFA
1  1131	1314  1316r			     DW	 $+2
   1132					     ; color y x ->
   1133					     ; ax - row
   1134					     ; bx - column
   1135					     ; ch - color
   1136	1316  5B				 pop bx
   1137	1317  58				 pop ax
   1138	1318  59				 pop cx
   1139	1319  8A E9				 mov ch, cl
   1140	131B  06				 push es
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 21
forth.asm



   1141	131C  E8 0033				 call pixptr12
   1142	131F  BA 03CE				 mov dx, 3ceh
   1143
   1144	1322  D2 E4				 shl ah, cl
   1145	1324  B0 08				 mov al, 8
   1146	1326  EF				 out dx, ax
   1147
   1148	1327  B8 0205				 mov ax, 205h
   1149	132A  EF				 out dx, ax
   1150
   1151	132B  B8 0003				 mov ax, 3
   1152	132E  EF				 out dx, ax
   1153
   1154	132F  26: 8A 07				 mov al, es:[bx]
   1155	1332  26: 88 2F				 mov es:[bx], ch
   1156
   1157	1335  B8 FF08				 mov ax, 0ff08h
   1158	1338  EF				 out dx, ax
   1159	1339  B8 0005				 mov ax, 5
   1160	133C  EF				 out dx,ax
   1161	133D  B4 03				 mov ah, 3
   1162	133F  EF				 out dx, ax
   1163	1340  07				 pop es
   1164						 NEXT
1  1165	1341  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1166	1342  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1167					 ; ------ call debugger	--------
1  1168	1344  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1169	1348  74 06			     jz	??000C
1  1170	134A  E8 FC05			     call printWORD
1  1171	134D  E8 FAE4			     call pause
1  1172	1350				   ??000C:
1  1173					 ; -----------------------------
1  1174	1350  FF 27			     JMP WORD PTR [BX]
   1175
   1176	1352					 pixptr12 proc
   1177					 ; ax-row
   1178					 ; bx-column
   1179					 ; returns
   1180					 ; es:bx -> pixel
   1181					 ; cl -	bit position
   1182					 ; ah -	bitmask
   1183	1352  52				 push dx
   1184	1353  8A CB				 mov cl, bl
   1185	1355  BA 0050				 mov dx, 80
   1186	1358  F7 E2				 mul dx
   1187	135A  D1 EB D1 EB D1 EB			 shr bx, 3
   1188	1360  03 D8				 add bx, ax
   1189	1362  B8 A000				 mov ax, 0a000h
   1190	1365  8E C0				 mov es, ax
   1191	1367  80 E1 07				 and cl, 7
   1192	136A  80 F1 07				 xor cl, 7
   1193	136D  B4 01				 mov ah, 1
   1194	136F  5A				 pop dx
   1195	1370  C3				 ret
   1196	1371					 pixptr12 endp
   1197
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 22
forth.asm



   1198						  HEAD	  83h,'PI',330Q,PIX		      ;	PIX
1  1199	      =ARRAY:1371		     LINK$=$
1  1200	1371  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1201							 ; 6 - признак immediate. 5- слово не описано smudge
1  1202	1372  50 49			     DB	 'PI'
1  1203	1374  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  1204
1  1205	1375  130Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1206	      =ARRAY:1371		     LINK=LINK$
1  1207
1  1208	1377				     PIX LABEL FAR  ; CFA
1  1209	1377  1379r			     DW	 $+2
   1210					 ; COLCOD ROW COLUMN -->  -    запись графической точки
   1211	1379  59				  POP	CX		    ; колонка x?
   1212	137A  5A				  POP	DX		    ; строка y?
   1213	137B  58				  POP	AX		    ; код цветности
   1214						  ;PUSH	 DX		     ; сохранение DX
   1215						  ;MOV	 DX, BX		     ; BH = номер видео	страницы ??? где
   1216						  ;SUB	 DH, DH		     ; ошибка в	коде
   1217	137C  50				  push	 ax
   1218	137D  B4 0F				  MOV	AH, 0Fh		    ; Чтение текущей страницы
   1219	137F  CD 10				  INT	10h		    ; в	BH
   1220	1381  58				  pop	 ax		    ; код цветности
   1221	1382  B4 0C				  MOV	AH, 0Ch		    ;
   1222	1384  CD 10				  INT	10h		    ; запись графической точки
   1223						  ;POP	 DX		     ; восстановление DX
   1224						  NEXT
1  1225	1386  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1226	1387  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1227					 ; ------ call debugger	--------
1  1228	1389  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1229	138D  74 06			     jz	??000D
1  1230	138F  E8 FBC0			     call printWORD
1  1231	1392  E8 FA9F			     call pause
1  1232	1395				   ??000D:
1  1233					 ; -----------------------------
1  1234	1395  FF 27			     JMP WORD PTR [BX]
   1235
   1236						  HEAD	  84h,'MOD','A'+80h,MODA		 ; MODA
1  1237	      =ARRAY:1397		     LINK$=$
1  1238	1397  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1239							 ; 6 - признак immediate. 5- слово не описано smudge
1  1240	1398  4D 4F 44			     DB	 'MOD'
1  1241	139B  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  1242
1  1243	139C  1371r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1244	      =ARRAY:1397		     LINK=LINK$
1  1245
1  1246	139E				     MODA LABEL	FAR  ; CFA
1  1247	139E  13A0r			     DW	 $+2
   1248					 ; установка режима. ( М --> - )
   1249	13A0  58				  POP	AX
   1250	13A1  2A E4				  SUB	AH, AH	     ; 00H уст.	видео режим. Очистить экран
   1251								     ;	установить поля	BIOS, установить режим.
   1252	13A3  CD 10				  INT	 10h
   1253						  NEXT
1  1254	13A5  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 23
forth.asm



1  1255	13A6  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1256					 ; ------ call debugger	--------
1  1257	13A8  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1258	13AC  74 06			     jz	??000E
1  1259	13AE  E8 FBA1			     call printWORD
1  1260	13B1  E8 FA80			     call pause
1  1261	13B4				   ??000E:
1  1262					 ; -----------------------------
1  1263	13B4  FF 27			     JMP WORD PTR [BX]
   1264
   1265						  HEAD	  83h,'EM',311Q,EMI$		      ;	EMI
1  1266	      =ARRAY:13B6		     LINK$=$
1  1267	13B6  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1268							 ; 6 - признак immediate. 5- слово не описано smudge
1  1269	13B7  45 4D			     DB	 'EM'
1  1270	13B9  C9			     DB	 311Q	; последний символ слова + 128 (7 бит =	1).
1  1271
1  1272	13BA  1397r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1273	      =ARRAY:13B6		     LINK=LINK$
1  1274
1  1275	13BC				     EMI$ LABEL	FAR  ; CFA
1  1276	13BC  13BEr			     DW	 $+2
   1277	13BE  59				  POP	CX		; Число	символов
   1278	13BF  58				  POP	AX		; Символ
   1279	13C0  51				  PUSH	CX		; Сохранение содержимого CX
   1280	13C1  50				  PUSH	AX		; Сохранение содержимого AХ
   1281	13C2  8B 5D 1A				  MOV	BX, [DI+32Q]	; Установка атрибута
   1282	13C5  B4 0F				  MOV	AH, 0Fh		; Чтение текущей страницы
   1283	13C7  CD 10				  INT	10h		; в BH
   1284	13C9  58				  POP	AX		; Восстановление содержимого AX
   1285	13CA  B4 09				  MOV	AH, 9		; Запись строки	символов
   1286	13CC  CD 10				  INT	10h
   1287	13CE  B4 03				  MOV	AH, 3		; Чтение положения курсора
   1288	13D0  CD 10				  INT	10h
   1289	13D2  59				  POP	CX
   1290	13D3  02 D1				  ADD	DL, CL		; DH,DL	= строка, колонка (считая от 0)
   1291	13D5  B4 02				  MOV	AH, 2		; Установка положения курсора
   1292	13D7  CD 10			$EM:	  INT	10h
   1293	13D9  83 7D 22 00			  CMP	WORD PTR [DI+42Q], 0  ;	сброс флага печати
   1294	13DD  75 25				  JNE	PRINT
   1295	13DF				OK:	  NEXT
1  1296	13DF  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1297	13E0  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1298					 ; ------ call debugger	--------
1  1299	13E2  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1300	13E6  74 06			     jz	??000F
1  1301	13E8  E8 FB67			     call printWORD
1  1302	13EB  E8 FA46			     call pause
1  1303	13EE				   ??000F:
1  1304					 ; -----------------------------
1  1305	13EE  FF 27			     JMP WORD PTR [BX]
   1306
   1307						  HEAD	  84h,'EMI',324Q,EMIT,$EMIT	      ;	EMIT
1  1308	      =ARRAY:13F0		     LINK$=$
1  1309	13F0  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1310							 ; 6 - признак immediate. 5- слово не описано smudge
1  1311	13F1  45 4D 49			     DB	 'EMI'
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 24
forth.asm



1  1312	13F4  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  1313
1  1314	13F5  13B6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1315	      =ARRAY:13F0		     LINK=LINK$
1  1316
1  1317	13F7				     EMIT LABEL	FAR  ; CFA
1  1318	13F7  13F9r			     DW	$EMIT
   1319					 ; вывод текста	без атрибутов (по умолчанию)
   1320	13F9				$EMIT	  LABEL	  FAR
   1321	13F9  58				  POP	AX
   1322	13FA  50			ENT$:	  PUSH	AX
   1323	13FB  B4 0F				  MOV	AH, 15	     ; Чтение текущей страницы
   1324	13FD  CD 10				  INT	10h
   1325	13FF  58				  POP	AX
   1326	1400  B4 0E				  MOV	AH, 14	     ;
   1327	1402  EB D3				  JMP	$EM
   1328
   1329	1404  BA 0000			PRINT:	  MOV	DX, 0	; Установка номера принтера
   1330	1407  2A E4				  SUB	AH, AH
   1331	1409  CD 17				  INT	17h
   1332	140B  F6 C4 29				  TEST	 AH, 29h
   1333	140E  74 CF				  JE	OK
   1334	1410  8A C4			ERR4:	  MOV	AL, AH
   1335	1412  04 30				  ADD	AL, 60Q
   1336	1414  B4 0E				  MOV	AH, 14
   1337	1416  CD 10				  INT	10h
   1338	1418  BA 1422r				  MOV	DX, OFFSET ERMES4
   1339	141B  B4 09				  MOV	AH, 9H
   1340	141D  CD 21				  INT	21H
   1341	141F  EB 5A 90				  JMP	TYPE$
   1342	1422  20 50 52 49 4E 54	45+	ERMES4	  DB   " PRINTER ERROR $" ;
   1343	      52 20 45 52 52 4F	52+
   1344	      20 24
   1345
   1346						  HEAD	  82h,'R',303Q,RC		; RC
1  1347	      =ARRAY:1432		     LINK$=$
1  1348	1432  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1349							 ; 6 - признак immediate. 5- слово не описано smudge
1  1350	1433  52			     DB	 'R'
1  1351	1434  C3			     DB	 303Q	; последний символ слова + 128 (7 бит =	1).
1  1352
1  1353	1435  13F0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1354	      =ARRAY:1432		     LINK=LINK$
1  1355
1  1356	1437				     RC	LABEL FAR  ; CFA
1  1357	1437  1439r			     DW	 $+2
   1358	1439  B8 000D				  MOV	AX, 13
   1359	143C  EB BC				  JMP	ENT$
   1360
   1361						  HEAD	  82h,'I',314Q,IL		; BELL
1  1362	      =ARRAY:143E		     LINK$=$
1  1363	143E  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1364							 ; 6 - признак immediate. 5- слово не описано smudge
1  1365	143F  49			     DB	 'I'
1  1366	1440  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  1367
1  1368	1441  1432r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 25
forth.asm



1  1369	      =ARRAY:143E		     LINK=LINK$
1  1370
1  1371	1443				     IL	LABEL FAR  ; CFA
1  1372	1443  1445r			     DW	 $+2
   1373	1445  B8 0007				  MOV	AX, 7
   1374	1448  EB B0				  JMP	ENT$
   1375
   1376						  HEAD	  84h,'PRI',316Q,PRIN		; PRINT-FLAG
1  1377	      =ARRAY:144A		     LINK$=$
1  1378	144A  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1379							 ; 6 - признак immediate. 5- слово не описано smudge
1  1380	144B  50 52 49			     DB	 'PRI'
1  1381	144E  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  1382
1  1383	144F  143Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1384	      =ARRAY:144A		     LINK=LINK$
1  1385
1  1386	1451				     PRIN LABEL	FAR  ; CFA
1  1387	1451  1453r			     DW	 $+2
   1388	1453  FF 45 22				  INC	WORD PTR  [DI+42Q]
   1389	1456  BA 0000				  MOV	DX,  0	     ; Установка номера	принтера
   1390	1459  B4 01				  MOV	AH,  1	     ; Инициализация принтера
   1391	145B  CD 17				  INT	17H
   1392	145D  F6 C4 29				  TEST	AH,  29h
   1393	1460  75 AE				  JNE	ERR4
   1394						  NEXT
1  1395	1462  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1396	1463  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1397					 ; ------ call debugger	--------
1  1398	1465  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1399	1469  74 06			     jz	??0010
1  1400	146B  E8 FAE4			     call printWORD
1  1401	146E  E8 F9C3			     call pause
1  1402	1471				   ??0010:
1  1403					 ; -----------------------------
1  1404	1471  FF 27			     JMP WORD PTR [BX]
   1405
   1406						  HEAD	  83h,'TT',331Q,TTY		 ; TERMI-FLAG
1  1407	      =ARRAY:1473		     LINK$=$
1  1408	1473  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1409							 ; 6 - признак immediate. 5- слово не описано smudge
1  1410	1474  54 54			     DB	 'TT'
1  1411	1476  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  1412
1  1413	1477  144Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1414	      =ARRAY:1473		     LINK=LINK$
1  1415
1  1416	1479				     TTY LABEL FAR  ; CFA
1  1417	1479  147Br			     DW	 $+2
   1418	147B  C7 45 22 0000		TYPE$:	  MOV	WORD PTR [DI+42Q],0
   1419						  NEXT
1  1420	1480  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1421	1481  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1422					 ; ------ call debugger	--------
1  1423	1483  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1424	1487  74 06			     jz	??0011
1  1425	1489  E8 FAC6			     call printWORD
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 26
forth.asm



1  1426	148C  E8 F9A5			     call pause
1  1427	148F				   ??0011:
1  1428					 ; -----------------------------
1  1429	148F  FF 27			     JMP WORD PTR [BX]
   1430
   1431						  HEAD	  83h,'SC',314Q,SCL		      ;	SCL
1  1432	      =ARRAY:1491		     LINK$=$
1  1433	1491  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1434							 ; 6 - признак immediate. 5- слово не описано smudge
1  1435	1492  53 43			     DB	 'SC'
1  1436	1494  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  1437
1  1438	1495  1473r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1439	      =ARRAY:1491		     LINK=LINK$
1  1440
1  1441	1497				     SCL LABEL FAR  ; CFA
1  1442	1497  1499r			     DW	 $+2
   1443					; SCREEN CLEAR
   1444						  ;MOV	 CX, 2048     ;	Загрузка счетчика
   1445						  ;MOV	 AH, 15
   1446						  ;INT	 10h	       ; Установка текущей страницы
   1447	1499  BA 1855				  mov	dx, 1855h      ;  DH,DL	= строка, колонка (считая от 0)
   1448	149C  2B C9				  sub	cx, cx
   1449						  ;MOV	 AH, 2	      ;	Курсор в исходное положение
   1450						  ;INT	 10h
   1451	149E  B7 00				  mov	bh, 0	    ; атрибут
   1452					 ; 09H писать символ/атрибут в текущей позиции курсора
   1453	14A0  B8 0600			CLEAR:	  MOV	AX, 0600H    ; число пустых строк, вдвигаемых снизу (0=очистить	все окно)
   1454	14A3  CD 10				  INT	10h
   1455						  NEXT
1  1456	14A5  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1457	14A6  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1458					 ; ------ call debugger	--------
1  1459	14A8  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1460	14AC  74 06			     jz	??0012
1  1461	14AE  E8 FAA1			     call printWORD
1  1462	14B1  E8 F980			     call pause
1  1463	14B4				   ??0012:
1  1464					 ; -----------------------------
1  1465	14B4  FF 27			     JMP WORD PTR [BX]
   1466
   1467						  HEAD	  83h,'FI',330Q,FIX		      ;	FIX
1  1468	      =ARRAY:14B6		     LINK$=$
1  1469	14B6  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1470							 ; 6 - признак immediate. 5- слово не описано smudge
1  1471	14B7  46 49			     DB	 'FI'
1  1472	14B9  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  1473
1  1474	14BA  1491r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1475	      =ARRAY:14B6		     LINK=LINK$
1  1476
1  1477	14BC				     FIX LABEL FAR  ; CFA
1  1478	14BC  14BEr			     DW	 $+2
   1479					; Позиционирование курсора: COL	ROW FIX
   1480	14BE  B4 0F				  MOV	AH, 0Fh
   1481	14C0  CD 10				  INT	10h	 ; Запись текущего номера страницы в BX
   1482	14C2  5A				  POP	DX
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 27
forth.asm



   1483	14C3  8A F2				  MOV	DH, DL	 ; строка
   1484	14C5  58				  POP	AX
   1485
   1486	14C6  8A D0				  MOV	DL, AL	 ; столбец
   1487	14C8  B4 02				  MOV	AH, 2	 ; уст.	позицию	курсора. установка
   1488								 ; на строку 25	делает курсор невидимым.
   1489	14CA  CD 10				  INT	10h	 ; Фиксация положения курсора
   1490						  NEXT
1  1491	14CC  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1492	14CD  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1493					 ; ------ call debugger	--------
1  1494	14CF  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1495	14D3  74 06			     jz	??0013
1  1496	14D5  E8 FA7A			     call printWORD
1  1497	14D8  E8 F959			     call pause
1  1498	14DB				   ??0013:
1  1499					 ; -----------------------------
1  1500	14DB  FF 27			     JMP WORD PTR [BX]
   1501
   1502						  HEAD	  84h,'DSP',314Q,DSPL		      ;	DSPL
1  1503	      =ARRAY:14DD		     LINK$=$
1  1504	14DD  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1505							 ; 6 - признак immediate. 5- слово не описано smudge
1  1506	14DE  44 53 50			     DB	 'DSP'
1  1507	14E1  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  1508
1  1509	14E2  14B6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1510	      =ARRAY:14DD		     LINK=LINK$
1  1511
1  1512	14E4				     DSPL LABEL	FAR  ; CFA
1  1513	14E4  14E6r			     DW	 $+2
   1514					; LOAD GRAFBUFFER (b adr DSPL)
   1515					 ; записывает байт в графическую память
   1516	14E6  5B				  POP	BX  ; адрес
   1517	14E7  58				  POP	AX  ; байт
   1518	14E8  06				  PUSH	ES  ; сохранение регистра сегмента
   1519	14E9  B9 B000				  MOV	CX, 0B000H ; GRAFBUF
   1520	14EC  8E C1				  MOV	ES, CX
   1521	14EE  26: 88 07				  MOV	BYTE PTR ES:[BX], AL
   1522	14F1  07				  POP	ES
   1523						  NEXT
1  1524	14F2  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1525	14F3  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1526					 ; ------ call debugger	--------
1  1527	14F5  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1528	14F9  74 06			     jz	??0014
1  1529	14FB  E8 FA54			     call printWORD
1  1530	14FE  E8 F933			     call pause
1  1531	1501				   ??0014:
1  1532					 ; -----------------------------
1  1533	1501  FF 27			     JMP WORD PTR [BX]
   1534
   1535					;	  ** Терминал **
   1536
   1537						  HEAD	  83h,'KE',331Q,KEY		      ;	KEY
1  1538	      =ARRAY:1503		     LINK$=$
1  1539	1503  83			     DB	 83h  ;	NFA 7 бит равен	1.
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 28
forth.asm



1  1540							 ; 6 - признак immediate. 5- слово не описано smudge
1  1541	1504  4B 45			     DB	 'KE'
1  1542	1506  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  1543
1  1544	1507  14DDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1545	      =ARRAY:1503		     LINK=LINK$
1  1546
1  1547	1509				     KEY LABEL FAR  ; CFA
1  1548	1509  150Br			     DW	 $+2
   1549					     ; читать (ожидать)	следующую нажатую клавишу
   1550					     ; выход: AL = ASCII символ	(если AL=0, AH содержит	расширенный код	ASCII )
   1551					     ; AH = сканкод  или расширенный код ASCII
   1552	150B  2A E4				  SUB	AH, AH
   1553	150D  CD 16				  INT	16h
   1554	150F  2A E4				  SUB	AH, AH
   1555	1511  50				  PUSH	AX
   1556						  NEXT
1  1557	1512  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1558	1513  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1559					 ; ------ call debugger	--------
1  1560	1515  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1561	1519  74 06			     jz	??0015
1  1562	151B  E8 FA34			     call printWORD
1  1563	151E  E8 F913			     call pause
1  1564	1521				   ??0015:
1  1565					 ; -----------------------------
1  1566	1521  FF 27			     JMP WORD PTR [BX]
   1567
   1568						  HEAD	  86h,'EXPEC',324Q,EXPE		      ;	EXPECT
1  1569	      =ARRAY:1523		     LINK$=$
1  1570	1523  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  1571							 ; 6 - признак immediate. 5- слово не описано smudge
1  1572	1524  45 58 50 45 43		     DB	 'EXPEC'
1  1573	1529  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  1574
1  1575	152A  1503r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1576	      =ARRAY:1523		     LINK=LINK$
1  1577
1  1578	152C				     EXPE LABEL	FAR  ; CFA
1  1579	152C  152Er			     DW	 $+2
   1580					     ; adr count ->
   1581	152E  B4 0A				  MOV	AH, 0AH		     ;	ввод строки в буфер
   1582	1530  59				  POP	CX		     ; Число символов
   1583	1531  5B				  POP	BX		     ; Адрес буфера SS
   1584	1532  88 0F				  MOV	BYTE PTR [BX],	CL   ; Засылка ожидаемого числа
   1585	1534  8B D3				  MOV	DX, BX
   1586	1536  CD 21				  INT	21h
   1587
   1588	1538  8A 47 01				  MOV	AL, BYTE PTR [BX+1]  ; фактически введено символов
   1589	153B  2A E4				  SUB	AH, AH		     ;
   1590	153D  03 D8				  ADD	BX, AX		     ; адрес конца строки
   1591	153F  C7 47 02 0000			  MOV	WORD PTR [BX+2],0    ; +2, т.к.	в начале строки	мах длина
   1592									     ; и число введенных символов
   1593						  NEXT
1  1594	1544  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1595	1545  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1596					 ; ------ call debugger	--------
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 29
forth.asm



1  1597	1547  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1598	154B  74 06			     jz	??0016
1  1599	154D  E8 FA02			     call printWORD
1  1600	1550  E8 F8E1			     call pause
1  1601	1553				   ??0016:
1  1602					 ; -----------------------------
1  1603	1553  FF 27			     JMP WORD PTR [BX]
   1604
   1605						  HEAD	  85h,'?TER',244Q,?TER$		      ;	?TER$
1  1606	      =ARRAY:1555		     LINK$=$
1  1607	1555  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  1608							 ; 6 - признак immediate. 5- слово не описано smudge
1  1609	1556  3F 54 45 52		     DB	 '?TER'
1  1610	155A  A4			     DB	 244Q	; последний символ слова + 128 (7 бит =	1).
1  1611
1  1612	155B  1523r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1613	      =ARRAY:1555		     LINK=LINK$
1  1614
1  1615	155D				     ?TER$ LABEL FAR  ;	CFA
1  1616	155D  155Fr			     DW	 $+2
   1617	155F  06				  PUSH	ES
   1618	1560  2B C9				  SUB	CX, CX
   1619	1562  8E C1				  MOV	ES, CX
   1620	1564  26: 80 0E	0417 20			  OR	BYTE PTR ES:[417H],  40Q
   1621	156A  B4 01			TER:	  MOV	AH, 1	 ; проверить готовность	символа	(и показать его, если так)
   1622								 ; выход: ZF = 1 если символ не	готов.
   1623								 ; ZF =	0 если символ готов.
   1624								 ; AX =	как для	подфункции 00H (но символ здесь	не
   1625								 ; удаляется из	очереди).
   1626	156C  CD 16				  INT	16h
   1627	156E  74 FA				  JZ	TER
   1628	1570  2A E4				  SUB	AH, AH	 ; читать (ожидать) следующую нажатую клавишу
   1629	1572  CD 16				  INT	16h
   1630	1574  26: 80 26	0417 DF			  AND	BYTE PTR ES:[417H],337Q	 ; Сброс 'NUM LOCK'
   1631	157A  07				  POP	ES		; Восстановление ES
   1632	157B  50				  PUSH	AX		; Запись символа
   1633						  NEXT
1  1634	157C  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1635	157D  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1636					 ; ------ call debugger	--------
1  1637	157F  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1638	1583  74 06			     jz	??0017
1  1639	1585  E8 F9CA			     call printWORD
1  1640	1588  E8 F8A9			     call pause
1  1641	158B				   ??0017:
1  1642					 ; -----------------------------
1  1643	158B  FF 27			     JMP WORD PTR [BX]
   1644
   1645					; ** Ввод/Вывод	**
   1646
   1647						  HEAD	  84h,'POR',324Q,PORT		      ;	PORT
1  1648	      =ARRAY:158D		     LINK$=$
1  1649	158D  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1650							 ; 6 - признак immediate. 5- слово не описано smudge
1  1651	158E  50 4F 52			     DB	 'POR'
1  1652	1591  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  1653
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 30
forth.asm



1  1654	1592  1555r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1655	      =ARRAY:158D		     LINK=LINK$
1  1656
1  1657	1594				     PORT LABEL	FAR  ; CFA
1  1658	1594  1596r			     DW	 $+2
   1659	1596  5A				  POP	DX
   1660	1597  58				  POP	AX
   1661	1598  EE				  OUT	DX, AL
   1662						  NEXT
1  1663	1599  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1664	159A  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1665					 ; ------ call debugger	--------
1  1666	159C  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1667	15A0  74 06			     jz	??0018
1  1668	15A2  E8 F9AD			     call printWORD
1  1669	15A5  E8 F88C			     call pause
1  1670	15A8				   ??0018:
1  1671					 ; -----------------------------
1  1672	15A8  FF 27			     JMP WORD PTR [BX]
   1673
   1674						  HEAD	  84h,'REA',304Q,READ		      ;	READ
1  1675	      =ARRAY:15AA		     LINK$=$
1  1676	15AA  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1677							 ; 6 - признак immediate. 5- слово не описано smudge
1  1678	15AB  52 45 41			     DB	 'REA'
1  1679	15AE  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  1680
1  1681	15AF  158Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1682	      =ARRAY:15AA		     LINK=LINK$
1  1683
1  1684	15B1				     READ LABEL	FAR  ; CFA
1  1685	15B1  15B3r			     DW	 $+2
   1686	15B3  5A				  POP	DX
   1687	15B4  EC				  IN	AL, DX
   1688	15B5  2A E4				  SUB	AH, AH
   1689	15B7  50				  PUSH	AX
   1690						  NEXT
1  1691	15B8  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1692	15B9  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1693					 ; ------ call debugger	--------
1  1694	15BB  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1695	15BF  74 06			     jz	??0019
1  1696	15C1  E8 F98E			     call printWORD
1  1697	15C4  E8 F86D			     call pause
1  1698	15C7				   ??0019:
1  1699					 ; -----------------------------
1  1700	15C7  FF 27			     JMP WORD PTR [BX]
   1701
   1702					;	  ** Арифметика	**
   1703
   1704						  HEAD	  82h,'1',253Q,ONEP		      ;	1+
1  1705	      =ARRAY:15C9		     LINK$=$
1  1706	15C9  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1707							 ; 6 - признак immediate. 5- слово не описано smudge
1  1708	15CA  31			     DB	 '1'
1  1709	15CB  AB			     DB	 253Q	; последний символ слова + 128 (7 бит =	1).
1  1710
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 31
forth.asm



1  1711	15CC  15AAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1712	      =ARRAY:15C9		     LINK=LINK$
1  1713
1  1714	15CE				     ONEP LABEL	FAR  ; CFA
1  1715	15CE  15D0r			     DW	 $+2
   1716	15D0  58				  POP	AX
   1717	15D1  40				  INC	AX
   1718	15D2  50				  PUSH	AX
   1719						  NEXT
1  1720	15D3  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1721	15D4  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1722					 ; ------ call debugger	--------
1  1723	15D6  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1724	15DA  74 06			     jz	??001A
1  1725	15DC  E8 F973			     call printWORD
1  1726	15DF  E8 F852			     call pause
1  1727	15E2				   ??001A:
1  1728					 ; -----------------------------
1  1729	15E2  FF 27			     JMP WORD PTR [BX]
   1730
   1731						  HEAD	  82h,'2',253Q,TWOP		      ;	2+
1  1732	      =ARRAY:15E4		     LINK$=$
1  1733	15E4  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1734							 ; 6 - признак immediate. 5- слово не описано smudge
1  1735	15E5  32			     DB	 '2'
1  1736	15E6  AB			     DB	 253Q	; последний символ слова + 128 (7 бит =	1).
1  1737
1  1738	15E7  15C9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1739	      =ARRAY:15E4		     LINK=LINK$
1  1740
1  1741	15E9				     TWOP LABEL	FAR  ; CFA
1  1742	15E9  15EBr			     DW	 $+2
   1743	15EB  58				  POP	AX
   1744	15EC  05 0002				  ADD	AX, 2
   1745	15EF  50				  PUSH	AX
   1746						  NEXT
1  1747	15F0  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1748	15F1  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1749					 ; ------ call debugger	--------
1  1750	15F3  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1751	15F7  74 06			     jz	??001B
1  1752	15F9  E8 F956			     call printWORD
1  1753	15FC  E8 F835			     call pause
1  1754	15FF				   ??001B:
1  1755					 ; -----------------------------
1  1756	15FF  FF 27			     JMP WORD PTR [BX]
   1757
   1758						  HEAD	  82h,'1',255Q,ONEM		      ;	1-
1  1759	      =ARRAY:1601		     LINK$=$
1  1760	1601  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1761							 ; 6 - признак immediate. 5- слово не описано smudge
1  1762	1602  31			     DB	 '1'
1  1763	1603  AD			     DB	 255Q	; последний символ слова + 128 (7 бит =	1).
1  1764
1  1765	1604  15E4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1766	      =ARRAY:1601		     LINK=LINK$
1  1767
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 32
forth.asm



1  1768	1606				     ONEM LABEL	FAR  ; CFA
1  1769	1606  1608r			     DW	 $+2
   1770	1608  58				  POP	AX
   1771	1609  48				  DEC	AX
   1772	160A  50				  PUSH	AX
   1773						  NEXT
1  1774	160B  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1775	160C  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1776					 ; ------ call debugger	--------
1  1777	160E  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1778	1612  74 06			     jz	??001C
1  1779	1614  E8 F93B			     call printWORD
1  1780	1617  E8 F81A			     call pause
1  1781	161A				   ??001C:
1  1782					 ; -----------------------------
1  1783	161A  FF 27			     JMP WORD PTR [BX]
   1784
   1785						  HEAD	  82h,'2',252Q,MUL2		      ;	2*
1  1786	      =ARRAY:161C		     LINK$=$
1  1787	161C  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1788							 ; 6 - признак immediate. 5- слово не описано smudge
1  1789	161D  32			     DB	 '2'
1  1790	161E  AA			     DB	 252Q	; последний символ слова + 128 (7 бит =	1).
1  1791
1  1792	161F  1601r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1793	      =ARRAY:161C		     LINK=LINK$
1  1794
1  1795	1621				     MUL2 LABEL	FAR  ; CFA
1  1796	1621  1623r			     DW	 $+2
   1797	1623  58				  POP	AX
   1798	1624  D1 E0				  SAL	AX,  1
   1799	1626  50				  PUSH	AX
   1800						  NEXT
1  1801	1627  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1802	1628  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1803					 ; ------ call debugger	--------
1  1804	162A  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1805	162E  74 06			     jz	??001D
1  1806	1630  E8 F91F			     call printWORD
1  1807	1633  E8 F7FE			     call pause
1  1808	1636				   ??001D:
1  1809					 ; -----------------------------
1  1810	1636  FF 27			     JMP WORD PTR [BX]
   1811
   1812						  HEAD	  82h,'2',257Q,DIV2		      ;	2/
1  1813	      =ARRAY:1638		     LINK$=$
1  1814	1638  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1815							 ; 6 - признак immediate. 5- слово не описано smudge
1  1816	1639  32			     DB	 '2'
1  1817	163A  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  1818
1  1819	163B  161Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1820	      =ARRAY:1638		     LINK=LINK$
1  1821
1  1822	163D				     DIV2 LABEL	FAR  ; CFA
1  1823	163D  163Fr			     DW	 $+2
   1824	163F  58				  POP	AX
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 33
forth.asm



   1825	1640  D1 F8				  SAR	AX, 1
   1826	1642  50				  PUSH	AX
   1827						  NEXT
1  1828	1643  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1829	1644  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1830					 ; ------ call debugger	--------
1  1831	1646  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1832	164A  74 06			     jz	??001E
1  1833	164C  E8 F903			     call printWORD
1  1834	164F  E8 F7E2			     call pause
1  1835	1652				   ??001E:
1  1836					 ; -----------------------------
1  1837	1652  FF 27			     JMP WORD PTR [BX]
   1838
   1839						  HEAD	  82h, 'U', 252Q,USTAR		      ;	U*
1  1840	      =ARRAY:1654		     LINK$=$
1  1841	1654  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1842							 ; 6 - признак immediate. 5- слово не описано smudge
1  1843	1655  55			     DB	 'U'
1  1844	1656  AA			     DB	 252Q	; последний символ слова + 128 (7 бит =	1).
1  1845
1  1846	1657  1638r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1847	      =ARRAY:1654		     LINK=LINK$
1  1848
1  1849	1659				     USTAR LABEL FAR  ;	CFA
1  1850	1659  165Br			     DW	 $+2
   1851					 ; u1  u2  ---	ud
   1852	165B  58				  POP	AX
   1853	165C  59				  POP	CX
   1854	165D  F7 E1				  MUL	CX
   1855	165F  50				  PUSH	AX
   1856	1660  52				  PUSH	DX
   1857						  NEXT
1  1858	1661  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1859	1662  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1860					 ; ------ call debugger	--------
1  1861	1664  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1862	1668  74 06			     jz	??001F
1  1863	166A  E8 F8E5			     call printWORD
1  1864	166D  E8 F7C4			     call pause
1  1865	1670				   ??001F:
1  1866					 ; -----------------------------
1  1867	1670  FF 27			     JMP WORD PTR [BX]
   1868
   1869						  HEAD	  82h,'U',257Q,USLAS		      ;	U/
1  1870	      =ARRAY:1672		     LINK$=$
1  1871	1672  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1872							 ; 6 - признак immediate. 5- слово не описано smudge
1  1873	1673  55			     DB	 'U'
1  1874	1674  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  1875
1  1876	1675  1654r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1877	      =ARRAY:1672		     LINK=LINK$
1  1878
1  1879	1677				     USLAS LABEL FAR  ;	CFA
1  1880	1677  1679r			     DW	 $+2
   1881					 ; ud u1 --- u2	u3
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 34
forth.asm



   1882	1679  59				  POP	CX	    ; Делитель
   1883	167A  5A				  POP	DX
   1884	167B  58				  POP	AX
   1885	167C  F7 F1				  DIV	CX
   1886	167E  52				  PUSH	DX	    ; Остаток
   1887	167F  50				  PUSH	AX	    ; Засылка  результата
   1888						  NEXT
1  1889	1680  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1890	1681  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1891					 ; ------ call debugger	--------
1  1892	1683  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1893	1687  74 06			     jz	??0020
1  1894	1689  E8 F8C6			     call printWORD
1  1895	168C  E8 F7A5			     call pause
1  1896	168F				   ??0020:
1  1897					 ; -----------------------------
1  1898	168F  FF 27			     JMP WORD PTR [BX]
   1899
   1900						  HEAD	  82h,'M',252Q,MSTAR		      ;	M*
1  1901	      =ARRAY:1691		     LINK$=$
1  1902	1691  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1903							 ; 6 - признак immediate. 5- слово не описано smudge
1  1904	1692  4D			     DB	 'M'
1  1905	1693  AA			     DB	 252Q	; последний символ слова + 128 (7 бит =	1).
1  1906
1  1907	1694  1672r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1908	      =ARRAY:1691		     LINK=LINK$
1  1909
1  1910	1696				     MSTAR LABEL FAR  ;	CFA
1  1911	1696  1698r			     DW	 $+2
   1912	1698  58				  POP	AX
   1913	1699  59				  POP	CX
   1914	169A  F7 E9				  IMUL	CX
   1915	169C  50				  PUSH	AX
   1916	169D  52				  PUSH	DX
   1917						  NEXT
1  1918	169E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1919	169F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1920					 ; ------ call debugger	--------
1  1921	16A1  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1922	16A5  74 06			     jz	??0021
1  1923	16A7  E8 F8A8			     call printWORD
1  1924	16AA  E8 F787			     call pause
1  1925	16AD				   ??0021:
1  1926					 ; -----------------------------
1  1927	16AD  FF 27			     JMP WORD PTR [BX]
   1928
   1929						  HEAD	   86h,'DMINU',323Q,DMINU	      ;	DMINUS
1  1930	      =ARRAY:16AF		     LINK$=$
1  1931	16AF  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  1932							 ; 6 - признак immediate. 5- слово не описано smudge
1  1933	16B0  44 4D 49 4E 55		     DB	 'DMINU'
1  1934	16B5  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  1935
1  1936	16B6  1691r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1937	      =ARRAY:16AF		     LINK=LINK$
1  1938
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 35
forth.asm



1  1939	16B8				     DMINU LABEL FAR  ;	CFA
1  1940	16B8  16BAr			     DW	 $+2
   1941					; Изменение знака числа	двойной	длины
   1942	16BA  58				  POP  AX
   1943	16BB  F7 D8			DMIN:	  NEG  AX
   1944	16BD  59				  POP  CX
   1945	16BE  F7 D9				  NEG  CX
   1946	16C0  1D 0000				  SBB  AX, 0	   ; sub with borrow
   1947	16C3  51				  PUSH CX
   1948	16C4  50				  PUSH AX
   1949	16C5				G$:	  NEXT
1  1950	16C5  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1951	16C6  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1952					 ; ------ call debugger	--------
1  1953	16C8  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1954	16CC  74 06			     jz	??0022
1  1955	16CE  E8 F881			     call printWORD
1  1956	16D1  E8 F760			     call pause
1  1957	16D4				   ??0022:
1  1958					 ; -----------------------------
1  1959	16D4  FF 27			     JMP WORD PTR [BX]
   1960
   1961						 HEAD	  84h,'DAB',323Q,DABS		      ;	DABS
1  1962	      =ARRAY:16D6		     LINK$=$
1  1963	16D6  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1964							 ; 6 - признак immediate. 5- слово не описано smudge
1  1965	16D7  44 41 42			     DB	 'DAB'
1  1966	16DA  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  1967
1  1968	16DB  16AFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1969	      =ARRAY:16D6		     LINK=LINK$
1  1970
1  1971	16DD				     DABS LABEL	FAR  ; CFA
1  1972	16DD  16DFr			     DW	 $+2
   1973	16DF  58				 POP   AX
   1974	16E0  3D 0000				 CMP   AX, 0
   1975	16E3  78 D6				 JS    DMIN
   1976	16E5  50				 PUSH  AX
   1977						 NEXT
1  1978	16E6  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1979	16E7  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1980					 ; ------ call debugger	--------
1  1981	16E9  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1982	16ED  74 06			     jz	??0023
1  1983	16EF  E8 F860			     call printWORD
1  1984	16F2  E8 F73F			     call pause
1  1985	16F5				   ??0023:
1  1986					 ; -----------------------------
1  1987	16F5  FF 27			     JMP WORD PTR [BX]
   1988
   1989						 HEAD	  82h,'M',257Q,MSLAS		      ;	M/
1  1990	      =ARRAY:16F7		     LINK$=$
1  1991	16F7  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1992							 ; 6 - признак immediate. 5- слово не описано smudge
1  1993	16F8  4D			     DB	 'M'
1  1994	16F9  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  1995
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 36
forth.asm



1  1996	16FA  16D6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1997	      =ARRAY:16F7		     LINK=LINK$
1  1998
1  1999	16FC				     MSLAS LABEL FAR  ;	CFA
1  2000	16FC  16FEr			     DW	 $+2
   2001	16FE  59				 POP   CX	   ; Делимое
   2002	16FF  5A				 POP   DX
   2003	1700  58				 POP   AX
   2004	1701  F7 F9				 IDIV  CX
   2005	1703  52				 PUSH  DX
   2006	1704  50				 PUSH  AX
   2007						 NEXT
1  2008	1705  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2009	1706  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2010					 ; ------ call debugger	--------
1  2011	1708  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2012	170C  74 06			     jz	??0024
1  2013	170E  E8 F841			     call printWORD
1  2014	1711  E8 F720			     call pause
1  2015	1714				   ??0024:
1  2016					 ; -----------------------------
1  2017	1714  FF 27			     JMP WORD PTR [BX]
   2018
   2019						 HEAD	  81h,,253Q,PLUS		      ;	+
1  2020	      =ARRAY:1716		     LINK$=$
1  2021	1716  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2022							 ; 6 - признак immediate. 5- слово не описано smudge
1  2023	1717  AB			     DB	 253Q	; последний символ слова + 128 (7 бит =	1).
1  2024
1  2025	1718  16F7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2026	      =ARRAY:1716		     LINK=LINK$
1  2027
1  2028	171A				     PLUS LABEL	FAR  ; CFA
1  2029	171A  171Cr			     DW	 $+2
   2030	171C  58				 POP  AX
   2031	171D  59				 POP  CX
   2032	171E  03 C1				 ADD  AX, CX
   2033	1720  50				 PUSH AX
   2034						 NEXT
1  2035	1721  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2036	1722  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2037					 ; ------ call debugger	--------
1  2038	1724  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2039	1728  74 06			     jz	??0025
1  2040	172A  E8 F825			     call printWORD
1  2041	172D  E8 F704			     call pause
1  2042	1730				   ??0025:
1  2043					 ; -----------------------------
1  2044	1730  FF 27			     JMP WORD PTR [BX]
   2045
   2046						 HEAD	  81h,,255Q,SUBB		       ; -
1  2047	      =ARRAY:1732		     LINK$=$
1  2048	1732  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2049							 ; 6 - признак immediate. 5- слово не описано smudge
1  2050	1733  AD			     DB	 255Q	; последний символ слова + 128 (7 бит =	1).
1  2051
1  2052	1734  1716r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 37
forth.asm



1  2053	      =ARRAY:1732		     LINK=LINK$
1  2054
1  2055	1736				     SUBB LABEL	FAR  ; CFA
1  2056	1736  1738r			     DW	 $+2
   2057					 ; n1 n2 -> n1-n2
   2058	1738  59				 POP  CX
   2059	1739  58				 POP  AX
   2060	173A  2B C1				 SUB  AX, CX
   2061	173C  50				 PUSH AX
   2062						 NEXT
1  2063	173D  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2064	173E  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2065					 ; ------ call debugger	--------
1  2066	1740  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2067	1744  74 06			     jz	??0026
1  2068	1746  E8 F809			     call printWORD
1  2069	1749  E8 F6E8			     call pause
1  2070	174C				   ??0026:
1  2071					 ; -----------------------------
1  2072	174C  FF 27			     JMP WORD PTR [BX]
   2073
   2074						 HEAD	  82h,'D',253Q,DPLUS		      ;	D+
1  2075	      =ARRAY:174E		     LINK$=$
1  2076	174E  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2077							 ; 6 - признак immediate. 5- слово не описано smudge
1  2078	174F  44			     DB	 'D'
1  2079	1750  AB			     DB	 253Q	; последний символ слова + 128 (7 бит =	1).
1  2080
1  2081	1751  1732r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2082	      =ARRAY:174E		     LINK=LINK$
1  2083
1  2084	1753				     DPLUS LABEL FAR  ;	CFA
1  2085	1753  1755r			     DW	 $+2
   2086	1755  58				 POP  AX
   2087	1756  59				 POP  CX
   2088	1757  8B DC				 MOV  BX, SP
   2089	1759  36: 01 4F	02			 ADD  SS:[BX+2],  CX
   2090	175D  36: 11 07				 ADC  SS:[BX],	  AX
   2091						 NEXT
1  2092	1760  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2093	1761  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2094					 ; ------ call debugger	--------
1  2095	1763  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2096	1767  74 06			     jz	??0027
1  2097	1769  E8 F7E6			     call printWORD
1  2098	176C  E8 F6C5			     call pause
1  2099	176F				   ??0027:
1  2100					 ; -----------------------------
1  2101	176F  FF 27			     JMP WORD PTR [BX]
   2102
   2103						 HEAD	  82h,'M',253Q,MPLUS		      ;	M+
1  2104	      =ARRAY:1771		     LINK$=$
1  2105	1771  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2106							 ; 6 - признак immediate. 5- слово не описано smudge
1  2107	1772  4D			     DB	 'M'
1  2108	1773  AB			     DB	 253Q	; последний символ слова + 128 (7 бит =	1).
1  2109
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 38
forth.asm



1  2110	1774  174Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2111	      =ARRAY:1771		     LINK=LINK$
1  2112
1  2113	1776				     MPLUS LABEL FAR  ;	CFA
1  2114	1776  1778r			     DW	 $+2
   2115	1778  59				 POP  CX
   2116	1779  8B DC				 MOV  BX, SP
   2117	177B  36: 01 4F	02			 ADD  SS:[BX+2],  CX
   2118	177F  36: 83 17	00			 ADC  word ptr SS:[BX],	   0
   2119						 NEXT
1  2120	1783  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2121	1784  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2122					 ; ------ call debugger	--------
1  2123	1786  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2124	178A  74 06			     jz	??0028
1  2125	178C  E8 F7C3			     call printWORD
1  2126	178F  E8 F6A2			     call pause
1  2127	1792				   ??0028:
1  2128					 ; -----------------------------
1  2129	1792  FF 27			     JMP WORD PTR [BX]
   2130
   2131						 HEAD	  85h,'MINU',323Q,MINUS		      ;	MINUS
1  2132	      =ARRAY:1794		     LINK$=$
1  2133	1794  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2134							 ; 6 - признак immediate. 5- слово не описано smudge
1  2135	1795  4D 49 4E 55		     DB	 'MINU'
1  2136	1799  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  2137
1  2138	179A  1771r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2139	      =ARRAY:1794		     LINK=LINK$
1  2140
1  2141	179C				     MINUS LABEL FAR  ;	CFA
1  2142	179C  179Er			     DW	 $+2
   2143	179E  58				 POP  AX
   2144	179F  F7 D8				 NEG  AX
   2145	17A1  50				 PUSH AX
   2146						 NEXT
1  2147	17A2  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2148	17A3  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2149					 ; ------ call debugger	--------
1  2150	17A5  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2151	17A9  74 06			     jz	??0029
1  2152	17AB  E8 F7A4			     call printWORD
1  2153	17AE  E8 F683			     call pause
1  2154	17B1				   ??0029:
1  2155					 ; -----------------------------
1  2156	17B1  FF 27			     JMP WORD PTR [BX]
   2157
   2158						 HEAD	  84h,'SWA',302Q,SWAB		      ;	SWAB
1  2159	      =ARRAY:17B3		     LINK$=$
1  2160	17B3  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2161							 ; 6 - признак immediate. 5- слово не описано smudge
1  2162	17B4  53 57 41			     DB	 'SWA'
1  2163	17B7  C2			     DB	 302Q	; последний символ слова + 128 (7 бит =	1).
1  2164
1  2165	17B8  1794r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2166	      =ARRAY:17B3		     LINK=LINK$
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 39
forth.asm



1  2167
1  2168	17BA				     SWAB LABEL	FAR  ; CFA
1  2169	17BA  17BCr			     DW	 $+2
   2170					     ; обмен байтами слова в стеке
   2171	17BC  58				 POP  AX
   2172	17BD  86 C4				 XCHG AL, AH
   2173	17BF  50				 PUSH AX
   2174						 NEXT
1  2175	17C0  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2176	17C1  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2177					 ; ------ call debugger	--------
1  2178	17C3  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2179	17C7  74 06			     jz	??002A
1  2180	17C9  E8 F786			     call printWORD
1  2181	17CC  E8 F665			     call pause
1  2182	17CF				   ??002A:
1  2183					 ; -----------------------------
1  2184	17CF  FF 27			     JMP WORD PTR [BX]
   2185
   2186						 HEAD	  83h,'AB',323Q,$ABS		       ; ABS
1  2187	      =ARRAY:17D1		     LINK$=$
1  2188	17D1  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2189							 ; 6 - признак immediate. 5- слово не описано smudge
1  2190	17D2  41 42			     DB	 'AB'
1  2191	17D4  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  2192
1  2193	17D5  17B3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2194	      =ARRAY:17D1		     LINK=LINK$
1  2195
1  2196	17D7				     $ABS LABEL	FAR  ; CFA
1  2197	17D7  17D9r			     DW	 $+2
   2198	17D9  58				 POP  AX
   2199	17DA  3D 0000				 CMP  AX, 0
   2200	17DD  79 02				 JNS  AB
   2201	17DF  F7 D8				 NEG  AX
   2202	17E1  50			AB:	 PUSH AX
   2203						 NEXT
1  2204	17E2  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2205	17E3  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2206					 ; ------ call debugger	--------
1  2207	17E5  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2208	17E9  74 06			     jz	??002B
1  2209	17EB  E8 F764			     call printWORD
1  2210	17EE  E8 F643			     call pause
1  2211	17F1				   ??002B:
1  2212					 ; -----------------------------
1  2213	17F1  FF 27			     JMP WORD PTR [BX]
   2214
   2215						 HEAD	  83h,'AN',304Q,$AND		      ;	AND
1  2216	      =ARRAY:17F3		     LINK$=$
1  2217	17F3  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2218							 ; 6 - признак immediate. 5- слово не описано smudge
1  2219	17F4  41 4E			     DB	 'AN'
1  2220	17F6  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  2221
1  2222	17F7  17D1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2223	      =ARRAY:17F3		     LINK=LINK$
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 40
forth.asm



1  2224
1  2225	17F9				     $AND LABEL	FAR  ; CFA
1  2226	17F9  17FBr			     DW	 $+2
   2227	17FB  58				 POP  AX
   2228	17FC  59				 POP  CX
   2229	17FD  23 C1				 AND  AX,  CX
   2230	17FF  50			ENDA:	 PUSH AX
   2231						 NEXT
1  2232	1800  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2233	1801  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2234					 ; ------ call debugger	--------
1  2235	1803  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2236	1807  74 06			     jz	??002C
1  2237	1809  E8 F746			     call printWORD
1  2238	180C  E8 F625			     call pause
1  2239	180F				   ??002C:
1  2240					 ; -----------------------------
1  2241	180F  FF 27			     JMP WORD PTR [BX]
   2242
   2243						 HEAD	  82h,'O',322Q,$OR		      ;	OR
1  2244	      =ARRAY:1811		     LINK$=$
1  2245	1811  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2246							 ; 6 - признак immediate. 5- слово не описано smudge
1  2247	1812  4F			     DB	 'O'
1  2248	1813  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  2249
1  2250	1814  17F3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2251	      =ARRAY:1811		     LINK=LINK$
1  2252
1  2253	1816				     $OR LABEL FAR  ; CFA
1  2254	1816  1818r			     DW	 $+2
   2255	1818  58				 POP  AX
   2256	1819  59				 POP  CX
   2257	181A  0B C1				 OR   AX, CX
   2258	181C  EB E1				 JMP  ENDA
   2259
   2260						 HEAD	  83h,'XO',322Q,$XOR		      ;	XOR
1  2261	      =ARRAY:181E		     LINK$=$
1  2262	181E  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2263							 ; 6 - признак immediate. 5- слово не описано smudge
1  2264	181F  58 4F			     DB	 'XO'
1  2265	1821  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  2266
1  2267	1822  1811r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2268	      =ARRAY:181E		     LINK=LINK$
1  2269
1  2270	1824				     $XOR LABEL	FAR  ; CFA
1  2271	1824  1826r			     DW	 $+2
   2272	1826  58				 POP  AX
   2273	1827  59				 POP  CX
   2274	1828  33 C1				 XOR  AX, CX
   2275	182A  EB D3				 JMP  ENDA
   2276
   2277						 HEAD2	   84h,<S->,304Q,STOD		      ;	S->D ; sds S->
1  2278	      =ARRAY:182C		     LINK$=$
1  2279	182C  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2280							 ; 6 - признак immediate. 5- слово не описано smudge
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 41
forth.asm



1  2281	182D  53 2D 3E			     DB	 'S-','>'
1  2282	1830  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  2283
1  2284	1831  181Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2285	      =ARRAY:182C		     LINK=LINK$
1  2286
1  2287	1833				     STOD LABEL	FAR  ; CFA
1  2288	1833  1835r			     DW	 $+2
   2289	1835  58				 POP  AX
   2290	1836  50				 PUSH AX
   2291	1837  8B CA				 MOV  CX, DX	       ; Сохранение содержимого	DX
   2292	1839  99				 CWD		       ; sign bit AX to	DX
   2293	183A  52				 PUSH  DX
   2294	183B  8B D1				 MOV  DX, CX	       ; Восстановление	DX
   2295						 NEXT
1  2296	183D  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2297	183E  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2298					 ; ------ call debugger	--------
1  2299	1840  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2300	1844  74 06			     jz	??002D
1  2301	1846  E8 F709			     call printWORD
1  2302	1849  E8 F5E8			     call pause
1  2303	184C				   ??002D:
1  2304					 ; -----------------------------
1  2305	184C  FF 27			     JMP WORD PTR [BX]
   2306
   2307						 HEAD	  83h,'MI',316Q,MIN		      ;	MIN
1  2308	      =ARRAY:184E		     LINK$=$
1  2309	184E  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2310							 ; 6 - признак immediate. 5- слово не описано smudge
1  2311	184F  4D 49			     DB	 'MI'
1  2312	1851  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  2313
1  2314	1852  182Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2315	      =ARRAY:184E		     LINK=LINK$
1  2316
1  2317	1854				     MIN LABEL FAR  ; CFA
1  2318	1854  1856r			     DW	 $+2
   2319	1856  58				 POP  AX
   2320	1857  59				 POP  CX
   2321	1858  3B C8				 CMP  CX,  AX
   2322	185A  7C 12				 JL  DEEP	     ;
   2323	185C  50			TOP:	 PUSH AX
   2324						 NEXT
1  2325	185D  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2326	185E  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2327					 ; ------ call debugger	--------
1  2328	1860  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2329	1864  74 06			     jz	??002E
1  2330	1866  E8 F6E9			     call printWORD
1  2331	1869  E8 F5C8			     call pause
1  2332	186C				   ??002E:
1  2333					 ; -----------------------------
1  2334	186C  FF 27			     JMP WORD PTR [BX]
   2335	186E  51			DEEP:	 PUSH CX
   2336						 NEXT
1  2337	186F  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 42
forth.asm



1  2338	1870  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2339					 ; ------ call debugger	--------
1  2340	1872  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2341	1876  74 06			     jz	??002F
1  2342	1878  E8 F6D7			     call printWORD
1  2343	187B  E8 F5B6			     call pause
1  2344	187E				   ??002F:
1  2345					 ; -----------------------------
1  2346	187E  FF 27			     JMP WORD PTR [BX]
   2347
   2348						 HEAD	  83h,'MA',330Q,MAX		      ;	MAX
1  2349	      =ARRAY:1880		     LINK$=$
1  2350	1880  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2351							 ; 6 - признак immediate. 5- слово не описано smudge
1  2352	1881  4D 41			     DB	 'MA'
1  2353	1883  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  2354
1  2355	1884  184Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2356	      =ARRAY:1880		     LINK=LINK$
1  2357
1  2358	1886				     MAX LABEL FAR  ; CFA
1  2359	1886  1888r			     DW	 $+2
   2360	1888  58				 POP  AX
   2361	1889  59				 POP  CX
   2362	188A  3B C8				 CMP  CX, AX
   2363	188C  7D E0				 JGE  DEEP
   2364	188E  EB CC				 JMP  TOP
   2365
   2366						 HEAD	  83h,'SP',300Q,SPAT		      ;	SP@
1  2367	      =ARRAY:1890		     LINK$=$
1  2368	1890  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2369							 ; 6 - признак immediate. 5- слово не описано smudge
1  2370	1891  53 50			     DB	 'SP'
1  2371	1893  C0			     DB	 300Q	; последний символ слова + 128 (7 бит =	1).
1  2372
1  2373	1894  1880r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2374	      =ARRAY:1890		     LINK=LINK$
1  2375
1  2376	1896				     SPAT LABEL	FAR  ; CFA
1  2377	1896  1898r			     DW	 $+2
   2378					     ; значение	текущего указателя регистра SP в стек
   2379	1898  8B C4				 MOV  AX, SP
   2380	189A  E9 FF62				 JMP  ENDA
   2381
   2382						 HEAD	  83h,'SP',241Q,SPSTO		      ;	SP!
1  2383	      =ARRAY:189D		     LINK$=$
1  2384	189D  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2385							 ; 6 - признак immediate. 5- слово не описано smudge
1  2386	189E  53 50			     DB	 'SP'
1  2387	18A0  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  2388
1  2389	18A1  1890r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2390	      =ARRAY:189D		     LINK=LINK$
1  2391
1  2392	18A3				     SPSTO LABEL FAR  ;	CFA
1  2393	18A3  18A5r			     DW	 $+2
   2394	18A5  8B 65 06				 MOV  SP, [DI+6]			     ; 80h
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 43
forth.asm



   2395						 NEXT
1  2396	18A8  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2397	18A9  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2398					 ; ------ call debugger	--------
1  2399	18AB  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2400	18AF  74 06			     jz	??0030
1  2401	18B1  E8 F69E			     call printWORD
1  2402	18B4  E8 F57D			     call pause
1  2403	18B7				   ??0030:
1  2404					 ; -----------------------------
1  2405	18B7  FF 27			     JMP WORD PTR [BX]
   2406
   2407						 HEAD	  83h,'RP',241Q,RPSTO		      ;	RP!
1  2408	      =ARRAY:18B9		     LINK$=$
1  2409	18B9  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2410							 ; 6 - признак immediate. 5- слово не описано smudge
1  2411	18BA  52 50			     DB	 'RP'
1  2412	18BC  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  2413
1  2414	18BD  189Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2415	      =ARRAY:18B9		     LINK=LINK$
1  2416
1  2417	18BF				     RPSTO LABEL FAR  ;	CFA
1  2418	18BF  18C1r			     DW	 $+2
   2419	18C1  8B 2E 0DA2r			 MOV  BP, $RS				     ; ccch
   2420						 NEXT
1  2421	18C5  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2422	18C6  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2423					 ; ------ call debugger	--------
1  2424	18C8  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2425	18CC  74 06			     jz	??0031
1  2426	18CE  E8 F681			     call printWORD
1  2427	18D1  E8 F560			     call pause
1  2428	18D4				   ??0031:
1  2429					 ; -----------------------------
1  2430	18D4  FF 27			     JMP WORD PTR [BX]
   2431
   2432						 HEAD	  82h,';',323Q,SEMI		      ;	;S
1  2433	      =ARRAY:18D6		     LINK$=$
1  2434	18D6  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2435							 ; 6 - признак immediate. 5- слово не описано smudge
1  2436	18D7  3B			     DB	 ';'
1  2437	18D8  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  2438
1  2439	18D9  18B9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2440	      =ARRAY:18D6		     LINK=LINK$
1  2441
1  2442	18DB				     SEMI LABEL	FAR  ; CFA
1  2443	18DB  18DDr			     DW	 $+2
   2444					     ; переход на слово	по адресу в стеке возврата СЛОЖНО
   2445					     ; слово,которым заканчивается слова на форте
   2446	18DD  8B 76 00				 MOV  SI, [BP] ; в RS хранится адрес следующего	слова,
   2447							     ; до перехода на исполнение слова,	которое	завершается
   2448	18E0  83 C5 02				 ADD  BP, 2 ; удаляем из RS
   2449						 NEXT ;	 возврат на предыдущее слово
1  2450	18E3  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2451	18E4  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 44
forth.asm



1  2452					 ; ------ call debugger	--------
1  2453	18E6  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2454	18EA  74 06			     jz	??0032
1  2455	18EC  E8 F663			     call printWORD
1  2456	18EF  E8 F542			     call pause
1  2457	18F2				   ??0032:
1  2458					 ; -----------------------------
1  2459	18F2  FF 27			     JMP WORD PTR [BX]
   2460
   2461					;	 ** Стек возвратов **
   2462
   2463						 HEAD	  85h, 'LEAV',305Q,LEAV		       ; LEAVE
1  2464	      =ARRAY:18F4		     LINK$=$
1  2465	18F4  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2466							 ; 6 - признак immediate. 5- слово не описано smudge
1  2467	18F5  4C 45 41 56		     DB	 'LEAV'
1  2468	18F9  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  2469
1  2470	18FA  18D6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2471	      =ARRAY:18F4		     LINK=LINK$
1  2472
1  2473	18FC				     LEAV LABEL	FAR  ; CFA
1  2474	18FC  18FEr			     DW	 $+2
   2475					     ; надо смотреть дальше с хранением	адресов
   2476					     ; приравнивает значения индекса и предела
   2477	18FE  8B 46 00				     MOV  AX, [BP]
   2478	1901  89 46 02				 MOV  [BP+2], AX
   2479						 NEXT
1  2480	1904  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2481	1905  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2482					 ; ------ call debugger	--------
1  2483	1907  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2484	190B  74 06			     jz	??0033
1  2485	190D  E8 F642			     call printWORD
1  2486	1910  E8 F521			     call pause
1  2487	1913				   ??0033:
1  2488					 ; -----------------------------
1  2489	1913  FF 27			     JMP WORD PTR [BX]
   2490
   2491						 HEAD	  82h, 62,322Q,TOR		      ;	>R sds
1  2492	      =ARRAY:1915		     LINK$=$
1  2493	1915  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2494							 ; 6 - признак immediate. 5- слово не описано smudge
1  2495	1916  3E			     DB	 62
1  2496	1917  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  2497
1  2498	1918  18F4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2499	      =ARRAY:1915		     LINK=LINK$
1  2500
1  2501	191A				     TOR LABEL FAR  ; CFA
1  2502	191A  191Cr			     DW	 $+2
   2503					     ; пишем в стек возвратов
   2504					     ; слово из	стека данных
   2505	191C  83 ED 02				 SUB  BP, 2 ; заняли ячейку
   2506	191F  8F 46 00				 POP  [BP]   ; записали	значение
   2507						 NEXT
1  2508	1922  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 45
forth.asm



1  2509	1923  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2510					 ; ------ call debugger	--------
1  2511	1925  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2512	1929  74 06			     jz	??0034
1  2513	192B  E8 F624			     call printWORD
1  2514	192E  E8 F503			     call pause
1  2515	1931				   ??0034:
1  2516					 ; -----------------------------
1  2517	1931  FF 27			     JMP WORD PTR [BX]
   2518
   2519						     HEAD     82h, 'R',276Q,FROMR		   ; R>
1  2520	      =ARRAY:1933		     LINK$=$
1  2521	1933  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2522							 ; 6 - признак immediate. 5- слово не описано smudge
1  2523	1934  52			     DB	 'R'
1  2524	1935  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1  2525
1  2526	1936  1915r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2527	      =ARRAY:1933		     LINK=LINK$
1  2528
1  2529	1938				     FROMR LABEL FAR  ;	CFA
1  2530	1938  193Ar			     DW	 $+2
   2531					     ; в стек данных слово по адресу из	стека возвратов
   2532	193A  FF 76 00				     PUSH [BP] ; в стек	записали
   2533	193D  83 C5 02				 ADD  BP, 2 ; убрали
   2534						 NEXT
1  2535	1940  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2536	1941  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2537					 ; ------ call debugger	--------
1  2538	1943  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2539	1947  74 06			     jz	??0035
1  2540	1949  E8 F606			     call printWORD
1  2541	194C  E8 F4E5			     call pause
1  2542	194F				   ??0035:
1  2543					 ; -----------------------------
1  2544	194F  FF 27			     JMP WORD PTR [BX]
   2545
   2546						 HEAD	  81h,,311Q,I			      ;	I R R@
1  2547	      =ARRAY:1951		     LINK$=$
1  2548	1951  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2549							 ; 6 - признак immediate. 5- слово не описано smudge
1  2550	1952  C9			     DB	 311Q	; последний символ слова + 128 (7 бит =	1).
1  2551
1  2552	1953  1933r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2553	      =ARRAY:1951		     LINK=LINK$
1  2554
1  2555	1955				     I LABEL FAR  ; CFA
1  2556	1955  1957r			     DW	 $+2
   2557					     ; Копирует	верхнее	число из стека возвратов
   2558					     ; и записывая в стек параметров
   2559	1957  FF 76 00		       RR$:	 PUSH [BP]
   2560	195A			       Z$:	 NEXT
1  2561	195A  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2562	195B  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2563					 ; ------ call debugger	--------
1  2564	195D  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2565	1961  74 06			     jz	??0036
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 46
forth.asm



1  2566	1963  E8 F5EC			     call printWORD
1  2567	1966  E8 F4CB			     call pause
1  2568	1969				   ??0036:
1  2569					 ; -----------------------------
1  2570	1969  FF 27			     JMP WORD PTR [BX]
   2571
   2572						 HEAD	  81h,,322Q,R			      ;	R
1  2573	      =ARRAY:196B		     LINK$=$
1  2574	196B  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2575							 ; 6 - признак immediate. 5- слово не описано smudge
1  2576	196C  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  2577
1  2578	196D  1951r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2579	      =ARRAY:196B		     LINK=LINK$
1  2580
1  2581	196F				     R LABEL FAR  ; CFA
1  2582	196F  1971r			     DW	 $+2
   2583	1971  EB E4				 JMP  RR$
   2584
   2585						 HEAD	  82h,'I',247Q,SRP		      ;	I'
1  2586	      =ARRAY:1973		     LINK$=$
1  2587	1973  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2588							 ; 6 - признак immediate. 5- слово не описано smudge
1  2589	1974  49			     DB	 'I'
1  2590	1975  A7			     DB	 247Q	; последний символ слова + 128 (7 бит =	1).
1  2591
1  2592	1976  196Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2593	      =ARRAY:1973		     LINK=LINK$
1  2594
1  2595	1978				     SRP LABEL FAR  ; CFA
1  2596	1978  197Ar			     DW	 $+2
   2597					     ; Копирует	второе сверху число из стека возвратов
   2598					     ; и записывает его	в стек параметров
   2599	197A  FF 76 02				 PUSH [BP+2]
   2600	197D  EB DB				 JMP  Z$
   2601
   2602					     HEAD     81h,,'J'+80h,J			; J
1  2603	      =ARRAY:197F		     LINK$=$
1  2604	197F  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2605							 ; 6 - признак immediate. 5- слово не описано smudge
1  2606	1980  CA			     DB	 'J'+80h   ; последний символ слова + 128 (7 бит = 1).
1  2607
1  2608	1981  1973r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2609	      =ARRAY:197F		     LINK=LINK$
1  2610
1  2611	1983				     J LABEL FAR  ; CFA
1  2612	1983  1985r			     DW	 $+2
   2613					     ; Копирует	третье сверху число из стека возвратов
   2614					     ; и записывает его	в стек параметров
   2615	1985  FF 76 04				 PUSH [BP+4]
   2616	1988  EB D0				 JMP  Z$
   2617
   2618					     HEAD     82h,'J',247Q,JT			 ; J'
1  2619	      =ARRAY:198A		     LINK$=$
1  2620	198A  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2621							 ; 6 - признак immediate. 5- слово не описано smudge
1  2622	198B  4A			     DB	 'J'
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 47
forth.asm



1  2623	198C  A7			     DB	 247Q	; последний символ слова + 128 (7 бит =	1).
1  2624
1  2625	198D  197Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2626	      =ARRAY:198A		     LINK=LINK$
1  2627
1  2628	198F				     JT	LABEL FAR  ; CFA
1  2629	198F  1991r			     DW	 $+2
   2630					     ; Копирует	четвертое сверху число из стека	возвратов
   2631					     ; и записывает его	в стек параметров
   2632	1991  FF 76 06				 PUSH [BP+6]
   2633	1994  EB C4				 JMP  Z$
   2634
   2635					     HEAD     81h,,'K'+80h,K			; K
1  2636	      =ARRAY:1996		     LINK$=$
1  2637	1996  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2638							 ; 6 - признак immediate. 5- слово не описано smudge
1  2639	1997  CB			     DB	 'K'+80h   ; последний символ слова + 128 (7 бит = 1).
1  2640
1  2641	1998  198Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2642	      =ARRAY:1996		     LINK=LINK$
1  2643
1  2644	199A				     K LABEL FAR  ; CFA
1  2645	199A  199Cr			     DW	 $+2
   2646					     ; Копирует	пятое сверху число из стека возвратов
   2647					     ; и записывает его	в стек параметров
   2648	199C  FF 76 08				 PUSH [BP+8]
   2649	199F  EB B9				 JMP  Z$
   2650
   2651					     HEAD     82h,'K',247Q,KT			 ; K'
1  2652	      =ARRAY:19A1		     LINK$=$
1  2653	19A1  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2654							 ; 6 - признак immediate. 5- слово не описано smudge
1  2655	19A2  4B			     DB	 'K'
1  2656	19A3  A7			     DB	 247Q	; последний символ слова + 128 (7 бит =	1).
1  2657
1  2658	19A4  1996r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2659	      =ARRAY:19A1		     LINK=LINK$
1  2660
1  2661	19A6				     KT	LABEL FAR  ; CFA
1  2662	19A6  19A8r			     DW	 $+2
   2663					     ; Копирует	шестое сверху число из стека возвратов
   2664					     ; и записывает его	в стек параметров
   2665	19A8  FF 76 0A				 PUSH [BP+10]
   2666	19AB  EB AD				 JMP  Z$
   2667
   2668						 HEAD	  83h,'LE',326Q,LEV		      ;	LEV
1  2669	      =ARRAY:19AD		     LINK$=$
1  2670	19AD  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2671							 ; 6 - признак immediate. 5- слово не описано smudge
1  2672	19AE  4C 45			     DB	 'LE'
1  2673	19B0  D6			     DB	 326Q	; последний символ слова + 128 (7 бит =	1).
1  2674
1  2675	19B1  19A1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2676	      =ARRAY:19AD		     LINK=LINK$
1  2677
1  2678	19B3				     LEV LABEL FAR  ; CFA
1  2679	19B3  19B5r			     DW	 $+2
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 48
forth.asm



   2680					     ; эквивалент R> DROP :) только быстрее
   2681					     ; для выхода из interpret
   2682	19B5  83 C5 02				 ADD  BP, 2
   2683						 NEXT
1  2684	19B8  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2685	19B9  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2686					 ; ------ call debugger	--------
1  2687	19BB  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2688	19BF  74 06			     jz	??0037
1  2689	19C1  E8 F58E			     call printWORD
1  2690	19C4  E8 F46D			     call pause
1  2691	19C7				   ??0037:
1  2692					 ; -----------------------------
1  2693	19C7  FF 27			     JMP WORD PTR [BX]
   2694
   2695						 ;** Операции со стеком	параметров **
   2696
   2697						 HEAD	  84h,'PIC',313Q,PICK		      ;	PICK
1  2698	      =ARRAY:19C9		     LINK$=$
1  2699	19C9  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2700							 ; 6 - признак immediate. 5- слово не описано smudge
1  2701	19CA  50 49 43			     DB	 'PIC'
1  2702	19CD  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  2703
1  2704	19CE  19ADr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2705	      =ARRAY:19C9		     LINK=LINK$
1  2706
1  2707	19D0				     PICK LABEL	FAR  ; CFA
1  2708	19D0  19D2r			     DW	 $+2
   2709	19D2  5B				 POP  BX
   2710	19D3  83 FB 00				 CMP  BX,  0
   2711	19D6  7E 08				 JLE  $GO
   2712	19D8  4B				 DEC  BX
   2713	19D9  D1 E3				 SAL  BX, 1
   2714	19DB  03 DC				 ADD  BX, SP
   2715	19DD  36: FF 37				 PUSH SS:[BX]
   2716	19E0				$GO:	 NEXT
1  2717	19E0  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2718	19E1  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2719					 ; ------ call debugger	--------
1  2720	19E3  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2721	19E7  74 06			     jz	??0038
1  2722	19E9  E8 F566			     call printWORD
1  2723	19EC  E8 F445			     call pause
1  2724	19EF				   ??0038:
1  2725					 ; -----------------------------
1  2726	19EF  FF 27			     JMP WORD PTR [BX]
   2727
   2728						 HEAD	  84h,'OVE',322Q,OVER		      ;	OVER
1  2729	      =ARRAY:19F1		     LINK$=$
1  2730	19F1  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2731							 ; 6 - признак immediate. 5- слово не описано smudge
1  2732	19F2  4F 56 45			     DB	 'OVE'
1  2733	19F5  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  2734
1  2735	19F6  19C9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2736	      =ARRAY:19F1		     LINK=LINK$
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 49
forth.asm



1  2737
1  2738	19F8				     OVER LABEL	FAR  ; CFA
1  2739	19F8  19FAr			     DW	 $+2
   2740	19FA  8B DC				 MOV  BX, SP
   2741	19FC  36: FF 77	02			     PUSH SS:[BX+2]
   2742						 NEXT
1  2743	1A00  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2744	1A01  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2745					 ; ------ call debugger	--------
1  2746	1A03  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2747	1A07  74 06			     jz	??0039
1  2748	1A09  E8 F546			     call printWORD
1  2749	1A0C  E8 F425			     call pause
1  2750	1A0F				   ??0039:
1  2751					 ; -----------------------------
1  2752	1A0F  FF 27			     JMP WORD PTR [BX]
   2753
   2754						 HEAD	  84h,'SWA',320Q,SWAP		      ;	SWAP
1  2755	      =ARRAY:1A11		     LINK$=$
1  2756	1A11  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2757							 ; 6 - признак immediate. 5- слово не описано smudge
1  2758	1A12  53 57 41			     DB	 'SWA'
1  2759	1A15  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2760
1  2761	1A16  19F1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2762	      =ARRAY:1A11		     LINK=LINK$
1  2763
1  2764	1A18				     SWAP LABEL	FAR  ; CFA
1  2765	1A18  1A1Ar			     DW	 $+2
   2766	1A1A  59				 POP  CX
   2767	1A1B  58				 POP  AX
   2768	1A1C  51				 PUSH CX
   2769	1A1D  50				 PUSH AX
   2770						 NEXT
1  2771	1A1E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2772	1A1F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2773					 ; ------ call debugger	--------
1  2774	1A21  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2775	1A25  74 06			     jz	??003A
1  2776	1A27  E8 F528			     call printWORD
1  2777	1A2A  E8 F407			     call pause
1  2778	1A2D				   ??003A:
1  2779					 ; -----------------------------
1  2780	1A2D  FF 27			     JMP WORD PTR [BX]
   2781
   2782						 HEAD	  85h,'2SWA',320Q,DSWAP		      ;	2SWAP
1  2783	      =ARRAY:1A2F		     LINK$=$
1  2784	1A2F  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2785							 ; 6 - признак immediate. 5- слово не описано smudge
1  2786	1A30  32 53 57 41		     DB	 '2SWA'
1  2787	1A34  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2788
1  2789	1A35  1A11r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2790	      =ARRAY:1A2F		     LINK=LINK$
1  2791
1  2792	1A37				     DSWAP LABEL FAR  ;	CFA
1  2793	1A37  1A39r			     DW	 $+2
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 50
forth.asm



   2794	1A39  58				 POP  AX
   2795	1A3A  59				 POP  CX
   2796	1A3B  8B DC				 MOV  BX,  SP
   2797	1A3D  36: 8B 57	02			 MOV  DX,WORD PTR SS:[BX+2]
   2798	1A41  52				 PUSH DX
   2799	1A42  36: 8B 17				 MOV  DX,WORD PTR SS:[BX]
   2800	1A45  52				 PUSH DX
   2801	1A46  36: 89 07				 MOV  WORD  PTR	SS:[BX],AX
   2802	1A49  36: 89 4F	02			 MOV  WORD  PTR	SS:[BX+2],CX
   2803						 NEXT
1  2804	1A4D  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2805	1A4E  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2806					 ; ------ call debugger	--------
1  2807	1A50  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2808	1A54  74 06			     jz	??003B
1  2809	1A56  E8 F4F9			     call printWORD
1  2810	1A59  E8 F3D8			     call pause
1  2811	1A5C				   ??003B:
1  2812					 ; -----------------------------
1  2813	1A5C  FF 27			     JMP WORD PTR [BX]
   2814
   2815						 HEAD	  83h,'DU',320Q,DUBL		      ;	DUP
1  2816	      =ARRAY:1A5E		     LINK$=$
1  2817	1A5E  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2818							 ; 6 - признак immediate. 5- слово не описано smudge
1  2819	1A5F  44 55			     DB	 'DU'
1  2820	1A61  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2821
1  2822	1A62  1A2Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2823	      =ARRAY:1A5E		     LINK=LINK$
1  2824
1  2825	1A64				     DUBL LABEL	FAR  ; CFA
1  2826	1A64  1A66r			     DW	 $+2
   2827	1A66  58				 POP  AX
   2828	1A67  50			DU:	 PUSH AX
   2829	1A68  50			C$:	 PUSH AX
   2830						 NEXT
1  2831	1A69  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2832	1A6A  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2833					 ; ------ call debugger	--------
1  2834	1A6C  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2835	1A70  74 06			     jz	??003C
1  2836	1A72  E8 F4DD			     call printWORD
1  2837	1A75  E8 F3BC			     call pause
1  2838	1A78				   ??003C:
1  2839					 ; -----------------------------
1  2840	1A78  FF 27			     JMP WORD PTR [BX]
   2841
   2842						 HEAD	  84h,'-DU',320Q,DDUP		      ;	-DUP
1  2843	      =ARRAY:1A7A		     LINK$=$
1  2844	1A7A  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2845							 ; 6 - признак immediate. 5- слово не описано smudge
1  2846	1A7B  2D 44 55			     DB	 '-DU'
1  2847	1A7E  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2848
1  2849	1A7F  1A5Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2850	      =ARRAY:1A7A		     LINK=LINK$
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 51
forth.asm



1  2851
1  2852	1A81				     DDUP LABEL	FAR  ; CFA
1  2853	1A81  1A83r			     DW	 $+2
   2854					     ; DUP если	в стеке	не 0
   2855	1A83  58				 POP  AX
   2856	1A84  3D 0000				 CMP  AX,  0
   2857	1A87  75 DE				 JNE  DU
   2858	1A89  EB DD				 JMP  C$
   2859
   2860						 HEAD	  84h,'2DU',320Q,DUP2		      ;	2DUP
1  2861	      =ARRAY:1A8B		     LINK$=$
1  2862	1A8B  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2863							 ; 6 - признак immediate. 5- слово не описано smudge
1  2864	1A8C  32 44 55			     DB	 '2DU'
1  2865	1A8F  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2866
1  2867	1A90  1A7Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2868	      =ARRAY:1A8B		     LINK=LINK$
1  2869
1  2870	1A92				     DUP2 LABEL	FAR  ; CFA
1  2871	1A92  1A94r			     DW	 $+2
   2872	1A94  58				 POP  AX
   2873	1A95  59				 POP  CX
   2874	1A96  51				 PUSH CX
   2875	1A97  50				 PUSH AX
   2876	1A98  51				 PUSH CX
   2877	1A99  50				 PUSH AX
   2878						 NEXT
1  2879	1A9A  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2880	1A9B  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2881					 ; ------ call debugger	--------
1  2882	1A9D  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2883	1AA1  74 06			     jz	??003D
1  2884	1AA3  E8 F4AC			     call printWORD
1  2885	1AA6  E8 F38B			     call pause
1  2886	1AA9				   ??003D:
1  2887					 ; -----------------------------
1  2888	1AA9  FF 27			     JMP WORD PTR [BX]
   2889
   2890						 HEAD	  83h,'RO',324Q,ROT		      ;	ROT
1  2891	      =ARRAY:1AAB		     LINK$=$
1  2892	1AAB  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2893							 ; 6 - признак immediate. 5- слово не описано smudge
1  2894	1AAC  52 4F			     DB	 'RO'
1  2895	1AAE  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  2896
1  2897	1AAF  1A8Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2898	      =ARRAY:1AAB		     LINK=LINK$
1  2899
1  2900	1AB1				     ROT LABEL FAR  ; CFA
1  2901	1AB1  1AB3r			     DW	 $+2
   2902	1AB3  58				 POP  AX
   2903	1AB4  59				 POP  CX
   2904	1AB5  5B				 POP  BX
   2905	1AB6  51				 PUSH CX
   2906	1AB7  50				 PUSH AX
   2907	1AB8  53				 PUSH BX
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 52
forth.asm



   2908						 NEXT
1  2909	1AB9  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2910	1ABA  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2911					 ; ------ call debugger	--------
1  2912	1ABC  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2913	1AC0  74 06			     jz	??003E
1  2914	1AC2  E8 F48D			     call printWORD
1  2915	1AC5  E8 F36C			     call pause
1  2916	1AC8				   ??003E:
1  2917					 ; -----------------------------
1  2918	1AC8  FF 27			     JMP WORD PTR [BX]
   2919
   2920						 HEAD	  84h,'-RO',324Q,MROT			; -ROT
1  2921	      =ARRAY:1ACA		     LINK$=$
1  2922	1ACA  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2923							 ; 6 - признак immediate. 5- слово не описано smudge
1  2924	1ACB  2D 52 4F			     DB	 '-RO'
1  2925	1ACE  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  2926
1  2927	1ACF  1AABr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2928	      =ARRAY:1ACA		     LINK=LINK$
1  2929
1  2930	1AD1				     MROT LABEL	FAR  ; CFA
1  2931	1AD1  1AD3r			     DW	 $+2
   2932	1AD3  58				 POP  AX
   2933	1AD4  59				 POP  CX
   2934	1AD5  5B				 POP  BX
   2935	1AD6  50				 PUSH AX
   2936	1AD7  53				 PUSH BX
   2937	1AD8  51				 PUSH CX
   2938						 NEXT
1  2939	1AD9  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2940	1ADA  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2941					 ; ------ call debugger	--------
1  2942	1ADC  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2943	1AE0  74 06			     jz	??003F
1  2944	1AE2  E8 F46D			     call printWORD
1  2945	1AE5  E8 F34C			     call pause
1  2946	1AE8				   ??003F:
1  2947					 ; -----------------------------
1  2948	1AE8  FF 27			     JMP WORD PTR [BX]
   2949
   2950						 HEAD	  85h,'4DRO',320Q,QDROP		      ;	4DROP
1  2951	      =ARRAY:1AEA		     LINK$=$
1  2952	1AEA  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2953							 ; 6 - признак immediate. 5- слово не описано smudge
1  2954	1AEB  34 44 52 4F		     DB	 '4DRO'
1  2955	1AEF  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2956
1  2957	1AF0  1ACAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2958	      =ARRAY:1AEA		     LINK=LINK$
1  2959
1  2960	1AF2				     QDROP LABEL FAR  ;	CFA
1  2961	1AF2  1AF4r			     DW	 $+2
   2962	1AF4  83 C4 06				 ADD  SP, 6
   2963						 NEXT
1  2964	1AF7  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 53
forth.asm



1  2965	1AF8  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2966					 ; ------ call debugger	--------
1  2967	1AFA  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2968	1AFE  74 06			     jz	??0040
1  2969	1B00  E8 F44F			     call printWORD
1  2970	1B03  E8 F32E			     call pause
1  2971	1B06				   ??0040:
1  2972					 ; -----------------------------
1  2973	1B06  FF 27			     JMP WORD PTR [BX]
   2974
   2975						 HEAD	  85h,'2DRO',320Q,DDROP		      ;	2DROP
1  2976	      =ARRAY:1B08		     LINK$=$
1  2977	1B08  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2978							 ; 6 - признак immediate. 5- слово не описано smudge
1  2979	1B09  32 44 52 4F		     DB	 '2DRO'
1  2980	1B0D  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2981
1  2982	1B0E  1AEAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2983	      =ARRAY:1B08		     LINK=LINK$
1  2984
1  2985	1B10				     DDROP LABEL FAR  ;	CFA
1  2986	1B10  1B12r			     DW	 $+2
   2987	1B12  83 C4 04			DRO:	 ADD  SP, 4
   2988						 NEXT
1  2989	1B15  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2990	1B16  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2991					 ; ------ call debugger	--------
1  2992	1B18  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2993	1B1C  74 06			     jz	??0041
1  2994	1B1E  E8 F431			     call printWORD
1  2995	1B21  E8 F310			     call pause
1  2996	1B24				   ??0041:
1  2997					 ; -----------------------------
1  2998	1B24  FF 27			     JMP WORD PTR [BX]
   2999
   3000						 HEAD	  84h,'DRO',320Q,DROP		      ;	DROP
1  3001	      =ARRAY:1B26		     LINK$=$
1  3002	1B26  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3003							 ; 6 - признак immediate. 5- слово не описано smudge
1  3004	1B27  44 52 4F			     DB	 'DRO'
1  3005	1B2A  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  3006
1  3007	1B2B  1B08r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3008	      =ARRAY:1B26		     LINK=LINK$
1  3009
1  3010	1B2D				     DROP LABEL	FAR  ; CFA
1  3011	1B2D  1B2Fr			     DW	 $+2
   3012	1B2F  83 C4 02			DRP:	 ADD  SP, 2
   3013						 NEXT
1  3014	1B32  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3015	1B33  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3016					 ; ------ call debugger	--------
1  3017	1B35  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3018	1B39  74 06			     jz	??0042
1  3019	1B3B  E8 F414			     call printWORD
1  3020	1B3E  E8 F2F3			     call pause
1  3021	1B41				   ??0042:
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 54
forth.asm



1  3022					 ; -----------------------------
1  3023	1B41  FF 27			     JMP WORD PTR [BX]
   3024
   3025						 HEAD	  83h,'NI','P'+80h,NIP		      ;	NIP
1  3026	      =ARRAY:1B43		     LINK$=$
1  3027	1B43  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3028							 ; 6 - признак immediate. 5- слово не описано smudge
1  3029	1B44  4E 49			     DB	 'NI'
1  3030	1B46  D0			     DB	 'P'+80h   ; последний символ слова + 128 (7 бит = 1).
1  3031
1  3032	1B47  1B26r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3033	      =ARRAY:1B43		     LINK=LINK$
1  3034
1  3035	1B49				     NIP LABEL FAR  ; CFA
1  3036	1B49  1B4Br			     DW	 $+2
   3037	1B4B  5B				 POP  BX
   3038	1B4C  58				 POP  AX
   3039	1B4D  53				 PUSH BX
   3040						 NEXT
1  3041	1B4E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3042	1B4F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3043					 ; ------ call debugger	--------
1  3044	1B51  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3045	1B55  74 06			     jz	??0043
1  3046	1B57  E8 F3F8			     call printWORD
1  3047	1B5A  E8 F2D7			     call pause
1  3048	1B5D				   ??0043:
1  3049					 ; -----------------------------
1  3050	1B5D  FF 27			     JMP WORD PTR [BX]
   3051
   3052					;	 ** Работа с памятью **
   3053
   3054						 HEAD	  85h,'CMOV',305Q,CMOV		     ; CMOVE
1  3055	      =ARRAY:1B5F		     LINK$=$
1  3056	1B5F  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3057							 ; 6 - признак immediate. 5- слово не описано smudge
1  3058	1B60  43 4D 4F 56		     DB	 'CMOV'
1  3059	1B64  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3060
1  3061	1B65  1B43r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3062	      =ARRAY:1B5F		     LINK=LINK$
1  3063
1  3064	1B67				     CMOV LABEL	FAR  ; CFA
1  3065	1B67  1B69r			     DW	 $+2
   3066					     ; src dst cnt -> перенос области памяти
   3067	1B69  59				 POP  CX	 ; Счетчик
   3068	1B6A  83 F9 00				 CMP  CX,  0
   3069	1B6D  7E A3				 JLE  DRO	 ; выход, c сбросом двух параметров в стеке
   3070	1B6F  8B C7				 MOV  AX,  DI	  ; Сохранение содержимого DI,SI
   3071	1B71  8B DE				 MOV  BX,  SI
   3072	1B73  5F				 POP  DI	  ; Куда
   3073	1B74  5E				 POP  SI	  ; Откуда
   3074	1B75  F3> A4			REP	 MOVS  BYTE PTR	ES:[DI], BYTE PTR DS:[SI]
   3075	1B77  8B F8				 MOV  DI, AX	  ; Восстановление DI,SI
   3076	1B79  8B F3				 MOV  SI, BX
   3077						 NEXT
1  3078	1B7B  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 55
forth.asm



1  3079	1B7C  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3080					 ; ------ call debugger	--------
1  3081	1B7E  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3082	1B82  74 06			     jz	??0044
1  3083	1B84  E8 F3CB			     call printWORD
1  3084	1B87  E8 F2AA			     call pause
1  3085	1B8A				   ??0044:
1  3086					 ; -----------------------------
1  3087	1B8A  FF 27			     JMP WORD PTR [BX]
   3088
   3089						 HEAD	  84h,'FIL',314Q,FILL		      ;	FILL
1  3090	      =ARRAY:1B8C		     LINK$=$
1  3091	1B8C  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3092							 ; 6 - признак immediate. 5- слово не описано smudge
1  3093	1B8D  46 49 4C			     DB	 'FIL'
1  3094	1B90  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3095
1  3096	1B91  1B5Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3097	      =ARRAY:1B8C		     LINK=LINK$
1  3098
1  3099	1B93				     FILL LABEL	FAR  ; CFA
1  3100	1B93  1B95r			     DW	 $+2
   3101					 ; addr	cnt chr	-> заполнение области памяти
   3102	1B95  58				 POP  AX      ;	Символ
   3103	1B96  59			FLL:	 POP  CX      ;	Счетчик	символов
   3104	1B97  83 F9 00				 CMP  CX, 0
   3105	1B9A  7E 93				 JLE  DRP     ;
   3106	1B9C  5B				 POP  BX
   3107	1B9D  88 07			$REPE:	 MOV  BYTE PTR [BX],  AL
   3108	1B9F  43				 INC  BX
   3109	1BA0  E2 FB				 LOOP $REPE
   3110						 NEXT
1  3111	1BA2  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3112	1BA3  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3113					 ; ------ call debugger	--------
1  3114	1BA5  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3115	1BA9  74 06			     jz	??0045
1  3116	1BAB  E8 F3A4			     call printWORD
1  3117	1BAE  E8 F283			     call pause
1  3118	1BB1				   ??0045:
1  3119					 ; -----------------------------
1  3120	1BB1  FF 27			     JMP WORD PTR [BX]
   3121
   3122						 HEAD	  85h,'ERAS',305Q,ERASE		      ;	ERASE
1  3123	      =ARRAY:1BB3		     LINK$=$
1  3124	1BB3  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3125							 ; 6 - признак immediate. 5- слово не описано smudge
1  3126	1BB4  45 52 41 53		     DB	 'ERAS'
1  3127	1BB8  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3128
1  3129	1BB9  1B8Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3130	      =ARRAY:1BB3		     LINK=LINK$
1  3131
1  3132	1BBB				     ERASE LABEL FAR  ;	CFA
1  3133	1BBB  1BBDr			     DW	 $+2
   3134					     ; заполнение нулем
   3135	1BBD  2B C0				 SUB  AX, AX
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 56
forth.asm



   3136	1BBF  EB D5				 JMP  FLL
   3137
   3138						 HEAD	  86h,'BLANK',323Q,BLANK	      ;	BLANKS
1  3139	      =ARRAY:1BC1		     LINK$=$
1  3140	1BC1  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  3141							 ; 6 - признак immediate. 5- слово не описано smudge
1  3142	1BC2  42 4C 41 4E 4B		     DB	 'BLANK'
1  3143	1BC7  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  3144
1  3145	1BC8  1BB3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3146	      =ARRAY:1BC1		     LINK=LINK$
1  3147
1  3148	1BCA				     BLANK LABEL FAR  ;	CFA
1  3149	1BCA  1BCCr			     DW	 $+2
   3150					     ; заполнение  пробелом
   3151	1BCC  B8 0020				 MOV  AX, 32
   3152	1BCF  EB C5				 JMP  FLL
   3153
   3154						 HEAD	  84h,'HOL',304Q,HOLD		      ;	HOLD
1  3155	      =ARRAY:1BD1		     LINK$=$
1  3156	1BD1  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3157							 ; 6 - признак immediate. 5- слово не описано smudge
1  3158	1BD2  48 4F 4C			     DB	 'HOL'
1  3159	1BD5  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  3160
1  3161	1BD6  1BC1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3162	      =ARRAY:1BD1		     LINK=LINK$
1  3163
1  3164	1BD8				     HOLD LABEL	FAR  ; CFA
1  3165	1BD8  1BDAr			     DW	 $+2
   3166					     ; Вводит в	текущую	ячейку выходного буфера	символ,
   3167					     ; код которого в стеке. Должен использоваться между <# и #>
   3168					     ; уменьшает на 1 значение указателя HLD.
   3169	1BDA  FF 4D 38				 DEC  WORD PTR	[DI+70Q]
   3170	1BDD  58				 POP  AX
   3171	1BDE  8B 5D 38				 MOV  BX,  [DI+70Q]
   3172	1BE1  88 07				 MOV  BYTE PTR [BX], AL
   3173						 NEXT
1  3174	1BE3  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3175	1BE4  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3176					 ; ------ call debugger	--------
1  3177	1BE6  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3178	1BEA  74 06			     jz	??0046
1  3179	1BEC  E8 F363			     call printWORD
1  3180	1BEF  E8 F242			     call pause
1  3181	1BF2				   ??0046:
1  3182					 ; -----------------------------
1  3183	1BF2  FF 27			     JMP WORD PTR [BX]
   3184
   3185						 HEAD	  82h,'+',241Q,PSTOR		      ;	+!
1  3186	      =ARRAY:1BF4		     LINK$=$
1  3187	1BF4  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3188							 ; 6 - признак immediate. 5- слово не описано smudge
1  3189	1BF5  2B			     DB	 '+'
1  3190	1BF6  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  3191
1  3192	1BF7  1BD1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 57
forth.asm



1  3193	      =ARRAY:1BF4		     LINK=LINK$
1  3194
1  3195	1BF9				     PSTOR LABEL FAR  ;	CFA
1  3196	1BF9  1BFBr			     DW	 $+2
   3197	1BFB  5B				 POP  BX
   3198	1BFC  59				 POP  CX
   3199	1BFD  01 0F				 ADD  [BX], CX
   3200						 NEXT
1  3201	1BFF  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3202	1C00  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3203					 ; ------ call debugger	--------
1  3204	1C02  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3205	1C06  74 06			     jz	??0047
1  3206	1C08  E8 F347			     call printWORD
1  3207	1C0B  E8 F226			     call pause
1  3208	1C0E				   ??0047:
1  3209					 ; -----------------------------
1  3210	1C0E  FF 27			     JMP WORD PTR [BX]
   3211
   3212						 HEAD	  82h,'-',241Q,MSTOR		      ;	+!
1  3213	      =ARRAY:1C10		     LINK$=$
1  3214	1C10  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3215							 ; 6 - признак immediate. 5- слово не описано smudge
1  3216	1C11  2D			     DB	 '-'
1  3217	1C12  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  3218
1  3219	1C13  1BF4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3220	      =ARRAY:1C10		     LINK=LINK$
1  3221
1  3222	1C15				     MSTOR LABEL FAR  ;	CFA
1  3223	1C15  1C17r			     DW	 $+2
   3224	1C17  5B				 POP  BX
   3225	1C18  59				 POP  CX
   3226	1C19  29 0F				 SUB  [BX], CX
   3227						 NEXT
1  3228	1C1B  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3229	1C1C  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3230					 ; ------ call debugger	--------
1  3231	1C1E  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3232	1C22  74 06			     jz	??0048
1  3233	1C24  E8 F32B			     call printWORD
1  3234	1C27  E8 F20A			     call pause
1  3235	1C2A				   ??0048:
1  3236					 ; -----------------------------
1  3237	1C2A  FF 27			     JMP WORD PTR [BX]
   3238
   3239						 HEAD	  84h,'TOG',314Q,TOGL		      ;	TOGGLE
1  3240	      =ARRAY:1C2C		     LINK$=$
1  3241	1C2C  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3242							 ; 6 - признак immediate. 5- слово не описано smudge
1  3243	1C2D  54 4F 47			     DB	 'TOG'
1  3244	1C30  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3245
1  3246	1C31  1C10r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3247	      =ARRAY:1C2C		     LINK=LINK$
1  3248
1  3249	1C33				     TOGL LABEL	FAR  ; CFA
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 58
forth.asm



1  3250	1C33  1C35r			     DW	 $+2
   3251					; адр-байта маска -> XOR в байт	памяти
   3252	1C35  59				 POP  CX	 ; Маска
   3253	1C36  5B				 POP  BX
   3254	1C37  30 0F				 XOR  BYTE PTR [BX],CL
   3255						 NEXT
1  3256	1C39  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3257	1C3A  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3258					 ; ------ call debugger	--------
1  3259	1C3C  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3260	1C40  74 06			     jz	??0049
1  3261	1C42  E8 F30D			     call printWORD
1  3262	1C45  E8 F1EC			     call pause
1  3263	1C48				   ??0049:
1  3264					 ; -----------------------------
1  3265	1C48  FF 27			     JMP WORD PTR [BX]
   3266
   3267						 HEAD	  81h,,300Q,AT			      ;	@
1  3268	      =ARRAY:1C4A		     LINK$=$
1  3269	1C4A  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3270							 ; 6 - признак immediate. 5- слово не описано smudge
1  3271	1C4B  C0			     DB	 300Q	; последний символ слова + 128 (7 бит =	1).
1  3272
1  3273	1C4C  1C2Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3274	      =ARRAY:1C4A		     LINK=LINK$
1  3275
1  3276	1C4E				     AT	LABEL FAR  ; CFA
1  3277	1C4E  1C50r			     DW	 $+2
   3278					     ; addr -> n
   3279	1C50  5B				 POP  BX
   3280	1C51  FF 37				 PUSH [BX]
   3281						 NEXT
1  3282	1C53  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3283	1C54  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3284					 ; ------ call debugger	--------
1  3285	1C56  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3286	1C5A  74 06			     jz	??004A
1  3287	1C5C  E8 F2F3			     call printWORD
1  3288	1C5F  E8 F1D2			     call pause
1  3289	1C62				   ??004A:
1  3290					 ; -----------------------------
1  3291	1C62  FF 27			     JMP WORD PTR [BX]
   3292
   3293						 HEAD	  82h,'A',300Q,AAT		      ;	a@
1  3294	      =ARRAY:1C64		     LINK$=$
1  3295	1C64  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3296							 ; 6 - признак immediate. 5- слово не описано smudge
1  3297	1C65  41			     DB	 'A'
1  3298	1C66  C0			     DB	 300Q	; последний символ слова + 128 (7 бит =	1).
1  3299
1  3300	1C67  1C4Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3301	      =ARRAY:1C64		     LINK=LINK$
1  3302
1  3303	1C69				     AAT LABEL FAR  ; CFA
1  3304	1C69  1C6Br			     DW	 $+2
   3305					     ; ( Offset	Segment	--> Value )
   3306	1C6B  58				 pop  ax
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 59
forth.asm



   3307	1C6C  5B				 pop  bx
   3308	1C6D  06				 push es
   3309	1C6E  8E C0				 mov  es, ax
   3310	1C70  26: 8B 07				 mov  ax, es:[bx]
   3311	1C73  07				 pop  es
   3312	1C74  50				 push ax
   3313						 NEXT
1  3314	1C75  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3315	1C76  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3316					 ; ------ call debugger	--------
1  3317	1C78  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3318	1C7C  74 06			     jz	??004B
1  3319	1C7E  E8 F2D1			     call printWORD
1  3320	1C81  E8 F1B0			     call pause
1  3321	1C84				   ??004B:
1  3322					 ; -----------------------------
1  3323	1C84  FF 27			     JMP WORD PTR [BX]
   3324
   3325						 HEAD	  82h,'C',300Q,CAT		      ;	c@
1  3326	      =ARRAY:1C86		     LINK$=$
1  3327	1C86  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3328							 ; 6 - признак immediate. 5- слово не описано smudge
1  3329	1C87  43			     DB	 'C'
1  3330	1C88  C0			     DB	 300Q	; последний символ слова + 128 (7 бит =	1).
1  3331
1  3332	1C89  1C64r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3333	      =ARRAY:1C86		     LINK=LINK$
1  3334
1  3335	1C8B				     CAT LABEL FAR  ; CFA
1  3336	1C8B  1C8Dr			     DW	 $+2
   3337					     ; Извлекает байт информации из ячейки,
   3338					     ; адрес которой находится в стеке
   3339	1C8D  5B				 POP  BX
   3340	1C8E  8A 07				 MOV  AL, BYTE PTR [BX]
   3341	1C90  2A E4				 SUB  AH, AH
   3342	1C92  50				 PUSH AX
   3343						 NEXT
1  3344	1C93  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3345	1C94  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3346					 ; ------ call debugger	--------
1  3347	1C96  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3348	1C9A  74 06			     jz	??004C
1  3349	1C9C  E8 F2B3			     call printWORD
1  3350	1C9F  E8 F192			     call pause
1  3351	1CA2				   ??004C:
1  3352					 ; -----------------------------
1  3353	1CA2  FF 27			     JMP WORD PTR [BX]
   3354
   3355						 HEAD	  81h,,241Q,STORE		      ;	!
1  3356	      =ARRAY:1CA4		     LINK$=$
1  3357	1CA4  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3358							 ; 6 - признак immediate. 5- слово не описано smudge
1  3359	1CA5  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  3360
1  3361	1CA6  1C86r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3362	      =ARRAY:1CA4		     LINK=LINK$
1  3363
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 60
forth.asm



1  3364	1CA8				     STORE LABEL FAR  ;	CFA
1  3365	1CA8  1CAAr			     DW	 $+2
   3366					     ; n addr ->
   3367	1CAA  5B				 POP  BX
   3368	1CAB  58				 POP  AX
   3369	1CAC  89 07				 MOV  [BX],   AX
   3370						 NEXT
1  3371	1CAE  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3372	1CAF  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3373					 ; ------ call debugger	--------
1  3374	1CB1  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3375	1CB5  74 06			     jz	??004D
1  3376	1CB7  E8 F298			     call printWORD
1  3377	1CBA  E8 F177			     call pause
1  3378	1CBD				   ??004D:
1  3379					 ; -----------------------------
1  3380	1CBD  FF 27			     JMP WORD PTR [BX]
   3381
   3382						 HEAD	  82h,'C',241Q,CSTOR		     ; C!
1  3383	      =ARRAY:1CBF		     LINK$=$
1  3384	1CBF  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3385							 ; 6 - признак immediate. 5- слово не описано smudge
1  3386	1CC0  43			     DB	 'C'
1  3387	1CC1  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  3388
1  3389	1CC2  1CA4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3390	      =ARRAY:1CBF		     LINK=LINK$
1  3391
1  3392	1CC4				     CSTOR LABEL FAR  ;	CFA
1  3393	1CC4  1CC6r			     DW	 $+2
   3394	1CC6  5B				 POP  BX
   3395	1CC7  58				 POP  AX
   3396	1CC8  88 07				 MOV  BYTE PTR [BX],  AL
   3397						 NEXT
1  3398	1CCA  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3399	1CCB  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3400					 ; ------ call debugger	--------
1  3401	1CCD  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3402	1CD1  74 06			     jz	??004E
1  3403	1CD3  E8 F27C			     call printWORD
1  3404	1CD6  E8 F15B			     call pause
1  3405	1CD9				   ??004E:
1  3406					 ; -----------------------------
1  3407	1CD9  FF 27			     JMP WORD PTR [BX]
   3408
   3409						 HEAD	  83h,'NF','A'+80h,NFA		     ; NFA
1  3410	      =ARRAY:1CDB		     LINK$=$
1  3411	1CDB  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3412							 ; 6 - признак immediate. 5- слово не описано smudge
1  3413	1CDC  4E 46			     DB	 'NF'
1  3414	1CDE  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  3415
1  3416	1CDF  1CBFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3417	      =ARRAY:1CDB		     LINK=LINK$
1  3418
1  3419	1CE1				     NFA LABEL FAR  ; CFA
1  3420	1CE1  1CE3r			     DW	 $+2
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 61
forth.asm



   3421					 ; pfa -> nfa
   3422	1CE3  5B				 POP  BX
   3423	1CE4  83 EB 05				 SUB  BX, 5
   3424	1CE7  B9 FFFF				 MOV  CX, -1
   3425
   3426	1CEA  E9 00A0				 JMP  TRV
   3427
   3428						 HEAD	  83h,'LF','A'+80h,LFA		     ; LFA
1  3429	      =ARRAY:1CED		     LINK$=$
1  3430	1CED  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3431							 ; 6 - признак immediate. 5- слово не описано smudge
1  3432	1CEE  4C 46			     DB	 'LF'
1  3433	1CF0  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  3434
1  3435	1CF1  1CDBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3436	      =ARRAY:1CED		     LINK=LINK$
1  3437
1  3438	1CF3				     LFA LABEL FAR  ; CFA
1  3439	1CF3  1CF5r			     DW	 $+2
   3440	1CF5  58				 POP  AX
   3441	1CF6  2D 0004				 SUB  AX, 4
   3442	1CF9  50				 PUSH AX
   3443						 NEXT
1  3444	1CFA  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3445	1CFB  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3446					 ; ------ call debugger	--------
1  3447	1CFD  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3448	1D01  74 06			     jz	??004F
1  3449	1D03  E8 F24C			     call printWORD
1  3450	1D06  E8 F12B			     call pause
1  3451	1D09				   ??004F:
1  3452					 ; -----------------------------
1  3453	1D09  FF 27			     JMP WORD PTR [BX]
   3454
   3455						 HEAD	  83h,'CF','A'+80h,CFA		     ; CFA
1  3456	      =ARRAY:1D0B		     LINK$=$
1  3457	1D0B  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3458							 ; 6 - признак immediate. 5- слово не описано smudge
1  3459	1D0C  43 46			     DB	 'CF'
1  3460	1D0E  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  3461
1  3462	1D0F  1CEDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3463	      =ARRAY:1D0B		     LINK=LINK$
1  3464
1  3465	1D11				     CFA LABEL FAR  ; CFA
1  3466	1D11  1D13r			     DW	 $+2
   3467					 ; PFA -> CFA
   3468	1D13  58				 POP  AX
   3469	1D14  2D 0002				 SUB  AX, 2
   3470	1D17  50				 PUSH AX
   3471						 NEXT
1  3472	1D18  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3473	1D19  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3474					 ; ------ call debugger	--------
1  3475	1D1B  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3476	1D1F  74 06			     jz	??0050
1  3477	1D21  E8 F22E			     call printWORD
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 62
forth.asm



1  3478	1D24  E8 F10D			     call pause
1  3479	1D27				   ??0050:
1  3480					 ; -----------------------------
1  3481	1D27  FF 27			     JMP WORD PTR [BX]
   3482
   3483						 HEAD	  84h,'!CS',320Q,SCSP		      ;	!CSP
1  3484	      =ARRAY:1D29		     LINK$=$
1  3485	1D29  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3486							 ; 6 - признак immediate. 5- слово не описано smudge
1  3487	1D2A  21 43 53			     DB	 '!CS'
1  3488	1D2D  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  3489
1  3490	1D2E  1D0Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3491	      =ARRAY:1D29		     LINK=LINK$
1  3492
1  3493	1D30				     SCSP LABEL	FAR  ; CFA
1  3494	1D30  1D32r			     DW	 $+2
   3495					 ; контролируют	сохранение указателя стека параметров
   3496					 ; в процессе интерпретации слова
   3497	1D32  89 65 34				 MOV  WORD PTR [DI]+64Q,SP
   3498						 NEXT
1  3499	1D35  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3500	1D36  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3501					 ; ------ call debugger	--------
1  3502	1D38  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3503	1D3C  74 06			     jz	??0051
1  3504	1D3E  E8 F211			     call printWORD
1  3505	1D41  E8 F0F0			     call pause
1  3506	1D44				   ??0051:
1  3507					 ; -----------------------------
1  3508	1D44  FF 27			     JMP WORD PTR [BX]
   3509
   3510						 HEAD	  84h,'HER',305Q,HERE		      ;	HERE
1  3511	      =ARRAY:1D46		     LINK$=$
1  3512	1D46  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3513							 ; 6 - признак immediate. 5- слово не описано smudge
1  3514	1D47  48 45 52			     DB	 'HER'
1  3515	1D4A  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3516
1  3517	1D4B  1D29r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3518	      =ARRAY:1D46		     LINK=LINK$
1  3519
1  3520	1D4D				     HERE LABEL	FAR  ; CFA
1  3521	1D4D  1D4Fr			     DW	 $+2
   3522	1D4F  FF 75 12				 PUSH [DI+22Q]
   3523						 NEXT
1  3524	1D52  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3525	1D53  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3526					 ; ------ call debugger	--------
1  3527	1D55  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3528	1D59  74 06			     jz	??0052
1  3529	1D5B  E8 F1F4			     call printWORD
1  3530	1D5E  E8 F0D3			     call pause
1  3531	1D61				   ??0052:
1  3532					 ; -----------------------------
1  3533	1D61  FF 27			     JMP WORD PTR [BX]
   3534
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 63
forth.asm



   3535						 HEAD	  85h,'ALLO',324Q,ALLOT		      ;	ALLOT
1  3536	      =ARRAY:1D63		     LINK$=$
1  3537	1D63  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3538							 ; 6 - признак immediate. 5- слово не описано smudge
1  3539	1D64  41 4C 4C 4F		     DB	 'ALLO'
1  3540	1D68  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3541
1  3542	1D69  1D46r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3543	      =ARRAY:1D63		     LINK=LINK$
1  3544
1  3545	1D6B				     ALLOT LABEL FAR  ;	CFA
1  3546	1D6B  1D6Dr			     DW	 $+2
   3547	1D6D  5B				 POP  BX
   3548	1D6E  01 5D 12				 ADD  [DI+22Q],BX	 ;
   3549						 NEXT
1  3550	1D71  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3551	1D72  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3552					 ; ------ call debugger	--------
1  3553	1D74  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3554	1D78  74 06			     jz	??0053
1  3555	1D7A  E8 F1D5			     call printWORD
1  3556	1D7D  E8 F0B4			     call pause
1  3557	1D80				   ??0053:
1  3558					 ; -----------------------------
1  3559	1D80  FF 27			     JMP WORD PTR [BX]
   3560
   3561						 HEAD	  84h,'TRA',326Q,TRAV		      ;	TRAVERSE
1  3562	      =ARRAY:1D82		     LINK$=$
1  3563	1D82  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3564							 ; 6 - признак immediate. 5- слово не описано smudge
1  3565	1D83  54 52 41			     DB	 'TRA'
1  3566	1D86  D6			     DB	 326Q	; последний символ слова + 128 (7 бит =	1).
1  3567
1  3568	1D87  1D63r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3569	      =ARRAY:1D82		     LINK=LINK$
1  3570
1  3571	1D89				     TRAV LABEL	FAR  ; CFA
1  3572	1D89  1D8Br			     DW	 $+2
   3573						 ; Движение вперед/назад вдоль имени переменной	длины
   3574	1D8B  59				 POP  CX     ; DELTA
   3575	1D8C  5B				 POP  BX     ; адрес строки
   3576	1D8D  03 D9			 TRV:	 ADD  BX, CX
   3577	1D8F  80 3F 00				 CMP  BYTE PTR [BX],  0
   3578	1D92  79 F9				 JNS  TRV    ; JUMP IF POSITIVE
   3579	1D94  53				 PUSH BX
   3580						 NEXT
1  3581	1D95  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3582	1D96  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3583					 ; ------ call debugger	--------
1  3584	1D98  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3585	1D9C  74 06			     jz	??0054
1  3586	1D9E  E8 F1B1			     call printWORD
1  3587	1DA1  E8 F090			     call pause
1  3588	1DA4				   ??0054:
1  3589					 ; -----------------------------
1  3590	1DA4  FF 27			     JMP WORD PTR [BX]
   3591
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 64
forth.asm



   3592						 HEAD	  301Q,,333Q,LBRAC		       ; [
1  3593	      =ARRAY:1DA6		     LINK$=$
1  3594	1DA6  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  3595							 ; 6 - признак immediate. 5- слово не описано smudge
1  3596	1DA7  DB			     DB	 333Q	; последний символ слова + 128 (7 бит =	1).
1  3597
1  3598	1DA8  1D82r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3599	      =ARRAY:1DA6		     LINK=LINK$
1  3600
1  3601	1DAA				     LBRAC LABEL FAR  ;	CFA
1  3602	1DAA  1DACr			     DW	 $+2
   3603						 ; Прекращение компил.,	начало исполн. (обнуление STATE)
   3604	1DAC  C7 45 2C 0000			 MOV  WORD PTR [DI+54Q],0
   3605						 NEXT
1  3606	1DB1  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3607	1DB2  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3608					 ; ------ call debugger	--------
1  3609	1DB4  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3610	1DB8  74 06			     jz	??0055
1  3611	1DBA  E8 F195			     call printWORD
1  3612	1DBD  E8 F074			     call pause
1  3613	1DC0				   ??0055:
1  3614					 ; -----------------------------
1  3615	1DC0  FF 27			     JMP WORD PTR [BX]
   3616
   3617						 HEAD	  301Q,,335Q,RBRAC		       ; ]
1  3618	      =ARRAY:1DC2		     LINK$=$
1  3619	1DC2  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  3620							 ; 6 - признак immediate. 5- слово не описано smudge
1  3621	1DC3  DD			     DB	 335Q	; последний символ слова + 128 (7 бит =	1).
1  3622
1  3623	1DC4  1DA6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3624	      =ARRAY:1DC2		     LINK=LINK$
1  3625
1  3626	1DC6				     RBRAC LABEL FAR  ;	CFA
1  3627	1DC6  1DC8r			     DW	 $+2
   3628	1DC8  C7 45 2C 00C0			 MOV  WORD PTR [DI+54Q],300Q   ; Начало	компиляции
   3629						 NEXT
1  3630	1DCD  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3631	1DCE  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3632					 ; ------ call debugger	--------
1  3633	1DD0  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3634	1DD4  74 06			     jz	??0056
1  3635	1DD6  E8 F179			     call printWORD
1  3636	1DD9  E8 F058			     call pause
1  3637	1DDC				   ??0056:
1  3638					 ; -----------------------------
1  3639	1DDC  FF 27			     JMP WORD PTR [BX]
   3640
   3641						 HEAD	  83h,'HE',330Q,$HEX		      ;	HEX
1  3642	      =ARRAY:1DDE		     LINK$=$
1  3643	1DDE  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3644							 ; 6 - признак immediate. 5- слово не описано smudge
1  3645	1DDF  48 45			     DB	 'HE'
1  3646	1DE1  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  3647
1  3648	1DE2  1DC2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 65
forth.asm



1  3649	      =ARRAY:1DDE		     LINK=LINK$
1  3650
1  3651	1DE4				     $HEX LABEL	FAR  ; CFA
1  3652	1DE4  1DE6r			     DW	 $+2
   3653	1DE6  C7 45 2E 0010			 MOV  WORD PTR [DI+56Q],16
   3654						 NEXT
1  3655	1DEB  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3656	1DEC  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3657					 ; ------ call debugger	--------
1  3658	1DEE  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3659	1DF2  74 06			     jz	??0057
1  3660	1DF4  E8 F15B			     call printWORD
1  3661	1DF7  E8 F03A			     call pause
1  3662	1DFA				   ??0057:
1  3663					 ; -----------------------------
1  3664	1DFA  FF 27			     JMP WORD PTR [BX]
   3665
   3666						 HEAD	  87h,'DECIMA',314Q,DECIMA	       ; DECIMAL
1  3667	      =ARRAY:1DFC		     LINK$=$
1  3668	1DFC  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  3669							 ; 6 - признак immediate. 5- слово не описано smudge
1  3670	1DFD  44 45 43 49 4D 41		     DB	 'DECIMA'
1  3671	1E03  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3672
1  3673	1E04  1DDEr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3674	      =ARRAY:1DFC		     LINK=LINK$
1  3675
1  3676	1E06				     DECIMA LABEL FAR  ; CFA
1  3677	1E06  1E08r			     DW	 $+2
   3678	1E08  C7 45 2E 000A			 MOV  WORD PTR [DI+56Q],10
   3679						 NEXT
1  3680	1E0D  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3681	1E0E  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3682					 ; ------ call debugger	--------
1  3683	1E10  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3684	1E14  74 06			     jz	??0058
1  3685	1E16  E8 F139			     call printWORD
1  3686	1E19  E8 F018			     call pause
1  3687	1E1C				   ??0058:
1  3688					 ; -----------------------------
1  3689	1E1C  FF 27			     JMP WORD PTR [BX]
   3690
   3691						 HEAD	  85h,'OCTA',314Q,OCTAL		      ;	OCTAL
1  3692	      =ARRAY:1E1E		     LINK$=$
1  3693	1E1E  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3694							 ; 6 - признак immediate. 5- слово не описано smudge
1  3695	1E1F  4F 43 54 41		     DB	 'OCTA'
1  3696	1E23  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3697
1  3698	1E24  1DFCr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3699	      =ARRAY:1E1E		     LINK=LINK$
1  3700
1  3701	1E26				     OCTAL LABEL FAR  ;	CFA
1  3702	1E26  1E28r			     DW	 $+2
   3703	1E28  C7 45 2E 0008			 MOV  WORD PTR [DI+56Q],  8
   3704	1E2D				Y$:	 NEXT
1  3705	1E2D  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 66
forth.asm



1  3706	1E2E  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3707					 ; ------ call debugger	--------
1  3708	1E30  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3709	1E34  74 06			     jz	??0059
1  3710	1E36  E8 F119			     call printWORD
1  3711	1E39  E8 EFF8			     call pause
1  3712	1E3C				   ??0059:
1  3713					 ; -----------------------------
1  3714	1E3C  FF 27			     JMP WORD PTR [BX]
   3715
   3716						 HEAD	  86h,'LATES',324Q,LATES	      ;	LATEST
1  3717	      =ARRAY:1E3E		     LINK$=$
1  3718	1E3E  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  3719							 ; 6 - признак immediate. 5- слово не описано smudge
1  3720	1E3F  4C 41 54 45 53		     DB	 'LATES'
1  3721	1E44  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3722
1  3723	1E45  1E1Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3724	      =ARRAY:1E3E		     LINK=LINK$
1  3725
1  3726	1E47				     LATES LABEL FAR  ;	CFA
1  3727	1E47  1E49r			     DW	 $+2
   3728					     ; в стек данных NFA  последнего определенного слова
   3729					     ; в current словаре
   3730	1E49  8B 5D 2A				 MOV  BX, [DI+52Q]
   3731	1E4C  FF 37				 PUSH [BX]
   3732						 NEXT
1  3733	1E4E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3734	1E4F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3735					 ; ------ call debugger	--------
1  3736	1E51  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3737	1E55  74 06			     jz	??005A
1  3738	1E57  E8 F0F8			     call printWORD
1  3739	1E5A  E8 EFD7			     call pause
1  3740	1E5D				   ??005A:
1  3741					 ; -----------------------------
1  3742	1E5D  FF 27			     JMP WORD PTR [BX]
   3743
   3744						 HEAD	  86h,'-TRAI',314Q,DTRAI	      ;	-TRAIL
1  3745	      =ARRAY:1E5F		     LINK$=$
1  3746	1E5F  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  3747							 ; 6 - признак immediate. 5- слово не описано smudge
1  3748	1E60  2D 54 52 41 49		     DB	 '-TRAI'
1  3749	1E65  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3750
1  3751	1E66  1E3Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3752	      =ARRAY:1E5F		     LINK=LINK$
1  3753
1  3754	1E68				     DTRAI LABEL FAR  ;	CFA
1  3755	1E68  1E6Ar			     DW	 $+2
   3756					 ; адр n1 --> адр n2 Убирает пробелы в конце строки
   3757	1E6A  59				 POP  CX
   3758	1E6B  5B				 POP  BX
   3759	1E6C  53				 PUSH BX
   3760	1E6D  03 D9				 ADD  BX, CX
   3761	1E6F  4B			COMPA:	 DEC  BX
   3762	1E70  80 3F 20				 CMP  BYTE PTR [BX],  32  ; BLANK ?
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 67
forth.asm



   3763	1E73  75 02				 JNE  NO
   3764	1E75  E2 F8				 LOOP COMPA
   3765	1E77  51			NO:	 PUSH CX
   3766						 NEXT
1  3767	1E78  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3768	1E79  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3769					 ; ------ call debugger	--------
1  3770	1E7B  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3771	1E7F  74 06			     jz	??005B
1  3772	1E81  E8 F0CE			     call printWORD
1  3773	1E84  E8 EFAD			     call pause
1  3774	1E87				   ??005B:
1  3775					 ; -----------------------------
1  3776	1E87  FF 27			     JMP WORD PTR [BX]
   3777
   3778						 HEAD	  85h,'UPPE',322Q,UPPER		      ;	UPPER
1  3779	      =ARRAY:1E89		     LINK$=$
1  3780	1E89  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3781							 ; 6 - признак immediate. 5- слово не описано smudge
1  3782	1E8A  55 50 50 45		     DB	 'UPPE'
1  3783	1E8E  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  3784
1  3785	1E8F  1E5Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3786	      =ARRAY:1E89		     LINK=LINK$
1  3787
1  3788	1E91				     UPPER LABEL FAR  ;	CFA
1  3789	1E91  1E93r			     DW	 $+2
   3790	1E93  59				 POP  CX		 ; число символов
   3791	1E94  5B				 POP  BX		 ; строка
   3792	1E95  80 3F 61			$COMP:	 CMP  BYTE PTR [BX],  61h ; a
   3793	1E98  7C 08				 JL   OFLIM
   3794	1E9A  80 3F 7A				 CMP  BYTE PTR [BX],  7Ah ; z
   3795	1E9D  7F 03				 JG   OFLIM
   3796	1E9F  83 27 DF				 AND  WORD PTR [BX], 177737Q ; FFDF
   3797	1EA2  43			OFLIM:	 INC  BX
   3798	1EA3  E2 F0				 LOOP $COMP
   3799						 NEXT
1  3800	1EA5  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3801	1EA6  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3802					 ; ------ call debugger	--------
1  3803	1EA8  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3804	1EAC  74 06			     jz	??005C
1  3805	1EAE  E8 F0A1			     call printWORD
1  3806	1EB1  E8 EF80			     call pause
1  3807	1EB4				   ??005C:
1  3808					 ; -----------------------------
1  3809	1EB4  FF 27			     JMP WORD PTR [BX]
   3810
   3811						 HEAD	  213Q,'DEFINITION',323Q,DEFIN	    ; DEFINITIONS
1  3812	      =ARRAY:1EB6		     LINK$=$
1  3813	1EB6  8B			     DB	 213Q  ; NFA 7 бит равен 1.
1  3814							 ; 6 - признак immediate. 5- слово не описано smudge
1  3815	1EB7  44 45 46 49 4E 49	54+	     DB	 'DEFINITION'
   3816	      49 4F 4E
1  3817	1EC1  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  3818
1  3819	1EC2  1E89r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 68
forth.asm



1  3820	      =ARRAY:1EB6		     LINK=LINK$
1  3821
1  3822	1EC4				     DEFIN LABEL FAR  ;	CFA
1  3823	1EC4  1EC6r			     DW	 $+2
   3824					 ; Контекстный словарь становится текущим, все последующие
   3825					 ; описания связаны с этим словарем
   3826	1EC6  8B 45 28				 MOV  AX, [DI+50Q]	 ; context
   3827	1EC9  89 45 2A				 MOV  [DI+52Q],AX	 ; current
   3828						 NEXT
1  3829	1ECC  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3830	1ECD  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3831					 ; ------ call debugger	--------
1  3832	1ECF  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3833	1ED3  74 06			     jz	??005D
1  3834	1ED5  E8 F07A			     call printWORD
1  3835	1ED8  E8 EF59			     call pause
1  3836	1EDB				   ??005D:
1  3837					 ; -----------------------------
1  3838	1EDB  FF 27			     JMP WORD PTR [BX]
   3839
   3840						 HEAD	  84h,'+BU',306Q,PBUF		      ;	+BUF
1  3841	      =ARRAY:1EDD		     LINK$=$
1  3842	1EDD  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3843							 ; 6 - признак immediate. 5- слово не описано smudge
1  3844	1EDE  2B 42 55			     DB	 '+BU'
1  3845	1EE1  C6			     DB	 306Q	; последний символ слова + 128 (7 бит =	1).
1  3846
1  3847	1EE2  1EB6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3848	      =ARRAY:1EDD		     LINK=LINK$
1  3849
1  3850	1EE4				     PBUF LABEL	FAR  ; CFA
1  3851	1EE4  1EE6r			     DW	 $+2
   3852					 ;
   3853	1EE6  8B DC				 MOV  BX, SP	     ;
   3854	1EE8  36: 81 07	0404			 ADD  SS:[BX],1028   ; адрес следующего	буфера
   3855	1EED  36: 8B 07				 MOV  AX, SS:[BX]
   3856	1EF0  39 45 18				 CMP  [DI+30Q],AX    ; LIMIT
   3857	1EF3  75 06				 JNE  PB	     ; уперлись	в адрес	лимита,	значит буфер - последний
   3858	1EF5  8B 4D 16				 MOV  CX, [DI+26Q]   ; FIRST
   3859	1EF8  36: 89 0F				 MOV  SS:[BX],CX     ; переходим на первый буфер
   3860	1EFB  36: FF 37			PB:	 PUSH SS:[BX]	     ; полученный адрес	буфера в стек
   3861	1EFE  8B 4D 3C				 MOV  CX, [DI+74Q]   ; prev
   3862	1F01  36: 29 4F	FE			 SUB  SS:[BX-2],CX   ; стек растет вниз. BX-2 сейчас  вершина стека
   3863								     ; если 0, значит адрес совпадает с	адресом	prev
   3864						 NEXT
1  3865	1F05  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3866	1F06  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3867					 ; ------ call debugger	--------
1  3868	1F08  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3869	1F0C  74 06			     jz	??005E
1  3870	1F0E  E8 F041			     call printWORD
1  3871	1F11  E8 EF20			     call pause
1  3872	1F14				   ??005E:
1  3873					 ; -----------------------------
1  3874	1F14  FF 27			     JMP WORD PTR [BX]
   3875
   3876						 HEAD	  86h,'UPDAT',305Q,UPDAT	      ;	UPDATE
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 69
forth.asm



1  3877	      =ARRAY:1F16		     LINK$=$
1  3878	1F16  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  3879							 ; 6 - признак immediate. 5- слово не описано smudge
1  3880	1F17  55 50 44 41 54		     DB	 'UPDAT'
1  3881	1F1C  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3882
1  3883	1F1D  1EDDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3884	      =ARRAY:1F16		     LINK=LINK$
1  3885
1  3886	1F1F				     UPDAT LABEL FAR  ;	CFA
1  3887	1F1F  1F21r			     DW	 $+2
   3888	1F21  8B 5D 3C				 MOV  BX, [DI+74Q]   ; prev buffer
   3889	1F24  0B DB				 OR BX,	BX	     ; если 0, буфер пустой
   3890	1F26  74 04				 jz $upd
   3891	1F28  81 0F 8000			 OR  WORD PTR [BX],   100000Q  ; ставим	бит
   3892	1F2C				 $upd:	 NEXT
1  3893	1F2C  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3894	1F2D  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3895					 ; ------ call debugger	--------
1  3896	1F2F  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3897	1F33  74 06			     jz	??005F
1  3898	1F35  E8 F01A			     call printWORD
1  3899	1F38  E8 EEF9			     call pause
1  3900	1F3B				   ??005F:
1  3901					 ; -----------------------------
1  3902	1F3B  FF 27			     JMP WORD PTR [BX]
   3903
   3904						 HEAD	  81h,,330Q,X			      ;	X
1  3905	      =ARRAY:1F3D		     LINK$=$
1  3906	1F3D  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3907							 ; 6 - признак immediate. 5- слово не описано smudge
1  3908	1F3E  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  3909
1  3910	1F3F  1F16r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3911	      =ARRAY:1F3D		     LINK=LINK$
1  3912
1  3913	1F41				     X LABEL FAR  ; CFA
1  3914	1F41  1F43r			     DW	 $+2
   3915					 ; сброс бита сохранения буфера
   3916	1F43  5B				 POP  BX
   3917	1F44  81 27 7FFF			 AND WORD PTR [BX],   77777Q   ;
   3918	1F48  FF 37				 PUSH [BX]
   3919						 NEXT
1  3920	1F4A  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3921	1F4B  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3922					 ; ------ call debugger	--------
1  3923	1F4D  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3924	1F51  74 06			     jz	??0060
1  3925	1F53  E8 EFFC			     call printWORD
1  3926	1F56  E8 EEDB			     call pause
1  3927	1F59				   ??0060:
1  3928					 ; -----------------------------
1  3929	1F59  FF 27			     JMP WORD PTR [BX]
   3930
   3931					;	 ** Управляющие	слова **
   3932
   3933						 HEAD	  301Q,,272Q,COLON,$COL		       ; :
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 70
forth.asm



1  3934	      =ARRAY:1F5B		     LINK$=$
1  3935	1F5B  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  3936							 ; 6 - признак immediate. 5- слово не описано smudge
1  3937	1F5C  BA			     DB	 272Q	; последний символ слова + 128 (7 бит =	1).
1  3938
1  3939	1F5D  1F3Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3940	      =ARRAY:1F5B		     LINK=LINK$
1  3941
1  3942	1F5F				     COLON LABEL FAR  ;	CFA
1  3943	1F5F  1F73r			     DW	$COL
   3944					     ; слово для создания новых	слов из	Форта
   3945	1F61  22ACr 1D30r 2168r	  +		 DW QEXEC,SCSP,CURR,AT,CONT,STORE,CREAT
   3946	      1C4Er 215Ar 1CA8r	  +
   3947	      265Fr
   3948	1F6F  1DC6r 2336r			 DW RBRAC,PSCOD	; после	этого слова SI указывает на следующий код,
   3949								; адрес, которого попадет в CFA	создаваемого слова
   3950	1F73				$COL	 LABEL	 FAR ; код для исполнения слов на форте	из этого исходника
   3951							     ; функция интерпретатора
   3952	1F73  83 C5 FE				 ADD  BP, -2 ; резервируем место в стеке возвратов
   3953	1F76  83 C3 02				 ADD  BX, 2  ; BX указывает на CFA здесь это $COL
   3954							     ; BX+2 будет указывать на адрес QEXEC
   3955	1F79  89 76 00				 MOV  [BP], SI ; сохраняем текущий указатель IP
   3956	1F7C  8B F3				 MOV  SI, BX ; исполняем слово QEXEC
   3957						 NEXT
1  3958	1F7E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3959	1F7F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3960					 ; ------ call debugger	--------
1  3961	1F81  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3962	1F85  74 06			     jz	??0061
1  3963	1F87  E8 EFC8			     call printWORD
1  3964	1F8A  E8 EEA7			     call pause
1  3965	1F8D				   ??0061:
1  3966					 ; -----------------------------
1  3967	1F8D  FF 27			     JMP WORD PTR [BX]
   3968
   3969						 HEAD	  301Q,,273Q,SMI,$COL		       ; ;
1  3970	      =ARRAY:1F8F		     LINK$=$
1  3971	1F8F  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  3972							 ; 6 - признак immediate. 5- слово не описано smudge
1  3973	1F90  BB			     DB	 273Q	; последний символ слова + 128 (7 бит =	1).
1  3974
1  3975	1F91  1F5Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3976	      =ARRAY:1F8F		     LINK=LINK$
1  3977
1  3978	1F93				     SMI LABEL FAR  ; CFA
1  3979	1F93  1F73r			     DW	$COL
   3980					     ; слово для завершения новых слов из Форта
   3981	1F95  22D5r 2309r 18DBr	  +		 DW QCSP,COMP,SEMI,SMUG,LBRAC,SEMI
   3982	      2322r 1DAAr 18DBr
   3983
   3984						 HEAD	  88h,'CONSTAN',324Q,CON,$COL	      ;	CONSTANT
1  3985	      =ARRAY:1FA1		     LINK$=$
1  3986	1FA1  88			     DB	 88h  ;	NFA 7 бит равен	1.
1  3987							 ; 6 - признак immediate. 5- слово не описано smudge
1  3988	1FA2  43 4F 4E 53 54 41	4E	     DB	 'CONSTAN'
1  3989	1FA9  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3990
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 71
forth.asm



1  3991	1FAA  1F8Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3992	      =ARRAY:1FA1		     LINK=LINK$
1  3993
1  3994	1FAC				     CON LABEL FAR  ; CFA
1  3995	1FAC  1F73r			     DW	$COL
   3996	1FAE  265Fr 2322r 2235r	  +		 DW CREAT,SMUG,COMMA,PSCOD		      ;
   3997	      2336r
   3998	1FB6				$CON	 LABEL	 FAR
   3999	1FB6  83 C3 02				 ADD  BX, 2 ; аналогично переменной
   4000	1FB9  FF 37				 PUSH [BX]  ; вместо адреса пишем значение по этому адресу PFA
   4001						 NEXT
1  4002	1FBB  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  4003	1FBC  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  4004					 ; ------ call debugger	--------
1  4005	1FBE  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  4006	1FC2  74 06			     jz	??0062
1  4007	1FC4  E8 EF8B			     call printWORD
1  4008	1FC7  E8 EE6A			     call pause
1  4009	1FCA				   ??0062:
1  4010					 ; -----------------------------
1  4011	1FCA  FF 27			     JMP WORD PTR [BX]
   4012
   4013						 HEAD	  88h, 'VARIABL',305Q,VAR,$COL	      ;	VARIABLE
1  4014	      =ARRAY:1FCC		     LINK$=$
1  4015	1FCC  88			     DB	 88h  ;	NFA 7 бит равен	1.
1  4016							 ; 6 - признак immediate. 5- слово не описано smudge
1  4017	1FCD  56 41 52 49 41 42	4C	     DB	 'VARIABL'
1  4018	1FD4  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4019
1  4020	1FD5  1FA1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4021	      =ARRAY:1FCC		     LINK=LINK$
1  4022
1  4023	1FD7				     VAR LABEL FAR  ; CFA
1  4024	1FD7  1F73r			     DW	$COL
   4025	1FD9  1FACr 2336r			 DW CON,PSCOD  ; должно	быть начальное значение	переменной
   4026	1FDD				$VAR	 LABEL	 FAR
   4027	1FDD  83 C3 02				 ADD  BX, 2  ; BX указывает на CFA ($COL)
   4028							     ; BX+2 пропускает поле CFA
   4029	1FE0  53				 PUSH BX     ; в BX находится адрес переменной PFA ($VAR)
   4030						 NEXT
1  4031	1FE1  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  4032	1FE2  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  4033					 ; ------ call debugger	--------
1  4034	1FE4  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  4035	1FE8  74 06			     jz	??0063
1  4036	1FEA  E8 EF65			     call printWORD
1  4037	1FED  E8 EE44			     call pause
1  4038	1FF0				   ??0063:
1  4039					 ; -----------------------------
1  4040	1FF0  FF 27			     JMP WORD PTR [BX]
   4041
   4042						 HEAD	  84h,'USE',322Q,USER, $COL	      ;	USER
1  4043	      =ARRAY:1FF2		     LINK$=$
1  4044	1FF2  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4045							 ; 6 - признак immediate. 5- слово не описано smudge
1  4046	1FF3  55 53 45			     DB	 'USE'
1  4047	1FF6  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 72
forth.asm



1  4048
1  4049	1FF7  1FCCr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4050	      =ARRAY:1FF2		     LINK=LINK$
1  4051
1  4052	1FF9				     USER LABEL	FAR  ; CFA
1  4053	1FF9  1F73r			     DW	$COL
   4054	1FFB  1FACr 2336r			 DW CON,PSCOD
   4055	1FFF				$USE	 LABEL	 FAR
   4056	1FFF  83 C3 02				 ADD  BX, 2
   4057	2002  8B 07				 MOV  AX, [BX] ; берем смещение	из PFA
   4058	2004  03 C7				 ADD  AX, DI  ;	вычисляем смещение
   4059	2006  50				 PUSH AX ; полученный адрес в стек
   4060						 NEXT
1  4061	2007  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  4062	2008  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  4063					 ; ------ call debugger	--------
1  4064	200A  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  4065	200E  74 06			     jz	??0064
1  4066	2010  E8 EF3F			     call printWORD
1  4067	2013  E8 EE1E			     call pause
1  4068	2016				   ??0064:
1  4069					 ; -----------------------------
1  4070	2016  FF 27			     JMP WORD PTR [BX]
   4071
   4072						 HEAD	  85h,'DOES',276Q,DOES,$COL	      ;	DOES>
1  4073	      =ARRAY:2018		     LINK$=$
1  4074	2018  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4075							 ; 6 - признак immediate. 5- слово не описано smudge
1  4076	2019  44 4F 45 53		     DB	 'DOES'
1  4077	201D  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1  4078
1  4079	201E  1FF2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4080	      =ARRAY:2018		     LINK=LINK$
1  4081
1  4082	2020				     DOES LABEL	FAR  ; CFA
1  4083	2020  1F73r			     DW	$COL
   4084					 ; запись в PFA	адреса кода, который следует за	DOES>.
   4085					 ; В CFA пишется адрес кода, следующего	за PSCOD, т.е. $DOE
   4086					 ; при исполнении в стек помещается адрес PFA+2
   4087					 ;  управление передается по адресу PFA
   4088	2022  1938r 1E47r 2268r	  +		 DW  FROMR,LATES,PFA,STORE,PSCOD
   4089	      1CA8r 2336r
   4090	202C				$DOE	 LABEL	 FAR   ; здесь используется только в FORTH
   4091	202C  83 ED 02				 SUB  BP,  2   ; резервируем место в RS
   4092	202F  89 76 00				 MOV  [BP], SI ; сохраняем SI адрес следующего слова
   4093	2032  83 C3 02				 ADD  BX, 2    ; BX+2 это PFA исполняемого слова (FORTH)
   4094	2035  8B 37				 MOV  SI, [BX] ; там лежит адрес слова DOVOC
   4095	2037  83 C3 02				 ADD  BX, 2    ; адрес параметра PFA+2 для DOVOC (120201Q)
   4096	203A  53				 PUSH BX       ; в стек
   4097						 NEXT	       ; исполняется слово DOVOC (по адресу PFA)
1  4098	203B  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  4099	203C  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  4100					 ; ------ call debugger	--------
1  4101	203E  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  4102	2042  74 06			     jz	??0065
1  4103	2044  E8 EF0B			     call printWORD
1  4104	2047  E8 EDEA			     call pause
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 73
forth.asm



1  4105	204A				   ??0065:
1  4106					 ; -----------------------------
1  4107	204A  FF 27			     JMP WORD PTR [BX]
   4108
   4109						 HEAD	  83h,'BY','E'+80h,BYE			; BYE
1  4110	      =ARRAY:204C		     LINK$=$
1  4111	204C  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4112							 ; 6 - признак immediate. 5- слово не описано smudge
1  4113	204D  42 59			     DB	 'BY'
1  4114	204F  C5			     DB	 'E'+80h   ; последний символ слова + 128 (7 бит = 1).
1  4115
1  4116	2050  2018r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4117	      =ARRAY:204C		     LINK=LINK$
1  4118
1  4119	2052				     BYE LABEL FAR  ; CFA
1  4120	2052  2054r			     DW	 $+2
   4121	2054  B4 4C				 mov ah, 4ch
   4122	2056  CD 21				 int 21h
   4123
   4124					;	 ** Константы **
   4125
   4126						 HEAD	  81h,,260Q,ZERO,$CON		      ;	0
1  4127	      =ARRAY:2058		     LINK$=$
1  4128	2058  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  4129							 ; 6 - признак immediate. 5- слово не описано smudge
1  4130	2059  B0			     DB	 260Q	; последний символ слова + 128 (7 бит =	1).
1  4131
1  4132	205A  204Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4133	      =ARRAY:2058		     LINK=LINK$
1  4134
1  4135	205C				     ZERO LABEL	FAR  ; CFA
1  4136	205C  1FB6r			     DW	$CON
   4137	205E  0000				 DW 0
   4138
   4139						 HEAD	  81h,,261Q,ONE,$CON		      ;	1
1  4140	      =ARRAY:2060		     LINK$=$
1  4141	2060  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  4142							 ; 6 - признак immediate. 5- слово не описано smudge
1  4143	2061  B1			     DB	 261Q	; последний символ слова + 128 (7 бит =	1).
1  4144
1  4145	2062  2058r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4146	      =ARRAY:2060		     LINK=LINK$
1  4147
1  4148	2064				     ONE LABEL FAR  ; CFA
1  4149	2064  1FB6r			     DW	$CON
   4150	2066  0001				 DW 1
   4151
   4152						 HEAD	  81h,,262Q,TWO,$CON		      ;	2
1  4153	      =ARRAY:2068		     LINK$=$
1  4154	2068  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  4155							 ; 6 - признак immediate. 5- слово не описано smudge
1  4156	2069  B2			     DB	 262Q	; последний символ слова + 128 (7 бит =	1).
1  4157
1  4158	206A  2060r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4159	      =ARRAY:2068		     LINK=LINK$
1  4160
1  4161	206C				     TWO LABEL FAR  ; CFA
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 74
forth.asm



1  4162	206C  1FB6r			     DW	$CON
   4163	206E  0002				 DW 2
   4164
   4165						 HEAD	  81h,,263Q,THREE,$CON		      ;	3
1  4166	      =ARRAY:2070		     LINK$=$
1  4167	2070  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  4168							 ; 6 - признак immediate. 5- слово не описано smudge
1  4169	2071  B3			     DB	 263Q	; последний символ слова + 128 (7 бит =	1).
1  4170
1  4171	2072  2068r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4172	      =ARRAY:2070		     LINK=LINK$
1  4173
1  4174	2074				     THREE LABEL FAR  ;	CFA
1  4175	2074  1FB6r			     DW	$CON
   4176	2076  0003				 DW 3
   4177
   4178						 HEAD	  81h,,270Q,EIGHT, $CON		      ;	8
1  4179	      =ARRAY:2078		     LINK$=$
1  4180	2078  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  4181							 ; 6 - признак immediate. 5- слово не описано smudge
1  4182	2079  B8			     DB	 270Q	; последний символ слова + 128 (7 бит =	1).
1  4183
1  4184	207A  2070r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4185	      =ARRAY:2078		     LINK=LINK$
1  4186
1  4187	207C				     EIGHT LABEL FAR  ;	CFA
1  4188	207C  1FB6r			     DW	$CON
   4189	207E  0008				 DW 8
   4190
   4191						 HEAD	  82h,'B',314Q,BLAN,$CON	      ;	BL
1  4192	      =ARRAY:2080		     LINK$=$
1  4193	2080  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4194							 ; 6 - признак immediate. 5- слово не описано smudge
1  4195	2081  42			     DB	 'B'
1  4196	2082  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  4197
1  4198	2083  2078r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4199	      =ARRAY:2080		     LINK=LINK$
1  4200
1  4201	2085				     BLAN LABEL	FAR  ; CFA
1  4202	2085  1FB6r			     DW	$CON
   4203	2087  0020				 DW 32
   4204
   4205						 HEAD	  82h,'C',314Q,$CL,$CON		      ;	C/L
1  4206	      =ARRAY:2089		     LINK$=$
1  4207	2089  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4208							 ; 6 - признак immediate. 5- слово не описано smudge
1  4209	208A  43			     DB	 'C'
1  4210	208B  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  4211
1  4212	208C  2080r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4213	      =ARRAY:2089		     LINK=LINK$
1  4214
1  4215	208E				     $CL LABEL FAR  ; CFA
1  4216	208E  1FB6r			     DW	$CON
   4217	2090  0040				 DW 64	 ;CHAR#	PER LINE
   4218
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 75
forth.asm



   4219						 HEAD	  82h,'1',313Q,BBUF,$CON	      ;	BBUF
1  4220	      =ARRAY:2092		     LINK$=$
1  4221	2092  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4222							 ; 6 - признак immediate. 5- слово не описано smudge
1  4223	2093  31			     DB	 '1'
1  4224	2094  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  4225
1  4226	2095  2089r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4227	      =ARRAY:2092		     LINK=LINK$
1  4228
1  4229	2097				     BBUF LABEL	FAR  ; CFA
1  4230	2097  1FB6r			     DW	$CON
   4231	2099  0400				 DW 1024 ; длина буфера
   4232
   4233						 ;** USER-переменные **
   4234
   4235						 HEAD	  82h,'S',260Q,SZERO,$USE	      ;	SO
1  4236	      =ARRAY:209B		     LINK$=$
1  4237	209B  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4238							 ; 6 - признак immediate. 5- слово не описано smudge
1  4239	209C  53			     DB	 'S'
1  4240	209D  B0			     DB	 260Q	; последний символ слова + 128 (7 бит =	1).
1  4241
1  4242	209E  2092r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4243	      =ARRAY:209B		     LINK=LINK$
1  4244
1  4245	20A0				     SZERO LABEL FAR  ;	CFA
1  4246	20A0  1FFFr			     DW	$USE
   4247	20A2  0006				 DW 6 ;	Указатель начала стека параметров
   4248
   4249						 HEAD	  82h,'R',260Q,RZERO,$USE	      ;	RO
1  4250	      =ARRAY:20A4		     LINK$=$
1  4251	20A4  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4252							 ; 6 - признак immediate. 5- слово не описано smudge
1  4253	20A5  52			     DB	 'R'
1  4254	20A6  B0			     DB	 260Q	; последний символ слова + 128 (7 бит =	1).
1  4255
1  4256	20A7  209Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4257	      =ARRAY:20A4		     LINK=LINK$
1  4258
1  4259	20A9				     RZERO LABEL FAR  ;	CFA
1  4260	20A9  1FFFr			     DW	$USE
   4261	20AB  0008				 DW 8  ; Указатель начала стека	возврата
   4262
   4263						 HEAD	  83h, 'TI',302Q,TIB,$USE	      ;	TIB
1  4264	      =ARRAY:20AD		     LINK$=$
1  4265	20AD  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4266							 ; 6 - признак immediate. 5- слово не описано smudge
1  4267	20AE  54 49			     DB	 'TI'
1  4268	20B0  C2			     DB	 302Q	; последний символ слова + 128 (7 бит =	1).
1  4269
1  4270	20B1  20A4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4271	      =ARRAY:20AD		     LINK=LINK$
1  4272
1  4273	20B3				     TIB LABEL FAR  ; CFA
1  4274	20B3  1FFFr			     DW	$USE
   4275	20B5  000A				 DW 12Q	 ;Входной буфер	терминала 10
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 76
forth.asm



   4276
   4277						 HEAD	  85h,'WIDT',310Q,$WIDTH,$USE	      ;	WIDTH
1  4278	      =ARRAY:20B7		     LINK$=$
1  4279	20B7  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4280							 ; 6 - признак immediate. 5- слово не описано smudge
1  4281	20B8  57 49 44 54		     DB	 'WIDT'
1  4282	20BC  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1  4283
1  4284	20BD  20ADr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4285	      =ARRAY:20B7		     LINK=LINK$
1  4286
1  4287	20BF				     $WIDTH LABEL FAR  ; CFA
1  4288	20BF  1FFFr			     DW	$USE
   4289	20C1  000C				 DW 14Q	; Определяет максимальную длину	имени в	словаре
   4290
   4291						 HEAD	  87h,'WARNIN',307Q,$WARN,$USE	      ;	WARNING
1  4292	      =ARRAY:20C3		     LINK$=$
1  4293	20C3  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  4294							 ; 6 - признак immediate. 5- слово не описано smudge
1  4295	20C4  57 41 52 4E 49 4E		     DB	 'WARNIN'
1  4296	20CA  C7			     DB	 307Q	; последний символ слова + 128 (7 бит =	1).
1  4297
1  4298	20CB  20B7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4299	      =ARRAY:20C3		     LINK=LINK$
1  4300
1  4301	20CD				     $WARN LABEL FAR  ;	CFA
1  4302	20CD  1FFFr			     DW	$USE
   4303	20CF  000E				 DW 16Q	 ;  при	0 только код ошибки выводится
   4304
   4305						 HEAD	  85h,'FENC',305Q,FENCE,$USE	      ;	FENCE
1  4306	      =ARRAY:20D1		     LINK$=$
1  4307	20D1  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4308							 ; 6 - признак immediate. 5- слово не описано smudge
1  4309	20D2  46 45 4E 43		     DB	 'FENC'
1  4310	20D6  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4311
1  4312	20D7  20C3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4313	      =ARRAY:20D1		     LINK=LINK$
1  4314
1  4315	20D9				     FENCE LABEL FAR  ;	CFA
1  4316	20D9  1FFFr			     DW	$USE
   4317	20DB  0010				 DW 20Q	; FENCE	указывает верхний край базового	словаря
   4318						 ; FENCE  (ограда) служит  для	защиты	базового словаря
   4319						 ; от стирания с помощью оператора FORGET,  указывает адрес,
   4320						 ; предшествующий первой  свободной  ячейке  в словаре сразу
   4321						 ; после загрузки системы Форт,	т.е. при этом FENCE @ равно HERE-2
   4322
   4323						 HEAD	  82h,'D',320Q,$DP,$USE		      ;	DP
1  4324	      =ARRAY:20DD		     LINK$=$
1  4325	20DD  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4326							 ; 6 - признак immediate. 5- слово не описано smudge
1  4327	20DE  44			     DB	 'D'
1  4328	20DF  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  4329
1  4330	20E0  20D1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4331	      =ARRAY:20DD		     LINK=LINK$
1  4332
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 77
forth.asm



1  4333	20E2				     $DP LABEL FAR  ; CFA
1  4334	20E2  1FFFr			     DW	$USE
   4335	20E4  0012				 DW 22Q	; указывает на первую свободную	ячейку словаря (DP @ = HERE)
   4336
   4337						 HEAD	  84h,'VOC',314Q,VOCL,$USE	      ;	VOCL
1  4338	      =ARRAY:20E6		     LINK$=$
1  4339	20E6  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4340							 ; 6 - признак immediate. 5- слово не описано smudge
1  4341	20E7  56 4F 43			     DB	 'VOC'
1  4342	20EA  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  4343
1  4344	20EB  20DDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4345	      =ARRAY:20E6		     LINK=LINK$
1  4346
1  4347	20ED				     VOCL LABEL	FAR  ; CFA
1  4348	20ED  1FFFr			     DW	$USE
   4349						 ; хранится адрес XVOC
   4350	20EF  0014				 DW 24Q	; переменная  связи контекстных	словарей.
   4351
   4352						 HEAD	  85h,'FIRS',324Q,FIRST,$USE	      ;	FIRST
1  4353	      =ARRAY:20F1		     LINK$=$
1  4354	20F1  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4355							 ; 6 - признак immediate. 5- слово не описано smudge
1  4356	20F2  46 49 52 53		     DB	 'FIRS'
1  4357	20F6  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4358
1  4359	20F7  20E6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4360	      =ARRAY:20F1		     LINK=LINK$
1  4361
1  4362	20F9				     FIRST LABEL FAR  ;	CFA
1  4363	20F9  1FFFr			     DW	$USE
   4364	20FB  0016				 DW 26Q	; адрес	первого	байта экранных буферов
   4365
   4366						 HEAD	  85h,'LIMI',324Q,LIMIT,$USE	      ;	LIMIT
1  4367	      =ARRAY:20FD		     LINK$=$
1  4368	20FD  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4369							 ; 6 - признак immediate. 5- слово не описано smudge
1  4370	20FE  4C 49 4D 49		     DB	 'LIMI'
1  4371	2102  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4372
1  4373	2103  20F1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4374	      =ARRAY:20FD		     LINK=LINK$
1  4375
1  4376	2105				     LIMIT LABEL FAR  ;	CFA
1  4377	2105  1FFFr			     DW	$USE
   4378	2107  0018				 DW 30Q	; указатель конца экранных буферов и некоторые другие
   4379
   4380						 HEAD	  83h,'AT',322Q,ATR,$USE	      ;	ATR
1  4381	      =ARRAY:2109		     LINK$=$
1  4382	2109  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4383							 ; 6 - признак immediate. 5- слово не описано smudge
1  4384	210A  41 54			     DB	 'AT'
1  4385	210C  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4386
1  4387	210D  20FDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4388	      =ARRAY:2109		     LINK=LINK$
1  4389
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 78
forth.asm



1  4390	210F				     ATR LABEL FAR  ; CFA
1  4391	210F  1FFFr			     DW	$USE
   4392	2111  001A				 DW 32Q		 ;Атрибут
   4393
   4394						 HEAD	  82h,'P',307Q,PG,$USE		      ;	PG
1  4395	      =ARRAY:2113		     LINK$=$
1  4396	2113  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4397							 ; 6 - признак immediate. 5- слово не описано smudge
1  4398	2114  50			     DB	 'P'
1  4399	2115  C7			     DB	 307Q	; последний символ слова + 128 (7 бит =	1).
1  4400
1  4401	2116  2109r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4402	      =ARRAY:2113		     LINK=LINK$
1  4403
1  4404	2118				     PG	LABEL FAR  ; CFA
1  4405	2118  1FFFr			     DW	$USE
   4406	211A  001C				 DW 34Q		 ; Текущая страница
   4407
   4408						 HEAD	  83h,'BL',313Q,BLK,$USE	      ;	BLK
1  4409	      =ARRAY:211C		     LINK$=$
1  4410	211C  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4411							 ; 6 - признак immediate. 5- слово не описано smudge
1  4412	211D  42 4C			     DB	 'BL'
1  4413	211F  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  4414
1  4415	2120  2113r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4416	      =ARRAY:211C		     LINK=LINK$
1  4417
1  4418	2122				     BLK LABEL FAR  ; CFA
1  4419	2122  1FFFr			     DW	$USE
   4420	2124  001E				 DW 36Q	; 0  для  входного  буфера  и  номеру экрана
   4421							; в противном  случае
   4422
   4423						 HEAD	  82h,'I',316Q,$IN,$USE		      ;	IN
1  4424	      =ARRAY:2126		     LINK$=$
1  4425	2126  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4426							 ; 6 - признак immediate. 5- слово не описано smudge
1  4427	2127  49			     DB	 'I'
1  4428	2128  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  4429
1  4430	2129  211Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4431	      =ARRAY:2126		     LINK=LINK$
1  4432
1  4433	212B				     $IN LABEL FAR  ; CFA
1  4434	212B  1FFFr			     DW	$USE
   4435	212D  0020				 DW 40Q	; внутренний   указатель   входного   буфера
   4436
   4437						 HEAD	  83h,'PN',324Q,PNT,$USE	      ;	PNT
1  4438	      =ARRAY:212F		     LINK$=$
1  4439	212F  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4440							 ; 6 - признак immediate. 5- слово не описано smudge
1  4441	2130  50 4E			     DB	 'PN'
1  4442	2132  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4443
1  4444	2133  2126r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4445	      =ARRAY:212F		     LINK=LINK$
1  4446
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 79
forth.asm



1  4447	2135				     PNT LABEL FAR  ; CFA
1  4448	2135  1FFFr			     DW	$USE
   4449	2137  0022				 DW 42Q		 ;Флаг-печати
   4450
   4451						 HEAD	  83h,'SC',322Q,SCR,$USE	      ;	SCR
1  4452	      =ARRAY:2139		     LINK$=$
1  4453	2139  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4454							 ; 6 - признак immediate. 5- слово не описано smudge
1  4455	213A  53 43			     DB	 'SC'
1  4456	213C  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4457
1  4458	213D  212Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4459	      =ARRAY:2139		     LINK=LINK$
1  4460
1  4461	213F				     SCR LABEL FAR  ; CFA
1  4462	213F  1FFFr			     DW	$USE
   4463	2141  0024				 DW 44Q	; для хранения текущего	значения номера	экрана
   4464							 ; только в list
   4465
   4466						 HEAD	  86h,'OFFSE',324Q,OFSET,$USE	     ; OFFSET
1  4467	      =ARRAY:2143		     LINK$=$
1  4468	2143  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  4469							 ; 6 - признак immediate. 5- слово не описано smudge
1  4470	2144  4F 46 46 53 45		     DB	 'OFFSE'
1  4471	2149  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4472
1  4473	214A  2139r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4474	      =ARRAY:2143		     LINK=LINK$
1  4475
1  4476	214C				     OFSET LABEL FAR  ;	CFA
1  4477	214C  1FFFr			     DW	$USE
   4478	214E  0026				 DW 46Q	; Диагностические сообщения обычно размещаются
   4479						     ; на экранах 4 и 5. Если это не так, задачу можно решить,
   4480						     ; поменяв значение	OFFSET или исправив число, стоящее
   4481						     ; перед OFFSET в описании MESSAGE
   4482
   4483						 HEAD	  87h,'CONTEX',324Q,CONT,$USE	      ;	CONTEXT
1  4484	      =ARRAY:2150		     LINK$=$
1  4485	2150  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  4486							 ; 6 - признак immediate. 5- слово не описано smudge
1  4487	2151  43 4F 4E 54 45 58		     DB	 'CONTEX'
1  4488	2157  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4489
1  4490	2158  2143r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4491	      =ARRAY:2150		     LINK=LINK$
1  4492
1  4493	215A				     CONT LABEL	FAR  ; CFA
1  4494	215A  1FFFr			     DW	$USE
   4495					 ; Пребывание в	том  или ином  словаре	контролируется системной переменной
   4496					 ; CONTEXT,  в которой хранится	 ссылка	 на  адрес  последнего	слова,
   4497					 ; описанного  в  данном (контекстном) словаре.
   4498	215C  0028				 DW 50Q	; Указатель, с какого словаря следует начинать просмотр
   4499							; при интерпретации
   4500
   4501						 HEAD	 87h, 'CURREN',324Q,CURR,$USE	     ; CURRENT
1  4502	      =ARRAY:215E		     LINK$=$
1  4503	215E  87			     DB	 87h  ;	NFA 7 бит равен	1.
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 80
forth.asm



1  4504							 ; 6 - признак immediate. 5- слово не описано smudge
1  4505	215F  43 55 52 52 45 4E		     DB	 'CURREN'
1  4506	2165  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4507
1  4508	2166  2150r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4509	      =ARRAY:215E		     LINK=LINK$
1  4510
1  4511	2168				     CURR LABEL	FAR  ; CFA
1  4512	2168  1FFFr			     DW	$USE
   4513	216A  002A				 DW 52Q	 ; хранящая ссылку в слове Словаря на последнее	слово,
   4514							 ; описанное в текущем Словаре.	очевидно, что
   4515							 ; текущий Словарь может не совпадать с	контекстным
   4516							 ; это же адрес	latest
   4517
   4518						 HEAD	  85h,'STAT',305Q,STATE,$USE	      ;	STATE
1  4519	      =ARRAY:216C		     LINK$=$
1  4520	216C  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4521							 ; 6 - признак immediate. 5- слово не описано smudge
1  4522	216D  53 54 41 54		     DB	 'STAT'
1  4523	2171  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4524
1  4525	2172  215Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4526	      =ARRAY:216C		     LINK=LINK$
1  4527
1  4528	2174				     STATE LABEL FAR  ;	CFA
1  4529	2174  1FFFr			     DW	$USE
   4530	2176  002C				 DW 54Q	 ; 0=> Исполнение
   4531
   4532						 HEAD	  84h,'BAS',305Q,BASE,$USE	      ;	BASE
1  4533	      =ARRAY:2178		     LINK$=$
1  4534	2178  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4535							 ; 6 - признак immediate. 5- слово не описано smudge
1  4536	2179  42 41 53			     DB	 'BAS'
1  4537	217C  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4538
1  4539	217D  216Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4540	      =ARRAY:2178		     LINK=LINK$
1  4541
1  4542	217F				     BASE LABEL	FAR  ; CFA
1  4543	217F  1FFFr			     DW	$USE
   4544	2181  002E				 DW 56Q	 ; система исчисления
   4545
   4546						 HEAD	  83h,'DP',314Q,DPL,$USE	      ;	DPL
1  4547	      =ARRAY:2183		     LINK$=$
1  4548	2183  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4549							 ; 6 - признак immediate. 5- слово не описано smudge
1  4550	2184  44 50			     DB	 'DP'
1  4551	2186  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  4552
1  4553	2187  2178r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4554	      =ARRAY:2183		     LINK=LINK$
1  4555
1  4556	2189				     DPL LABEL FAR  ; CFA
1  4557	2189  1FFFr			     DW	$USE
   4558	218B  0030				 DW 60Q	; DPL определяет положение десятичной запятой (во входном
   4559							; представлении	это точка), для	чисел одинарной	длины DPL=-1.
   4560
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 81
forth.asm



   4561						 HEAD	  83h,'CS',320Q,CSP,$USE	      ;	CSP
1  4562	      =ARRAY:218D		     LINK$=$
1  4563	218D  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4564							 ; 6 - признак immediate. 5- слово не описано smudge
1  4565	218E  43 53			     DB	 'CS'
1  4566	2190  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  4567
1  4568	2191  2183r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4569	      =ARRAY:218D		     LINK=LINK$
1  4570
1  4571	2193				     CSP LABEL FAR  ; CFA
1  4572	2193  1FFFr			     DW	$USE
   4573	2195  0034				 DW 64Q
   4574
   4575						 HEAD	  82h,'R',243Q,RNUM,$USE	      ;	R#
1  4576	      =ARRAY:2197		     LINK$=$
1  4577	2197  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4578							 ; 6 - признак immediate. 5- слово не описано smudge
1  4579	2198  52			     DB	 'R'
1  4580	2199  A3			     DB	 243Q	; последний символ слова + 128 (7 бит =	1).
1  4581
1  4582	219A  218Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4583	      =ARRAY:2197		     LINK=LINK$
1  4584
1  4585	219C				     RNUM LABEL	FAR  ; CFA
1  4586	219C  1FFFr			     DW	$USE
   4587	219E  0036				 DW 66Q	; указатель  положения	курсора	 на  экране
   4588
   4589						 HEAD	  83h,'HL',304Q,HLD,$USE	      ;	HLD
1  4590	      =ARRAY:21A0		     LINK$=$
1  4591	21A0  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4592							 ; 6 - признак immediate. 5- слово не описано smudge
1  4593	21A1  48 4C			     DB	 'HL'
1  4594	21A3  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4595
1  4596	21A4  2197r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4597	      =ARRAY:21A0		     LINK=LINK$
1  4598
1  4599	21A6				     HLD LABEL FAR  ; CFA
1  4600	21A6  1FFFr			     DW	$USE
   4601	21A8  0038				 DW 70Q	; которая является указателем позиции
   4602							; в выходном буфере (обычно PAD)
   4603
   4604						 HEAD	  83h,'US',305Q,USE,$USE	      ;	USE
1  4605	      =ARRAY:21AA		     LINK$=$
1  4606	21AA  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4607							 ; 6 - признак immediate. 5- слово не описано smudge
1  4608	21AB  55 53			     DB	 'US'
1  4609	21AD  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4610
1  4611	21AE  21A0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4612	      =ARRAY:21AA		     LINK=LINK$
1  4613
1  4614	21B0				     USE LABEL FAR  ; CFA
1  4615	21B0  1FFFr			     DW	$USE
   4616	21B2  003A				 DW 72Q	;
   4617						 ; A variable containing the address of	the block buffer to use	next,
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 82
forth.asm



   4618						 ; as the least	recently written.
   4619
   4620						 HEAD	  84h,'PRE',326Q,PREV,$USE	      ;	PREV
1  4621	      =ARRAY:21B4		     LINK$=$
1  4622	21B4  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4623							 ; 6 - признак immediate. 5- слово не описано smudge
1  4624	21B5  50 52 45			     DB	 'PRE'
1  4625	21B8  D6			     DB	 326Q	; последний символ слова + 128 (7 бит =	1).
1  4626
1  4627	21B9  21AAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4628	      =ARRAY:21B4		     LINK=LINK$
1  4629
1  4630	21BB				     PREV LABEL	FAR  ; CFA
1  4631	21BB  1FFFr			     DW	$USE
   4632	21BD  003C				 DW 74Q	; адрес	экранного блока
   4633						 ; A variable containing the address of	the disc buffer	most recently
   4634						 ; referenced. The UPDATE command marks	this buffer to be later	written
   4635						 ; to disc.
   4636
   4637						 HEAD	  83h,'$E',330Q,$EX,$USE	      ;	EXP
1  4638	      =ARRAY:21BF		     LINK$=$
1  4639	21BF  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4640							 ; 6 - признак immediate. 5- слово не описано smudge
1  4641	21C0  24 45			     DB	 '$E'
1  4642	21C2  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  4643
1  4644	21C3  21B4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4645	      =ARRAY:21BF		     LINK=LINK$
1  4646
1  4647	21C5				     $EX LABEL FAR  ; CFA
1  4648	21C5  1FFFr			     DW	$USE
   4649	21C7  003E				 DW 76Q	 ; целочисленное значение  порядка  числа,
   4650							 ; который  следует  за	признаком Е
   4651
   4652						 HEAD	  83h,'ER',302Q,ERB,$USE	      ;	ERB
1  4653	      =ARRAY:21C9		     LINK$=$
1  4654	21C9  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4655							 ; 6 - признак immediate. 5- слово не описано smudge
1  4656	21CA  45 52			     DB	 'ER'
1  4657	21CC  C2			     DB	 302Q	; последний символ слова + 128 (7 бит =	1).
1  4658
1  4659	21CD  21BFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4660	      =ARRAY:21C9		     LINK=LINK$
1  4661
1  4662	21CF				     ERB LABEL FAR  ; CFA
1  4663	21CF  1FFFr			     DW	$USE
   4664	21D1  0040				 DW 100Q ; 64d 40h
   4665						 ; Если	ERB=0,	ERROR  работает	 обычным  образом,  в противном	случае
   4666						 ; переменная ERB обнуляется,  а уход из  программы  в	Форт  через  QUIT
   4667						 ; блокируется.
   4668
   4669						 HEAD	  83h,'DE','B'+80h,DEB,$USE		 ; DEB
1  4670	      =ARRAY:21D3		     LINK$=$
1  4671	21D3  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4672							 ; 6 - признак immediate. 5- слово не описано smudge
1  4673	21D4  44 45			     DB	 'DE'
1  4674	21D6  C2			     DB	 'B'+80h   ; последний символ слова + 128 (7 бит = 1).
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 83
forth.asm



1  4675
1  4676	21D7  21C9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4677	      =ARRAY:21D3		     LINK=LINK$
1  4678
1  4679	21D9				     DEB LABEL FAR  ; CFA
1  4680	21D9  1FFFr			     DW	$USE
   4681	21DB  0042				 DW 102Q  ; признак отладки  66d
   4682
   4683						 HEAD	  89h,'LASTRAND','X'+80h,LASTRANDX,$USE	 ; LASTRANDX
1  4684	      =ARRAY:21DD		     LINK$=$
1  4685	21DD  89			     DB	 89h  ;	NFA 7 бит равен	1.
1  4686							 ; 6 - признак immediate. 5- слово не описано smudge
1  4687	21DE  4C 41 53 54 52 41	4E+	     DB	 'LASTRAND'
   4688	      44
1  4689	21E6  D8			     DB	 'X'+80h   ; последний символ слова + 128 (7 бит = 1).
1  4690
1  4691	21E7  21D3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4692	      =ARRAY:21DD		     LINK=LINK$
1  4693
1  4694	21E9				     LASTRANDX LABEL FAR  ; CFA
1  4695	21E9  1FFFr			     DW	$USE
   4696	21EB  0044				 DW 104Q  ;
   4697
   4698						 HEAD	  82h,'X','A'+80h,XA,$USE	       ; XA
1  4699	      =ARRAY:21ED		     LINK$=$
1  4700	21ED  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4701							 ; 6 - признак immediate. 5- слово не описано smudge
1  4702	21EE  58			     DB	 'X'
1  4703	21EF  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  4704
1  4705	21F0  21DDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4706	      =ARRAY:21ED		     LINK=LINK$
1  4707
1  4708	21F2				     XA	LABEL FAR  ; CFA
1  4709	21F2  1FFFr			     DW	$USE
   4710	21F4  0046				 DW 106Q  ;
   4711
   4712						 HEAD	  82h,'X','C'+80h,XC,$USE	       ; XC
1  4713	      =ARRAY:21F6		     LINK$=$
1  4714	21F6  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4715							 ; 6 - признак immediate. 5- слово не описано smudge
1  4716	21F7  58			     DB	 'X'
1  4717	21F8  C3			     DB	 'C'+80h   ; последний символ слова + 128 (7 бит = 1).
1  4718
1  4719	21F9  21EDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4720	      =ARRAY:21F6		     LINK=LINK$
1  4721
1  4722	21FB				     XC	LABEL FAR  ; CFA
1  4723	21FB  1FFFr			     DW	$USE
   4724	21FD  0048				 DW 110Q  ;
   4725
   4726						 HEAD	  82h,'X','M'+80h,XM,$USE	       ; XM
1  4727	      =ARRAY:21FF		     LINK$=$
1  4728	21FF  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4729							 ; 6 - признак immediate. 5- слово не описано smudge
1  4730	2200  58			     DB	 'X'
1  4731	2201  CD			     DB	 'M'+80h   ; последний символ слова + 128 (7 бит = 1).
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 84
forth.asm



1  4732
1  4733	2202  21F6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4734	      =ARRAY:21FF		     LINK=LINK$
1  4735
1  4736	2204				     XM	LABEL FAR  ; CFA
1  4737	2204  1FFFr			     DW	$USE
   4738	2206  004A				 DW 112Q  ;
   4739
   4740					     ;** Слова высокого	уровня **
   4741
   4742						 HEAD	  85h,'?TER',315Q,?TERM,$COL	      ;	?TERM
1  4743	      =ARRAY:2208		     LINK$=$
1  4744	2208  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4745							 ; 6 - признак immediate. 5- слово не описано smudge
1  4746	2209  3F 54 45 52		     DB	 '?TER'
1  4747	220D  CD			     DB	 315Q	; последний символ слова + 128 (7 бит =	1).
1  4748
1  4749	220E  21FFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4750	      =ARRAY:2208		     LINK=LINK$
1  4751
1  4752	2210				     ?TERM LABEL FAR  ;	CFA
1  4753	2210  1F73r			     DW	$COL
   4754					 ; вывод в стек	кода символа из	буфера клавиатуры без ожидания нажатия
   4755	2212  155Dr 0FD4r 00FF	  +		 DW ?TER$,LIT,377Q,$AND,SEMI
   4756	      17F9r 18DBr
   4757
   4758						 HEAD	  82h,'C',322Q,CR,$COL		      ;	CR
1  4759	      =ARRAY:221C		     LINK$=$
1  4760	221C  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4761							 ; 6 - признак immediate. 5- слово не описано smudge
1  4762	221D  43			     DB	 'C'
1  4763	221E  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4764
1  4765	221F  2208r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4766	      =ARRAY:221C		     LINK=LINK$
1  4767
1  4768	2221				     CR	LABEL FAR  ; CFA
1  4769	2221  1F73r			     DW	$COL
   4770					 ; вывод символов 0D 0A
   4771	2223  0FD4r 000D 13F7r	  +		 DW LIT,15Q,EMIT,LIT,12Q,EMIT,SEMI
   4772	      0FD4r 000A 13F7r	  +
   4773	      18DBr
   4774
   4775						 HEAD	  81h,,254Q,COMMA,$COL		      ;	,
1  4776	      =ARRAY:2231		     LINK$=$
1  4777	2231  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  4778							 ; 6 - признак immediate. 5- слово не описано smudge
1  4779	2232  AC			     DB	 254Q	; последний символ слова + 128 (7 бит =	1).
1  4780
1  4781	2233  221Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4782	      =ARRAY:2231		     LINK=LINK$
1  4783
1  4784	2235				     COMMA LABEL FAR  ;	CFA
1  4785	2235  1F73r			     DW	$COL
   4786					 ; в  свободную	ячейку словаря помещяем	число из стека и
   4787					 ;  занимаем эту ячейку	(смещаем указатель here)
   4788	2237  1D4Dr 1CA8r 206Cr	  +		 DW HERE,STORE,TWO,ALLOT,SEMI
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 85
forth.asm



   4789	      1D6Br 18DBr
   4790
   4791						 HEAD	  82h,'C',254Q,CCOM,$COL	      ;	C,
1  4792	      =ARRAY:2241		     LINK$=$
1  4793	2241  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4794							 ; 6 - признак immediate. 5- слово не описано smudge
1  4795	2242  43			     DB	 'C'
1  4796	2243  AC			     DB	 254Q	; последний символ слова + 128 (7 бит =	1).
1  4797
1  4798	2244  2231r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4799	      =ARRAY:2241		     LINK=LINK$
1  4800
1  4801	2246				     CCOM LABEL	FAR  ; CFA
1  4802	2246  1F73r			     DW	$COL
   4803	2248  1D4Dr 1CC4r 2064r	  +		 DW HERE,CSTOR,ONE,ALLOT,SEMI
   4804	      1D6Br 18DBr
   4805
   4806						 HEAD	   85h,'SPAC',305Q,SPACE,$COL	      ;	SPACE
1  4807	      =ARRAY:2252		     LINK$=$
1  4808	2252  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4809							 ; 6 - признак immediate. 5- слово не описано smudge
1  4810	2253  53 50 41 43		     DB	 'SPAC'
1  4811	2257  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4812
1  4813	2258  2241r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4814	      =ARRAY:2252		     LINK=LINK$
1  4815
1  4816	225A				     SPACE LABEL FAR  ;	CFA
1  4817	225A  1F73r			     DW	$COL
   4818	225C  2085r 13F7r 18DBr			 DW BLAN,EMIT,SEMI
   4819
   4820						  HEAD	  83h,'PF','A'+80h,PFA,$COL	      ;	PFA
1  4821	      =ARRAY:2262		     LINK$=$
1  4822	2262  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4823							 ; 6 - признак immediate. 5- слово не описано smudge
1  4824	2263  50 46			     DB	 'PF'
1  4825	2265  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  4826
1  4827	2266  2252r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4828	      =ARRAY:2262		     LINK=LINK$
1  4829
1  4830	2268				     PFA LABEL FAR  ; CFA
1  4831	2268  1F73r			     DW	$COL
   4832					 ; NFA -> PFA
   4833	226A  2064r 1D89r 0FD4r	  +		  DW  ONE,TRAV,LIT,5,PLUS,SEMI
   4834	      0005 171Ar 18DBr
   4835
   4836						  HEAD	  83h,'?E',322Q,QERR,$COL	      ;	?ER
1  4837	      =ARRAY:2276		     LINK$=$
1  4838	2276  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4839							 ; 6 - признак immediate. 5- слово не описано smudge
1  4840	2277  3F 45			     DB	 '?E'
1  4841	2279  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4842
1  4843	227A  2262r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4844	      =ARRAY:2276		     LINK=LINK$
1  4845
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 86
forth.asm



1  4846	227C				     QERR LABEL	FAR  ; CFA
1  4847	227C  1F73r			     DW	$COL
   4848					 ; f errorcode -> если f=0, то без ошибок
   4849	227E  1A18r 101Br 0006	  +		  DW  SWAP,ZBRAN,TTT-$,ERROR,SEMI
   4850	      261Ar 18DBr
   4851	2288  1B2Dr 18DBr		TTT:	  DW  DROP,SEMI
   4852
   4853						  HEAD	  85h,'?COM',320Q,QCOMP,$COL	      ;	?COMP
1  4854	      =ARRAY:228C		     LINK$=$
1  4855	228C  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4856							 ; 6 - признак immediate. 5- слово не описано smudge
1  4857	228D  3F 43 4F 4D		     DB	 '?COM'
1  4858	2291  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  4859
1  4860	2292  2276r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4861	      =ARRAY:228C		     LINK=LINK$
1  4862
1  4863	2294				     QCOMP LABEL FAR  ;	CFA
1  4864	2294  1F73r			     DW	$COL
   4865					     ; проверка	режима работы. система в режиме	компиляции?
   4866	2296  2174r 1C4Er 1169r	  +		  DW  STATE,AT,ZEQU,LIT,21Q,QERR,SEMI	     ; 17
   4867	      0FD4r 0011 227Cr	  +
   4868	      18DBr
   4869
   4870						  HEAD	  85h,'?EXE',303Q,QEXEC,$COL	      ;	?EXEC
1  4871	      =ARRAY:22A4		     LINK$=$
1  4872	22A4  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4873							 ; 6 - признак immediate. 5- слово не описано smudge
1  4874	22A5  3F 45 58 45		     DB	 '?EXE'
1  4875	22A9  C3			     DB	 303Q	; последний символ слова + 128 (7 бит =	1).
1  4876
1  4877	22AA  228Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4878	      =ARRAY:22A4		     LINK=LINK$
1  4879
1  4880	22AC				     QEXEC LABEL FAR  ;	CFA
1  4881	22AC  1F73r			     DW	$COL
   4882					     ; проверка	режима исполнения    0=> Исполнение
   4883	22AE  2174r 1C4Er 0FD4r	  +		  DW  STATE,AT,LIT,22Q,QERR,SEMI	     ; 18
   4884	      0012 227Cr 18DBr
   4885
   4886						  HEAD	  85h,'?PAI',322Q,QPAIR,$COL	      ;	?PAIR
1  4887	      =ARRAY:22BA		     LINK$=$
1  4888	22BA  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4889							 ; 6 - признак immediate. 5- слово не описано smudge
1  4890	22BB  3F 50 41 49		     DB	 '?PAI'
1  4891	22BF  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4892
1  4893	22C0  22A4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4894	      =ARRAY:22BA		     LINK=LINK$
1  4895
1  4896	22C2				     QPAIR LABEL FAR  ;	CFA
1  4897	22C2  1F73r			     DW	$COL
   4898	22C4  1736r 0FD4r 0013	  +		  DW  SUBB,LIT,23Q,QERR,SEMI
   4899	      227Cr 18DBr
   4900
   4901						  HEAD	  84h,'?CS',320Q,QCSP,$COL	      ;	?CSP
1  4902	      =ARRAY:22CE		     LINK$=$
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 87
forth.asm



1  4903	22CE  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4904							 ; 6 - признак immediate. 5- слово не описано smudge
1  4905	22CF  3F 43 53			     DB	 '?CS'
1  4906	22D2  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  4907
1  4908	22D3  22BAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4909	      =ARRAY:22CE		     LINK=LINK$
1  4910
1  4911	22D5				     QCSP LABEL	FAR  ; CFA
1  4912	22D5  1F73r			     DW	$COL
   4913					     ; контролируют сохранение указателя
   4914					     ; стека параметров	в процессе интерпретации слова
   4915					     ; текущее и сохраненное значение стека должны быть	равны
   4916	22D7  1896r 2193r 1C4Er	  +		  DW  SPAT,CSP,AT,SUBB,LIT,24Q,QERR,SEMI
   4917	      1736r 0FD4r 0014	  +
   4918	      227Cr 18DBr
   4919
   4920						  HEAD	  85h,'?LOA',304Q,QLOAD,$COL	      ;	?LOAD
1  4921	      =ARRAY:22E7		     LINK$=$
1  4922	22E7  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4923							 ; 6 - признак immediate. 5- слово не описано smudge
1  4924	22E8  3F 4C 4F 41		     DB	 '?LOA'
1  4925	22EC  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4926
1  4927	22ED  22CEr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4928	      =ARRAY:22E7		     LINK=LINK$
1  4929
1  4930	22EF				     QLOAD LABEL FAR  ;	CFA
1  4931	22EF  1F73r			     DW	$COL
   4932					     ; ошибка, если не вовремя загрузки
   4933	22F1  2122r 1C4Er 1169r	  +		  DW  BLK,AT,ZEQU,LIT,26Q,QERR,SEMI	 ; 22
   4934	      0FD4r 0016 227Cr	  +
   4935	      18DBr
   4936
   4937						  HEAD	  87h,'COMPIL',305Q,COMP,$COL	      ;	COMPILE
1  4938	      =ARRAY:22FF		     LINK$=$
1  4939	22FF  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  4940							 ; 6 - признак immediate. 5- слово не описано smudge
1  4941	2300  43 4F 4D 50 49 4C		     DB	 'COMPIL'
1  4942	2306  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4943
1  4944	2307  22E7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4945	      =ARRAY:22FF		     LINK=LINK$
1  4946
1  4947	2309				     COMP LABEL	FAR  ; CFA
1  4948	2309  1F73r			     DW	$COL
   4949					 ; Компиляция исполнительного адреса, следующего за оператором
   4950	230B  2294r 1955r 1938r	  +		  DW  QCOMP,I,FROMR,TWOP,TOR,AT,COMMA,SEMI
   4951	      15E9r 191Ar 1C4Er	  +
   4952	      2235r 18DBr
   4953
   4954						  HEAD	  84h,'SMU',307Q,SMUG,$COL	      ;	SMUDGE
1  4955	      =ARRAY:231B		     LINK$=$
1  4956	231B  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4957							 ; 6 - признак immediate. 5- слово не описано smudge
1  4958	231C  53 4D 55			     DB	 'SMU'
1  4959	231F  C7			     DB	 307Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 88
forth.asm



1  4960
1  4961	2320  22FFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4962	      =ARRAY:231B		     LINK=LINK$
1  4963
1  4964	2322				     SMUG LABEL	FAR  ; CFA
1  4965	2322  1F73r			     DW	$COL
   4966					     ; сбрасывает 5-й бит первого байта	 описания  и  тем  самым
   4967					     ; делает	данное	 слово	полноправным  членом  текущего	словаря
   4968	2324  1E47r 2085r 1C33r	  +		  DW  LATES,BLAN,TOGL,SEMI
   4969	      18DBr
   4970
   4971						  HEAD	  87h,'(;CODE',251Q,PSCOD,$COL	      ;	(;CODE)
1  4972	      =ARRAY:232C		     LINK$=$
1  4973	232C  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  4974							 ; 6 - признак immediate. 5- слово не описано smudge
1  4975	232D  28 3B 43 4F 44 45		     DB	 '(;CODE'
1  4976	2333  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1  4977
1  4978	2334  231Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4979	      =ARRAY:232C		     LINK=LINK$
1  4980
1  4981	2336				     PSCOD LABEL FAR  ;	CFA
1  4982	2336  1F73r			     DW	$COL
   4983					 ; адрес из стека возвратов (там находится адрес начала	кода на	ассемблере)
   4984					 ; пишем в CFA последнего определяемого	слова
   4985					 ; таким образом в CFA будет свой код интерпретатора на	ассемблере
   4986	2338  1938r 1E47r 2268r	  +		  DW  FROMR,LATES,PFA,CFA,STORE,SEMI
   4987	      1D11r 1CA8r 18DBr
   4988
   4989						  HEAD	  87h, '<BUILD',323Q,BUILD,$COL	       ; <BUILDS ;
1  4990	      =ARRAY:2344		     LINK$=$
1  4991	2344  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  4992							 ; 6 - признак immediate. 5- слово не описано smudge
1  4993	2345  3C 42 55 49 4C 44		     DB	 '<BUILD'
1  4994	234B  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  4995
1  4996	234C  232Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4997	      =ARRAY:2344		     LINK=LINK$
1  4998
1  4999	234E				     BUILD LABEL FAR  ;	CFA
1  5000	234E  1F73r			     DW	$COL
   5001					 ; формирует в словаре описание	константы равной 0 с именем XXX
   5002					 ; в поле PFA находится	0, который потом заменится адресом кода,
   5003					 ; следующего за словом	DOES
   5004					 ; в CFA будет помещен адрес кода $DOE
   5005	2350  205Cr 1FACr 18DBr			  DW  ZERO,CON,SEMI
   5006
   5007						  HEAD	  85h,'COUN',324Q,COUNT,$COL	      ;	COUNT
1  5008	      =ARRAY:2356		     LINK$=$
1  5009	2356  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5010							 ; 6 - признак immediate. 5- слово не описано smudge
1  5011	2357  43 4F 55 4E		     DB	 'COUN'
1  5012	235B  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  5013
1  5014	235C  2344r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5015	      =ARRAY:2356		     LINK=LINK$
1  5016
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 89
forth.asm



1  5017	235E				     COUNT LABEL FAR  ;	CFA
1  5018	235E  1F73r			     DW	$COL
   5019					 ; addr1 --- addr2 n
   5020					 ; адрес HERE+1	(это адрес первого байта слова)
   5021					 ; и число символов в  слове  (HERE  C@)
   5022	2360  1A64r				  DW  DUBL	     ; addr1 addr1
   5023	2362  15CEr 1A18r			  DW  ONEP,SWAP	     ; addr1+1 addr1
   5024	2366  1C8Br 18DBr			  DW  CAT,SEMI	     ; addr1+1 u8[addr1]
   5025
   5026						  HEAD	  84h,'TYP',305Q,$TYPE,$COL	      ;	TYPE
1  5027	      =ARRAY:236A		     LINK$=$
1  5028	236A  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5029							 ; 6 - признак immediate. 5- слово не описано smudge
1  5030	236B  54 59 50			     DB	 'TYP'
1  5031	236E  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  5032
1  5033	236F  2356r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5034	      =ARRAY:236A		     LINK=LINK$
1  5035
1  5036	2371				     $TYPE LABEL FAR  ;	CFA
1  5037	2371  1F73r			     DW	$COL
   5038					 ; адр count ->	вывод строки на	экран
   5039	2373  1A81r 101Br 001C	  +		  DW  DDUP,ZBRAN,TC1-$,ZERO,XDO
   5040	      205Cr 105Cr
   5041	237D  1A64r 1955r 171Ar	  +	 TC0:	  DW  DUBL,I,PLUS,CAT,LIT,177Q,$AND
   5042	      1C8Br 0FD4r 007F	  +
   5043	      17F9r
   5044	238B  2064r 13BCr 1085r	  +		  DW  ONE,EMI$,XLOOP,TC0-$
   5045	      FFEC
   5046	2393  1B2Dr 18DBr		 TC1:	  DW  DROP,SEMI
   5047
   5048						  HEAD	  84h,'(."',251Q,PDOTQ,$COL	      ;	(.")
1  5049	      =ARRAY:2397		     LINK$=$
1  5050	2397  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5051							 ; 6 - признак immediate. 5- слово не описано smudge
1  5052	2398  28 2E 22			     DB	 '(."'
1  5053	239B  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1  5054
1  5055	239C  236Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5056	      =ARRAY:2397		     LINK=LINK$
1  5057
1  5058	239E				     PDOTQ LABEL FAR  ;	CFA
1  5059	239E  1F73r			     DW	$COL
   5060	23A0  1955r				  DW  I	     ; при исполнении следующее	число -
   5061							     ; число символов сохраняется в RS
   5062	23A2  235Er 1A64r 15CEr			  DW COUNT,DUBL,ONEP
   5063	23A8  1938r 171Ar 191Ar	  +		  DW  FROMR,PLUS,TOR,$TYPE,SEMI
   5064	      2371r 18DBr
   5065
   5066						  HEAD	  302Q,'.',242Q,DOTQ,$COL	       ; ."
1  5067	      =ARRAY:23B2		     LINK$=$
1  5068	23B2  C2			     DB	 302Q  ; NFA 7 бит равен 1.
1  5069							 ; 6 - признак immediate. 5- слово не описано smudge
1  5070	23B3  2E			     DB	 '.'
1  5071	23B4  A2			     DB	 242Q	; последний символ слова + 128 (7 бит =	1).
1  5072
1  5073	23B5  2397r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 90
forth.asm



1  5074	      =ARRAY:23B2		     LINK=LINK$
1  5075
1  5076	23B7				     DOTQ LABEL	FAR  ; CFA
1  5077	23B7  1F73r			     DW	$COL
   5078	23B9  0FD4r 0022 2174r	  +		  DW  LIT,34,STATE,AT,ZBRAN,XT-$
   5079	      1C4Er 101Br 0012
   5080	23C5  2309r 239Er 2438r	  +		  DW  COMP,PDOTQ,$WORD,HERE,CAT,ONEP
   5081	      1D4Dr 1C8Br 15CEr
   5082	23D1  1D6Br 18DBr			  DW  ALLOT, SEMI
   5083	23D5  2438r 1D4Dr 235Er	  +	XT:	  DW  $WORD,HERE,COUNT,$TYPE,SEMI
   5084	      2371r 18DBr
   5085
   5086						  HEAD	  85h,'QUER',331Q,QUERY,$COL	      ;	QUERY
1  5087	      =ARRAY:23DF		     LINK$=$
1  5088	23DF  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5089							 ; 6 - признак immediate. 5- слово не описано smudge
1  5090	23E0  51 55 45 52		     DB	 'QUER'
1  5091	23E4  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  5092
1  5093	23E5  23B2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5094	      =ARRAY:23DF		     LINK=LINK$
1  5095
1  5096	23E7				     QUERY LABEL FAR  ;	CFA
1  5097	23E7  1F73r			     DW	$COL
   5098					 ; входной буфер,  адрес которого хранится в системной переменной
   5099					 ; по имени TIB	(Terminal Input	Buffer).  Ввод	в  этот	 буфер
   5100					 ; осуществляется оператором QUERY
   5101	23E9  20B3r 1C4Er 1D11r	  +		  DW  TIB,AT,CFA,LIT,120Q,EXPE
   5102	      0FD4r 0050 152Cr
   5103	23F5  205Cr 212Br 1CA8r	  +		  DW  ZERO,$IN,STORE,CR,SEMI
   5104	      2221r 18DBr
   5105
   5106						  HEAD	  301Q,,200Q,NULL,$COL		       ; NULL
1  5107	      =ARRAY:23FF		     LINK$=$
1  5108	23FF  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  5109							 ; 6 - признак immediate. 5- слово не описано smudge
1  5110	2400  80			     DB	 200Q	; последний символ слова + 128 (7 бит =	1).
1  5111
1  5112	2401  23DFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5113	      =ARRAY:23FF		     LINK=LINK$
1  5114
1  5115	2403				     NULL LABEL	FAR  ; CFA
1  5116	2403  1F73r			     DW	$COL
   5117					 ; немедленного	исполнения. исполняется, если встретился 0 в коде
   5118					 ; прерывает бесконечное испольнение INTERPRET
   5119	2405  2122r 1C4Er 101Br	  +		  DW  BLK,AT,ZBRAN,NUL-$	 ; если	пультовый режим
   5120	      0010
   5121	240D  2064r 2122r 1BF9r	  +		  DW  ONE,BLK,PSTOR,ZERO,$IN,STORE,QEXEC
   5122	      205Cr 212Br 1CA8r	  +
   5123	      22ACr
   5124	241B  19B3r 18DBr		 NUL:	  DW  LEV,SEMI
   5125
   5126						  HEAD	  83h,'PA',304Q,PAD,$COL	      ;	PAD
1  5127	      =ARRAY:241F		     LINK$=$
1  5128	241F  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  5129							 ; 6 - признак immediate. 5- слово не описано smudge
1  5130	2420  50 41			     DB	 'PA'
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 91
forth.asm



1  5131	2422  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  5132
1  5133	2423  23FFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5134	      =ARRAY:241F		     LINK=LINK$
1  5135
1  5136	2425				     PAD LABEL FAR  ; CFA
1  5137	2425  1F73r			     DW	$COL
   5138					     ; Многие операции	 выдачи	  результатов	и   сообщений	на   экран
   5139					     ; производятся   через   специальный   буфер,   адрес   которого  смещен
   5140					     ; относительно HERE.  В базовом словаре имеется  оператор	PAD,  который
   5141					     ; выдает в	стек адрес КОНЦА этого буфера:
   5142	2427  1D4Dr 0FD4r 0044	  +		  DW  HERE,LIT,104Q,PLUS,SEMI
   5143	      171Ar 18DBr
   5144
   5145						  HEAD	  84h,'WOR',304Q,$WORD,$COL	      ;	WORD
1  5146	      =ARRAY:2431		     LINK$=$
1  5147	2431  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5148							 ; 6 - признак immediate. 5- слово не описано smudge
1  5149	2432  57 4F 52			     DB	 'WOR'
1  5150	2435  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  5151
1  5152	2436  241Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5153	      =ARRAY:2431		     LINK=LINK$
1  5154
1  5155	2438				     $WORD LABEL FAR  ;	CFA
1  5156	2438  1F73r			     DW	$COL
   5157					     ; разделитель -> число_символов строка по адресу here
   5158	243A  2122r 1C4Er 1A81r	  +		  DW  BLK,AT,DDUP,ZBRAN,WD1-$; ввод с клавиатуры
   5159	      101Br 0008
   5160	2444  2945r 1040r 0006			  DW  BLOCK,BRAN,WD2-$	     ; адрес буфера из переменной BLK
   5161	244A  20B3r 1C4Er		WD1:	  DW  TIB,AT		     ; адрес входного терминала
   5162	244E  212Br 1C4Er 171Ar	  +	WD2:	  DW  $IN,AT,PLUS,SWAP,ENCL,HERE,BLAN,BLANK,$IN
   5163	      1A18r 1275r 1D4Dr	  +
   5164	      2085r 1BCAr 212Br
   5165	2460  1BF9r 191Ar 1955r	  +		  DW  PSTOR,TOR,I,HERE,CSTOR
   5166	      1D4Dr 1CC4r
   5167	246A  1D4Dr 15CEr 1938r	  +		  DW  HERE,ONEP,FROMR,CMOV,SEMI
   5168	      1B67r 18DBr
   5169
   5170						  HEAD	  88h,'(NUMBER',251Q,PNUMB,$COL	      ;	(NUMBER)
1  5171	      =ARRAY:2474		     LINK$=$
1  5172	2474  88			     DB	 88h  ;	NFA 7 бит равен	1.
1  5173							 ; 6 - признак immediate. 5- слово не описано smudge
1  5174	2475  28 4E 55 4D 42 45	52	     DB	 '(NUMBER'
1  5175	247C  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1  5176
1  5177	247D  2431r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5178	      =ARRAY:2474		     LINK=LINK$
1  5179
1  5180	247F				     PNUMB LABEL FAR  ;	CFA
1  5181	247F  1F73r			     DW	$COL
   5182	2481  15CEr 191Ar 1955r	  +	BN:	  DW  ONEP,TOR,I,CAT,BASE,AT,DIGIT,ZBRAN,MMO-$
   5183	      1C8Br 217Fr 1C4Er	  +
   5184	      1146r 101Br 002C
   5185	2493  1A18r 217Fr 1C4Er	  +		  DW  SWAP,BASE,AT,USTAR,DROP,ROT,BASE,AT,USTAR
   5186	      1659r 1B2Dr 1AB1r	  +
   5187	      217Fr 1C4Er 1659r
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 92
forth.asm



   5188	24A5  1753r 2189r 1C4Er	  +		  DW  DPLUS,DPL,AT,ONEP,ZBRAN,BN1-$,ONE,DPL,PSTOR
   5189	      15CEr 101Br 0008	  +
   5190	      2064r 2189r 1BF9r
   5191	24B7  1938r 1040r FFC6		BN1:	  DW  FROMR,BRAN,BN-$
   5192	24BD  1938r 18DBr		MMO:	  DW  FROMR,SEMI
   5193
   5194						  HEAD	  85h,'-FIN',304Q,DFIND,$COL	      ;	-FIND
1  5195	      =ARRAY:24C1		     LINK$=$
1  5196	24C1  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5197							 ; 6 - признак immediate. 5- слово не описано smudge
1  5198	24C2  2D 46 49 4E		     DB	 '-FIN'
1  5199	24C6  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  5200
1  5201	24C7  2474r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5202	      =ARRAY:24C1		     LINK=LINK$
1  5203
1  5204	24C9				     DFIND LABEL FAR  ;	CFA
1  5205	24C9  1F73r			     DW	$COL
   5206					     ; Поиск слова в словаре, которое следует следующим	в тексте программы
   5207	24CB  2085r 2438r 1D4Dr	  +		  DW  BLAN,$WORD,HERE,COUNT,UPPER,HERE
   5208	      235Er 1E91r 1D4Dr
   5209	24D7  215Ar 1C4Er 1C4Er			  DW  CONT,AT,AT ; поиска в контекстном	словаре
   5210	24DD  10D4r 1A81r 1169r	  +		  DW  PFIND,DDUP,ZEQU,ZBRAN,FIN-$,HERE,LATES,PFIND
   5211	      101Br 0008 1D4Dr	  +
   5212	      1E47r 10D4r
   5213	24ED  18DBr			FIN:	  DW  SEMI
   5214
   5215						  HEAD	  86h,'NUMBE',322Q,NUMB,$COL	      ;	NUMBER
1  5216	      =ARRAY:24EF		     LINK$=$
1  5217	24EF  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  5218							 ; 6 - признак immediate. 5- слово не описано smudge
1  5219	24F0  4E 55 4D 42 45		     DB	 'NUMBE'
1  5220	24F5  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  5221
1  5222	24F6  24C1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5223	      =ARRAY:24EF		     LINK=LINK$
1  5224
1  5225	24F8				     NUMB LABEL	FAR  ; CFA
1  5226	24F8  1F73r			     DW	$COL
   5227	24FA  205Cr 21C5r 1CA8r	  +		  DW  ZERO,$EX,STORE,BASE,AT,ZERO,ROT
   5228	      217Fr 1C4Er 205Cr	  +
   5229	      1AB1r
   5230	2508  15CEr 1A64r 1C8Br	  +		  DW  ONEP,DUBL,CAT,DUBL,LIT,53Q,EQUAL
   5231	      1A64r 0FD4r 002B	  +
   5232	      11DEr
   5233	2516  101Br 000A 1E06r	  +		  DW  ZBRAN,NH1-$,DECIMA,DROP,BRAN,NH4-$
   5234	      1B2Dr 1040r 002E
   5235	2522  1A64r 0FD4r 002D	  +	NH1:	  DW  DUBL,LIT,55Q,EQUAL,ZBRAN,NH2-$,DROP,DECIMA
   5236	      11DEr 101Br 0012	  +
   5237	      1B2Dr 1E06r
   5238	2532  1A18r 1B2Dr 2064r	  +		  DW  SWAP,DROP,ONE,SWAP,BRAN,NH4-$
   5239	      1A18r 1040r 0012
   5240	253E  0FD4r 0027 11DEr	  +	NH2:	  DW  LIT,47Q,EQUAL,ZBRAN,NH3-$,OCTAL,ONEP
   5241	      101Br 0006 1E26r	  +
   5242	      15CEr
   5243	254C  1606r			NH3:	  DW  ONEM
   5244	254E  0FD4r FFFF 2189r	  +	NH4:	  DW  LIT,-1,DPL,STORE,ZERO,ZERO,ROT,PNUMB,DUBL
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 93
forth.asm



   5245	      1CA8r 205Cr 205Cr	  +
   5246	      1AB1r 247Fr 1A64r
   5247	2560  1C8Br 2085r 1736r	  +		  DW  CAT,BLAN,SUBB,ZBRAN,NH6-$
   5248	      101Br 0088
   5249	256A  1A64r 1C8Br 0FD4r	  +		  DW  DUBL,CAT,LIT,56Q,EQUAL,ZBRAN,EXP-$
   5250	      002E 11DEr 101Br	  +
   5251	      0016
   5252	2578  205Cr 2189r 1CA8r	  +		  DW  ZERO,DPL,STORE,PNUMB,DUBL,CAT,BLAN,SUBB,ZBRAN,NH6-$
   5253	      247Fr 1A64r 1C8Br	  +
   5254	      2085r 1736r 101Br	  +
   5255	      0066
   5256	258C  2189r 1C4Er 1A18r	  +	EXP:	  DW  DPL,AT,SWAP,DUBL,CAT,LIT
   5257	      1A64r 1C8Br 0FD4r
   5258	2598  0045 11DEr 101Br	  +		  DW  105Q,EQUAL,ZBRAN,ER1-$,ONEP,DUBL,CAT
   5259	      0068 15CEr 1A64r	  +
   5260	      1C8Br
   5261	25A6  0FD4r 002D 11DEr	  +		  DW  LIT,55Q,EQUAL,ZBRAN,NEMI-$,ONE,BRAN,NH0-$
   5262	      101Br 0008 2064r	  +
   5263	      1040r 0014
   5264	25B6  1A64r 1C8Br 0FD4r	  +	NEMI:	  DW  DUBL,CAT,LIT,53Q,SUBB,ZBRAN,PLU-$,ONEM
   5265	      002B 1736r 101Br	  +
   5266	      0004 1606r
   5267	25C6  205Cr			PLU:	  DW  ZERO
   5268	25C8  1A18r 205Cr 205Cr	  +	NH0:	  DW  SWAP,ZERO,ZERO,ROT,PNUMB,CAT,BLAN,EQUAL,ZBRAN,ER-$
   5269	      1AB1r 247Fr 1C8Br	  +
   5270	      2085r 11DEr 101Br	  +
   5271	      0028
   5272	25DC  1B2Dr 1A18r 101Br	  +		  DW  DROP,SWAP,ZBRAN,NH5-$,MINUS
   5273	      0004 179Cr
   5274	25E6  21C5r 1CA8r 2189r	  +	NH5:	  DW  $EX,STORE,DPL,STORE,ZERO
   5275	      1CA8r 205Cr
   5276	25F0  1B2Dr 1AB1r 101Br	  +	NH6:	  DW  DROP,ROT,ZBRAN,NH7-$,DMINU
   5277	      0004 16B8r
   5278	25FA  1AB1r 217Fr 1CA8r	  +	NH7:	  DW  ROT,BASE,STORE,SEMI
   5279	      18DBr
   5280	2602  1B10r 1B2Dr		ER:	  DW  DDROP,DROP
   5281	2606  1B10r 1B10r 1B2Dr	  +	ER1:	  DW  DDROP,DDROP,DROP,ZERO,ERROR,SEMI
   5282	      205Cr 261Ar 18DBr
   5283
   5284						  HEAD	  85h,'ERRO',322Q,ERROR,$COL	      ;	ERROR
1  5285	      =ARRAY:2612		     LINK$=$
1  5286	2612  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5287							 ; 6 - признак immediate. 5- слово не описано smudge
1  5288	2613  45 52 52 4F		     DB	 'ERRO'
1  5289	2617  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  5290
1  5291	2618  24EFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5292	      =ARRAY:2612		     LINK=LINK$
1  5293
1  5294	261A				     ERROR LABEL FAR  ;	CFA
1  5295	261A  1F73r			     DW	$COL
   5296	261C  1D4Dr 235Er 2371r	  +		  DW  HERE,COUNT,$TYPE,PDOTQ
   5297	      239Er
   5298	2624  03 20 3F 20			  DB  3	, ' ? '
   5299	2628  21CFr 1C4Er 101Br	  +		  DW  ERB,AT,ZBRAN,XER-$
   5300	      000C
   5301	2630  205Cr 21CFr 1CA8r	  +		  DW  ZERO,ERB,STORE,DROP,SEMI
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 94
forth.asm



   5302	      1B2Dr 18DBr
   5303	263A  29BFr 18A3r 27CDr		XER:	  DW  MESS,SPSTO,QUIT
   5304
   5305						  HEAD	  83h,'ID',256Q,IDDOT,$COL	      ;	ID.
1  5306	      =ARRAY:2640		     LINK$=$
1  5307	2640  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  5308							 ; 6 - признак immediate. 5- слово не описано smudge
1  5309	2641  49 44			     DB	 'ID'
1  5310	2643  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  5311
1  5312	2644  2612r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5313	      =ARRAY:2640		     LINK=LINK$
1  5314
1  5315	2646				     IDDOT LABEL FAR  ;	CFA
1  5316	2646  1F73r			     DW	$COL
   5317					     ; печатает	  имя	слова
   5318	2648  235Er 0FD4r 001F	  +		  DW  COUNT,LIT,37Q,$AND,$TYPE,SPACE,SEMI
   5319	      17F9r 2371r 225Ar	  +
   5320	      18DBr
   5321
   5322						  HEAD	  86h,'CREAT',305Q,CREAT,$COL	      ;	CREATE
1  5323	      =ARRAY:2656		     LINK$=$
1  5324	2656  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  5325							 ; 6 - признак immediate. 5- слово не описано smudge
1  5326	2657  43 52 45 41 54		     DB	 'CREAT'
1  5327	265C  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  5328
1  5329	265D  2640r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5330	      =ARRAY:2656		     LINK=LINK$
1  5331
1  5332	265F				     CREAT LABEL FAR  ;	CFA
1  5333	265F  1F73r			     DW	$COL
   5334					     ; - --> адр XXX (I, C)
   5335					     ; формирование новых слов - описателей.
   5336					     ; (CREATE XXX DOES>) XXX исполняется на этапе компиляции,
   5337					     ; текст программы,	следующий за DOES>, адрес которого
   5338					     ; помещается в PFA	- на этапе исполнения.
   5339	2661  24C9r 101Br 0010	  +		  DW  DFIND,ZBRAN,CRE-$,DROP,TWOP,NFA,IDDOT
   5340	      1B2Dr 15E9r 1CE1r	  +
   5341	      2646r
   5342	266F  0FD4r 0004 29BFr			  DW  LIT,4,MESS	     ; сообщение о повторном определении слова
   5343	2675  1D4Dr 1A64r 1C8Br	  +	CRE:	  DW  HERE,DUBL,CAT,$WIDTH,AT,MIN,ONEP,ALLOT ; here указывает на число символов	слова
   5344	      20BFr 1C4Er 1854r	  +
   5345	      15CEr 1D6Br
   5346										     ; сдвигаем	here на	длину слова + сам байт длины
   5347	2685  1A64r 0FD4r 00A0	  +		  DW  DUBL,LIT,240Q,TOGL,HERE,ONEM   ; выключаем из поиска
   5348	      1C33r 1D4Dr 1606r
   5349										 ; 240Q	= 10100000
   5350	2691  0FD4r 0080 1C33r	  +		  DW  LIT,200Q,TOGL,LATES,COMMA,CURR,AT,STORE ;	в последней букве слова	включаем 7  +
   5351	      1E47r 2235r 2168r	  +  бит
   5352	      1C4Er 1CA8r
   5353										 ; ссылка на пред слово	и сохраняем ссылку на вновь
   5354										 ; созданное слово
   5355	26A1  1D4Dr 15E9r 2235r	  +		  DW  HERE,TWOP,COMMA,SEMI	 ; в CFA пишем адрес PFA
   5356	      18DBr
   5357						  HEAD	  311Q,'[COMPILE',335Q,BCOM,$COL       ; [COMPILE]
1  5358	      =ARRAY:26A9		     LINK$=$
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 95
forth.asm



1  5359	26A9  C9			     DB	 311Q  ; NFA 7 бит равен 1.
1  5360							 ; 6 - признак immediate. 5- слово не описано smudge
1  5361	26AA  5B 43 4F 4D 50 49	4C+	     DB	 '[COMPILE'
   5362	      45
1  5363	26B2  DD			     DB	 335Q	; последний символ слова + 128 (7 бит =	1).
1  5364
1  5365	26B3  2656r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5366	      =ARRAY:26A9		     LINK=LINK$
1  5367
1  5368	26B5				     BCOM LABEL	FAR  ; CFA
1  5369	26B5  1F73r			     DW	$COL
   5370					     ; Используется в описании типа двоеточия и	служит для
   5371						     ; компиляции слова	немедленного действия XXX, как если бы оно
   5372					     ; не было таким. Слово XXX	будет исполнено	тогда, когда будет
   5373					     ; исполнено слово,	в котором использована комбинация [COMPILE] XXX
   5374					     ; кладет в	словарь	CFA компилируемого слова
   5375	26B7  24C9r 1169r 205Cr	  +		  DW  DFIND,ZEQU,ZERO,QERR,DROP,COMMA,SEMI
   5376	      227Cr 1B2Dr 2235r	  +
   5377	      18DBr
   5378
   5379						 HEAD	 307Q,'LITERA',314Q,LITER,$COL	      ;	LITERAL
1  5380	      =ARRAY:26C5		     LINK$=$
1  5381	26C5  C7			     DB	 307Q  ; NFA 7 бит равен 1.
1  5382							 ; 6 - признак immediate. 5- слово не описано smudge
1  5383	26C6  4C 49 54 45 52 41		     DB	 'LITERA'
1  5384	26CC  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  5385
1  5386	26CD  26A9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5387	      =ARRAY:26C5		     LINK=LINK$
1  5388
1  5389	26CF				     LITER LABEL FAR  ;	CFA
1  5390	26CF  1F73r			     DW	$COL
   5391					 ; компилирует число в словарь
   5392	26D1  2174r 1C4Er 101Br	  +		 DW  STATE,AT,ZBRAN,LIL-$	; в режиме исполнения ничего не	делает
   5393	      0008
   5394	26D9  2309r 0FD4r 2235r			 DW  COMP,LIT,COMMA
   5395	26DF  18DBr			 LIL:	 DW  SEMI
   5396
   5397						  HEAD	  310Q,'DLITERA',314Q,DLITE,$COL       ; DLITERAL
1  5398	      =ARRAY:26E1		     LINK$=$
1  5399	26E1  C8			     DB	 310Q  ; NFA 7 бит равен 1.
1  5400							 ; 6 - признак immediate. 5- слово не описано smudge
1  5401	26E2  44 4C 49 54 45 52	41	     DB	 'DLITERA'
1  5402	26E9  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  5403
1  5404	26EA  26C5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5405	      =ARRAY:26E1		     LINK=LINK$
1  5406
1  5407	26EC				     DLITE LABEL FAR  ;	CFA
1  5408	26EC  1F73r			     DW	$COL
   5409					 ; компилирует в словарь двойное число
   5410	26EE  2174r 1C4Er 101Br	  +		  DW  STATE,AT,ZBRAN,DLI-$
   5411	      0008
   5412	26F6  1A18r 26CFr 26CFr			 DW  SWAP,LITER,LITER
   5413	26FC  18DBr			DLI:	  DW  SEMI
   5414
   5415						  HEAD	  86h,'?STAC',313Q,QSTAC,$COL	      ;	?STACK
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 96
forth.asm



1  5416	      =ARRAY:26FE		     LINK$=$
1  5417	26FE  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  5418							 ; 6 - признак immediate. 5- слово не описано smudge
1  5419	26FF  3F 53 54 41 43		     DB	 '?STAC'
1  5420	2704  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  5421
1  5422	2705  26E1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5423	      =ARRAY:26FE		     LINK=LINK$
1  5424
1  5425	2707				     QSTAC LABEL FAR  ;	CFA
1  5426	2707  1F73r			     DW	$COL
   5427					 ; -> f	, true если значение указателя стека в пределах	допусков
   5428	2709  20A0r 1C4Er 1D11r	  +		  DW  SZERO,AT,CFA,SPAT,ULESS,ONE,QERR
   5429	      1896r 11FDr 2064r	  +
   5430	      227Cr
   5431	2717  0FD4r FF80 1896r	  +		  DW  LIT,-200Q,SPAT,ULESS,TWO
   5432	      11FDr 206Cr
   5433	2721  227Cr 18DBr			  DW  QERR, SEMI
   5434
   5435						  HEAD	  211Q,'INTERPRE',324Q,INTER,$COL      ; INTERPRET
1  5436	      =ARRAY:2725		     LINK$=$
1  5437	2725  89			     DB	 211Q  ; NFA 7 бит равен 1.
1  5438							 ; 6 - признак immediate. 5- слово не описано smudge
1  5439	2726  49 4E 54 45 52 50	52+	     DB	 'INTERPRE'
   5440	      45
1  5441	272E  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  5442
1  5443	272F  26FEr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5444	      =ARRAY:2725		     LINK=LINK$
1  5445
1  5446	2731				     INTER LABEL FAR  ;	CFA
1  5447	2731  1F73r			     DW	$COL
   5448	2733  24C9r 101Br 0018		IT1:	  DW  DFIND,ZBRAN,IT3-$	; переход если не найдено
   5449	2739  2174r 1C4Er 120Cr	  +		  DW  STATE,AT,LESS, ZBRAN,IT2-$ ; выполнить
   5450	      101Br 0008
   5451	2743  2235r 1040r 0020			  DW  COMMA,BRAN,IT5-$
   5452	2749  0FC9r 1040r 001A		IT2:	  DW  EXEC,BRAN,IT5-$
   5453	274F  1D4Dr 24F8r 2189r	  +	IT3:	  DW  HERE,NUMB,DPL,AT,ONEP,ZBRAN,IT4-$
   5454	      1C4Er 15CEr 101Br	  +
   5455	      0008
   5456	275D  26ECr 1040r 0006			  DW  DLITE,BRAN,IT5-$
   5457	2763  1B2Dr 26CFr		IT4:	  DW  DROP,LITER
   5458	2767  2707r 1040r FFC8		IT5:	  DW  QSTAC,BRAN,IT1-$
   5459
   5460						  HEAD	  211Q,'IMMEDIAT',305Q,IMMED,$COL      ; IMMEDIATE
1  5461	      =ARRAY:276D		     LINK$=$
1  5462	276D  89			     DB	 211Q  ; NFA 7 бит равен 1.
1  5463							 ; 6 - признак immediate. 5- слово не описано smudge
1  5464	276E  49 4D 4D 45 44 49	41+	     DB	 'IMMEDIAT'
   5465	      54
1  5466	2776  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  5467
1  5468	2777  2725r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5469	      =ARRAY:276D		     LINK=LINK$
1  5470
1  5471	2779				     IMMED LABEL FAR  ;	CFA
1  5472	2779  1F73r			     DW	$COL
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 97
forth.asm



   5473					 ; отмечает последнее слово признаком
   5474	277B  1E47r 208Er 1C33r	  +		  DW  LATES,$CL,TOGL,SEMI	 ; cl -	6 бит
   5475	      18DBr
   5476
   5477						 HEAD	 212Q,'VOCABULAR',331Q,VOCAB,$COL     ;	VOCABULARY
1  5478	      =ARRAY:2783		     LINK$=$
1  5479	2783  8A			     DB	 212Q  ; NFA 7 бит равен 1.
1  5480							 ; 6 - признак immediate. 5- слово не описано smudge
1  5481	2784  56 4F 43 41 42 55	4C+	     DB	 'VOCABULAR'
   5482	      41 52
1  5483	278D  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  5484
1  5485	278E  276Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5486	      =ARRAY:2783		     LINK=LINK$
1  5487
1  5488	2790				     VOCAB LABEL FAR  ;	CFA
1  5489	2790  1F73r			     DW	$COL
   5490					 ; создание нового словаря
   5491	2792  234Er 0FD4r A081	  +		 DW  BUILD,LIT,120201Q,COMMA ;
   5492	      2235r
   5493	279A  2168r 1C4Er 1D11r	  +		 DW  CURR,AT,CFA,COMMA
   5494	      2235r
   5495	27A2  1D4Dr 20EDr 1C4Er	  +		 DW  HERE,VOCL,AT,COMMA,VOCL,STORE,DOES
   5496	      2235r 20EDr 1CA8r	  +
   5497	      2020r
   5498	27B0				 DOVOC	 LABEL	  FAR
   5499	27B0  15E9r 215Ar 1CA8r	  +		 DW  TWOP,CONT,STORE,SEMI ; этот код будет в PFA нового	словаря
   5500	      18DBr
   5501									  ; в CFA словаря попадет код $DOE, который
   5502									  ; передает управлению	коду по	адресу PFA
   5503									  ; в стек кладет адрес	PFA+2
   5504
   5505
   5506						  HEAD	  301Q,,250Q,PAREN,$COL		       ; (
1  5507	      =ARRAY:27B8		     LINK$=$
1  5508	27B8  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  5509							 ; 6 - признак immediate. 5- слово не описано smudge
1  5510	27B9  A8			     DB	 250Q	; последний символ слова + 128 (7 бит =	1).
1  5511
1  5512	27BA  2783r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5513	      =ARRAY:27B8		     LINK=LINK$
1  5514
1  5515	27BC				     PAREN LABEL FAR  ;	CFA
1  5516	27BC  1F73r			     DW	$COL
   5517					     ; пропуск до следующей )
   5518	27BE  0FD4r 0029 2438r	  +		  DW  LIT,29h,$WORD,SEMI
   5519	      18DBr
   5520
   5521						  HEAD	  84h,'QUI',324Q,QUIT,$COL	      ;	QUIT
1  5522	      =ARRAY:27C6		     LINK$=$
1  5523	27C6  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5524							 ; 6 - признак immediate. 5- слово не описано smudge
1  5525	27C7  51 55 49			     DB	 'QUI'
1  5526	27CA  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  5527
1  5528	27CB  27B8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5529	      =ARRAY:27C6		     LINK=LINK$
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 98
forth.asm



1  5530
1  5531	27CD				     QUIT LABEL	FAR  ; CFA
1  5532	27CD  1F73r			     DW	$COL
   5533					 ; Очищает оба стека и возвращает управление терминалу.
   5534					 ; Не выдается никаких сообщений
   5535	27CF  205Cr 2122r 1CA8r	  +		  DW  ZERO,BLK,STORE,LBRAC
   5536	      1DAAr
   5537	27D7  18BFr 2221r 23E7r	  +	QUI:	  DW  RPSTO,CR,QUERY,INTER,STATE,AT
   5538	      2731r 2174r 1C4Er
   5539	27E3  1169r 101Br FFF0	  +		  DW  ZEQU,ZBRAN,QUI-$,PDOTQ
   5540	      239Er
   5541	27EB  03 20 4F 4B			  DB  3,' OK'
   5542	27EF  1040r FFE6			  DW  BRAN,QUI-$
   5543
   5544						  HEAD	  85h,'ABOR',324Q,ABORT,$COL	      ;	ABORT
1  5545	      =ARRAY:27F3		     LINK$=$
1  5546	27F3  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5547							 ; 6 - признак immediate. 5- слово не описано smudge
1  5548	27F4  41 42 4F 52		     DB	 'ABOR'
1  5549	27F8  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  5550
1  5551	27F9  27C6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5552	      =ARRAY:27F3		     LINK=LINK$
1  5553
1  5554	27FB				     ABORT LABEL FAR  ;	CFA
1  5555	27FB  1F73r			     DW	$COL
   5556					 ; Прерывает исполнение, делает	словарь	Форт контекстным,
   5557					 ; выполняет QUIT. Распечатывает версию	интерпретатора
   5558	27FD  18A3r 1E06r 2221r	  +		  DW  SPSTO,DECIMA,CR,PDOTQ
   5559	      239Er
   5560	2805  11 46 4F 52 54 48	2D+		  DB  17,'FORTH-PC IS HERE '
   5561	      50 43 20 49 53 20	48+
   5562	      45 52 45 20
   5563	2817  2FA7r 1EC4r 27CDr			  DW  FORTH,DEFIN,QUIT
   5564
   5565						  HEAD	  82h,'S',256Q,SPOT,$COL	      ;	S.
1  5566	      =ARRAY:281D		     LINK$=$
1  5567	281D  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5568							 ; 6 - признак immediate. 5- слово не описано smudge
1  5569	281E  53			     DB	 'S'
1  5570	281F  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  5571
1  5572	2820  27F3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5573	      =ARRAY:281D		     LINK=LINK$
1  5574
1  5575	2822				     SPOT LABEL	FAR  ; CFA
1  5576	2822  1F73r			     DW	$COL
   5577					 ; печать верхнего значения со стека без его изменения
   5578	2824  1A64r 2C9Dr 18DBr			  DW  DUBL,UDOT,SEMI
   5579
   5580						  HEAD	  81h,,252Q,STAR,$COL		      ;	*
1  5581	      =ARRAY:282A		     LINK$=$
1  5582	282A  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  5583							 ; 6 - признак immediate. 5- слово не описано smudge
1  5584	282B  AA			     DB	 252Q	; последний символ слова + 128 (7 бит =	1).
1  5585
1  5586	282C  281Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 99
forth.asm



1  5587	      =ARRAY:282A		     LINK=LINK$
1  5588
1  5589	282E				     STAR LABEL	FAR  ; CFA
1  5590	282E  1F73r			     DW	$COL
   5591	2830  1696r 1B2Dr 18DBr			  DW  MSTAR,DROP,SEMI
   5592
   5593						  HEAD	  84h,'/MO',304Q,SLMOD,$COL	      ;	/MOD
1  5594	      =ARRAY:2836		     LINK$=$
1  5595	2836  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5596							 ; 6 - признак immediate. 5- слово не описано smudge
1  5597	2837  2F 4D 4F			     DB	 '/MO'
1  5598	283A  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  5599
1  5600	283B  282Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5601	      =ARRAY:2836		     LINK=LINK$
1  5602
1  5603	283D				     SLMOD LABEL FAR  ;	CFA
1  5604	283D  1F73r			     DW	$COL
   5605					 ; n1 n2 --- rem quot
   5606	283F  191Ar 1833r 1938r	  +		  DW  TOR,STOD,FROMR,MSLAS,SEMI
   5607	      16FCr 18DBr
   5608
   5609						  HEAD	  81h,,257Q,SLASH,$COL		      ;	/
1  5610	      =ARRAY:2849		     LINK$=$
1  5611	2849  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  5612							 ; 6 - признак immediate. 5- слово не описано smudge
1  5613	284A  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  5614
1  5615	284B  2836r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5616	      =ARRAY:2849		     LINK=LINK$
1  5617
1  5618	284D				     SLASH LABEL FAR  ;	CFA
1  5619	284D  1F73r			     DW	$COL
   5620	284F  283Dr 1A18r 1B2Dr	  +		  DW  SLMOD,SWAP,DROP,SEMI
   5621	      18DBr
   5622
   5623						  HEAD	  83h,'MO',304Q,$MOD,$COL	      ;	MOD
1  5624	      =ARRAY:2857		     LINK$=$
1  5625	2857  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  5626							 ; 6 - признак immediate. 5- слово не описано smudge
1  5627	2858  4D 4F			     DB	 'MO'
1  5628	285A  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  5629
1  5630	285B  2849r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5631	      =ARRAY:2857		     LINK=LINK$
1  5632
1  5633	285D				     $MOD LABEL	FAR  ; CFA
1  5634	285D  1F73r			     DW	$COL
   5635	285F  283Dr 1B2Dr 18DBr			  DW  SLMOD,DROP,SEMI
   5636
   5637						  HEAD	  85h,'*/MO',304Q,SSMOD,$COL	      ;. */MOD
1  5638	      =ARRAY:2865		     LINK$=$
1  5639	2865  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5640							 ; 6 - признак immediate. 5- слово не описано smudge
1  5641	2866  2A 2F 4D 4F		     DB	 '*/MO'
1  5642	286A  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  5643
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 100
forth.asm



1  5644	286B  2857r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5645	      =ARRAY:2865		     LINK=LINK$
1  5646
1  5647	286D				     SSMOD LABEL FAR  ;	CFA
1  5648	286D  1F73r			     DW	$COL
   5649					 ; u1 u2 u3 -->	u-rem u-result
   5650					 ; u1*u2/u3 - остаток и	частное, u1 u2 - 32-разрядное число
   5651
   5652	286F  191Ar 1696r 1938r	  +		  DW  TOR,MSTAR,FROMR,MSLAS,SEMI
   5653	      16FCr 18DBr
   5654
   5655						  HEAD	  82h,'*',257Q,SSLA,$COL	      ;	*/
1  5656	      =ARRAY:2879		     LINK$=$
1  5657	2879  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5658							 ; 6 - признак immediate. 5- слово не описано smudge
1  5659	287A  2A			     DB	 '*'
1  5660	287B  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  5661
1  5662	287C  2865r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5663	      =ARRAY:2879		     LINK=LINK$
1  5664
1  5665	287E				     SSLA LABEL	FAR  ; CFA
1  5666	287E  1F73r			     DW	$COL
   5667	2880  286Dr 1A18r 1B2Dr	  +		  DW  SSMOD,SWAP,DROP,SEMI
   5668	      18DBr
   5669
   5670						  HEAD	  85h,'M/MO',304Q,MSMOD,$COL	      ;	M/MOD
1  5671	      =ARRAY:2888		     LINK$=$
1  5672	2888  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5673							 ; 6 - признак immediate. 5- слово не описано smudge
1  5674	2889  4D 2F 4D 4F		     DB	 'M/MO'
1  5675	288D  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  5676
1  5677	288E  2879r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5678	      =ARRAY:2888		     LINK=LINK$
1  5679
1  5680	2890				     MSMOD LABEL FAR  ;	CFA
1  5681	2890  1F73r			     DW	$COL
   5682	2892  191Ar 205Cr 1955r	  +		  DW  TOR,ZERO,I,USLAS,FROMR,SWAP,TOR,USLAS
   5683	      1677r 1938r 1A18r	  +
   5684	      191Ar 1677r
   5685	28A2  1938r 18DBr		$MO:	  DW  FROMR,SEMI
   5686
   5687						  HEAD	  215Q,'EMPTY-BUFFER',323Q,MTBUF,$COL  ;EMPTY-BUFFERS
1  5688	      =ARRAY:28A6		     LINK$=$
1  5689	28A6  8D			     DB	 215Q  ; NFA 7 бит равен 1.
1  5690							 ; 6 - признак immediate. 5- слово не описано smudge
1  5691	28A7  45 4D 50 54 59 2D	42+	     DB	 'EMPTY-BUFFER'
   5692	      55 46 46 45 52
1  5693	28B3  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  5694
1  5695	28B4  2888r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5696	      =ARRAY:28A6		     LINK=LINK$
1  5697
1  5698	28B6				     MTBUF LABEL FAR  ;	CFA
1  5699	28B6  1F73r			     DW	$COL
   5700	28B8  20F9r 1C4Er 0FD4r	  +		  DW  FIRST,AT,LIT,0C12h,ERASE,SEMI   ;	3084 было
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 101
forth.asm



   5701	      0C12 1BBBr 18DBr
   5702
   5703						  HEAD	  85h,'FLUS',310Q,FLUSH,$COL	      ;	FLUSH
1  5704	      =ARRAY:28C4		     LINK$=$
1  5705	28C4  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5706							 ; 6 - признак immediate. 5- слово не описано smudge
1  5707	28C5  46 4C 55 53		     DB	 'FLUS'
1  5708	28C9  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1  5709
1  5710	28CA  28A6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5711	      =ARRAY:28C4		     LINK=LINK$
1  5712
1  5713	28CC				     FLUSH LABEL FAR  ;	CFA
1  5714	28CC  1F73r			     DW	$COL
   5715					 ; запись буферов на диск
   5716	28CE  2105r 1C4Er 20F9r	  +		  DW  LIMIT,AT,FIRST,AT,XDO
   5717	      1C4Er 105Cr
   5718	28D8  1955r 1C4Er 11BEr	  +	FLU:	  DW  I,AT,ZLESS,ZBRAN,FL1-$
   5719	      101Br 000E
   5720	28E2  1955r 15E9r 1955r	  +		  DW  I,TWOP,I,X,ZERO, RW
   5721	      1F41r 205Cr 2F01r
   5722	28EE  0FD4r 0404 10B3r	  +	FL1:	  DW  LIT,1028,XPLOO,FLU-$,MTBUF,SEMI
   5723	      FFE4 28B6r 18DBr
   5724
   5725						  HEAD	  86h,'BUFFE',322Q,BUFFE,$COL	      ;	BUFFER
1  5726	      =ARRAY:28FA		     LINK$=$
1  5727	28FA  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  5728							 ; 6 - признак immediate. 5- слово не описано smudge
1  5729	28FB  42 55 46 46 45		     DB	 'BUFFE'
1  5730	2900  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  5731
1  5732	2901  28C4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5733	      =ARRAY:28FA		     LINK=LINK$
1  5734
1  5735	2903				     BUFFE LABEL FAR  ;	CFA
1  5736	2903  1F73r			     DW	$COL
   5737					 ; u --> адр  Резервирует блок в памяти, приписывает ему
   5738					 ; номер u, но никакого	чтения с носителя не производится
   5739	2905  21B0r 1C4Er 191Ar	  +		  DW  USE,AT,TOR,I	 ; адрес буфера	в стеках
   5740	      1955r
   5741	290D  1EE4r 101Br FFFC		BR1:	  DW  PBUF,ZBRAN,BR1-$	 ; ищем	свободный буфер
   5742	2913  21B0r 1CA8r			 DW USE,STORE		 ; полученный адрес сохранить в	USE
   5743	2917  1955r 1C4Er 11BEr	  +		  DW  I,AT,ZLESS,ZBRAN,BR2-$ ; если buffer изменен,
   5744	      101Br 000E
   5745	2921  1955r 15E9r 1955r	  +		  DW  I,TWOP,I,X,ZERO, RW    ; то запись его на	диск
   5746	      1F41r 205Cr 2F01r
   5747	292D  1955r 1CA8r 1955r	  +	BR2:	  DW  I,STORE,I,PREV,STORE   ; номер буфера записать и адрес сохранить в PREV
   5748	      21BBr 1CA8r
   5749	2937  1938r 15E9r 18DBr			 DW FROMR,TWOP,SEMI	     ; возвращаемое значение
   5750
   5751						  HEAD	  85h,'BLOC',313Q,BLOCK,$COL	      ;	BLOCK
1  5752	      =ARRAY:293D		     LINK$=$
1  5753	293D  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5754							 ; 6 - признак immediate. 5- слово не описано smudge
1  5755	293E  42 4C 4F 43		     DB	 'BLOC'
1  5756	2942  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  5757
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 102
forth.asm



1  5758	2943  28FAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5759	      =ARRAY:293D		     LINK=LINK$
1  5760
1  5761	2945				     BLOCK LABEL FAR  ;	CFA
1  5762	2945  1F73r			     DW	$COL
   5763					 ;   u --> адр	Записывает в стек адрес	первого	байта в	блоке с
   5764					 ;   номером u.	Если блок не находится в памяти, он переносится	с носителя
   5765	2947  214Cr 1C4Er 171Ar	  +		  DW  OFSET,AT,PLUS,TOR
   5766	      191Ar
   5767	294F  21BBr 1C4Er 1A64r	  +		  DW  PREV,AT,DUBL,X,I,SUBB,ZBRAN,BLC-$
   5768	      1F41r 1955r 1736r	  +
   5769	      101Br 002E
   5770	295F  1EE4r 1169r 101Br	  +	BLO:	  DW  PBUF,ZEQU,ZBRAN,BCK-$
   5771	      0012
   5772	2967  1B2Dr 1955r 2903r	  +		  DW  DROP,I,BUFFE,DUBL,I,ONE,RW,CFA
   5773	      1A64r 1955r 2064r	  +
   5774	      2F01r 1D11r
   5775	2977  1A64r 1F41r 1955r	  +	BCK:	  DW  DUBL,X,I,SUBB,ZEQU
   5776	      1736r 1169r
   5777	2981  101Br FFDC 1A64r	  +		  DW  ZBRAN,BLO-$,DUBL,PREV,STORE
   5778	      21BBr 1CA8r
   5779	298B  1938r 1B2Dr 15E9r	  +	BLC:	  DW  FROMR,DROP,TWOP,SEMI
   5780	      18DBr
   5781
   5782						  HEAD	  85h,'.LIN',305Q,DLINE,$COL	      ;	.LINE
1  5783	      =ARRAY:2993		     LINK$=$
1  5784	2993  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5785							 ; 6 - признак immediate. 5- слово не описано smudge
1  5786	2994  2E 4C 49 4E		     DB	 '.LIN'
1  5787	2998  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  5788
1  5789	2999  293Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5790	      =ARRAY:2993		     LINK=LINK$
1  5791
1  5792	299B				     DLINE LABEL FAR  ;	CFA
1  5793	299B  1F73r			     DW	$COL
   5794					 ; строка номер_экрана -- печать строки	из экрана
   5795	299D  191Ar 208Er 2097r	  +		  DW  TOR,$CL,BBUF,SSMOD ; строка*64/1024
   5796	      286Dr
   5797	29A5  1938r 171Ar 2945r			  DW  FROMR,PLUS,BLOCK	 ; номер_экрана	+ частное
   5798	29AB  171Ar				  DW  PLUS	     ; остаток+	адрес_блока (нужная строка)
   5799	29AD  208Er 1E68r 2371r	  +		  DW  $CL,DTRAI,$TYPE,SEMI ; 64	- число	пробелов (число	символов в строке)
   5800	      18DBr
   5801
   5802						  HEAD	  87h,'MESSAG',305Q,MESS,$COL	      ;	MESSAGE
1  5803	      =ARRAY:29B5		     LINK$=$
1  5804	29B5  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  5805							 ; 6 - признак immediate. 5- слово не описано smudge
1  5806	29B6  4D 45 53 53 41 47		     DB	 'MESSAG'
1  5807	29BC  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  5808
1  5809	29BD  2993r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5810	      =ARRAY:29B5		     LINK=LINK$
1  5811
1  5812	29BF				     MESS LABEL	FAR  ; CFA
1  5813	29BF  1F73r			     DW	$COL
   5814	29C1  212Br 1C4Er 219Cr	  +		  DW  $IN,AT,RNUM,STORE	; сохранить значение $in
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 103
forth.asm



   5815	      1CA8r
   5816	29C9  20CDr 1C4Er 101Br	  +		  DW  $WARN,AT,ZBRAN,MS1-$ ; нужен ли текст сообщения
   5817	      0016
   5818	29D1  1A81r 101Br 000E			  DW  DDUP,ZBRAN,MES-$
   5819	29D7  0FD4r 0004 214Cr	  +		  DW  LIT,4,OFSET,AT,SUBB,DLINE	; текстовые сообщения на 4 экране
   5820	      1C4Er 1736r 299Br
   5821	29E3  18DBr			MES:	  DW  SEMI
   5822	29E5  239Er			MS1:	  DW  PDOTQ
   5823	29E7  06 4D 53 47 20 23	20		  DB  6,'MSG # '
   5824	29EE  2C84r 18DBr			  DW $DOT,SEMI
   5825
   5826						  HEAD	  84h,'LOA',304Q,LOA,$COL	     ; LOAD
1  5827	      =ARRAY:29F2		     LINK$=$
1  5828	29F2  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5829							 ; 6 - признак immediate. 5- слово не описано smudge
1  5830	29F3  4C 4F 41			     DB	 'LOA'
1  5831	29F6  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  5832
1  5833	29F7  29B5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5834	      =ARRAY:29F2		     LINK=LINK$
1  5835
1  5836	29F9				     LOA LABEL FAR  ; CFA
1  5837	29F9  1F73r			     DW	$COL
   5838					 ; n ->	номер экрана
   5839	29FB  2122r 1C4Er 212Br	  +		  DW  BLK,AT,$IN,AT,ZERO,$IN,STORE,ROT,BLK
   5840	      1C4Er 205Cr 212Br	  +
   5841	      1CA8r 1AB1r 2122r
   5842	2A0D  1CA8r 2731r 212Br	  +		  DW  STORE,INTER,$IN,STORE,BLK,STORE,SEMI
   5843	      1CA8r 2122r 1CA8r	  +
   5844	      18DBr
   5845
   5846						  HEAD	  303Q,'--',276Q,ARROW,$COL	       ; -->
1  5847	      =ARRAY:2A1B		     LINK$=$
1  5848	2A1B  C3			     DB	 303Q  ; NFA 7 бит равен 1.
1  5849							 ; 6 - признак immediate. 5- слово не описано smudge
1  5850	2A1C  2D 2D			     DB	 '--'
1  5851	2A1E  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1  5852
1  5853	2A1F  29F2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5854	      =ARRAY:2A1B		     LINK=LINK$
1  5855
1  5856	2A21				     ARROW LABEL FAR  ;	CFA
1  5857	2A21  1F73r			     DW	$COL
   5858					 ; згрузка следующего экрана
   5859	2A23  22EFr 205Cr 212Br	  +		  DW  QLOAD,ZERO,$IN,STORE,ONE
   5860	      1CA8r 2064r
   5861	2A2D  2122r 1BF9r 18DBr			  DW  BLK,PSTOR,SEMI
   5862
   5863						  HEAD	  301Q,,247Q,TICK,$COL		       ; '
1  5864	      =ARRAY:2A33		     LINK$=$
1  5865	2A33  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  5866							 ; 6 - признак immediate. 5- слово не описано smudge
1  5867	2A34  A7			     DB	 247Q	; последний символ слова + 128 (7 бит =	1).
1  5868
1  5869	2A35  2A1Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5870	      =ARRAY:2A33		     LINK=LINK$
1  5871
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 104
forth.asm



1  5872	2A37				     TICK LABEL	FAR  ; CFA
1  5873	2A37  1F73r			     DW	$COL
   5874					 ; Ищет	слово XXX в словаре и записывает в стек	его PFA
   5875	2A39  24C9r 1169r 205Cr	  +		  DW  DFIND,ZEQU,ZERO,QERR,DROP,TWOP,LITER,SEMI
   5876	      227Cr 1B2Dr 15E9r	  +
   5877	      26CFr 18DBr
   5878
   5879						  HEAD	  86h,'FORGE',324Q,FORGE,$COL	      ;	FORGET
1  5880	      =ARRAY:2A49		     LINK$=$
1  5881	2A49  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  5882							 ; 6 - признак immediate. 5- слово не описано smudge
1  5883	2A4A  46 4F 52 47 45		     DB	 'FORGE'
1  5884	2A4F  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  5885
1  5886	2A50  2A33r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5887	      =ARRAY:2A49		     LINK=LINK$
1  5888
1  5889	2A52				     FORGE LABEL FAR  ;	CFA
1  5890	2A52  1F73r			     DW	$COL
   5891	2A54  2168r 1C4Er 215Ar	  +		  DW  CURR,AT,CONT,AT,SUBB,LIT,30Q,QERR	    ; 24 ошибка	не описана
   5892	      1C4Er 1736r 0FD4r	  +
   5893	      0018 227Cr
   5894											     ; ошибка если CURRENT = CONTEXT
   5895	2A64  2A37r 1A64r 20D9r	  +		  DW  TICK,DUBL,FENCE,AT,ULESS,LIT,25Q,QERR  ; 21 слово	защищено
   5896	      1C4Er 11FDr 0FD4r	  +
   5897	      0015 227Cr
   5898	2A74  1A64r 1CE1r 20E2r	  +		  DW  DUBL,NFA,$DP,STORE		    ; словарь свободен до указаного слова
   5899	      1CA8r
   5900	2A7C  1CF3r 1C4Er 215Ar	  +		  DW  LFA,AT,CONT,AT,STORE,SEMI		    ; в	переменную context пишем адрес
   5901	      1C4Er 1CA8r 18DBr
   5902										     ; значение	LFA забываемого	слова
   5903
   5904						  HEAD	  84h,'BAC',313Q,BACK,$COL	      ;	BACK
1  5905	      =ARRAY:2A88		     LINK$=$
1  5906	2A88  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5907							 ; 6 - признак immediate. 5- слово не описано smudge
1  5908	2A89  42 41 43			     DB	 'BAC'
1  5909	2A8C  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  5910
1  5911	2A8D  2A49r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5912	      =ARRAY:2A88		     LINK=LINK$
1  5913
1  5914	2A8F				     BACK LABEL	FAR  ; CFA
1  5915	2A8F  1F73r			     DW	$COL
   5916					 ; HERE	- , ; (компилирует в описание слова адрес возврата)
   5917	2A91  1D4Dr 1736r 2235r	  +		  DW  HERE,SUBB,COMMA,SEMI
   5918	      18DBr
   5919
   5920						  HEAD	  305Q,'BEGI',316Q,BEGIN,$COL	       ; BEGIN
1  5921	      =ARRAY:2A99		     LINK$=$
1  5922	2A99  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  5923							 ; 6 - признак immediate. 5- слово не описано smudge
1  5924	2A9A  42 45 47 49		     DB	 'BEGI'
1  5925	2A9E  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  5926
1  5927	2A9F  2A88r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5928	      =ARRAY:2A99		     LINK=LINK$
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 105
forth.asm



1  5929
1  5930	2AA1				     BEGIN LABEL FAR  ;	CFA
1  5931	2AA1  1F73r			     DW	$COL
   5932					 ; BEGIN ... UNTIL
   5933					 ; BEGIN ... AGAIN
   5934					 ; BEGIN ... WHILE ... REPEAT
   5935	2AA3  2294r 1D4Dr 2064r	  +		  DW  QCOMP,HERE,ONE,SEMI
   5936	      18DBr
   5937
   5938						  HEAD	  302Q,'D',317Q,$DO,$COL	       ; DO
1  5939	      =ARRAY:2AAB		     LINK$=$
1  5940	2AAB  C2			     DB	 302Q  ; NFA 7 бит равен 1.
1  5941							 ; 6 - признак immediate. 5- слово не описано smudge
1  5942	2AAC  44			     DB	 'D'
1  5943	2AAD  CF			     DB	 317Q	; последний символ слова + 128 (7 бит =	1).
1  5944
1  5945	2AAE  2A99r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5946	      =ARRAY:2AAB		     LINK=LINK$
1  5947
1  5948	2AB0				     $DO LABEL FAR  ; CFA
1  5949	2AB0  1F73r			     DW	$COL
   5950	2AB2  2309r 105Cr 1D4Dr	  +		  DW  COMP,XDO,HERE,THREE,SEMI
   5951	      2074r 18DBr
   5952
   5953						  HEAD	  304Q,'LOO',320Q,LOO,$COL	      ;	LOOP
1  5954	      =ARRAY:2ABC		     LINK$=$
1  5955	2ABC  C4			     DB	 304Q  ; NFA 7 бит равен 1.
1  5956							 ; 6 - признак immediate. 5- слово не описано smudge
1  5957	2ABD  4C 4F 4F			     DB	 'LOO'
1  5958	2AC0  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  5959
1  5960	2AC1  2AABr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5961	      =ARRAY:2ABC		     LINK=LINK$
1  5962
1  5963	2AC3				     LOO LABEL FAR  ; CFA
1  5964	2AC3  1F73r			     DW	$COL
   5965	2AC5  2074r 22C2r 2309r	  +		  DW  THREE,QPAIR,COMP,XLOOP,BACK,SEMI
   5966	      1085r 2A8Fr 18DBr
   5967
   5968						  HEAD	  305Q,'+LOO',320Q,PLOOP,$COL	       ; +LOOP
1  5969	      =ARRAY:2AD1		     LINK$=$
1  5970	2AD1  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  5971							 ; 6 - признак immediate. 5- слово не описано smudge
1  5972	2AD2  2B 4C 4F 4F		     DB	 '+LOO'
1  5973	2AD6  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  5974
1  5975	2AD7  2ABCr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5976	      =ARRAY:2AD1		     LINK=LINK$
1  5977
1  5978	2AD9				     PLOOP LABEL FAR  ;	CFA
1  5979	2AD9  1F73r			     DW	$COL
   5980	2ADB  2074r 22C2r 2309r	  +		  DW  THREE,QPAIR,COMP,XPLOO,BACK,SEMI
   5981	      10B3r 2A8Fr 18DBr
   5982
   5983						  HEAD	  305Q,'UNTI',314Q,UNTIL,$COL	       ; UNTIL
1  5984	      =ARRAY:2AE7		     LINK$=$
1  5985	2AE7  C5			     DB	 305Q  ; NFA 7 бит равен 1.
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 106
forth.asm



1  5986							 ; 6 - признак immediate. 5- слово не описано smudge
1  5987	2AE8  55 4E 54 49		     DB	 'UNTI'
1  5988	2AEC  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  5989
1  5990	2AED  2AD1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5991	      =ARRAY:2AE7		     LINK=LINK$
1  5992
1  5993	2AEF				     UNTIL LABEL FAR  ;	CFA
1  5994	2AEF  1F73r			     DW	$COL
   5995	2AF1  2064r 22C2r 2309r	  +		  DW  ONE,QPAIR,COMP,ZBRAN,BACK,SEMI
   5996	      101Br 2A8Fr 18DBr
   5997
   5998						 HEAD	 305Q,'AGAI','N'+80h,AGAIN,$COL	       ; AGAIN sds
1  5999	      =ARRAY:2AFD		     LINK$=$
1  6000	2AFD  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  6001							 ; 6 - признак immediate. 5- слово не описано smudge
1  6002	2AFE  41 47 41 49		     DB	 'AGAI'
1  6003	2B02  CE			     DB	 'N'+80h   ; последний символ слова + 128 (7 бит = 1).
1  6004
1  6005	2B03  2AE7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6006	      =ARRAY:2AFD		     LINK=LINK$
1  6007
1  6008	2B05				     AGAIN LABEL FAR  ;	CFA
1  6009	2B05  1F73r			     DW	$COL
   6010	2B07  2064r 22C2r 2309r	  +		 DW  ONE,QPAIR,COMP,BRAN,BACK,SEMI
   6011	      1040r 2A8Fr 18DBr
   6012
   6013						  HEAD	  305Q,'WHIL',305Q,$WHILE,$COL	       ; WHILE
1  6014	      =ARRAY:2B13		     LINK$=$
1  6015	2B13  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  6016							 ; 6 - признак immediate. 5- слово не описано smudge
1  6017	2B14  57 48 49 4C		     DB	 'WHIL'
1  6018	2B18  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  6019
1  6020	2B19  2AFDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6021	      =ARRAY:2B13		     LINK=LINK$
1  6022
1  6023	2B1B				     $WHILE LABEL FAR  ; CFA
1  6024	2B1B  1F73r			     DW	$COL
   6025	2B1D  2B43r 18DBr			  DW  $IF,SEMI
   6026
   6027						  HEAD	  306Q,'REPEA',324Q,REPEA,$COL	      ;	REPEAT
1  6028	      =ARRAY:2B21		     LINK$=$
1  6029	2B21  C6			     DB	 306Q  ; NFA 7 бит равен 1.
1  6030							 ; 6 - признак immediate. 5- слово не описано smudge
1  6031	2B22  52 45 50 45 41		     DB	 'REPEA'
1  6032	2B27  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  6033
1  6034	2B28  2B13r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6035	      =ARRAY:2B21		     LINK=LINK$
1  6036
1  6037	2B2A				     REPEA LABEL FAR  ;	CFA
1  6038	2B2A  1F73r			     DW	$COL
   6039	2B2C  1AB1r 2064r 22C2r	  +		  DW  ROT,ONE,QPAIR,ROT,COMP,BRAN,BACK
   6040	      1AB1r 2309r 1040r	  +
   6041	      2A8Fr
   6042	2B3A  2B7Br 18DBr			  DW  THEN,SEMI
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 107
forth.asm



   6043
   6044						  HEAD	  302Q,'I',306Q,$IF,$COL	       ; IF
1  6045	      =ARRAY:2B3E		     LINK$=$
1  6046	2B3E  C2			     DB	 302Q  ; NFA 7 бит равен 1.
1  6047							 ; 6 - признак immediate. 5- слово не описано smudge
1  6048	2B3F  49			     DB	 'I'
1  6049	2B40  C6			     DB	 306Q	; последний символ слова + 128 (7 бит =	1).
1  6050
1  6051	2B41  2B21r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6052	      =ARRAY:2B3E		     LINK=LINK$
1  6053
1  6054	2B43				     $IF LABEL FAR  ; CFA
1  6055	2B43  1F73r			     DW	$COL
   6056	2B45  2309r 101Br 1D4Dr	  +		  DW  COMP,ZBRAN,HERE,ZERO,COMMA,TWO,SEMI
   6057	      205Cr 2235r 206Cr	  +
   6058	      18DBr
   6059
   6060						  HEAD	  304Q,'ELS',305Q,$ELSE,$COL	       ; ELSE
1  6061	      =ARRAY:2B53		     LINK$=$
1  6062	2B53  C4			     DB	 304Q  ; NFA 7 бит равен 1.
1  6063							 ; 6 - признак immediate. 5- слово не описано smudge
1  6064	2B54  45 4C 53			     DB	 'ELS'
1  6065	2B57  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  6066
1  6067	2B58  2B3Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6068	      =ARRAY:2B53		     LINK=LINK$
1  6069
1  6070	2B5A				     $ELSE LABEL FAR  ;	CFA
1  6071	2B5A  1F73r			     DW	$COL
   6072	2B5C  206Cr 22C2r 2309r			  DW  TWO,QPAIR,COMP
   6073	2B62  1040r 1D4Dr 205Cr	  +		  DW  BRAN,HERE,ZERO,COMMA   ; если исполнение пришло к	этому BRAN
   6074	      2235r
   6075									     ; значит была выполнена ветка TRUE	и
   6076									     ; надо перепрыгнуть ветку FALSE (безусловно)
   6077	2B6A  1A18r 206Cr 2B7Br	  +		  DW  SWAP,TWO,THEN,TWO,SEMI ; адреса переходов	меняем местами,	т.к.
   6078	      206Cr 18DBr
   6079									     ; по условию FALSE	должен выполниться
   6080									     ; код после слова ELSE, воспользуемся
   6081									     ; для этого словом	THEN
   6082
   6083						  HEAD	  304Q,'THE',316Q,THEN,$COL	       ; THEN
1  6084	      =ARRAY:2B74		     LINK$=$
1  6085	2B74  C4			     DB	 304Q  ; NFA 7 бит равен 1.
1  6086							 ; 6 - признак immediate. 5- слово не описано smudge
1  6087	2B75  54 48 45			     DB	 'THE'
1  6088	2B78  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  6089
1  6090	2B79  2B53r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6091	      =ARRAY:2B74		     LINK=LINK$
1  6092
1  6093	2B7B				     THEN LABEL	FAR  ; CFA
1  6094	2B7B  1F73r			     DW	$COL
   6095	2B7D  2294r 206Cr 22C2r	  +		  DW  QCOMP,TWO,QPAIR,HERE,OVER,SUBB,SWAP,STORE,SEMI
   6096	      1D4Dr 19F8r 1736r	  +
   6097	      1A18r 1CA8r 18DBr
   6098					 ; if -	step	  cond if true else false then
   6099					     ; DICT:  ?BRANCH 0
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 108
forth.asm



   6100					     ; STACK:  adr_if
   6101					 ; else	- step получается слишком много	кода...	Вроде разобрался! :)
   6102					     ; ?BRANCH 0     BRANCH 0
   6103					     ;	adr_else adr_if
   6104					 ; then	- step
   6105					     ;1	DICT:  ?BRANCH 0
   6106					     ;1	STACK:	adr_if
   6107					     ;2	STACK:	adr_if adr_then
   6108					     ;3	STACK:	adr_if adr_then	 adr_if
   6109					     ;4	STACK:	adr_if (adr_if-adr_then)
   6110					     ;4	STACK:	(adr_if-adr_then) adr_if
   6111					     ;5	DICT:  ?BRANCH [adr_if]=(adr_if-adr_then)
   6112					     ;5	STACK:
   6113
   6114						  HEAD	  86h,'SPACE',323Q,SPACS,$COL	      ;	SPACES
1  6115	      =ARRAY:2B8F		     LINK$=$
1  6116	2B8F  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  6117							 ; 6 - признак immediate. 5- слово не описано smudge
1  6118	2B90  53 50 41 43 45		     DB	 'SPACE'
1  6119	2B95  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  6120
1  6121	2B96  2B74r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6122	      =ARRAY:2B8F		     LINK=LINK$
1  6123
1  6124	2B98				     SPACS LABEL FAR  ;	CFA
1  6125	2B98  1F73r			     DW	$COL
   6126	2B9A  205Cr 1886r 1A81r	  +		  DW  ZERO,MAX,DDUP,ZBRAN,SP1-$,ZERO,XDO
   6127	      101Br 000C 205Cr	  +
   6128	      105Cr
   6129	2BA8  225Ar 1085r FFFC		SPA:	  DW  SPACE,XLOOP,SPA-$
   6130	2BAE  18DBr			SP1:	  DW  SEMI
   6131
   6132						  HEAD	  82h,'<',243Q,BDIGS,$COL	      ;	<# ; sds replace
1  6133	      =ARRAY:2BB0		     LINK$=$
1  6134	2BB0  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  6135							 ; 6 - признак immediate. 5- слово не описано smudge
1  6136	2BB1  3C			     DB	 '<'
1  6137	2BB2  A3			     DB	 243Q	; последний символ слова + 128 (7 бит =	1).
1  6138
1  6139	2BB3  2B8Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6140	      =ARRAY:2BB0		     LINK=LINK$
1  6141
1  6142	2BB5				     BDIGS LABEL FAR  ;	CFA
1  6143	2BB5  1F73r			     DW	$COL
   6144					 ; Начинает процесс преобразования числа в последовательность кодов ASCII.
   6145					 ; Исходное число в стеке должно быть двойной длины без	знака
   6146	2BB7  2425r 21A6r 1CA8r	  +		  DW  PAD,HLD,STORE,SEMI
   6147	      18DBr
   6148
   6149						  HEAD	  82h,'#',276Q,EDIGS,$COL	      ;	#>
1  6150	      =ARRAY:2BBF		     LINK$=$
1  6151	2BBF  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  6152							 ; 6 - признак immediate. 5- слово не описано smudge
1  6153	2BC0  23			     DB	 '#'
1  6154	2BC1  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1  6155
1  6156	2BC2  2BB0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 109
forth.asm



1  6157	      =ARRAY:2BBF		     LINK=LINK$
1  6158
1  6159	2BC4				     EDIGS LABEL FAR  ;	CFA
1  6160	2BC4  1F73r			     DW	$COL
   6161					 ; Завершает преобразование числа. В стеке остается число
   6162					 ; полученных символов и адрес,	как это	требуется для
   6163					 ; оператора TYPE
   6164	2BC6  1B10r 21A6r 1C4Er	  +		  DW  DDROP,HLD,AT,PAD,OVER,SUBB,SEMI
   6165	      2425r 19F8r 1736r	  +
   6166	      18DBr
   6167
   6168						  HEAD	  84h,'SIG',316Q,SIGN,$COL	      ;	SIGN
1  6169	      =ARRAY:2BD4		     LINK$=$
1  6170	2BD4  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  6171							 ; 6 - признак immediate. 5- слово не описано smudge
1  6172	2BD5  53 49 47			     DB	 'SIG'
1  6173	2BD8  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  6174
1  6175	2BD9  2BBFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6176	      =ARRAY:2BD4		     LINK=LINK$
1  6177
1  6178	2BDB				     SIGN LABEL	FAR  ; CFA
1  6179	2BDB  1F73r			     DW	$COL
   6180					 ; Вводит знак "минус" в выходной буфер
   6181	2BDD  1AB1r 11BEr 101Br	  +		  DW  ROT,ZLESS,ZBRAN,SIG-$,LIT,55Q,HOLD
   6182	      0008 0FD4r 002D	  +
   6183	      1BD8r
   6184	2BEB  18DBr			SIG:	  DW  SEMI
   6185
   6186						  HEAD	  81h,,243Q,DIG,$COL		      ;	#
1  6187	      =ARRAY:2BED		     LINK$=$
1  6188	2BED  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  6189							 ; 6 - признак immediate. 5- слово не описано smudge
1  6190	2BEE  A3			     DB	 243Q	; последний символ слова + 128 (7 бит =	1).
1  6191
1  6192	2BEF  2BD4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6193	      =ARRAY:2BED		     LINK=LINK$
1  6194
1  6195	2BF1				     DIG LABEL FAR  ; CFA
1  6196	2BF1  1F73r			     DW	$COL
   6197					 ; Преобразует одну цифру и записывает ее в выходной буфер (PAD),
   6198					 ; выдает цифру	всегда,	если преобразовывать нечего, записывается 0
   6199	2BF3  217Fr 1C4Er 2890r	  +		  DW  BASE,AT,MSMOD,ROT,LIT,11Q,OVER,LESS
   6200	      1AB1r 0FD4r 0009	  +
   6201	      19F8r 120Cr
   6202	2C03  101Br 0008 0FD4r	  +		  DW  ZBRAN,DIGI-$,LIT,7,PLUS
   6203	      0007 171Ar
   6204	2C0D  0FD4r 0030 171Ar	  +	DIGI:	  DW  LIT,60Q,PLUS,HOLD,SEMI
   6205	      1BD8r 18DBr
   6206
   6207						  HEAD	  82h,'#',323Q,DIGS,$COL	      ;	#S
1  6208	      =ARRAY:2C17		     LINK$=$
1  6209	2C17  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  6210							 ; 6 - признак immediate. 5- слово не описано smudge
1  6211	2C18  23			     DB	 '#'
1  6212	2C19  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  6213
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 110
forth.asm



1  6214	2C1A  2BEDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6215	      =ARRAY:2C17		     LINK=LINK$
1  6216
1  6217	2C1C				     DIGS LABEL	FAR  ; CFA
1  6218	2C1C  1F73r			     DW	$COL
   6219					 ; Преобразует число до	тех пор, пока не будет получен 0.
   6220					 ; Одна	цифра выдается в любом случае (0)
   6221	2C1E  2BF1r 1A92r 1816r	  +	DIS:	  DW  DIG,DUP2,$OR,ZEQU,ZBRAN,DIS-$,SEMI
   6222	      1169r 101Br FFF6	  +
   6223	      18DBr
   6224
   6225						  HEAD	  83h,'D.',322Q,DDOTR,$COL	      ;	D.R
1  6226	      =ARRAY:2C2C		     LINK$=$
1  6227	2C2C  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  6228							 ; 6 - признак immediate. 5- слово не описано smudge
1  6229	2C2D  44 2E			     DB	 'D.'
1  6230	2C2F  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  6231
1  6232	2C30  2C17r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6233	      =ARRAY:2C2C		     LINK=LINK$
1  6234
1  6235	2C32				     DDOTR LABEL FAR  ;	CFA
1  6236	2C32  1F73r			     DW	$COL
   6237					 ; s width -> печать двойного числа со знаком с	выравниваем вправо
   6238	2C34  191Ar 1A18r 19F8r	  +		  DW  TOR,SWAP,OVER,DABS,BDIGS,DIGS,SIGN,EDIGS
   6239	      16DDr 2BB5r 2C1Cr	  +
   6240	      2BDBr 2BC4r
   6241	2C44  1938r 19F8r 1736r	  +		  DW  FROMR,OVER,SUBB,SPACS,$TYPE,SEMI
   6242	      2B98r 2371r 18DBr
   6243
   6244						  HEAD	  82h,'.',322Q,DOTR,$COL	      ;	.R
1  6245	      =ARRAY:2C50		     LINK$=$
1  6246	2C50  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  6247							 ; 6 - признак immediate. 5- слово не описано smudge
1  6248	2C51  2E			     DB	 '.'
1  6249	2C52  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  6250
1  6251	2C53  2C2Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6252	      =ARRAY:2C50		     LINK=LINK$
1  6253
1  6254	2C55				     DOTR LABEL	FAR  ; CFA
1  6255	2C55  1F73r			     DW	$COL
   6256					 ; s width -> печать числа со знаком с выравниваем вправо
   6257	2C57  191Ar 1833r 1938r	  +		  DW  TOR,STOD,FROMR,DDOTR,SEMI
   6258	      2C32r 18DBr
   6259
   6260						  HEAD	  83h,'U.',322Q,UDOTR,$COL	      ;	U.R
1  6261	      =ARRAY:2C61		     LINK$=$
1  6262	2C61  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  6263							 ; 6 - признак immediate. 5- слово не описано smudge
1  6264	2C62  55 2E			     DB	 'U.'
1  6265	2C64  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  6266
1  6267	2C65  2C50r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6268	      =ARRAY:2C61		     LINK=LINK$
1  6269
1  6270	2C67				     UDOTR LABEL FAR  ;	CFA
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 111
forth.asm



1  6271	2C67  1F73r			     DW	$COL
   6272					 ; u width -> печать числа без знака с выравниваем вправо
   6273	2C69  205Cr 1A18r 2C32r	  +		  DW  ZERO,SWAP,DDOTR,SEMI
   6274	      18DBr
   6275
   6276						  HEAD	  82h,'D',256Q,DDOT,$COL	      ;	D.
1  6277	      =ARRAY:2C71		     LINK$=$
1  6278	2C71  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  6279							 ; 6 - признак immediate. 5- слово не описано smudge
1  6280	2C72  44			     DB	 'D'
1  6281	2C73  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  6282
1  6283	2C74  2C61r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6284	      =ARRAY:2C71		     LINK=LINK$
1  6285
1  6286	2C76				     DDOT LABEL	FAR  ; CFA
1  6287	2C76  1F73r			     DW	$COL
   6288					 ; печать двойных чисел
   6289	2C78  205Cr 2C32r 225Ar	  +		  DW  ZERO,DDOTR,SPACE,SEMI
   6290	      18DBr
   6291
   6292						  HEAD	  81h,,256Q,$DOT,$COL		      ;	.
1  6293	      =ARRAY:2C80		     LINK$=$
1  6294	2C80  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  6295							 ; 6 - признак immediate. 5- слово не описано smudge
1  6296	2C81  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  6297
1  6298	2C82  2C71r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6299	      =ARRAY:2C80		     LINK=LINK$
1  6300
1  6301	2C84				     $DOT LABEL	FAR  ; CFA
1  6302	2C84  1F73r			     DW	$COL
   6303	2C86  1833r 2C76r 18DBr			  DW  STOD,DDOT,SEMI
   6304
   6305						  HEAD	  81h,,277Q,QUEST,$COL		      ;	?
1  6306	      =ARRAY:2C8C		     LINK$=$
1  6307	2C8C  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  6308							 ; 6 - признак immediate. 5- слово не описано smudge
1  6309	2C8D  BF			     DB	 277Q	; последний символ слова + 128 (7 бит =	1).
1  6310
1  6311	2C8E  2C80r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6312	      =ARRAY:2C8C		     LINK=LINK$
1  6313
1  6314	2C90				     QUEST LABEL FAR  ;	CFA
1  6315	2C90  1F73r			     DW	$COL
   6316					 ; печать содержимого по адресу	в стеке
   6317	2C92  1C4Er 2C84r 18DBr			  DW  AT,$DOT,SEMI
   6318
   6319						  HEAD	  82h,'U',256Q,UDOT,$COL	      ;	U.
1  6320	      =ARRAY:2C98		     LINK$=$
1  6321	2C98  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  6322							 ; 6 - признак immediate. 5- слово не описано smudge
1  6323	2C99  55			     DB	 'U'
1  6324	2C9A  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  6325
1  6326	2C9B  2C8Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6327	      =ARRAY:2C98		     LINK=LINK$
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 112
forth.asm



1  6328
1  6329	2C9D				     UDOT LABEL	FAR  ; CFA
1  6330	2C9D  1F73r			     DW	$COL
   6331					 ; печать числа	без знака
   6332	2C9F  205Cr 2C76r 18DBr			  DW  ZERO,DDOT,SEMI
   6333
   6334					 ;	   ** Вспомогательные процедуры	**
   6335
   6336						  HEAD	  84h,'LIS',324Q,$LIST,$COL	      ;	LIST
1  6337	      =ARRAY:2CA5		     LINK$=$
1  6338	2CA5  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  6339							 ; 6 - признак immediate. 5- слово не описано smudge
1  6340	2CA6  4C 49 53			     DB	 'LIS'
1  6341	2CA9  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  6342
1  6343	2CAA  2C98r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6344	      =ARRAY:2CA5		     LINK=LINK$
1  6345
1  6346	2CAC				     $LIST LABEL FAR  ;	CFA
1  6347	2CAC  1F73r			     DW	$COL
   6348					 ; n ->	вывод содержимого экрана
   6349	2CAE  1E06r 2221r 1A64r	  +		  DW  DECIMA,CR,DUBL,SCR,STORE,PDOTQ
   6350	      213Fr 1CA8r 239Er
   6351	2CBA  03 53 23 20			  DB  3,'S# '
   6352	2CBE  2C84r				  DW  $DOT
   6353	2CC0  0FD4r 0010 205Cr	  +		  DW  LIT,20Q,ZERO,XDO
   6354	      105Cr
   6355	2CC8  2221r 1955r 2074r	  +	LSTI:	  DW  CR,I,THREE,DOTR,SPACE
   6356	      2C55r 225Ar
   6357	2CD2  1955r 213Fr 1C4Er	  +		  DW  I,SCR,AT,DLINE
   6358	      299Br
   6359	2CDA  1085r FFEC 2221r	  +		  DW XLOOP,LSTI-$,CR,SEMI
   6360	      18DBr
   6361
   6362						  HEAD	  85h,'INDE',330Q,INDEX,$COL	      ;	INDEX
1  6363	      =ARRAY:2CE2		     LINK$=$
1  6364	2CE2  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  6365							 ; 6 - признак immediate. 5- слово не описано smudge
1  6366	2CE3  49 4E 44 45		     DB	 'INDE'
1  6367	2CE7  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  6368
1  6369	2CE8  2CA5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6370	      =ARRAY:2CE2		     LINK=LINK$
1  6371
1  6372	2CEA				     INDEX LABEL FAR  ;	CFA
1  6373	2CEA  1F73r			     DW	$COL
   6374					 ; n1 n2 -> выводит первую строку экранов с n1 по n2
   6375	2CEC  15CEr 1A18r 105Cr			  DW  ONEP,SWAP,XDO
   6376	2CF2  2221r 1955r 2074r	  +	INDX:	  DW  CR,I,THREE,DOTR,SPACE,ZERO,I,DLINE
   6377	      2C55r 225Ar 205Cr	  +
   6378	      1955r 299Br
   6379	2D02  1085r FFEE 18DBr			  DW  XLOOP,INDX-$,SEMI
   6380
   6381						  HEAD	  84h,'TRI',317Q,TRIO,$COL	      ;	TRIO
1  6382	      =ARRAY:2D08		     LINK$=$
1  6383	2D08  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  6384							 ; 6 - признак immediate. 5- слово не описано smudge
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 113
forth.asm



1  6385	2D09  54 52 49			     DB	 'TRI'
1  6386	2D0C  CF			     DB	 317Q	; последний символ слова + 128 (7 бит =	1).
1  6387
1  6388	2D0D  2CE2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6389	      =ARRAY:2D08		     LINK=LINK$
1  6390
1  6391	2D0F				     TRIO LABEL	FAR  ; CFA
1  6392	2D0F  1F73r			     DW	$COL
   6393					 ; При документировании	текстов	программ оказывается удобным размещать
   6394					 ; тексты экранов по три на странице
   6395	2D11  0FD4r 000C 13F7r			  DW  LIT,14Q,EMIT
   6396	2D17  2074r 19F8r 171Ar	  +		  DW  THREE,OVER,PLUS,SWAP,XDO
   6397	      1A18r 105Cr
   6398	2D21  1955r 2CACr 1085r	  +	TRI:	  DW  I,$LIST,XLOOP,TRI-$,SEMI
   6399	      FFFA 18DBr
   6400
   6401						  HEAD	  85h,'VLIS',324Q,VLIST,$COL	      ;	VLIST
1  6402	      =ARRAY:2D2B		     LINK$=$
1  6403	2D2B  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  6404							 ; 6 - признак immediate. 5- слово не описано smudge
1  6405	2D2C  56 4C 49 53		     DB	 'VLIS'
1  6406	2D30  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  6407
1  6408	2D31  2D08r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6409	      =ARRAY:2D2B		     LINK=LINK$
1  6410
1  6411	2D33				     VLIST LABEL FAR  ;	CFA
1  6412	2D33  1F73r			     DW	$COL
   6413					 ; список слов в контекстном словаре
   6414	2D35  215Ar 1C4Er 1C4Er			  DW  CONT,AT,AT
   6415	2D3B  2221r 2074r 205Cr	  +	VL0:	  DW  CR,THREE,ZERO,XDO
   6416	      105Cr
   6417	2D43  1A64r 2646r 0FD4r	  +	VL1:	  DW  DUBL,IDDOT,LIT,15Q,OVER,CAT,LIT,37Q,$AND,SUBB
   6418	      000D 19F8r 1C8Br	  +
   6419	      0FD4r 001F 17F9r	  +
   6420	      1736r
   6421	2D57  2B98r 2268r 1A64r	  +		  DW  SPACS,PFA,DUBL,LIT,6,UDOTR,SPACE,LIT,41Q
   6422	      0FD4r 0006 2C67r	  +
   6423	      225Ar 0FD4r 0021
   6424	2D69  13F7r 225Ar 1CF3r	  +		  DW  EMIT,SPACE,   LFA,AT,DUBL,ZEQU,ZBRAN,VL2-$
   6425	      1C4Er 1A64r 1169r	  +
   6426	      101Br 0004
   6427	2D79  18FCr				  DW  LEAV ; добавил паузу
   6428	2D7B  1085r FFC6 1509r	  +	VL2:	  DW  XLOOP,VL1-$, KEY,	DROP
   6429	      1B2Dr
   6430	2D83  1A81r 1169r 101Br	  +		  DW  DDUP,ZEQU,ZBRAN,VL0-$,SEMI
   6431	      FFB2 18DBr
   6432
   6433						  HEAD	  83h,'LC',314Q,LCL,$COL	      ;	LCL
1  6434	      =ARRAY:2D8D		     LINK$=$
1  6435	2D8D  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  6436							 ; 6 - признак immediate. 5- слово не описано smudge
1  6437	2D8E  4C 43			     DB	 'LC'
1  6438	2D90  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  6439
1  6440	2D91  2D2Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6441	      =ARRAY:2D8D		     LINK=LINK$
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 114
forth.asm



1  6442
1  6443	2D93				     LCL LABEL FAR  ; CFA
1  6444	2D93  1F73r			     DW	$COL
   6445					 ; очистка командной строки
   6446	2D95  205Cr 205Cr 14BCr	  +		  DW  ZERO,ZERO,FIX,$CL,SPACS,RC,SEMI
   6447	      208Er 2B98r 1437r	  +
   6448	      18DBr
   6449
   6450						  HEAD	  82h,'H',324Q,HT,$COL		      ;	HT HOME?
1  6451	      =ARRAY:2DA3		     LINK$=$
1  6452	2DA3  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  6453							 ; 6 - признак immediate. 5- слово не описано smudge
1  6454	2DA4  48			     DB	 'H'
1  6455	2DA5  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  6456
1  6457	2DA6  2D8Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6458	      =ARRAY:2DA3		     LINK=LINK$
1  6459
1  6460	2DA8				     HT	LABEL FAR  ; CFA
1  6461	2DA8  1F73r			     DW	$COL
   6462					 ; курсор в начало экрана
   6463	2DAA  205Cr 205Cr 14BCr	  +		  DW  ZERO,ZERO,FIX,SEMI
   6464	      18DBr
   6465
   6466						  HEAD	  84h,'COP',331Q,COPY,$COL	      ;	COPY
1  6467	      =ARRAY:2DB2		     LINK$=$
1  6468	2DB2  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  6469							 ; 6 - признак immediate. 5- слово не описано smudge
1  6470	2DB3  43 4F 50			     DB	 'COP'
1  6471	2DB6  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  6472
1  6473	2DB7  2DA3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6474	      =ARRAY:2DB2		     LINK=LINK$
1  6475
1  6476	2DB9				     COPY LABEL	FAR  ; CFA
1  6477	2DB9  1F73r			     DW	$COL
   6478					 ; копия экрана
   6479	2DBB  1A18r 2945r 1D11r	  +		  DW  SWAP,BLOCK,CFA,STORE,UPDAT,FLUSH,SEMI
   6480	      1CA8r 1F1Fr 28CCr	  +
   6481	      18DBr
   6482
   6483						  HEAD	  82h,'T',331Q,TY$$,$COL	      ;	TY
1  6484	      =ARRAY:2DC9		     LINK$=$
1  6485	2DC9  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  6486							 ; 6 - признак immediate. 5- слово не описано smudge
1  6487	2DCA  54			     DB	 'T'
1  6488	2DCB  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  6489
1  6490	2DCC  2DB2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6491	      =ARRAY:2DC9		     LINK=LINK$
1  6492
1  6493	2DCE				     TY$$ LABEL	FAR  ; CFA
1  6494	2DCE  1F73r			     DW	$COL
   6495					 ; adr n ->  дамп памяти
   6496	2DD0  205Cr 105Cr			  DW  ZERO,XDO
   6497	2DD4  1955r 207Cr 285Dr	  +	TY4:	  DW  I,EIGHT,$MOD,ZEQU,ZBRAN,TY5-$
   6498	      1169r 101Br 000C
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 115
forth.asm



   6499	2DE0  2221r 1A64r 0FD4r	  +		  DW  CR,DUBL,LIT,7,UDOTR
   6500	      0007 2C67r
   6501	2DEA  1A64r 1C4Er 0FD4r	  +	TY5:	  DW  DUBL,AT,LIT,7,UDOTR,TWOP,XLOOP,TY4-$,SEMI
   6502	      0007 2C67r 15E9r	  +
   6503	      1085r FFDC 18DBr
   6504
   6505						  HEAD	  85h,'DEPT',310Q,DEPTH,$COL	      ;	DEPTH
1  6506	      =ARRAY:2DFC		     LINK$=$
1  6507	2DFC  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  6508							 ; 6 - признак immediate. 5- слово не описано smudge
1  6509	2DFD  44 45 50 54		     DB	 'DEPT'
1  6510	2E01  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1  6511
1  6512	2E02  2DC9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6513	      =ARRAY:2DFC		     LINK=LINK$
1  6514
1  6515	2E04				     DEPTH LABEL FAR  ;	CFA
1  6516	2E04  1F73r			     DW	$COL
   6517					 ; число элементов в стеке
   6518	2E06  20A0r 1C4Er 1896r	  +		  DW  SZERO,AT,SPAT,TWOP,SUBB,DIV2,SEMI
   6519	      15E9r 1736r 163Dr	  +
   6520	      18DBr
   6521
   6522						  HEAD	  84h,'DUM',320Q,DUMP,$COL	      ;	DUMP
1  6523	      =ARRAY:2E14		     LINK$=$
1  6524	2E14  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  6525							 ; 6 - признак immediate. 5- слово не описано smudge
1  6526	2E15  44 55 4D			     DB	 'DUM'
1  6527	2E18  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  6528
1  6529	2E19  2DFCr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6530	      =ARRAY:2E14		     LINK=LINK$
1  6531
1  6532	2E1B				     DUMP LABEL	FAR  ; CFA
1  6533	2E1B  1F73r			     DW	$COL
   6534					 ; адр u --> - Отображает u байт памяти	начиная	с адр
   6535	2E1D  205Cr 105Cr			  DW  ZERO,XDO
   6536	2E21  1A64r 0FD4r 0007	  +	DMP:	  DW  DUBL,LIT,7,UDOTR,SPACE,EIGHT,ZERO,XDO
   6537	      2C67r 225Ar 207Cr	  +
   6538	      205Cr 105Cr
   6539	2E31  1A64r 1955r 171Ar	  +	DP1:	  DW  DUBL,I,PLUS,CAT,LIT,5,DOTR,XLOOP,DP1-$
   6540	      1C8Br 0FD4r 0005	  +
   6541	      2C55r 1085r FFF0
   6542	2E43  0FD4r 0004 2B98r	  +		  DW  LIT,4,SPACS,EIGHT,ZERO,XDO
   6543	      207Cr 205Cr 105Cr
   6544	2E4F  1A64r 1955r 171Ar	  +	DP2:	  DW  DUBL,I,PLUS,CAT,LIT,177Q,$AND,DUBL,BLAN
   6545	      1C8Br 0FD4r 007F	  +
   6546	      17F9r 1A64r 2085r
   6547	2E61  120Cr 101Br 0008	  +		  DW  LESS,ZBRAN,DP3-$,DROP,LIT,56Q
   6548	      1B2Dr 0FD4r 002E
   6549	2E6D  13F7r 1085r FFDE	  +	DP3:	  DW  EMIT,XLOOP,DP2-$,CR,EIGHT,PLUS,EIGHT
   6550	      2221r 207Cr 171Ar	  +
   6551	      207Cr
   6552	2E7B  10B3r FFA4 1B2Dr	  +		  DW  XPLOO,DMP-$,DROP,SEMI
   6553	      18DBr
   6554
   6555						  HEAD	  84h,'SWA',323Q,SWAS,$COL	      ;	SWAS
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 116
forth.asm



1  6556	      =ARRAY:2E83		     LINK$=$
1  6557	2E83  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  6558							 ; 6 - признак immediate. 5- слово не описано smudge
1  6559	2E84  53 57 41			     DB	 'SWA'
1  6560	2E87  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  6561
1  6562	2E88  2E14r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6563	      =ARRAY:2E83		     LINK=LINK$
1  6564
1  6565	2E8A				     SWAS LABEL	FAR  ; CFA
1  6566	2E8A  1F73r			     DW	$COL
   6567					     ; перемены	 мест экранов М	и N
   6568	2E8C  191Ar 2945r 1D11r	  +		  DW  TOR,BLOCK,CFA,DUBL,AT,I,BLOCK,CFA,STORE,UPDAT
   6569	      1A64r 1C4Er 1955r	  +
   6570	      2945r 1D11r 1CA8r	  +
   6571	      1F1Fr
   6572	2EA0  1938r 0FD4r 8000	  +		  DW  FROMR,LIT,100000Q,$OR,SWAP,STORE,FLUSH,SEMI
   6573	      1816r 1A18r 1CA8r	  +
   6574	      28CCr 18DBr
   6575
   6576						  HEAD	  83h,'ST',331Q,STY,$COL	      ;	STY
1  6577	      =ARRAY:2EB0		     LINK$=$
1  6578	2EB0  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  6579							 ; 6 - признак immediate. 5- слово не описано smudge
1  6580	2EB1  53 54			     DB	 'ST'
1  6581	2EB3  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  6582
1  6583	2EB4  2E83r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6584	      =ARRAY:2EB0		     LINK=LINK$
1  6585
1  6586	2EB6				     STY LABEL FAR  ; CFA
1  6587	2EB6  1F73r			     DW	$COL
   6588					     ; печать стека
   6589	2EB8  2E04r 1A81r 101Br	  +		  DW  DEPTH,DDUP,ZBRAN,STY3-$,ZERO,XDO
   6590	      0024 205Cr 105Cr
   6591	2EC4  1955r 207Cr 285Dr	  +	STY1:	  DW  I,EIGHT,$MOD,ZEQU,ZBRAN,STY2-$,CR
   6592	      1169r 101Br 0004	  +
   6593	      2221r
   6594	2ED2  1955r 15CEr 19D0r	  +	STY2:	  DW  I,ONEP,PICK,LIT,7,UDOTR,XLOOP,STY1-$
   6595	      0FD4r 0007 2C67r	  +
   6596	      1085r FFE4
   6597	2EE2  18DBr			STY3:	  DW  SEMI
   6598
   6599						  HEAD	  82h,'O',256Q,ODOT,$COL	      ;	O.
1  6600	      =ARRAY:2EE4		     LINK$=$
1  6601	2EE4  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  6602							 ; 6 - признак immediate. 5- слово не описано smudge
1  6603	2EE5  4F			     DB	 'O'
1  6604	2EE6  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  6605
1  6606	2EE7  2EB0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6607	      =ARRAY:2EE4		     LINK=LINK$
1  6608
1  6609	2EE9				     ODOT LABEL	FAR  ; CFA
1  6610	2EE9  1F73r			     DW	$COL
   6611					     ; тоже что	и S. в octal системе
   6612	2EEB  217Fr 1C4Er 19F8r	  +		  DW  BASE,AT,OVER,OCTAL,UDOT,BASE,STORE,SEMI
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 117
forth.asm



   6613	      1E26r 2C9Dr 217Fr	  +
   6614	      1CA8r 18DBr
   6615
   6616						  HEAD	  83h,'R/',327Q,RW		      ;	R/W
1  6617	      =ARRAY:2EFB		     LINK$=$
1  6618	2EFB  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  6619							 ; 6 - признак immediate. 5- слово не описано smudge
1  6620	2EFC  52 2F			     DB	 'R/'
1  6621	2EFE  D7			     DB	 327Q	; последний символ слова + 128 (7 бит =	1).
1  6622
1  6623	2EFF  2EE4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6624	      =ARRAY:2EFB		     LINK=LINK$
1  6625
1  6626	2F01				     RW	LABEL FAR  ; CFA
1  6627	2F01  2F03r			     DW	 $+2
   6628					; Открытие файла
   6629	2F03  BA 2FBEr				  MOV	DX, OFFSET file
   6630						  ;MOV	 AH, 0FH      ;	open file
   6631	2F06  B4 3D				  MOV	AH, 3dh
   6632	2F08  B0 02				  mov	al, 2
   6633	2F0A  CD 21				  INT	21H
   6634						  ;CMP	 AL, 0FFH
   6635						  ;JE	 ERR0
   6636	2F0C  72 60				  jc ERR0
   6637	2F0E  A3 2FBCr				  mov	 handle, ax
   6638	2F11  5B				  POP	BX  ; R/W - флаг
   6639	2F12  58				  POP	AX  ; Номер блока
   6640	2F13  5A				  POP	DX  ; Адрес буфера
   6641	2F14  48				  DEC	AX
   6642	2F15  B1 0A				  MOV	CL, 10 ; 3 было
   6643	2F17  D3 E0				  SAL	AX, CL	; (BLOCK#-1)*8 ; теперь	на 1024	байт
   6644						  ;MOV	 RANDREC,AX
   6645						  ;MOV	 RANDREC+2,0
   6646	2F19  53				  push	 bx
   6647	2F1A  52				  push	 dx
   6648	2F1B  8B D0				  mov	 dx, ax
   6649	2F1D  B9 0000				  mov	 cx, 0
   6650	2F20  B8 4200				  mov	 ax, 4200h
   6651	2F23  8B 1E 2FBCr			  mov bx, handle
   6652	2F27  CD 21				  int 21h
   6653	2F29  72 43				  jc ERR0
   6654	2F2B  5A				  pop	 dx
   6655	2F2C  5B				  pop	 bx
   6656	2F2D  83 FB 00				  CMP	BX, 0 ;	режим
   6657	2F30  75 10				  JNE	RED
   6658					; WRITE
   6659						  ;MOV	 BX, DX
   6660						  ;MOV	 CX, 8	    ; Номер записи
   6661	2F32				WR:	  ;MOV	 DX, BX
   6662						  ;MOV	 AH,1AH	    ; Запись адреса буфера (Set	disk transfer address)
   6663						  ;INT	 21H
   6664						  ;MOV	 DX,OFFSET FCB
   6665						  ;MOV	 AH, 22H    ; Запись RECORD (Random write)
   6666						  ;INT	 21H
   6667	2F32  B4 40				  MOV	AH, 40H
   6668	2F34  B9 0400				  MOV	CX, 1024
   6669	2F37  8B 1E 2FBCr			  mov	 bx, handle
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 118
forth.asm



   6670	2F3B  CD 21				  INT	21H
   6671						  ;CMP	 AL, 0
   6672						  ;JNE	 ERR1
   6673	2F3D  72 35				  jc err1
   6674						  ;INC	 RANDREC    ; Коррекция	адреса буфера
   6675						  ;ADD	 BX, 80H
   6676						  ;LOOP	 WR
   6677	2F3F  EB 12 90				  JMP  OUT1
   6678
   6679	2F42				 RED:	  ;MOV	 CX, 8
   6680						  ;MOV	 BX, DX
   6681					 ;RD:	  ;MOV	 DX, BX	      ;	адрес буфера
   6682						  ;MOV	 AH, 1AH     ; Запись адреса буфера
   6683	2F42  B4 3F				  MOV	AH, 3fH
   6684	2F44  B9 0400				  MOV	CX, 1024
   6685	2F47  8B 1E 2FBCr			  mov	 bx, handle
   6686	2F4B  CD 21				  INT	21H
   6687	2F4D  72 31				  jc ERR3
   6688	2F4F  3B C1				  cmp ax,cx
   6689	2F51  75 2D				  jne err3
   6690						  ;MOV	 DX, OFFSET  FCB
   6691						  ;MOV	 AH, 21H      ;	Random read
   6692						  ;INT	 21H
   6693						  ;CMP	 AL, 0
   6694						  ;JNE	 ERR3
   6695						  ;INC	 RANDREC     ; Коррекция адреса
   6696						  ;ADD	 BX, 80H
   6697						 ; LOOP	  RD
   6698
   6699	2F53				OUT1:	  ;MOV	 DX, OFFSET  FCB  ; Закрытие файла
   6700	2F53  8B 1E 2FBCr			  mov bx, handle
   6701						  ;MOV	 AH, 10H
   6702	2F57  B4 3E				  mov ah, 3eh
   6703	2F59  CD 21				  INT	21H
   6704						  ;CMP	 AL, 0
   6705						  ;JNE	 ERR2
   6706	2F5B  72 1D				  jc ERR2
   6707	2F5D				EXIT:	  NEXT
1  6708	2F5D  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  6709	2F5E  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  6710					 ; ------ call debugger	--------
1  6711	2F60  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  6712	2F64  74 06			     jz	??0066
1  6713	2F66  E8 DFE9			     call printWORD
1  6714	2F69  E8 DEC8			     call pause
1  6715	2F6C				   ??0066:
1  6716					 ; -----------------------------
1  6717	2F6C  FF 27			     JMP WORD PTR [BX]
   6718	2F6E  BA 2FEFr			ERR0:	  MOV	DX, OFFSET  ERMES0
   6719	2F71  EB 10 90				  JMP	DONE
   6720	2F74  BA 3000r			ERR1:	  MOV	DX, OFFSET  ERMES1
   6721	2F77  EB 0A 90				  JMP	DONE
   6722	2F7A  BA 3011r			ERR2:	  MOV	DX, OFFSET  ERMES2
   6723	2F7D  EB 04 90				  JMP	DONE
   6724	2F80  BA 3022r			ERR3:	  MOV	DX, OFFSET  ERMES3
   6725	2F83  B4 09			DONE:	  MOV	AH, 9H ; вывод сообщения
   6726	2F85  CD 21				  INT	21H
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 119
forth.asm



   6727	2F87  EB D4				  JMP	EXIT
   6728
   6729						  HEAD	  305Q,';COD','E'+80h,SEMIC,$COL	  ; ;CODE
1  6730	      =ARRAY:2F89		     LINK$=$
1  6731	2F89  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  6732							 ; 6 - признак immediate. 5- слово не описано smudge
1  6733	2F8A  3B 43 4F 44		     DB	 ';COD'
1  6734	2F8E  C5			     DB	 'E'+80h   ; последний символ слова + 128 (7 бит = 1).
1  6735
1  6736	2F8F  2EFBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6737	      =ARRAY:2F89		     LINK=LINK$
1  6738
1  6739	2F91				     SEMIC LABEL FAR  ;	CFA
1  6740	2F91  1F73r			     DW	$COL
   6741					 ; для определения в форт программе слов на ассемблере
   6742	2F93  22D5r 2309r 2336r	  +		  DW  QCSP,COMP,PSCOD,LBRAC,SMUG,SEMI
   6743	      1DAAr 2322r 18DBr
   6744
   6745						  HEAD	  305Q,'FORT','H'+80h,FORTH,$DOE	  ; FORTH
1  6746	      =ARRAY:2F9F		     LINK$=$
1  6747	2F9F  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  6748							 ; 6 - признак immediate. 5- слово не описано smudge
1  6749	2FA0  46 4F 52 54		     DB	 'FORT'
1  6750	2FA4  C8			     DB	 'H'+80h   ; последний символ слова + 128 (7 бит = 1).
1  6751
1  6752	2FA5  2F89r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6753	      =ARRAY:2F9F		     LINK=LINK$
1  6754
1  6755	2FA7				     FORTH LABEL FAR  ;	CFA
1  6756	2FA7  202Cr			     DW	$DOE
   6757					 ; Делает словарь Форт контекстным.
   6758					 ; см. FORTH DIMENSION
   6759	2FA9  27B0r				 DW  DOVOC   ; PFA
   6760	2FAB  A081				 DW 120201Q  ; = A0 81 мнимый заголовок	слова для связи	словарей
   6761	2FAD  2FB1r				 DW TASK-7   ; PFA+4 NFA(TASK) последнее слово в этом словаре
   6762	2FAF				 XVOC	 LABEL	 FAR ; VOC-LINK
   6763	2FAF  0000				 DW  0	     ; ссылка на предыдущий словарь
   6764							     ; для чего	так и не нашел.	похоже,	здесь не используется
   6765					 ; VOC-LINK ---	addr U
   6766					 ;    A	user variable containing the address of	a field	in the definition
   6767					 ;    of the most recently created vocabulary. All vocabulary names are
   6768					 ;    linked by	these fields to	allow control for FORGETting thru multiple
   6769					 ;    vocabularies.
   6770
   6771						  HEAD	  84h,'TAS','K'+80h,TASK,$COL		 ; TASK
1  6772	      =ARRAY:2FB1		     LINK$=$
1  6773	2FB1  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  6774							 ; 6 - признак immediate. 5- слово не описано smudge
1  6775	2FB2  54 41 53			     DB	 'TAS'
1  6776	2FB5  CB			     DB	 'K'+80h   ; последний символ слова + 128 (7 бит = 1).
1  6777
1  6778	2FB6  2F9Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6779	      =ARRAY:2FB1		     LINK=LINK$
1  6780
1  6781	2FB8				     TASK LABEL	FAR  ; CFA
1  6782	2FB8  1F73r			     DW	$COL
   6783					     ; пустое определение. последнее слово в словаре FORTH
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 120
forth.asm



   6784	2FBA  18DBr				  DW  SEMI
   6785
   6786	2FBC  0000			handle	 dw 0
   6787	2FBE  66 6F 72 74 68 2E	64+	file	 db "forth.dat", 0
   6788	      61 74 00
   6789					; FCB not used now
   6790	2FC8				FCB	  LABEL	WORD
   6791	2FC8  00			DRIVE	  DB	0
   6792	2FC9  46 4F 52 54 48 20	20+	FN	  DB	'FORTH	 '
   6793	      20
   6794	2FD1  44 41 54			EXT	  DB	'DAT'
   6795	2FD4  0000			CURBLK	  DW	0	   ; Относительное начало файла
   6796	2FD6  0080			RECSIZE	  DW	80H	   ; размер логичю записи
   6797	2FD8  1388 0000			FILESIZE  DW	5000,0	   ; размер файла
   6798	2FDC  0000 0000			DATE	  DW	0,0
   6799	2FE0  00 00 00 00 00 00	00+		  DB	0,0,0,0,0, 0,0,0,0,0 ; REZERV
   6800	      00 00 00
   6801	2FEA  00			CURREC	  DB	0	    ; запись с текущего	блока
   6802	2FEB  0000 0000			RANDREC	  DW	0,0	    ; номер записи
   6803
   6804	2FEF  45 52 52 20 4F 50	45+	ERMES0	  DB	'ERR OPENING FILE$'
   6805	      4E 49 4E 47 20 46	49+
   6806	      4C 45 24
   6807	3000  45 52 52 20 57 52	49+	ERMES1	  DB	'ERR WRITING FILE$'
   6808	      54 49 4E 47 20 46	49+
   6809	      4C 45 24
   6810	3011  45 52 52 20 43 4C	4F+	ERMES2	  DB	'ERR CLOSING FILE$'
   6811	      53 49 4E 47 20 46	49+
   6812	      4C 45 24
   6813	3022  45 52 52 20 52 45	41+	ERMES3	  DB	'ERR READING FILE$'
   6814	      44 49 4E 47 20 46	49+
   6815	      4C 45 24
   6816
   6817
   6818	3033  3E80*(0000)		XDP	DW  16000 DUP(0)	   ; DICTIONARY
   6819
   6820	0000				STCK   SEGMENT STACK		  ; Стек параметров
   6821	0000  40*(????)				DW  64 DUP (?)
   6822	0080				XS0	LABEL	WORD
   6823	0080  0000 0000				DW  0,0	  ; STACK
   6824	0084				STCK   ENDS
   6825
   6826	AD33				ARRAY	   ENDS
   6827					END	   $INI
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 121
Symbol Table




Symbol Name			  Type	 Value

$ABS				  Far	 ARRAY:17D7
$AND				  Far	 ARRAY:17F9
$BUF				  Word	 ARRAY:0DB0
$CL				  Far	 ARRAY:208E
$COL				  Far	 ARRAY:1F73
$COMP				  Near	 ARRAY:1E95
$CON				  Far	 ARRAY:1FB6
$DATE				  Word	 ARRAY:0004
$DO				  Far	 ARRAY:2AB0
$DOE				  Far	 ARRAY:202C
$DOT				  Far	 ARRAY:2C84
$DP				  Far	 ARRAY:20E2
$ELSE				  Far	 ARRAY:2B5A
$EM				  Near	 ARRAY:13D7
$EMIT				  Far	 ARRAY:13F9
$EVEN				  Far	 ARRAY:124D
$EX				  Far	 ARRAY:21C5
$GO				  Near	 ARRAY:19E0
$HEX				  Far	 ARRAY:1DE4
$IF				  Far	 ARRAY:2B43
$IN				  Far	 ARRAY:212B
$INI				  Far	 ARRAY:0DB4
$LESS				  Near	 ARRAY:10C0
$LIST				  Far	 ARRAY:2CAC
$LOOP				  Near	 ARRAY:110D
$MO				  Near	 ARRAY:28A2
$MOD				  Far	 ARRAY:285D
$OR				  Far	 ARRAY:1816
$PAGE				  Far	 ARRAY:12C3
$REPE				  Near	 ARRAY:1B9D
$RS				  Word	 ARRAY:0DA2
$SIG				  Near	 ARRAY:10FA
$STI				  Word	 ARRAY:0D9C
$STK				  Word	 ARRAY:0DA0
$TIME				  Word	 ARRAY:0000
$TYPE				  Far	 ARRAY:2371
$UPD				  Near	 ARRAY:1F2C
$US				  Word	 ARRAY:0D9E
$USE				  Far	 ARRAY:1FFF
$VAR				  Far	 ARRAY:1FDD
$WARN				  Far	 ARRAY:20CD
$WHILE				  Far	 ARRAY:2B1B
$WIDTH				  Far	 ARRAY:20BF
$WORD				  Far	 ARRAY:2438
$XOR				  Far	 ARRAY:1824
??0000				  Near	 ARRAY:0E24
??0001				  Near	 ARRAY:0FE7
??0002				  Near	 ARRAY:100F
??0003				  Near	 ARRAY:1035
??0004				  Near	 ARRAY:1053
??0005				  Near	 ARRAY:107A
??0006				  Near	 ARRAY:10A7
??0007				  Near	 ARRAY:1183
??0008				  Near	 ARRAY:1267
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 122
Symbol Table



??0009				  Near	 ARRAY:12B3
??000A				  Near	 ARRAY:12D9
??000B				  Near	 ARRAY:130A
??000C				  Near	 ARRAY:1350
??000D				  Near	 ARRAY:1395
??000E				  Near	 ARRAY:13B4
??000F				  Near	 ARRAY:13EE
??0010				  Near	 ARRAY:1471
??0011				  Near	 ARRAY:148F
??0012				  Near	 ARRAY:14B4
??0013				  Near	 ARRAY:14DB
??0014				  Near	 ARRAY:1501
??0015				  Near	 ARRAY:1521
??0016				  Near	 ARRAY:1553
??0017				  Near	 ARRAY:158B
??0018				  Near	 ARRAY:15A8
??0019				  Near	 ARRAY:15C7
??001A				  Near	 ARRAY:15E2
??001B				  Near	 ARRAY:15FF
??001C				  Near	 ARRAY:161A
??001D				  Near	 ARRAY:1636
??001E				  Near	 ARRAY:1652
??001F				  Near	 ARRAY:1670
??0020				  Near	 ARRAY:168F
??0021				  Near	 ARRAY:16AD
??0022				  Near	 ARRAY:16D4
??0023				  Near	 ARRAY:16F5
??0024				  Near	 ARRAY:1714
??0025				  Near	 ARRAY:1730
??0026				  Near	 ARRAY:174C
??0027				  Near	 ARRAY:176F
??0028				  Near	 ARRAY:1792
??0029				  Near	 ARRAY:17B1
??002A				  Near	 ARRAY:17CF
??002B				  Near	 ARRAY:17F1
??002C				  Near	 ARRAY:180F
??002D				  Near	 ARRAY:184C
??002E				  Near	 ARRAY:186C
??002F				  Near	 ARRAY:187E
??0030				  Near	 ARRAY:18B7
??0031				  Near	 ARRAY:18D4
??0032				  Near	 ARRAY:18F2
??0033				  Near	 ARRAY:1913
??0034				  Near	 ARRAY:1931
??0035				  Near	 ARRAY:194F
??0036				  Near	 ARRAY:1969
??0037				  Near	 ARRAY:19C7
??0038				  Near	 ARRAY:19EF
??0039				  Near	 ARRAY:1A0F
??003A				  Near	 ARRAY:1A2D
??003B				  Near	 ARRAY:1A5C
??003C				  Near	 ARRAY:1A78
??003D				  Near	 ARRAY:1AA9
??003E				  Near	 ARRAY:1AC8
??003F				  Near	 ARRAY:1AE8
??0040				  Near	 ARRAY:1B06
??0041				  Near	 ARRAY:1B24
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 123
Symbol Table



??0042				  Near	 ARRAY:1B41
??0043				  Near	 ARRAY:1B5D
??0044				  Near	 ARRAY:1B8A
??0045				  Near	 ARRAY:1BB1
??0046				  Near	 ARRAY:1BF2
??0047				  Near	 ARRAY:1C0E
??0048				  Near	 ARRAY:1C2A
??0049				  Near	 ARRAY:1C48
??004A				  Near	 ARRAY:1C62
??004B				  Near	 ARRAY:1C84
??004C				  Near	 ARRAY:1CA2
??004D				  Near	 ARRAY:1CBD
??004E				  Near	 ARRAY:1CD9
??004F				  Near	 ARRAY:1D09
??0050				  Near	 ARRAY:1D27
??0051				  Near	 ARRAY:1D44
??0052				  Near	 ARRAY:1D61
??0053				  Near	 ARRAY:1D80
??0054				  Near	 ARRAY:1DA4
??0055				  Near	 ARRAY:1DC0
??0056				  Near	 ARRAY:1DDC
??0057				  Near	 ARRAY:1DFA
??0058				  Near	 ARRAY:1E1C
??0059				  Near	 ARRAY:1E3C
??005A				  Near	 ARRAY:1E5D
??005B				  Near	 ARRAY:1E87
??005C				  Near	 ARRAY:1EB4
??005D				  Near	 ARRAY:1EDB
??005E				  Near	 ARRAY:1F14
??005F				  Near	 ARRAY:1F3B
??0060				  Near	 ARRAY:1F59
??0061				  Near	 ARRAY:1F8D
??0062				  Near	 ARRAY:1FCA
??0063				  Near	 ARRAY:1FF0
??0064				  Near	 ARRAY:2016
??0065				  Near	 ARRAY:204A
??0066				  Near	 ARRAY:2F6C
??DATE				  Text	 "01/12/20"
??FILENAME			  Text	 "forth	  "
??TIME				  Text	 "10:24:08"
??VERSION			  Number 030A
?TER$				  Far	 ARRAY:155D
?TERM				  Far	 ARRAY:2210
@32BIT				  Text	 0
@@1				  Near	 ARRAY:0F29
@@2				  Near	 ARRAY:0F41
@@ASCII				  Byte	 ARRAY:0E9F
@@ASCII				  Byte	 ARRAY:0F20
@@ASCII				  Byte	 ARRAY:0EEC
@@CAPTION			  Byte	 ARRAY:0E92
@@CAPTION			  Byte	 ARRAY:0EE6
@@CAPTION			  Byte	 ARRAY:0F17
@@CR				  Byte	 ARRAY:0FB7
@@L				  Near	 ARRAY:0EB2
@@R				  Near	 ARRAY:0EDE
@@R				  Near	 ARRAY:0F0F
@@R				  Near	 ARRAY:0EC3
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 124
Symbol Table



@CODE				  Text	 _TEXT
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 ARRAY
@D				  Near	 ARRAY:0E70
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@E				  Near	 ARRAY:0E5D
@FILENAME			  Text	 FORTH
@INTERFACE			  Text	 00H
@MODEL				  Text	 2
@R				  Near	 ARRAY:0E75
@RS				  Near	 ARRAY:0E66
@S				  Near	 ARRAY:0E6B
@STACK				  Text	 DGROUP
@START				  Near	 ARRAY:0E34
@V				  Near	 ARRAY:0E61
@WORDSIZE			  Text	 2
A				  Near	 ARRAY:127B
AA				  Near	 ARRAY:128F
AAA1				  Near	 ARRAY:127F
AAT				  Far	 ARRAY:1C69
AB				  Near	 ARRAY:17E1
ABORT				  Far	 ARRAY:27FB
AGAIN				  Far	 ARRAY:2B05
ALLOT				  Far	 ARRAY:1D6B
ARROW				  Far	 ARRAY:2A21
ASCII				  Byte	 ARRAY:0F92
AT				  Far	 ARRAY:1C4E
ATR				  Far	 ARRAY:210F
BACK				  Far	 ARRAY:2A8F
BASE				  Far	 ARRAY:217F
BBUF				  Far	 ARRAY:2097
BCK				  Near	 ARRAY:2977
BCOM				  Far	 ARRAY:26B5
BDIGS				  Far	 ARRAY:2BB5
BEGIN				  Far	 ARRAY:2AA1
BLAN				  Far	 ARRAY:2085
BLANK				  Far	 ARRAY:1BCA
BLANKBUFFER			  Near	 ARRAY:0F4A
BLC				  Near	 ARRAY:298B
BLK				  Far	 ARRAY:2122
BLO				  Near	 ARRAY:295F
BLOCK				  Far	 ARRAY:2945
BN				  Near	 ARRAY:2481
BN1				  Near	 ARRAY:24B7
BR1				  Near	 ARRAY:290D
BR2				  Near	 ARRAY:292D
BRAN				  Far	 ARRAY:1040
BUFFE				  Far	 ARRAY:2903
BUILD				  Far	 ARRAY:234E
BYE				  Far	 ARRAY:2052
C$				  Near	 ARRAY:1A68
CAT				  Far	 ARRAY:1C8B
CCOM				  Far	 ARRAY:2246
CFA				  Far	 ARRAY:1D11
CLEAR				  Near	 ARRAY:14A0
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 125
Symbol Table



CMOV				  Far	 ARRAY:1B67
CNT				  Near	 ARRAY:1042
COLON				  Far	 ARRAY:1F5F
COMMA				  Far	 ARRAY:2235
COMP				  Far	 ARRAY:2309
COMPA				  Near	 ARRAY:1E6F
CON				  Far	 ARRAY:1FAC
CONT				  Far	 ARRAY:215A
COPY				  Far	 ARRAY:2DB9
COUNT				  Far	 ARRAY:235E
CR				  Far	 ARRAY:2221
CRE				  Near	 ARRAY:2675
CREAT				  Far	 ARRAY:265F
CSP				  Far	 ARRAY:2193
CSTOR				  Far	 ARRAY:1CC4
CURBLK				  Word	 ARRAY:2FD4
CURR				  Far	 ARRAY:2168
CURREC				  Byte	 ARRAY:2FEA
DABS				  Far	 ARRAY:16DD
DATE				  Word	 ARRAY:2FDC
DDOT				  Far	 ARRAY:2C76
DDOTR				  Far	 ARRAY:2C32
DDROP				  Far	 ARRAY:1B10
DDUP				  Far	 ARRAY:1A81
DEB				  Far	 ARRAY:21D9
DEBUG				  Number 0001
DECIMA				  Far	 ARRAY:1E06
DEEP				  Near	 ARRAY:186E
DEFIN				  Far	 ARRAY:1EC4
DEPTH				  Far	 ARRAY:2E04
DFIND				  Far	 ARRAY:24C9
DIG				  Far	 ARRAY:2BF1
DIGI				  Near	 ARRAY:2C0D
DIGIT				  Far	 ARRAY:1146
DIGS				  Far	 ARRAY:2C1C
DIS				  Near	 ARRAY:2C1E
DIV2				  Far	 ARRAY:163D
DLI				  Near	 ARRAY:26FC
DLINE				  Far	 ARRAY:299B
DLITE				  Far	 ARRAY:26EC
DMIN				  Near	 ARRAY:16BB
DMINU				  Far	 ARRAY:16B8
DMP				  Near	 ARRAY:2E21
DOES				  Far	 ARRAY:2020
DONE				  Near	 ARRAY:2F83
DOTQ				  Far	 ARRAY:23B7
DOTR				  Far	 ARRAY:2C55
DOVOC				  Far	 ARRAY:27B0
DP1				  Near	 ARRAY:2E31
DP2				  Near	 ARRAY:2E4F
DP3				  Near	 ARRAY:2E6D
DPL				  Far	 ARRAY:2189
DPLUS				  Far	 ARRAY:1753
DRIVE				  Byte	 ARRAY:2FC8
DRO				  Near	 ARRAY:1B12
DROP				  Far	 ARRAY:1B2D
DRP				  Near	 ARRAY:1B2F
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 126
Symbol Table



DSKBUF				  Word	 ARRAY:0006
DSPL				  Far	 ARRAY:14E4
DSWAP				  Far	 ARRAY:1A37
DTRAI				  Far	 ARRAY:1E68
DU				  Near	 ARRAY:1A67
DUBL				  Far	 ARRAY:1A64
DUMP				  Far	 ARRAY:2E1B
DUP2				  Far	 ARRAY:1A92
EDIGS				  Far	 ARRAY:2BC4
EIGHT				  Far	 ARRAY:207C
EMI$				  Far	 ARRAY:13BC
EMIT				  Far	 ARRAY:13F7
ENCL				  Far	 ARRAY:1275
ENDA				  Near	 ARRAY:17FF
ENDBUF				  Word	 ARRAY:0C12
ENT				  Near	 ARRAY:0DBF
ENT$				  Near	 ARRAY:13FA
EQGR				  Far	 ARRAY:123B
EQLES				  Far	 ARRAY:121C
EQUAL				  Far	 ARRAY:11DE
EQW				  Near	 ARRAY:129B
ER				  Near	 ARRAY:2602
ER1				  Near	 ARRAY:2606
ERASE				  Far	 ARRAY:1BBB
ERB				  Far	 ARRAY:21CF
ERMES0				  Byte	 ARRAY:2FEF
ERMES1				  Byte	 ARRAY:3000
ERMES2				  Byte	 ARRAY:3011
ERMES3				  Byte	 ARRAY:3022
ERMES4				  Byte	 ARRAY:1422
ERR0				  Near	 ARRAY:2F6E
ERR1				  Near	 ARRAY:2F74
ERR2				  Near	 ARRAY:2F7A
ERR3				  Near	 ARRAY:2F80
ERR4				  Near	 ARRAY:1410
ERROR				  Far	 ARRAY:261A
EXEC				  Far	 ARRAY:0FC9
EXIT				  Near	 ARRAY:2F5D
EXP				  Near	 ARRAY:258C
EXPE				  Far	 ARRAY:152C
EXT				  Byte	 ARRAY:2FD1
FAIL				  Near	 ARRAY:1138
FALSE				  Near	 ARRAY:1171
FALSE1				  Near	 ARRAY:1255
FAST				  Near	 ARRAY:10E8
FCB				  Word	 ARRAY:2FC8
FENCE				  Far	 ARRAY:20D9
FILE				  Byte	 ARRAY:2FBE
FILESIZE			  Word	 ARRAY:2FD8
FILL				  Far	 ARRAY:1B93
FIN				  Near	 ARRAY:24ED
FIRST				  Far	 ARRAY:20F9
FIX				  Far	 ARRAY:14BC
FL1				  Near	 ARRAY:28EE
FLL				  Near	 ARRAY:1B96
FLU				  Near	 ARRAY:28D8
FLUSH				  Far	 ARRAY:28CC
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 127
Symbol Table



FN				  Byte	 ARRAY:2FC9
FORGE				  Far	 ARRAY:2A52
FORTH				  Far	 ARRAY:2FA7
FROMR				  Far	 ARRAY:1938
G$				  Near	 ARRAY:16C5
GO$				  Near	 ARRAY:0E26
GREAT				  Far	 ARRAY:122B
HANDLE				  Word	 ARRAY:2FBC
HERE				  Far	 ARRAY:1D4D
HLD				  Far	 ARRAY:21A6
HOLD				  Far	 ARRAY:1BD8
HT				  Far	 ARRAY:2DA8
I				  Far	 ARRAY:1955
IDDOT				  Far	 ARRAY:2646
IL				  Far	 ARRAY:1443
IMMED				  Far	 ARRAY:2779
INDEX				  Far	 ARRAY:2CEA
INDX				  Near	 ARRAY:2CF2
INIT				  Far	 ARRAY:0DBD
INTER				  Far	 ARRAY:2731
IT1				  Near	 ARRAY:2733
IT2				  Near	 ARRAY:2749
IT3				  Near	 ARRAY:274F
IT4				  Near	 ARRAY:2763
IT5				  Near	 ARRAY:2767
J				  Far	 ARRAY:1983
JT				  Far	 ARRAY:198F
K				  Far	 ARRAY:199A
KEY				  Far	 ARRAY:1509
KT				  Far	 ARRAY:19A6
LASTRANDX			  Far	 ARRAY:21E9
LATES				  Far	 ARRAY:1E47
LBRAC				  Far	 ARRAY:1DAA
LCL				  Far	 ARRAY:2D93
LEAV				  Far	 ARRAY:18FC
LESS				  Far	 ARRAY:120C
LEV				  Far	 ARRAY:19B3
LFA				  Far	 ARRAY:1CF3
LIL				  Near	 ARRAY:26DF
LIMIT				  Far	 ARRAY:2105
LINK				  Number ARRAY:2FB1
LINK$				  Number ARRAY:2FB1
LIT				  Far	 ARRAY:0FD4
LITER				  Far	 ARRAY:26CF
LOA				  Far	 ARRAY:29F9
LOO				  Far	 ARRAY:2AC3
LOP				  Near	 ARRAY:108A
LSTI				  Near	 ARRAY:2CC8
LV				  Near	 ARRAY:1092
M09				  Near	 ARRAY:115C
MATCH				  Near	 ARRAY:10F2
MAX				  Far	 ARRAY:1886
MES				  Near	 ARRAY:29E3
MESS				  Far	 ARRAY:29BF
MIN				  Far	 ARRAY:1854
MINUS				  Far	 ARRAY:179C
MM				  Near	 ARRAY:0F73
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 128
Symbol Table



MMM1				  Near	 ARRAY:0F7E
MMO				  Near	 ARRAY:24BD
MODA				  Far	 ARRAY:139E
MPLUS				  Far	 ARRAY:1776
MROT				  Far	 ARRAY:1AD1
MS1				  Near	 ARRAY:29E5
MSLAS				  Far	 ARRAY:16FC
MSMOD				  Far	 ARRAY:2890
MSTAR				  Far	 ARRAY:1696
MSTOR				  Far	 ARRAY:1C15
MTBUF				  Far	 ARRAY:28B6
MUL2				  Far	 ARRAY:1621
NEMI				  Near	 ARRAY:25B6
NEQ				  Far	 ARRAY:11ED
NFA				  Far	 ARRAY:1CE1
NH0				  Near	 ARRAY:25C8
NH1				  Near	 ARRAY:2522
NH2				  Near	 ARRAY:253E
NH3				  Near	 ARRAY:254C
NH4				  Near	 ARRAY:254E
NH5				  Near	 ARRAY:25E6
NH6				  Near	 ARRAY:25F0
NH7				  Near	 ARRAY:25FA
NIP				  Far	 ARRAY:1B49
NO				  Near	 ARRAY:1E77
NOTEQ				  Near	 ARRAY:1282
NUL				  Near	 ARRAY:241B
NULL				  Far	 ARRAY:2403
NUMB				  Far	 ARRAY:24F8
NZEQ				  Far	 ARRAY:1190
OCTAL				  Far	 ARRAY:1E26
ODOT				  Far	 ARRAY:2EE9
OFLIM				  Near	 ARRAY:1EA2
OFSET				  Far	 ARRAY:214C
OK				  Near	 ARRAY:13DF
ONE				  Far	 ARRAY:2064
ONEM				  Far	 ARRAY:1606
ONEP				  Far	 ARRAY:15CE
OUT1				  Near	 ARRAY:2F53
OUTCR				  Near	 ARRAY:0FAF
OUTTEXT				  Near	 ARRAY:0FBA
OVER				  Far	 ARRAY:19F8
PAD				  Far	 ARRAY:2425
PAREN				  Far	 ARRAY:27BC
PAUSE				  Near	 ARRAY:0E34
PB				  Near	 ARRAY:1EFB
PBUF				  Far	 ARRAY:1EE4
PDOTQ				  Far	 ARRAY:239E
PFA				  Far	 ARRAY:2268
PFIND				  Far	 ARRAY:10D4
PG				  Far	 ARRAY:2118
PICK				  Far	 ARRAY:19D0
PIX				  Far	 ARRAY:1377
PIX12				  Far	 ARRAY:1314
PIX13				  Far	 ARRAY:12E3
PIXPTR12			  Near	 ARRAY:1352
PLOOP				  Far	 ARRAY:2AD9
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 129
Symbol Table



PLU				  Near	 ARRAY:25C6
PLUS				  Far	 ARRAY:171A
PNT				  Far	 ARRAY:2135
PNUMB				  Far	 ARRAY:247F
PORT				  Far	 ARRAY:1594
PREV				  Far	 ARRAY:21BB
PRIN				  Far	 ARRAY:1451
PRINT				  Near	 ARRAY:1404
PRINTWORD			  Near	 ARRAY:0F52
PSCOD				  Far	 ARRAY:2336
PSTOR				  Far	 ARRAY:1BF9
PUT				  Near	 ARRAY:1173
PUT1				  Near	 ARRAY:1257
QCOMP				  Far	 ARRAY:2294
QCSP				  Far	 ARRAY:22D5
QDROP				  Far	 ARRAY:1AF2
QERR				  Far	 ARRAY:227C
QEXEC				  Far	 ARRAY:22AC
QLOAD				  Far	 ARRAY:22EF
QPAIR				  Far	 ARRAY:22C2
QSTAC				  Far	 ARRAY:2707
QUERY				  Far	 ARRAY:23E7
QUEST				  Far	 ARRAY:2C90
QUI				  Near	 ARRAY:27D7
QUIT				  Far	 ARRAY:27CD
R				  Far	 ARRAY:196F
RANDREC				  Word	 ARRAY:2FEB
RBRAC				  Far	 ARRAY:1DC6
RC				  Far	 ARRAY:1437
READ				  Far	 ARRAY:15B1
RECSIZE				  Word	 ARRAY:2FD6
RED				  Near	 ARRAY:2F42
REPEA				  Far	 ARRAY:2B2A
RNUM				  Far	 ARRAY:219C
ROT				  Far	 ARRAY:1AB1
RPSTO				  Far	 ARRAY:18BF
RR$				  Near	 ARRAY:1957
RW				  Far	 ARRAY:2F01
RZERO				  Far	 ARRAY:20A9
SCL				  Far	 ARRAY:1497
SCR				  Far	 ARRAY:213F
SCSP				  Far	 ARRAY:1D30
SEMI				  Far	 ARRAY:18DB
SEMIC				  Far	 ARRAY:2F91
SHOWRS				  Near	 ARRAY:0EC4
SHOWSTACK			  Near	 ARRAY:0EF2
SHOWSTDUMP			  Near	 ARRAY:0EA8
SHOWWD				  Near	 ARRAY:0E76
SIG				  Near	 ARRAY:2BEB
SIGN				  Far	 ARRAY:2BDB
SLASH				  Far	 ARRAY:284D
SLMOD				  Far	 ARRAY:283D
SLOW				  Near	 ARRAY:1106
SLOW1				  Near	 ARRAY:111A
SMI				  Far	 ARRAY:1F93
SMUG				  Far	 ARRAY:2322
SP1				  Near	 ARRAY:2BAE
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 130
Symbol Table



SPA				  Near	 ARRAY:2BA8
SPACE				  Far	 ARRAY:225A
SPACS				  Far	 ARRAY:2B98
SPAT				  Far	 ARRAY:1896
SPOT				  Far	 ARRAY:2822
SPSTO				  Far	 ARRAY:18A3
SRP				  Far	 ARRAY:1978
SSLA				  Far	 ARRAY:287E
SSMOD				  Far	 ARRAY:286D
STAR				  Far	 ARRAY:282E
STATE				  Far	 ARRAY:2174
STOD				  Far	 ARRAY:1833
STORE				  Far	 ARRAY:1CA8
STY				  Far	 ARRAY:2EB6
STY1				  Near	 ARRAY:2EC4
STY2				  Near	 ARRAY:2ED2
STY3				  Near	 ARRAY:2EE2
SUBB				  Far	 ARRAY:1736
SWAB				  Far	 ARRAY:17BA
SWAP				  Far	 ARRAY:1A18
SWAS				  Far	 ARRAY:2E8A
SZERO				  Far	 ARRAY:20A0
TASK				  Far	 ARRAY:2FB8
TC0				  Near	 ARRAY:237D
TC1				  Near	 ARRAY:2393
TER				  Near	 ARRAY:156A
TERMON				  Far	 ARRAY:0FF2
THEN				  Far	 ARRAY:2B7B
THREE				  Far	 ARRAY:2074
TIB				  Far	 ARRAY:20B3
TICK				  Far	 ARRAY:2A37
TOGL				  Far	 ARRAY:1C33
TOHEX				  Near	 ARRAY:0F26
TOP				  Near	 ARRAY:185C
TOR				  Far	 ARRAY:191A
TRAV				  Far	 ARRAY:1D89
TRI				  Near	 ARRAY:2D21
TRIO				  Far	 ARRAY:2D0F
TRUE				  Near	 ARRAY:1185
TRUE1				  Near	 ARRAY:1269
TRV				  Near	 ARRAY:1D8D
TTT				  Near	 ARRAY:2288
TTY				  Far	 ARRAY:1479
TWO				  Far	 ARRAY:206C
TWOP				  Far	 ARRAY:15E9
TY$$				  Far	 ARRAY:2DCE
TY4				  Near	 ARRAY:2DD4
TY5				  Near	 ARRAY:2DEA
TYPE$				  Near	 ARRAY:147B
UDOT				  Far	 ARRAY:2C9D
UDOTR				  Far	 ARRAY:2C67
ULESS				  Far	 ARRAY:11FD
UNTIL				  Far	 ARRAY:2AEF
UPDAT				  Far	 ARRAY:1F1F
UPPER				  Far	 ARRAY:1E91
USE				  Far	 ARRAY:21B0
USER				  Far	 ARRAY:1FF9
Turbo Assembler	 Version 3.1	    01/12/20 10:24:08	    Page 131
Symbol Table



USLAS				  Far	 ARRAY:1677
USTAR				  Far	 ARRAY:1659
VAR				  Far	 ARRAY:1FD7
VL0				  Near	 ARRAY:2D3B
VL1				  Near	 ARRAY:2D43
VL2				  Near	 ARRAY:2D7B
VLIST				  Far	 ARRAY:2D33
VOCAB				  Far	 ARRAY:2790
VOCL				  Far	 ARRAY:20ED
WD1				  Near	 ARRAY:244A
WD2				  Near	 ARRAY:244E
WR				  Near	 ARRAY:2F32
X				  Far	 ARRAY:1F41
XA				  Far	 ARRAY:21F2
XC				  Far	 ARRAY:21FB
XDO				  Far	 ARRAY:105C
XDP				  Word	 ARRAY:3033
XER				  Near	 ARRAY:263A
XLOOP				  Far	 ARRAY:1085
XM				  Far	 ARRAY:2204
XPLOO				  Far	 ARRAY:10B3
XR0				  Word	 ARRAY:0CCC
XS0				  Word	 STCK:0080
XT				  Near	 ARRAY:23D5
XTIB				  Word	 ARRAY:0C14
XUP				  Word	 ARRAY:0CD0
XVOC				  Far	 ARRAY:2FAF
XXX				  Near	 ARRAY:0DD5
Y$				  Near	 ARRAY:1E2D
Z$				  Near	 ARRAY:195A
ZBRAN				  Far	 ARRAY:101B
ZEQGR				  Far	 ARRAY:11AF
ZEQLES				  Far	 ARRAY:11CE
ZEQU				  Far	 ARRAY:1169
ZERO				  Far	 ARRAY:205C
ZGRET				  Far	 ARRAY:119F
ZLESS				  Far	 ARRAY:11BE
ZZZ				  Near	 ARRAY:12B5

Macro Name

HEAD
HEAD2
NEXT

Groups & Segments		  Bit Size Align  Combine Class

ARRAY				  16  AD33 Para	  none
DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
STCK				  16  0084 Para	  Stack
_TEXT				  16  0000 Word	  Public  CODE
