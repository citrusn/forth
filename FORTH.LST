Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 1
forth.asm



      1				     ; 253 слова head
      2				     ; 103 слова используют $col
      3				     ; 9 слова использует $con
      4				     ; 29 слова	использует $use
      5				     ; 1 слово forth
      6
      7				     masm
      8				     .8086
      9	0000			     .MODEL SMALL
     10				     LOCALS
     11	      =0000		     LINK=0
     12					 ; Макроопределения
     13					 ; Описание примитивов и слов высокого уровня
     14					 HEAD  MACRO length,name,lchar,labl,code
     15					 LINK$=$
     16					     DB	 length	 ; NFA 7 бит равен 1.
     17							 ; 6 - признак immediate. 5- слово не описано smudge
     18					     IFNB <name>
     19					     DB	 NAME
     20					     ENDIF
     21					     DB	 lchar	 ; последний символ слова + 128	(7 бит = 1).
     22					     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
     23					 LINK=LINK$
     24					 labl LABEL FAR	 ; CFA
     25					     IFNB <code> ;
     26					     DW	code
     27					     ELSE
     28					     DW	 $+2
     29					     ENDIF
     30					     ENDM
     31
     32	      =0001			 debug equ 1
     33					 NEXT MACRO   ;	переход	к исполнению следующего	слова
     34					     local m1
     35					     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
     36					     MOV  BX, AX     ; BX равен	CFA  следующего	слова
     37					 ; ------ call debugger	--------
     38					 IF debug
     39					     cmp byte ptr [di+102Q], 0
     40					     jz	m1
     41					     call printWORD
     42					     call pause
     43					   m1:
     44					 ENDIF
     45					 ; -----------------------------
     46					     JMP WORD PTR [BX]
     47					     ENDM
     48
     49
     50	0000				ARRAY	SEGMENT
     51	0000  0000 0000			$TIME	DW  0,0			    ; TIMER COUNTER
     52	0004  0000			$DATE	DW  0			    ; DATE
     53
     54					;  Сегмент стека и словарь пользователя	размещен в конце текста
     55					;  интерпретатора. Для версии, записываемой в ПЗУ, их нужно
     56					;  разместить здесь.
     57
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 2
forth.asm



     58	0006  03*(0000 0200*(0000)+	DSKBUF	DW  3 DUP(0,512	DUP(0),0)   ; Экранные буферы на 1024 байта
     59	      0000)
     60	0C12  0000			ENDBUF	DW  0	     ; 6 1034 (40Ah) 2062(80Eh)	адреса буферов
     61
     62	0C14  5C*(0000)			XTIB	DW  92 DUP(0)		    ; Входной буфер
     63	0CCC  0000 0000			XR0	DW  0,0			    ; Стек возвратов  растет в область
     64									    ; меньших адресов.	ADD BP - убрать	данные
     65	0CD0  66*(0000)			XUP	DW  102	DUP(0)		    ; USER-область на нее указывает DI
     66
     67	0D9C  2FA1r			$STI	DW  TASK-7  ;		    ; Стартовая	таблица	PFA слова TASK
     68	0D9E  0CD0r			$US	DW  XUP	    ;		    ; адрес user области
     69					;    переменные
     70	0DA0  0080r			$STK	DW  XS0	    ;+6		     ; SO
     71	0DA2  0CCCr			$RS	DW  XR0	    ;+8		     ; RO стек возвратов
     72	0DA4  0C14r				DW  XTIB    ;+10	     ; входной буфер
     73	0DA6  001F				DW  1Fh	    ;+12	     ; WIDTH 31	буква
     74	0DA8  0000				DW  0	    ;+14	     ; WARNING
     75	0DAA  3023r				DW  XDP	    ;+16	     ; словарь FENCE (забор)
     76	0DAC  3023r				DW  XDP	    ;+18	     ; DP
     77	0DAE  2F9Fr				DW  XVOC    ;+20	     ; словарь VOCL в слове Forth
     78	0DB0  0006r			$BUF	DW  DSKBUF  ;+22	     ; экранный	буфер FIRST
     79	0DB2  0C12r				DW  ENDBUF  ;+24 или 30Q     ; LIMIT
     80
     81					ASSUME	CS:ARRAY, DS:ARRAY, ES:ARRAY, SS:STCK
     82
     83	0DB4				$INI	  PROC	  FAR
     84	0DB4  EB 08				  JMP  ENT
     85					; ** PRIMITIVES	**
     86
     87						  HEAD	  83h,'IN',311Q,INIT		      ;INI
1    88	      =ARRAY:0DB6		 LINK$=$
1    89	0DB6  83			     DB	 83h  ;	NFA 7 бит равен	1.
1    90							 ; 6 - признак immediate. 5- слово не описано smudge
1    91	0DB7  49 4E			     DB	 'IN'
1    92	0DB9  C9			     DB	 311Q	; последний символ слова + 128 (7 бит =	1).
1    93	0DBA  0000			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1    94	      =ARRAY:0DB6		 LINK=LINK$
1    95	0DBC				 INIT LABEL FAR	 ; CFA
1    96	0DBC  0DBEr			     DW	 $+2
     97	0DBE  B9 0000s			ENT:	  MOV	CX, ARRAY
     98	0DC1  8E D9				  MOV	DS, CX		; Установка DX
     99	0DC3  8E C1				  MOV	ES, CX
    100	0DC5  A1 0D9Cr				  MOV	AX, $STI	; Восстановление словаря (PFA слова TASK)
    101	0DC8  BE 2F9Dr				  LEA	SI, FORTH+6	; Адрес	места нахождения в PFA forth
    102	0DCB  89 04				  MOV	[SI], AX	;
    103	0DCD  8B 36 0DB0r			  MOV	SI, $BUF
    104	0DD1  B9 06CB				  MOV	CX, 1739	; Установка счетчика 1730
    105	0DD4  C7 04 0000		XXX:	  MOV	WORD PTR [SI],0	; Обнуление массивов
    106	0DD8  83 C6 02				  ADD	SI, 2
    107	0DDB  E2 F7				  LOOP	XXX
    108
    109					; INIT 'OFFSET,	USE, PREV
    110	0DDD  8B 1E 0D9Er			  MOV	BX, $US		 ; xup
    111	0DE1  8B 0E 0DB0r			  MOV	CX, $BUF	 ; TO 'USE'
    112	0DE5  89 4F 3A				  MOV	[BX]+72Q,CX	 ; USE ? адрес блока
    113	0DE8  89 4F 3C				  MOV	[BX]+74Q,CX	 ; PREV	? адрес	блока
    114	0DEB  C7 47 42 0000			  MOV	word ptr [BX]+102Q,00h	    ; отладка выключена
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 3
forth.asm



    115	0DF0  B9 000A				  MOV	CX, 10		 ; Установка счетчика USER (14Q	надо на	2 меньше уже)
    116	0DF3  8B 3E 0D9Er			  MOV	DI, $US		 ; Запись адреса области USER
    117	0DF7  83 C7 06				  ADD	DI, 6		 ; почему 6....	? User переменные начинаются с 6 адреса
    118	0DFA  BE 0DA0r				  LEA	SI, $STK	 ; Запись начального адреса
    119						  ; заполняем начальные	значения переменых
    120	0DFD  F3> A5			REP	  MOVS	WORD PTR ES:[DI], WORD PTR DS:[SI]
    121	0DFF  8B 2E 0DA2r			  MOV	BP, $RS		 ; Установка начального	значения
    122									 ; указателя стека возвратов
    123									 ; пересекается	с областью TIB
    124									 ; RS растет в область с меньшими адресами
    125	0E03  8B 3E 0D9Er			  MOV	DI, $US
    126	0E07  C7 45 1A 0007			  MOV	WORD PTR [DI+32Q],7  ; Установка цвета вывода текста
    127	0E0C  C7 45 22 0000			  MOV	WORD PTR [DI+42Q],0  ; Сброс флага печати
    128	0E11  BE 0E25r				  LEA	SI, GO$
    129						  NEXT
1   130	0E14  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   131	0E15  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   132					 ; ------ call debugger	--------
1   133	0E17  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   134	0E1B  74 06			     jz	??0000
1   135	0E1D  E8 0131			     call printWORD
1   136	0E20  E8 0010			     call pause
1   137	0E23				   ??0000:
1   138					 ; -----------------------------
1   139	0E23  FF 27			     JMP WORD PTR [BX]
    140						  ; здесь инструкции языка форт. указатель на них в SI
    141	0E25  1897r 1DFAr 2F97r	  +	GO$:	  DW SPSTO,DECIMA,FORTH,DEFIN, ONE,LOA,	quit; загрузка первого экрана
    142	      1EB8r 2058r 29EDr	  +
    143	      27C1r
    144	0E33			     $INI      ENDP
    145
    146				     include debug.asm
1   147				     ; ╨╛╨▒╤А╨░╨▒╨╛╤В╨║╨░ ╨╜╨░╨╢╨░╤В╨╕╤П ╨║╨╗╨░╨▓╨╕╤И
1   148	0E33			     pause proc
1   149	0E33				 @start:
1   150	0E33  33 C0			     xor ax, ax
1   151	0E35  CD 16			     int 16h ; AL = ASCII ╤Б╨╕╨╝╨▓╨╛╨╗ (╨╡╤Б╨╗╨╕ AL=0, AH ╤Б╨╛╨┤╨╡╤А╨╢╨╕╤В		    +
    152				     ╤А╨░╤Б╤И╨╕╤А╨╡╨╜╨╜╤Л╨╣ ╨║╨╛╨┤ ASCII )
1   153						     ; AH = ╤Б╨║╨░╨╜╨║╨╛╨┤  ╨╕╨╗╨╕ ╤А╨░╤Б╤И╨╕╤А╨╡╨╜╨╜╤Л╨╣ ╨║╨╛╨┤ ASCII
1   154	0E37  80 FC 10			     cmp ah, 10h ; ╨║╨╗╨░╨▓╨╕╤И╨░ Q (quit)
1   155	0E3A  74 20			     je	@e
1   156	0E3C  80 FC 20			     cmp ah, 20h ; ╨║╨╗╨░╨▓╨╕╤И╨░ D (debug off)
1   157	0E3F  74 2E			     je	@d
1   158	0E41  80 FC 1F			     cmp ah, 1Fh ; ╨║╨╗╨░╨▓╨╕╤И╨░ S (show parameters stack)
1   159	0E44  74 24			     je	@s
1   160	0E46  80 FC 13			     cmp ah, 13h ; ╨║╨╗╨░╨▓╨╕╤И╨░ R (show return stack)
1   161	0E49  74 1A			     je	@rs
1   162	0E4B  80 FC 31			     cmp ah, 31h ; ╨║╨╗╨░╨▓╨╕╤И╨░ N (next step)
1   163	0E4E  74 24			     je	@r
1   164	0E50  80 FC 39			     cmp ah, 39h ; ╨║╨╗╨░╨▓╨╕╤И╨░ SPACE	(next step)
1   165	0E53  74 1F			     je	@r
1   166	0E55  80 FC 11			     cmp ah, 11h ; ╨║╨╗╨░╨▓╨╕╤И╨░ W(next word from dict)
1   167	0E58  74 06			     je	@v
1   168	0E5A  EB D7			     jmp @start
1   169	0E5C  B4 4C			 @e: mov ah, 4Ch ; ╨▓╤Л╤Е╨╛╨┤ ╨╕╨╖ ╨┐╤А╨╛╨│╤А╨░╨╝╨╝╤Л
1   170	0E5E  CD 21			     int 21h
1   171	0E60  E8 0012			 @v: call showWD
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 4
forth.asm



1   172	0E63  EB CE			     jmp @start
1   173	0E65  E8 005B			 @rs: call showRS
1   174	0E68  EB C9			     jmp @start
1   175	0E6A  E8 0084			 @s: call showStack
1   176	0E6D  EB C4			     jmp @start
1   177	0E6F  C7 45 42 0000		 @d: mov word ptr [DI]+102Q,00h	 ; ╨╛╤В╨╗╨░╨┤╨║╨░ ╨▓╤Л╨║╨╗╤О╤З╨╡╨╜╨░
1   178					     ;jmp @start
1   179	0E74  C3			 @r: ret
1   180	0E75			     pause endp
1   181
1   182	0E75			     proc showWD
1   183	0E75  57			 push di
1   184	0E76  53			 push bx
1   185	0E77  BA 0E91r			 mov dx, offset	@@caption
1   186	0E7A  E8 013C			 call outText
1   187	0E7D  BF 0E9Er			 mov di,OFFSET @@ASCII ;
1   188	0E80  8B 04			 mov ax, [si]
1   189	0E82  E8 00A0			 call toHex
1   190	0E85  BA 0E9Er			 mov dx, offset	@@ASCII
1   191	0E88  E8 012E			 call outText
1   192	0E8B  E8 0120			 call outCR
1   193	0E8E  5B			 pop bx
1   194	0E8F  5F			 pop di
1   195	0E90  C3			 ret
1   196	0E91  4E 45 58 54 20 57	4F+	 @@caption DB "NEXT WORD:  $"
    197	      52 44 3A 20 20 24
1   198	0E9E  30 30 30 30 20 20	20+	 @@ASCII DB "0000    $"
    199	      20 24
1   200	0EA7			     showWD endp
1   201
1   202				     ; ╨┐╨╡╤З╨░╤В╤М ╨┤╨░╨╝╨┐╨░ ╨┐╨░╨╝╤П╤В╨╕ ╨▓ ╨┐╨╛╤А╤П╨┤╨║╨╡ ╤Б╤В╨╡╨║╨░
1   203				     ; c╤Е - ╤З╨╕╤Б╨╗╨╛	╨▒╨░╨╣╤В
1   204				     ; bx - ╨░╨┤╤А╨╡╤Б ╨┐╨░╨╝╤П╤В╨╕
1   205				     ; dx - ╨░╨┤╤А╨╡╤Б ╤Б╤В╤А╨╛╨║╨╕
1   206	0EA7			     showStDump	proc
1   207	0EA7  D1 E9			 shr cx, 1   ; ╨▒╨░╨╣╤В╤Л ╨▓ ╤Б╨╗╨╛╨▓╨░
1   208	0EA9  0B C9			 or cx , cx
1   209	0EAB  74 15			 jz @@r
1   210	0EAD  8C D0			 mov ax, ss
1   211	0EAF  8E C0			 mov es, ax
1   212	0EB1			       @@l:
1   213	0EB1  4B			 dec bx
1   214	0EB2  4B			 dec bx
1   215	0EB3  26: 8B 07			 mov ax, es:[bx]
1   216	0EB6  53			 push bx
1   217	0EB7  8B FA			 mov di, dx
1   218	0EB9  E8 0069			 call toHex
1   219					 ;mov dx, offset @@ASCII
1   220	0EBC  E8 00FA			 call outText
1   221	0EBF  5B			 pop bx
1   222	0EC0  E2 EF			 loop @@l
1   223	0EC2			       @@r:
1   224	0EC2  C3			 ret
1   225	0EC3			     showStDump	endP
1   226
1   227				     ; ╤Б╤В╨╡╨║	╨▓╨╛╨╖╨▓╤А╨░╤В╨╛╨▓
1   228	0EC3			     showRS proc
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 5
forth.asm



1   229	0EC3  57			 push di
1   230	0EC4  56			 push si
1   231	0EC5  06			 push es
1   232	0EC6  53			 push bx
1   233	0EC7  BA 0EE5r			 mov dx, offset	@@caption
1   234	0ECA  E8 00EC			 call outText
1   235	0ECD  B9 0CCCr			 mov cx, offset	XR0
1   236	0ED0  8B DD			 mov bx, BP
1   237	0ED2  2B CB			 sub cx, bx
1   238	0ED4  BA 0EEBr			 mov dx, offset	@@ASCII
1   239	0ED7  BB 0CCCr			 mov bx, offset	XR0
1   240	0EDA  E8 FFCA			 call showStDump
1   241	0EDD			       @@r:
1   242	0EDD  E8 00CE			 call outCR
1   243	0EE0  5B			 pop bx
1   244	0EE1  07			 pop es
1   245	0EE2  5E			 pop si
1   246	0EE3  5F			 pop di
1   247	0EE4  C3			 ret
1   248	0EE5  52 53 3A 20 20 24		 @@caption DB "RS:  $"
1   249	0EEB  30 30 30 30 20 24		 @@ASCII DB "0000 $"
1   250	0EF1			     showRS endP
1   251
1   252				     ; ╤Б╤В╨╡╨║	╨┐╨░╤А╨░╨╝╨╡╤В╤А╨╛╨▓
1   253	0EF1			     showStack proc
1   254	0EF1  57			 push di
1   255	0EF2  56			 push si
1   256	0EF3  06			 push es
1   257	0EF4  53			 push bx
1   258	0EF5  BA 0F16r			 mov dx, offset	@@caption
1   259	0EF8  E8 00BE			 call outText
1   260	0EFB  B9 0080			 mov cx, 80h
1   261	0EFE  8B DC			 mov bx, SP
1   262	0F00  83 C3 0C			 add bx, 2*6   ; ╤Б╤В╨╛╨╗╤М╨║╨╛	╨╗╨╕╤И╨╜╨╕╤Е ╤Н╨╗╨╡╨╝╨╡╨╜╤В╨╛╨▓	╤Б╤В╨╡╨║╨╡
1   263	0F03  2B CB			 sub cx, bx
1   264	0F05  BB 0080			 mov bx, 80h
1   265	0F08  BA 0F1Fr			 mov dx, offset	@@ASCII
1   266	0F0B  E8 FF99			 call showStDump
1   267	0F0E			       @@r:
1   268	0F0E  E8 009D			 call outCR
1   269	0F11  5B			 pop bx
1   270	0F12  07			 pop es
1   271	0F13  5E			 pop si
1   272	0F14  5F			 pop di
1   273	0F15  C3			 ret
1   274	0F16  53 54 41 43 4B 3A	20+	 @@caption DB "STACK:  $"
    275	      20 24
1   276	0F1F  30 30 30 30 20 24		 @@ASCII DB "0000 $"
1   277	0F25			     showStack endP
1   278
1   279				     ; AX- ╨╖╨╜╨░╤З╨╡╨╜╨╕╨╡ ╨┤╨╗╤П ╨┐╨╡╤З╨░╤В╨╕	╨▓ 16 ╨▓╨╕╨┤╨╡
1   280				     ; di - ╨░╨┤╤А╨╡╤Б ╤Б╤В╤А╨╛╨║╨╕ ╨┤╨╗╤П ╨▓╤Л╨▓╨╛╨┤╨░
1   281	0F25			     toHex PROC
1   282	0F25  51			 push cx
1   283	0F26  B1 04			 mov cl,4	     ; number of ASCII
1   284	0F28  D1 C0 D1 C0 D1 C0	D1+  @@1: rol ax,4	     ; 1 Nibble	(start with highest byte)
    285	      C0
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 6
forth.asm



1   286	0F30  8A D8			 mov bl,al
1   287	0F32  80 E3 0F			 and bl,0Fh	     ; only low-Nibble
1   288	0F35  80 C3 30			 add bl,30h	     ; convert to ASCII
1   289	0F38  80 FB 39			 cmp bl,39h	     ; above 9?
1   290	0F3B  76 03			 jna short @@2
1   291	0F3D  80 C3 07			 add bl,7	     ; "A" to "F"
1   292	0F40  88 1D		     @@2: mov [di],bl	      ;	store ASCII in buffer
1   293	0F42  47			 inc di		     ; increase	target address
1   294	0F43  FE C9			 dec cl		     ; decrease	loop counter
1   295	0F45  75 E1			 jnz @@1	      ;	jump if	cl is not equal	0 (zeroflag is not set)
1   296	0F47  59			 pop cx
1   297	0F48  C3			 ret
1   298	0F49			     toHex endP
1   299
1   300				     ; di- ╨░╨┤╤А╨╡╤Б ╨▒╤Г╤Д╨╡╤А╨░
1   301				     ; cx - ╤З╨╕╤Б╨╗╨╛ ╤Б╨╕╨╝╨▓╨╛╨╗╨╛╨▓
1   302				     ; ╨╖╨░╨┐╨╛╨╗╨╜╨╡╨╜╨╕╨╡ ╨┐╤А╨╛╨▒╨╡╨╗╨╛╨╝
1   303	0F49			     blankBuffer proc
1   304	0F49  57			 push di
1   305	0F4A  FC			 cld
1   306	0F4B  B0 20			 mov al, 32
1   307	0F4D  F3> AA			 rep stosb
1   308	0F4F  5F			 pop di
1   309	0F50  C3			 ret
1   310	0F51			     blankBuffer endp
1   311
1   312				     ; ╨▓╤Л╨▓╨╛╨┤ ╨░╨┤╤А╨╡╤Б╨░ ╨╕ ╨╕╨╝╨╡╨╜╨╕ ╤Б╨╗╨╛╨▓╨░
1   313				     ; AX- ╨╖╨╜╨░╤З╨╡╨╜╨╕╨╡ ╨░╨┤╤А╨╡╤Б╨░
1   314	0F51			     printWORD proc
1   315	0F51  57			 push di
1   316	0F52  56			 push si
1   317	0F53  53			 push bx
1   318	0F54  50			 push ax
1   319	0F55  BF 0F91r			 mov di,OFFSET ASCII ; get the offset address
1   320	0F58  B9 0019			 mov cx, 25
1   321	0F5B  E8 FFEB			 call blankBuffer
1   322					 ; ╨┐╨╡╤З╨░╤В╤М	╨░╨┤╤А╨╡╤Б╨░ ╤Б╨╗╨╛╨▓╨░
1   323	0F5E  8B C6			 mov ax, si
1   324	0F60  2D 0002			 sub ax, 2
1   325	0F63  E8 FFBF			 call toHex
1   326	0F66  47			 inc di
1   327	0F67  47			 inc di
1   328					 ; ╨┐╨╡╤З╨░╤В╤М	CFA ╤Б╨╗╨╛╨▓╨░
1   329	0F68  58			 pop ax
1   330	0F69  50			 push ax
1   331	0F6A  E8 FFB8			 call toHex
1   332	0F6D  47			 inc di	 ; ╨▓╤Л╨▓╨╛╨┤ ╨╕╨╝╨╡╨╜╨╕ ╤Б╨╗╨╛╨▓╨░ ╨┐╨╛╤Б╨╗╨╡ ╨╡╨│╨╛ ╨░╨┤╤А╨╡╤Б╨░
1   333	0F6E  5B			 pop bx	; ╨░╨┤╤А╨╡╤Б ╤Б╨╗╨╛╨▓╨░	CFA?
1   334					 ;mov al, byte ptr [bx-3] ; ╨┐╨╛╤Б╨╗╨╡╨┤╨╜╨╕╨╣ ╤Б╨╕╨╝╨▓╨╛╨╗ ╤Б╨╗╨╛╨▓╨░
1   335	0F6F  83 EB 03			 SUB bx, 3   ;
1   336	0F72				 mm:	      ;	╨╕╤Й╨╡╨╝ ╨┐╨╛╨╗╨╡ ╨┤╨╗╨╕╨╜╤Л
1   337	0F72  4B			 dec bx
1   338	0F73  80 3F 00			 CMP  BYTE PTR [bx],  0
1   339	0F76  79 FA			 JNS  mm     ; JUMP IF POSITIVE
1   340	0F78  8B 0F			 mov cx, [bx] ;	╨┤╨╗╨╕╨╜╨░ ╤Б╨╗╨╛╨▓╨░ +	╨▓╤Б╤П╨║╨╕╨╡  ╤Б╨╗╤Г╨╢.	╨┐╨╛╨╗╤П
1   341	0F7A  83 E1 3F			 and cx, 003Fh
1   342	0F7D				 mmm1:
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 7
forth.asm



1   343	0F7D  43			 inc bx
1   344	0F7E  8A 07			 mov al, byte ptr [bx]
1   345	0F80  24 7F			 and al, 7Fh ;	 ╨┐╨╛╤Б╨╗╨╡╨┤╨╜╨╕╨╣ ╤Б╨╕╨╝╨▓╨╛╨╗ ╤Г╨▓╨╡╨╗╨╕╤З╨╡╨╜ ╨╜╨░ 80h
1   346	0F82  88 05			 mov [di],al
1   347	0F84  47			 inc di
1   348	0F85  E2 F6			 loop mmm1
1   349					 ; Print string
1   350	0F87  BA 0F91r			 mov dx,OFFSET ASCII ; DOS 1+ WRITE STRING TO STANDARD OUTPUT
1   351	0F8A  E8 002C			 call outText
1   352	0F8D  5B			 pop bx
1   353	0F8E  5E			 pop si
1   354	0F8F  5F			 pop di
1   355	0F90  C3			 ret
1   356	0F91  30 30 30 30 3A 20	30+	 ASCII DB "0000: 0000		     ",0Dh,0Ah,"$" ; buffer for	ASCII string
    357	      30 30 30 20 20 20	20+
    358	      20 20 20 20 20 20	20+
    359	      20 20 20 20 20 0D	0A+
    360	      24
1   361	0FAE			     printWORD endP
1   362
1   363	0FAE			     outCR proc
1   364	0FAE  B4 09			 mov ah,9	     ; DS:DX->'$'-terminated string
1   365	0FB0  BA 0FB6r			 lea dx, @@cr
1   366	0FB3  CD 21			 int 21h	     ; (using pipe character">") or output to printer
1   367	0FB5  C3			 ret
1   368	0FB6  0D 0A 24			 @@cr DB 0Dh, 0Ah, "$"
1   369	0FB9			     outCR endp
1   370
1   371				     ; ╨▓╤Л╨▓╨╛╨┤ ╤В╨╡╨║╤Б╤В╨░
1   372	0FB9			     outText proc
1   373	0FB9  B4 09			 mov ah,9	     ; DS:DX->'$'-terminated string
1   374	0FBB  CD 21			 int 21h	     ; (using pipe character">") or output to printer
1   375	0FBD  C3			 ret
1   376	0FBE			     outText endp
1   377
    378
    379					; BX - WP находится адрес исполняемого слова
    380					; SI - IP-регистр    должен сохраняться
    381					; DI - указатель области USER
    382					; BP - указатель стека возвратов
    383					; SP - указатель стека параметров
    384
    385						  HEAD	  87h,'EXECUT',305Q,EXEC	      ;
1   386	      =ARRAY:0FBE		 LINK$=$
1   387	0FBE  87			     DB	 87h  ;	NFA 7 бит равен	1.
1   388							 ; 6 - признак immediate. 5- слово не описано smudge
1   389	0FBF  45 58 45 43 55 54		     DB	 'EXECUT'
1   390	0FC5  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1   391	0FC6  0DB6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   392	      =ARRAY:0FBE		 LINK=LINK$
1   393	0FC8				 EXEC LABEL FAR	 ; CFA
1   394	0FC8  0FCAr			     DW	 $+2
    395					 ; в стеке адрес поля CFA (НЕ PFA)
    396	0FCA  5B				  POP	BX
    397	0FCB  FF 27				  JMP  WORD PTR	[ BX ]
    398
    399						  HEAD	  83h,'LI',324Q,LIT		      ;	LIT
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 8
forth.asm



1   400	      =ARRAY:0FCD		 LINK$=$
1   401	0FCD  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   402							 ; 6 - признак immediate. 5- слово не описано smudge
1   403	0FCE  4C 49			     DB	 'LI'
1   404	0FD0  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1   405	0FD1  0FBEr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   406	      =ARRAY:0FCD		 LINK=LINK$
1   407	0FD3				 LIT LABEL FAR	; CFA
1   408	0FD3  0FD5r			     DW	 $+2
    409	0FD5  AD				  LODSW
    410	0FD6  50				  PUSH	AX
    411						  NEXT
1   412	0FD7  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   413	0FD8  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   414					 ; ------ call debugger	--------
1   415	0FDA  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   416	0FDE  74 06			     jz	??0001
1   417	0FE0  E8 FF6E			     call printWORD
1   418	0FE3  E8 FE4D			     call pause
1   419	0FE6				   ??0001:
1   420					 ; -----------------------------
1   421	0FE6  FF 27			     JMP WORD PTR [BX]
    422
    423						  HEAD	  86h,'TERMO',316Q,TERMON	      ;	TERMON
1   424	      =ARRAY:0FE8		 LINK$=$
1   425	0FE8  86			     DB	 86h  ;	NFA 7 бит равен	1.
1   426							 ; 6 - признак immediate. 5- слово не описано smudge
1   427	0FE9  54 45 52 4D 4F		     DB	 'TERMO'
1   428	0FEE  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1   429	0FEF  0FCDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   430	      =ARRAY:0FE8		 LINK=LINK$
1   431	0FF1				 TERMON	LABEL FAR  ; CFA
1   432	0FF1  0FF3r			     DW	 $+2
    433					 ; NumLock, ScrollLock,	CapsLock, Ins. Состояние этих клавиш записывается
    434					 ; в область данных BIOS в два байта с адресами	0000h:0417h и 0000h:0418h
    435	0FF3  58				  POP	AX
    436	0FF4  06				  PUSH	ES
    437	0FF5  B9 0000				  MOV	CX, 0
    438	0FF8  8E C1				  MOV	ES, CX
    439	0FFA  26: A3 0417			  MOV	ES:417H,AX
    440	0FFE  07				  POP	ES
    441						  NEXT
1   442	0FFF  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   443	1000  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   444					 ; ------ call debugger	--------
1   445	1002  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   446	1006  74 06			     jz	??0002
1   447	1008  E8 FF46			     call printWORD
1   448	100B  E8 FE25			     call pause
1   449	100E				   ??0002:
1   450					 ; -----------------------------
1   451	100E  FF 27			     JMP WORD PTR [BX]
    452
    453						  HEAD	  87h,'?BRANC',310Q,ZBRAN	      ;	?BRANCH
1   454	      =ARRAY:1010		 LINK$=$
1   455	1010  87			     DB	 87h  ;	NFA 7 бит равен	1.
1   456							 ; 6 - признак immediate. 5- слово не описано smudge
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 9
forth.asm



1   457	1011  3F 42 52 41 4E 43		     DB	 '?BRANC'
1   458	1017  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1   459	1018  0FE8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   460	      =ARRAY:1010		 LINK=LINK$
1   461	101A				 ZBRAN LABEL FAR  ; CFA
1   462	101A  101Cr			     DW	 $+2
    463					 ; переход, если 0 в стеке (FALSE)
    464	101C  58				  POP	AX
    465	101D  3D 0000				  CMP	AX, 0
    466	1020  74 1F				  JE	CNT
    467	1022  83 C6 02				  ADD	SI, 2 ;	без перехода пропускаем	следующее слово	(адрес перехода)
    468						  NEXT
1   469	1025  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   470	1026  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   471					 ; ------ call debugger	--------
1   472	1028  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   473	102C  74 06			     jz	??0003
1   474	102E  E8 FF20			     call printWORD
1   475	1031  E8 FDFF			     call pause
1   476	1034				   ??0003:
1   477					 ; -----------------------------
1   478	1034  FF 27			     JMP WORD PTR [BX]
    479
    480						  HEAD	  86h,'BRANC',310Q,BRAN		      ;	BRANCH
1   481	      =ARRAY:1036		 LINK$=$
1   482	1036  86			     DB	 86h  ;	NFA 7 бит равен	1.
1   483							 ; 6 - признак immediate. 5- слово не описано smudge
1   484	1037  42 52 41 4E 43		     DB	 'BRANC'
1   485	103C  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1   486	103D  1010r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   487	      =ARRAY:1036		 LINK=LINK$
1   488	103F				 BRAN LABEL FAR	 ; CFA
1   489	103F  1041r			     DW	 $+2
    490					 ; безусловный переход.	SI указывает на	число инструкций,
    491					 ; которые нужно пропустить
    492	1041  03 34			CNT:	  ADD	SI,  [SI]  ; si	содержит число инструкций,
    493								 ; которые необходимо пропустить
    494						  NEXT
1   495	1043  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   496	1044  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   497					 ; ------ call debugger	--------
1   498	1046  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   499	104A  74 06			     jz	??0004
1   500	104C  E8 FF02			     call printWORD
1   501	104F  E8 FDE1			     call pause
1   502	1052				   ??0004:
1   503					 ; -----------------------------
1   504	1052  FF 27			     JMP WORD PTR [BX]
    505
    506						  HEAD	  84h,'(DO',251Q,XDO		      ;	(DO)
1   507	      =ARRAY:1054		 LINK$=$
1   508	1054  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   509							 ; 6 - признак immediate. 5- слово не описано smudge
1   510	1055  28 44 4F			     DB	 '(DO'
1   511	1058  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1   512	1059  1036r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   513	      =ARRAY:1054		 LINK=LINK$
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 10
forth.asm



1   514	105B				 XDO LABEL FAR	; CFA
1   515	105B  105Dr			     DW	 $+2
    516	105D  58				  POP	AX  ; в	стек данных начальное значение цикла
    517	105E  83 ED 02				  SUB	BP, 2
    518	1061  8F 46 00				  POP	[BP] ; конечное	значение цикла
    519	1064  83 ED 02				  SUB	BP, 2
    520	1067  89 46 00				  MOV	WORD PTR  [BP],AX ; в стек возвратов начальное значение	цикла
    521						 ; RS растет в сторону с меньшими адресами
    522						 ; BP  до входа	в слово.
    523						 ; BP-2	- конечное значение цикла
    524						 ; BP-4	- начальное значение
    525						  NEXT
1   526	106A  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   527	106B  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   528					 ; ------ call debugger	--------
1   529	106D  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   530	1071  74 06			     jz	??0005
1   531	1073  E8 FEDB			     call printWORD
1   532	1076  E8 FDBA			     call pause
1   533	1079				   ??0005:
1   534					 ; -----------------------------
1   535	1079  FF 27			     JMP WORD PTR [BX]
    536
    537						  HEAD	  86h,'(LOOP',251Q,XLOOP	      ;	(LOOP)
1   538	      =ARRAY:107B		 LINK$=$
1   539	107B  86			     DB	 86h  ;	NFA 7 бит равен	1.
1   540							 ; 6 - признак immediate. 5- слово не описано smudge
1   541	107C  28 4C 4F 4F 50		     DB	 '(LOOP'
1   542	1081  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1   543	1082  1054r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   544	      =ARRAY:107B		 LINK=LINK$
1   545	1084				 XLOOP LABEL FAR  ; CFA
1   546	1084  1086r			     DW	 $+2
    547					; Приращение индекса цикла LOOP	и может	быть  ветвление
    548	1086  FF 46 00				  INC	WORD PTR  [BP] ; начальное значение увеличиваем
    549	1089  8B 46 00			LOP:	  MOV	AX,  [BP]    ; индекс
    550	108C  3B 46 02				  CMP	AX,  [BP+2]  ; предел цикла
    551	108F  7C B0				  JL	CNT
    552	1091  83 C5 04			LV:	  ADD	BP,  4 ; удаляем параметры цикла
    553	1094  83 C6 02				  ADD	SI,  2 ; переход к следующеу слову
    554						  NEXT
1   555	1097  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   556	1098  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   557					 ; ------ call debugger	--------
1   558	109A  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   559	109E  74 06			     jz	??0006
1   560	10A0  E8 FEAE			     call printWORD
1   561	10A3  E8 FD8D			     call pause
1   562	10A6				   ??0006:
1   563					 ; -----------------------------
1   564	10A6  FF 27			     JMP WORD PTR [BX]
    565
    566						  HEAD	  87h,'(+LOOP',251Q,XPLOO	      ;	(+LOOP)
1   567	      =ARRAY:10A8		 LINK$=$
1   568	10A8  87			     DB	 87h  ;	NFA 7 бит равен	1.
1   569							 ; 6 - признак immediate. 5- слово не описано smudge
1   570	10A9  28 2B 4C 4F 4F 50		     DB	 '(+LOOP'
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 11
forth.asm



1   571	10AF  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1   572	10B0  107Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   573	      =ARRAY:10A8		 LINK=LINK$
1   574	10B2				 XPLOO LABEL FAR  ; CFA
1   575	10B2  10B4r			     DW	 $+2
    576					 ; n  ---
    577	10B4  58				  POP	AX
    578	10B5  01 46 00				  ADD	[BP],	AX
    579	10B8  3D 0000				  CMP	AX, 0
    580	10BB  7C 02				  JL	$LESS
    581	10BD  EB CA				  JMP	LOP
    582	10BF  8B 4E 00			  $LESS:  MOV	CX, [BP]   ; Работа с отрицательными приращениями
    583	10C2  39 4E 02				  CMP	[BP]+2,	CX
    584	10C5  7E CA				  JLE	LV
    585	10C7  E9 FF77				  JMP	CNT
    586
    587						  HEAD	  86h,'(FIND',251Q,PFIND	      ;	PFIND
1   588	      =ARRAY:10CA		 LINK$=$
1   589	10CA  86			     DB	 86h  ;	NFA 7 бит равен	1.
1   590							 ; 6 - признак immediate. 5- слово не описано smudge
1   591	10CB  28 46 49 4E 44		     DB	 '(FIND'
1   592	10D0  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1   593	10D1  10A8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   594	      =ARRAY:10CA		 LINK=LINK$
1   595	10D3				 PFIND LABEL FAR  ; CFA
1   596	10D3  10D5r			     DW	 $+2
    597					     ;	addr1 addr2 ---	pfa b tf (ok) оператор поиска
    598					; Адрес	строки	NFA => PFA длина TRUE/FALSE (!реально СFA !)
    599	10D5  58				  POP	AX	 ; NFA последнего слова	в context словаре
    600	10D6  59				  POP	CX	 ; addr1 строка	для поиска. первый байт	длина образца
    601	10D7  55				  PUSH	BP	 ; сохранение содержимого регистров
    602	10D8  56				  PUSH	SI	 ; --
    603	10D9  57				  PUSH	DI	 ; --
    604	10DA  8B F1				  MOV	SI, CX	 ; адрес образца
    605	10DC  2B ED				  SUB	BP, BP	 ;
    606	10DE  8B F8				  MOV	DI, AX	 ; NFA	последнего слова в словаре
    607	10E0  8B 14				  MOV	DX,WORD	PTR [SI] ; длина строки	поиска и первый	символ
    608	10E2  81 E2 7F7F			  AND	DX, 77577Q ; 7F7f - сброс старших битов. кажется лишним
    609	10E6  FC				  CLD			 ; DF=0	(вперед)
    610	10E7  8B 0D			FAST:	  MOV	CX,WORD	PTR [DI] ;
    611	10E9  81 E1 7F3F			  AND	CX, 77477Q ; сброс 7-ых	и 6 бита в первом байте
    612	10ED  3B D1				  CMP	DX, CX	 ; сравним длину и первый символ
    613	10EF  74 14				  JE	SLOW	 ; если	равны, может то, что ищем
    614	10F1  83 3D 00			MATCH:	  CMP	WORD PTR [DI], 0 ; ищем	конец nfa
    615	10F4  78 03				  JS	$SIG	     ; BPL
    616	10F6  47				  INC	DI	     ; следующий символ	в слове
    617	10F7  EB F8				  JMP	MATCH
    618	10F9  83 C7 02			$SIG:	  ADD	DI, 2	     ; переход к полю LFA
    619	10FC  83 3D 00				  CMP	WORD PTR [DI],0	 ; список слов закончился
    620	10FF  74 34				  JE	FAIL		 ; LFA =0, поиск не удачен
    621	1101  8B 3D				  MOV	DI,WORD	PTR [DI] ; переход к другому слову в словаре
    622	1103  EB E2				  JMP	FAST
    623	1105  8B 2D			SLOW:	  MOV	BP,WORD	PTR [DI] ; длина и первый символ найденого слова
    624	1107  8B DE				  MOV	BX, SI		 ; адрес образца
    625	1109  EB 0D				  JMP	SLOW1
    626	110B  43			$LOOP:	  INC	BX		 ; перебор символов
    627	110C  8B 07				  MOV	AX,WORD	PTR [BX]
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 12
forth.asm



    628	110E  8B 0D				  MOV	CX,WORD	PTR [DI]
    629	1110  81 E1 7FFF			  AND	CX, 77777Q   ; 7FFFh
    630	1114  3B C1				  CMP	AX, CX
    631	1116  75 D9				  JNE	MATCH	     ; не совпало, переход на начало
    632	1118  47			SLOW1:	  INC	DI
    633	1119  F7 45 FF 8000			  TEST	WORD PTR -1[DI],100000Q	; 8000h
    634	111E  74 EB				  JZ	$LOOP	     ; переход,	если 7 бит РАВЕН 0
    635	1120  8B D5				  MOV	DX, BP	     ; длина слова
    636	1122  83 C7 05				  ADD	DI, 5	     ; PFA найденого слова
    637	1125  8B C7				  MOV	AX, DI
    638	1127  5F				  POP	DI	     ; восстановление содержимого регистров
    639	1128  5E				  POP	SI
    640	1129  5D				  POP	BP
    641	112A  2D 0002				  SUB	AX, 2	     ; CFA
    642	112D  50				  PUSH	AX
    643	112E  81 E2 00FF			  AND	DX, 377Q	; FFh выделяем байт длины и ФЛАГОВ
    644	1132  52				  PUSH	DX		; в стек
    645	1133  EB 4B				  JMP	TRUE		; Установка флага "Найдено"
    646	1135  5F			FAIL:	  POP	DI
    647	1136  5E				  POP	SI
    648	1137  5D				  POP	BP
    649	1138  EB 32				  JMP	FALSE
    650
    651						  HEAD	  85h,'DIGI',324Q,DIGIT		      ;	DIGIT
1   652	      =ARRAY:113A		 LINK$=$
1   653	113A  85			     DB	 85h  ;	NFA 7 бит равен	1.
1   654							 ; 6 - признак immediate. 5- слово не описано smudge
1   655	113B  44 49 47 49		     DB	 'DIGI'
1   656	113F  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1   657	1140  10CAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   658	      =ARRAY:113A		 LINK=LINK$
1   659	1142				 DIGIT LABEL FAR  ; CFA
1   660	1142  1144r			     DW	 $+2
    661					; ASCII-DIGIT BASE=>DIGIT-VALUE	TRUE (FALSE)
    662	1144  58				  POP	AX	; AX=BASE
    663	1145  59				  POP	CX
    664	1146  83 E9 30				  SUB	CX, 60Q	; VALID	DIGIT =	ASCII-60
    665	1149  7C 21				  JL	FALSE
    666	114B  83 F9 09				  CMP	CX, 9	; Если >9
    667	114E  7E 08				  JLE	M09
    668	1150  83 E9 07				  SUB	CX, 7
    669	1153  83 F9 0A				  CMP	CX, 10
    670	1156  7C 14				  JL	FALSE
    671	1158  3B C8			M09:	  CMP	CX, AX	; Если не меньше BASE, то ошибка
    672	115A  7D 10				  JGE	FALSE
    673	115C  51				  PUSH	CX	; Запись цифры в стек
    674	115D  EB 21				  JMP	TRUE	; "Успешный" выход
    675
    676					;	  **  Стандартные слова	 **
    677					;	  **  Условные операторы  **
    678
    679						  HEAD	  82h,'0',275Q,ZEQU		      ;	0=
1   680	      =ARRAY:115F		 LINK$=$
1   681	115F  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   682							 ; 6 - признак immediate. 5- слово не описано smudge
1   683	1160  30			     DB	 '0'
1   684	1161  BD			     DB	 275Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 13
forth.asm



1   685	1162  113Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   686	      =ARRAY:115F		 LINK=LINK$
1   687	1164				 ZEQU LABEL FAR	 ; CFA
1   688	1164  1166r			     DW	 $+2
    689	1166  58				  POP	AX
    690	1167  3D 0000				  CMP	AX,  0
    691	116A  74 14				  JE	TRUE
    692	116C  2B C0			FALSE:	  SUB	AX,  AX
    693	116E  50			PUT:	  PUSH	AX
    694						  NEXT
1   695	116F  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   696	1170  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   697					 ; ------ call debugger	--------
1   698	1172  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   699	1176  74 06			     jz	??0007
1   700	1178  E8 FDD6			     call printWORD
1   701	117B  E8 FCB5			     call pause
1   702	117E				   ??0007:
1   703					 ; -----------------------------
1   704	117E  FF 27			     JMP WORD PTR [BX]
    705	1180  B8 0001			TRUE:	  MOV	AX,  1
    706	1183  EB E9				  JMP	PUT
    707
    708						  HEAD	  83h,'0<','>'+80h,NZEQ		      ;	0<>
1   709	      =ARRAY:1185		 LINK$=$
1   710	1185  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   711							 ; 6 - признак immediate. 5- слово не описано smudge
1   712	1186  30 3C			     DB	 '0<'
1   713	1188  BE			     DB	 '>'+80h   ; последний символ слова + 128 (7 бит = 1).
1   714	1189  115Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   715	      =ARRAY:1185		 LINK=LINK$
1   716	118B				 NZEQ LABEL FAR	 ; CFA
1   717	118B  118Dr			     DW	 $+2
    718	118D  58				  POP	AX
    719	118E  3D 0000				  CMP	AX,  0
    720	1191  75 ED				  JNE	 TRUE
    721	1193  EB D7				  JMP FALSE
    722
    723						  HEAD	  82h,'0',276Q,ZGRET		      ;	0>
1   724	      =ARRAY:1195		 LINK$=$
1   725	1195  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   726							 ; 6 - признак immediate. 5- слово не описано smudge
1   727	1196  30			     DB	 '0'
1   728	1197  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1   729	1198  1185r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   730	      =ARRAY:1195		 LINK=LINK$
1   731	119A				 ZGRET LABEL FAR  ; CFA
1   732	119A  119Cr			     DW	 $+2
    733	119C  58				  POP	AX
    734	119D  3D 0000				  CMP	AX, 0
    735	11A0  7F DE				  JG	TRUE
    736	11A2  EB C8				  JMP	FALSE
    737
    738						  HEAD	  83h,'0=',276Q,ZEQGR		       ; 0=>
1   739	      =ARRAY:11A4		 LINK$=$
1   740	11A4  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   741							 ; 6 - признак immediate. 5- слово не описано smudge
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 14
forth.asm



1   742	11A5  30 3D			     DB	 '0='
1   743	11A7  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1   744	11A8  1195r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   745	      =ARRAY:11A4		 LINK=LINK$
1   746	11AA				 ZEQGR LABEL FAR  ; CFA
1   747	11AA  11ACr			     DW	 $+2
    748	11AC  58				  POP	AX
    749	11AD  3D 0000				  CMP	AX, 0
    750	11B0  7D CE				  JGE	 TRUE
    751	11B2  EB B8				  JMP	FALSE
    752
    753						  HEAD	  82h,'0',274Q,ZLESS		      ;	0<
1   754	      =ARRAY:11B4		 LINK$=$
1   755	11B4  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   756							 ; 6 - признак immediate. 5- слово не описано smudge
1   757	11B5  30			     DB	 '0'
1   758	11B6  BC			     DB	 274Q	; последний символ слова + 128 (7 бит =	1).
1   759	11B7  11A4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   760	      =ARRAY:11B4		 LINK=LINK$
1   761	11B9				 ZLESS LABEL FAR  ; CFA
1   762	11B9  11BBr			     DW	 $+2
    763	11BB  58				  POP	AX
    764	11BC  3D 0000				  CMP	AX, 0
    765	11BF  78 BF				  JS	TRUE	     ; Если минус
    766	11C1  EB A9				  JMP	FALSE
    767
    768						  HEAD	  83h,'0=',274Q,ZEQLES		      ;	0=<
1   769	      =ARRAY:11C3		 LINK$=$
1   770	11C3  83			     DB	 83h  ;	NFA 7 бит равен	1.
1   771							 ; 6 - признак immediate. 5- слово не описано smudge
1   772	11C4  30 3D			     DB	 '0='
1   773	11C6  BC			     DB	 274Q	; последний символ слова + 128 (7 бит =	1).
1   774	11C7  11B4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   775	      =ARRAY:11C3		 LINK=LINK$
1   776	11C9				 ZEQLES	LABEL FAR  ; CFA
1   777	11C9  11CBr			     DW	 $+2
    778	11CB  58				  POP	AX
    779	11CC  3D 0000				  CMP	AX, 0
    780	11CF  78 AF				  JS   TRUE	    ; Если минус
    781	11D1  74 AD				  JE   TRUE	     ; или ноль
    782	11D3  EB 97				  JMP	FALSE
    783
    784						  HEAD	  81h,,275Q,EQUAL		      ;	=
1   785	      =ARRAY:11D5		 LINK$=$
1   786	11D5  81			     DB	 81h  ;	NFA 7 бит равен	1.
1   787							 ; 6 - признак immediate. 5- слово не описано smudge
1   788	11D6  BD			     DB	 275Q	; последний символ слова + 128 (7 бит =	1).
1   789	11D7  11C3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   790	      =ARRAY:11D5		 LINK=LINK$
1   791	11D9				 EQUAL LABEL FAR  ; CFA
1   792	11D9  11DBr			     DW	 $+2
    793	11DB  58				  POP	AX
    794	11DC  59				  POP	CX
    795	11DD  3B C8				  CMP	CX, AX
    796	11DF  74 9F				  JE	TRUE
    797	11E1  EB 89				  JMP	FALSE
    798
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 15
forth.asm



    799						  HEAD	  82h,'<','>'+80h,NEQ		       ; <>
1   800	      =ARRAY:11E3		 LINK$=$
1   801	11E3  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   802							 ; 6 - признак immediate. 5- слово не описано smudge
1   803	11E4  3C			     DB	 '<'
1   804	11E5  BE			     DB	 '>'+80h   ; последний символ слова + 128 (7 бит = 1).
1   805	11E6  11D5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   806	      =ARRAY:11E3		 LINK=LINK$
1   807	11E8				 NEQ LABEL FAR	; CFA
1   808	11E8  11EAr			     DW	 $+2
    809	11EA  58				  POP	AX
    810	11EB  59				  POP	CX
    811	11EC  3B C8				  CMP	CX, AX
    812	11EE  74 5A				  JE	FALSE1
    813	11F0  EB 6C				  JMP	TRUE1
    814
    815						  HEAD	  82h,'U',274Q,ULESS		      ;	U<
1   816	      =ARRAY:11F2		 LINK$=$
1   817	11F2  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   818							 ; 6 - признак immediate. 5- слово не описано smudge
1   819	11F3  55			     DB	 'U'
1   820	11F4  BC			     DB	 274Q	; последний символ слова + 128 (7 бит =	1).
1   821	11F5  11E3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   822	      =ARRAY:11F2		 LINK=LINK$
1   823	11F7				 ULESS LABEL FAR  ; CFA
1   824	11F7  11F9r			     DW	 $+2
    825	11F9  58				  POP	AX
    826	11FA  59				  POP	CX
    827	11FB  3B C8				  CMP	CX, AX
    828	11FD  72 5F				  JB	TRUE1		; для чисел без	знака
    829	11FF  EB 49				  JMP	FALSE1
    830
    831						  HEAD	  81h,,274Q,LESS		      ;	<
1   832	      =ARRAY:1201		 LINK$=$
1   833	1201  81			     DB	 81h  ;	NFA 7 бит равен	1.
1   834							 ; 6 - признак immediate. 5- слово не описано smudge
1   835	1202  BC			     DB	 274Q	; последний символ слова + 128 (7 бит =	1).
1   836	1203  11F2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   837	      =ARRAY:1201		 LINK=LINK$
1   838	1205				 LESS LABEL FAR	 ; CFA
1   839	1205  1207r			     DW	 $+2
    840	1207  58				  POP	AX
    841	1208  59				  POP	CX
    842	1209  3B C1				  CMP	AX, CX
    843	120B  7F 51				  JG	TRUE1
    844	120D  EB 3B				  JMP	FALSE1
    845
    846						  HEAD	  82h,'=',274Q,EQLES		      ;	=<
1   847	      =ARRAY:120F		 LINK$=$
1   848	120F  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   849							 ; 6 - признак immediate. 5- слово не описано smudge
1   850	1210  3D			     DB	 '='
1   851	1211  BC			     DB	 274Q	; последний символ слова + 128 (7 бит =	1).
1   852	1212  1201r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   853	      =ARRAY:120F		 LINK=LINK$
1   854	1214				 EQLES LABEL FAR  ; CFA
1   855	1214  1216r			     DW	 $+2
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 16
forth.asm



    856	1216  58				  POP	AX
    857	1217  59				  POP	CX
    858	1218  3B C1				  CMP	AX, CX
    859	121A  7D 42				  JGE	 TRUE1
    860	121C  EB 2C				  JMP	FALSE1
    861
    862						  HEAD	  81h,,276Q,GREAT		      ;	>
1   863	      =ARRAY:121E		 LINK$=$
1   864	121E  81			     DB	 81h  ;	NFA 7 бит равен	1.
1   865							 ; 6 - признак immediate. 5- слово не описано smudge
1   866	121F  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1   867	1220  120Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   868	      =ARRAY:121E		 LINK=LINK$
1   869	1222				 GREAT LABEL FAR  ; CFA
1   870	1222  1224r			     DW	 $+2
    871	1224  58				  POP	AX
    872	1225  59				  POP	CX
    873	1226  3B C1				  CMP	AX, CX
    874	1228  7C 34				      JL    TRUE1
    875	122A  EB 1E				  JMP	FALSE1
    876
    877						  HEAD	  82h,'=',276Q,EQGR			; =>
1   878	      =ARRAY:122C		 LINK$=$
1   879	122C  82			     DB	 82h  ;	NFA 7 бит равен	1.
1   880							 ; 6 - признак immediate. 5- слово не описано smudge
1   881	122D  3D			     DB	 '='
1   882	122E  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1   883	122F  121Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   884	      =ARRAY:122C		 LINK=LINK$
1   885	1231				 EQGR LABEL FAR	 ; CFA
1   886	1231  1233r			     DW	 $+2
    887	1233  58				  POP	AX
    888	1234  59				  POP	CX
    889	1235  3B C1				  CMP	AX, CX
    890	1237  7E 25				      JLE    TRUE1
    891	1239  EB 0F				  JMP	FALSE1
    892
    893						 HEAD	  84h,'EVE', 'N'+80h, $EVEN	      ;	EVEN
1   894	      =ARRAY:123B		 LINK$=$
1   895	123B  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   896							 ; 6 - признак immediate. 5- слово не описано smudge
1   897	123C  45 56 45			     DB	 'EVE'
1   898	123F  CE			     DB	 'N'+80h   ; последний символ слова + 128 (7 бит = 1).
1   899	1240  122Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   900	      =ARRAY:123B		 LINK=LINK$
1   901	1242				 $EVEN LABEL FAR  ; CFA
1   902	1242  1244r			     DW	 $+2
    903					 ; проверка на четность
    904	1244  58				 pop ax
    905	1245  A9 0001				 test ax, 1 ; проверяем	младший	бит
    906	1248  74 14				 jz true1 ; если бит=0,	то число четное
    907	124A  2B C0			 FALSE1: SUB   AX,  AX
    908	124C  50			 PUT1:	 PUSH  AX
    909						 NEXT
1   910	124D  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   911	124E  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   912					 ; ------ call debugger	--------
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 17
forth.asm



1   913	1250  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   914	1254  74 06			     jz	??0008
1   915	1256  E8 FCF8			     call printWORD
1   916	1259  E8 FBD7			     call pause
1   917	125C				   ??0008:
1   918					 ; -----------------------------
1   919	125C  FF 27			     JMP WORD PTR [BX]
    920	125E  B8 0001			 TRUE1:	 MOV   AX,  1
    921	1261  EB E9				 JMP   PUT1
    922
    923					;	  ******************
    924
    925						  HEAD	  84h,'ENC',314Q,ENCL		      ;	ENCLOSE
1   926	      =ARRAY:1263		 LINK$=$
1   927	1263  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   928							 ; 6 - признак immediate. 5- слово не описано smudge
1   929	1264  45 4E 43			     DB	 'ENC'
1   930	1267  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1   931	1268  123Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   932	      =ARRAY:1263		 LINK=LINK$
1   933	126A				 ENCL LABEL FAR	 ; CFA
1   934	126A  126Cr			     DW	 $+2
    935					 ; addr1 c -- addr1 n1 n2 n3
    936	126C  58				  POP	AX	   ; разделитель
    937	126D  59				  POP	CX	   ; начальный адрес
    938	126E  8B D9				  MOV	BX, CX
    939	1270  38 07			A:	  CMP	BYTE PTR  [BX],	AL ; обход разделителей	в начале
    940	1272  75 03				  JNE	NOTEQ
    941	1274  43			AAA1:	  INC	BX
    942	1275  EB F9				  JMP	A
    943	1277  80 3F 0D			NOTEQ:	  CMP	BYTE PTR  [BX],	15Q ; обход перевода строки
    944	127A  74 F8				  JE	AAA1
    945	127C  80 3F 0A				  CMP	BYTE PTR  [BX],	12Q
    946	127F  74 F3				  JE	AAA1		     ; обход перевода строки
    947	1281  8B D3				  MOV	DX, BX		     ; начало лексемы
    948	1283  52				  PUSH	DX
    949	1284  80 3F 00			AA:	  CMP	BYTE PTR  [BX],	 0
    950	1287  74 21				  JE	ZZZ		     ; если нуль
    951	1289  38 07				  CMP	BYTE PTR  [BX],	AL   ; не нуль,	ищем конец лексемы
    952	128B  74 03				  JE	EQW
    953	128D  43				  INC	BX
    954	128E  EB F4				  JMP	AA
    955	1290  8B C3			EQW:	  MOV	AX, BX
    956	1292  2B DA				  SUB	BX, DX
    957	1294  53				  PUSH	BX
    958	1295  2B C1				  SUB	AX, CX
    959	1297  40				  INC	AX
    960	1298  50				  PUSH	AX
    961						  NEXT		     ; выход из	слова
1   962	1299  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   963	129A  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   964					 ; ------ call debugger	--------
1   965	129C  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1   966	12A0  74 06			     jz	??0009
1   967	12A2  E8 FCAC			     call printWORD
1   968	12A5  E8 FB8B			     call pause
1   969	12A8				   ??0009:
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 18
forth.asm



1   970					 ; -----------------------------
1   971	12A8  FF 27			     JMP WORD PTR [BX]
    972
    973	12AA  3B DA			ZZZ:	  CMP	BX, DX
    974	12AC  75 E2				  JNE	EQW
    975	12AE  43				  INC	BX
    976	12AF  EB DF				  JMP	EQW
    977
    978					 ;	   ** Дисплей **
    979
    980						  HEAD	  84h,'PAG',305Q,$PAGE		      ;	PAGE
1   981	      =ARRAY:12B1		 LINK$=$
1   982	12B1  84			     DB	 84h  ;	NFA 7 бит равен	1.
1   983							 ; 6 - признак immediate. 5- слово не описано smudge
1   984	12B2  50 41 47			     DB	 'PAG'
1   985	12B5  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1   986	12B6  1263r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1   987	      =ARRAY:12B1		 LINK=LINK$
1   988	12B8				 $PAGE LABEL FAR  ; CFA
1   989	12B8  12BAr			     DW	 $+2
    990					 ; Установка активной страницы ( PAGE --)
    991	12BA  58				  POP	AX
    992					 ; вход:  AL = номер страницы (большинство программ использует страницу	0)
    993	12BB  B4 05				  MOV	AH, 5
    994	12BD  CD 10				  INT	10h
    995						  NEXT
1   996	12BF  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1   997	12C0  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1   998					 ; ------ call debugger	--------
1   999	12C2  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1000	12C6  74 06			     jz	??000A
1  1001	12C8  E8 FC86			     call printWORD
1  1002	12CB  E8 FB65			     call pause
1  1003	12CE				   ??000A:
1  1004					 ; -----------------------------
1  1005	12CE  FF 27			     JMP WORD PTR [BX]
   1006
   1007						 HEAD	 85h,'PIX1','3'+80h,PIX13	      ;	pixel 13h mode
1  1008	      =ARRAY:12D0		 LINK$=$
1  1009	12D0  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  1010							 ; 6 - признак immediate. 5- слово не описано smudge
1  1011	12D1  50 49 58 31		     DB	 'PIX1'
1  1012	12D5  B3			     DB	 '3'+80h   ; последний символ слова + 128 (7 бит = 1).
1  1013	12D6  12B1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1014	      =ARRAY:12D0		 LINK=LINK$
1  1015	12D8				 PIX13 LABEL FAR  ; CFA
1  1016	12D8  12DAr			     DW	 $+2
   1017					     ; color y x ->
   1018	12DA  5B				 pop bx
   1019	12DB  58				 pop ax
   1020	12DC  BA 0140				 mov dx, 320
   1021	12DF  F7 E2				 mul dx
   1022	12E1  03 C3				 add ax, bx
   1023	12E3  BB A000				 mov bx, 0a000h
   1024	12E6  59				 pop cx
   1025	12E7  06				 push es
   1026	12E8  8E C3				 mov es, bx
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 19
forth.asm



   1027	12EA  8B D8				 mov bx, ax
   1028	12EC  26: 88 0F				 mov es:[bx], cl
   1029	12EF  07				 pop es
   1030						 NEXT
1  1031	12F0  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1032	12F1  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1033					 ; ------ call debugger	--------
1  1034	12F3  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1035	12F7  74 06			     jz	??000B
1  1036	12F9  E8 FC55			     call printWORD
1  1037	12FC  E8 FB34			     call pause
1  1038	12FF				   ??000B:
1  1039					 ; -----------------------------
1  1040	12FF  FF 27			     JMP WORD PTR [BX]
   1041
   1042						 HEAD	 85h,'PIX1','2'+80h,PIX12	      ;	pixel 12h mode
1  1043	      =ARRAY:1301		 LINK$=$
1  1044	1301  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  1045							 ; 6 - признак immediate. 5- слово не описано smudge
1  1046	1302  50 49 58 31		     DB	 'PIX1'
1  1047	1306  B2			     DB	 '2'+80h   ; последний символ слова + 128 (7 бит = 1).
1  1048	1307  12D0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1049	      =ARRAY:1301		 LINK=LINK$
1  1050	1309				 PIX12 LABEL FAR  ; CFA
1  1051	1309  130Br			     DW	 $+2
   1052					     ; color y x ->
   1053					     ; ax - row
   1054					     ; bx - column
   1055					     ; ch - color
   1056	130B  5B				 pop bx
   1057	130C  58				 pop ax
   1058	130D  59				 pop cx
   1059	130E  8A E9				 mov ch, cl
   1060	1310  06				 push es
   1061	1311  E8 0033				 call pixptr12
   1062	1314  BA 03CE				 mov dx, 3ceh
   1063
   1064	1317  D2 E4				 shl ah, cl
   1065	1319  B0 08				 mov al, 8
   1066	131B  EF				 out dx, ax
   1067
   1068	131C  B8 0205				 mov ax, 205h
   1069	131F  EF				 out dx, ax
   1070
   1071	1320  B8 0003				 mov ax, 3
   1072	1323  EF				 out dx, ax
   1073
   1074	1324  26: 8A 07				 mov al, es:[bx]
   1075	1327  26: 88 2F				 mov es:[bx], ch
   1076
   1077	132A  B8 FF08				 mov ax, 0ff08h
   1078	132D  EF				 out dx, ax
   1079	132E  B8 0005				 mov ax, 5
   1080	1331  EF				 out dx,ax
   1081	1332  B4 03				 mov ah, 3
   1082	1334  EF				 out dx, ax
   1083	1335  07				 pop es
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 20
forth.asm



   1084						 NEXT
1  1085	1336  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1086	1337  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1087					 ; ------ call debugger	--------
1  1088	1339  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1089	133D  74 06			     jz	??000C
1  1090	133F  E8 FC0F			     call printWORD
1  1091	1342  E8 FAEE			     call pause
1  1092	1345				   ??000C:
1  1093					 ; -----------------------------
1  1094	1345  FF 27			     JMP WORD PTR [BX]
   1095
   1096	1347					 pixptr12 proc
   1097					 ; ax-row
   1098					 ; bx-column
   1099					 ; returns
   1100					 ; es:bx -> pixel
   1101					 ; cl -	bit position
   1102					 ; ah -	bitmask
   1103	1347  52				 push dx
   1104	1348  8A CB				 mov cl, bl
   1105	134A  BA 0050				 mov dx, 80
   1106	134D  F7 E2				 mul dx
   1107	134F  D1 EB D1 EB D1 EB			 shr bx, 3
   1108	1355  03 D8				 add bx, ax
   1109	1357  B8 A000				 mov ax, 0a000h
   1110	135A  8E C0				 mov es, ax
   1111	135C  80 E1 07				 and cl, 7
   1112	135F  80 F1 07				 xor cl, 7
   1113	1362  B4 01				 mov ah, 1
   1114	1364  5A				 pop dx
   1115	1365  C3				 ret
   1116	1366					 pixptr12 endp
   1117
   1118						  HEAD	  83h,'PI',330Q,PIX		      ;	PIX
1  1119	      =ARRAY:1366		 LINK$=$
1  1120	1366  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1121							 ; 6 - признак immediate. 5- слово не описано smudge
1  1122	1367  50 49			     DB	 'PI'
1  1123	1369  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  1124	136A  1301r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1125	      =ARRAY:1366		 LINK=LINK$
1  1126	136C				 PIX LABEL FAR	; CFA
1  1127	136C  136Er			     DW	 $+2
   1128					 ; COLCOD ROW COLUMN -->  -    запись графической точки
   1129	136E  59				  POP	CX		    ; колонка x?
   1130	136F  5A				  POP	DX		    ; строка y?
   1131	1370  58				  POP	AX		    ; код цветности
   1132						  ;PUSH	 DX		     ; сохранение DX
   1133						  ;MOV	 DX, BX		     ; BH = номер видео	страницы ??? где
   1134						  ;SUB	 DH, DH		     ; ошибка в	коде
   1135	1371  50				  push	 ax
   1136	1372  B4 0F				  MOV	AH, 0Fh		    ; Чтение текущей страницы
   1137	1374  CD 10				  INT	10h		    ; в	BH
   1138	1376  58				  pop	 ax		    ; код цветности
   1139	1377  B4 0C				  MOV	AH, 0Ch		    ;
   1140	1379  CD 10				  INT	10h		    ; запись графической точки
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 21
forth.asm



   1141						  ;POP	 DX		     ; восстановление DX
   1142						  NEXT
1  1143	137B  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1144	137C  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1145					 ; ------ call debugger	--------
1  1146	137E  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1147	1382  74 06			     jz	??000D
1  1148	1384  E8 FBCA			     call printWORD
1  1149	1387  E8 FAA9			     call pause
1  1150	138A				   ??000D:
1  1151					 ; -----------------------------
1  1152	138A  FF 27			     JMP WORD PTR [BX]
   1153
   1154						  HEAD	  84h,'MOD','A'+80h,MODA		 ; MODA
1  1155	      =ARRAY:138C		 LINK$=$
1  1156	138C  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1157							 ; 6 - признак immediate. 5- слово не описано smudge
1  1158	138D  4D 4F 44			     DB	 'MOD'
1  1159	1390  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  1160	1391  1366r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1161	      =ARRAY:138C		 LINK=LINK$
1  1162	1393				 MODA LABEL FAR	 ; CFA
1  1163	1393  1395r			     DW	 $+2
   1164					 ; установка режима. ( М --> - )
   1165	1395  58				  POP	AX
   1166	1396  2A E4				  SUB	AH, AH	     ; 00H уст.	видео режим. Очистить экран
   1167								     ;	установить поля	BIOS, установить режим.
   1168	1398  CD 10				  INT	 10h
   1169						  NEXT
1  1170	139A  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1171	139B  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1172					 ; ------ call debugger	--------
1  1173	139D  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1174	13A1  74 06			     jz	??000E
1  1175	13A3  E8 FBAB			     call printWORD
1  1176	13A6  E8 FA8A			     call pause
1  1177	13A9				   ??000E:
1  1178					 ; -----------------------------
1  1179	13A9  FF 27			     JMP WORD PTR [BX]
   1180
   1181						  HEAD	  83h,'EM',311Q,EMI$		      ;	EMI
1  1182	      =ARRAY:13AB		 LINK$=$
1  1183	13AB  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1184							 ; 6 - признак immediate. 5- слово не описано smudge
1  1185	13AC  45 4D			     DB	 'EM'
1  1186	13AE  C9			     DB	 311Q	; последний символ слова + 128 (7 бит =	1).
1  1187	13AF  138Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1188	      =ARRAY:13AB		 LINK=LINK$
1  1189	13B1				 EMI$ LABEL FAR	 ; CFA
1  1190	13B1  13B3r			     DW	 $+2
   1191	13B3  59				  POP	CX		; Число	символов
   1192	13B4  58				  POP	AX		; Символ
   1193	13B5  51				  PUSH	CX		; Сохранение содержимого CX
   1194	13B6  50				  PUSH	AX		; Сохранение содержимого AХ
   1195	13B7  8B 5D 1A				  MOV	BX, [DI+32Q]	; Установка атрибута
   1196	13BA  B4 0F				  MOV	AH, 0Fh		; Чтение текущей страницы
   1197	13BC  CD 10				  INT	10h		; в BH
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 22
forth.asm



   1198	13BE  58				  POP	AX		; Восстановление содержимого AX
   1199	13BF  B4 09				  MOV	AH, 9		; Запись строки	символов
   1200	13C1  CD 10				  INT	10h
   1201	13C3  B4 03				  MOV	AH, 3		; Чтение положения курсора
   1202	13C5  CD 10				  INT	10h
   1203	13C7  59				  POP	CX
   1204	13C8  02 D1				  ADD	DL, CL		; DH,DL	= строка, колонка (считая от 0)
   1205	13CA  B4 02				  MOV	AH, 2		; Установка положения курсора
   1206	13CC  CD 10			$EM:	  INT	10h
   1207	13CE  83 7D 22 00			  CMP	WORD PTR [DI+42Q], 0  ;	сброс флага печати
   1208	13D2  75 25				  JNE	PRINT
   1209	13D4				OK:	  NEXT
1  1210	13D4  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1211	13D5  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1212					 ; ------ call debugger	--------
1  1213	13D7  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1214	13DB  74 06			     jz	??000F
1  1215	13DD  E8 FB71			     call printWORD
1  1216	13E0  E8 FA50			     call pause
1  1217	13E3				   ??000F:
1  1218					 ; -----------------------------
1  1219	13E3  FF 27			     JMP WORD PTR [BX]
   1220
   1221						  HEAD	  84h,'EMI',324Q,EMIT,$EMIT	      ;	EMIT
1  1222	      =ARRAY:13E5		 LINK$=$
1  1223	13E5  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1224							 ; 6 - признак immediate. 5- слово не описано smudge
1  1225	13E6  45 4D 49			     DB	 'EMI'
1  1226	13E9  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  1227	13EA  13ABr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1228	      =ARRAY:13E5		 LINK=LINK$
1  1229	13EC				 EMIT LABEL FAR	 ; CFA
1  1230	13EC  13EEr			     DW	$EMIT
   1231					 ; вывод текста	без атрибутов (по умолчанию)
   1232	13EE				$EMIT	  LABEL	  FAR
   1233	13EE  58				  POP	AX
   1234	13EF  50			ENT$:	  PUSH	AX
   1235	13F0  B4 0F				  MOV	AH, 15	     ; Чтение текущей страницы
   1236	13F2  CD 10				  INT	10h
   1237	13F4  58				  POP	AX
   1238	13F5  B4 0E				  MOV	AH, 14	     ;
   1239	13F7  EB D3				  JMP	$EM
   1240
   1241	13F9  BA 0000			PRINT:	  MOV	DX, 0	; Установка номера принтера
   1242	13FC  2A E4				  SUB	AH, AH
   1243	13FE  CD 17				  INT	17h
   1244	1400  F6 C4 29				  TEST	 AH, 29h
   1245	1403  74 CF				  JE	OK
   1246	1405  8A C4			ERR4:	  MOV	AL, AH
   1247	1407  04 30				  ADD	AL, 60Q
   1248	1409  B4 0E				  MOV	AH, 14
   1249	140B  CD 10				  INT	10h
   1250	140D  BA 1416r				  MOV	DX, OFFSET ERMES4
   1251	1410  B4 09				  MOV	AH, 9H
   1252	1412  CD 21				  INT	21H
   1253	1414  EB 59				  JMP	TYPE$
   1254	1416  20 50 52 49 4E 54	45+	ERMES4	  DB   " PRINTER ERROR $" ;
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 23
forth.asm



   1255	      52 20 45 52 52 4F	52+
   1256	      20 24
   1257
   1258						  HEAD	  82h,'R',303Q,RC		; RC
1  1259	      =ARRAY:1426		 LINK$=$
1  1260	1426  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1261							 ; 6 - признак immediate. 5- слово не описано smudge
1  1262	1427  52			     DB	 'R'
1  1263	1428  C3			     DB	 303Q	; последний символ слова + 128 (7 бит =	1).
1  1264	1429  13E5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1265	      =ARRAY:1426		 LINK=LINK$
1  1266	142B				 RC LABEL FAR  ; CFA
1  1267	142B  142Dr			     DW	 $+2
   1268	142D  B8 000D				  MOV	AX, 13
   1269	1430  EB BD				  JMP	ENT$
   1270
   1271						  HEAD	  82h,'I',314Q,IL		; BELL
1  1272	      =ARRAY:1432		 LINK$=$
1  1273	1432  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1274							 ; 6 - признак immediate. 5- слово не описано smudge
1  1275	1433  49			     DB	 'I'
1  1276	1434  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  1277	1435  1426r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1278	      =ARRAY:1432		 LINK=LINK$
1  1279	1437				 IL LABEL FAR  ; CFA
1  1280	1437  1439r			     DW	 $+2
   1281	1439  B8 0007				  MOV	AX, 7
   1282	143C  EB B1				  JMP	ENT$
   1283
   1284						  HEAD	  84h,'PRI',316Q,PRIN		; PRINT-FLAG
1  1285	      =ARRAY:143E		 LINK$=$
1  1286	143E  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1287							 ; 6 - признак immediate. 5- слово не описано smudge
1  1288	143F  50 52 49			     DB	 'PRI'
1  1289	1442  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  1290	1443  1432r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1291	      =ARRAY:143E		 LINK=LINK$
1  1292	1445				 PRIN LABEL FAR	 ; CFA
1  1293	1445  1447r			     DW	 $+2
   1294	1447  FF 45 22				  INC	WORD PTR  [DI+42Q]
   1295	144A  BA 0000				  MOV	DX,  0	     ; Установка номера	принтера
   1296	144D  B4 01				  MOV	AH,  1	     ; Инициализация принтера
   1297	144F  CD 17				  INT	17H
   1298	1451  F6 C4 29				  TEST	AH,  29h
   1299	1454  75 AF				  JNE	ERR4
   1300						  NEXT
1  1301	1456  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1302	1457  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1303					 ; ------ call debugger	--------
1  1304	1459  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1305	145D  74 06			     jz	??0010
1  1306	145F  E8 FAEF			     call printWORD
1  1307	1462  E8 F9CE			     call pause
1  1308	1465				   ??0010:
1  1309					 ; -----------------------------
1  1310	1465  FF 27			     JMP WORD PTR [BX]
   1311
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 24
forth.asm



   1312						  HEAD	  83h,'TT',331Q,TTY		 ; TERMI-FLAG
1  1313	      =ARRAY:1467		 LINK$=$
1  1314	1467  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1315							 ; 6 - признак immediate. 5- слово не описано smudge
1  1316	1468  54 54			     DB	 'TT'
1  1317	146A  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  1318	146B  143Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1319	      =ARRAY:1467		 LINK=LINK$
1  1320	146D				 TTY LABEL FAR	; CFA
1  1321	146D  146Fr			     DW	 $+2
   1322	146F  C7 45 22 0000		TYPE$:	  MOV	WORD PTR [DI+42Q],0
   1323						  NEXT
1  1324	1474  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1325	1475  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1326					 ; ------ call debugger	--------
1  1327	1477  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1328	147B  74 06			     jz	??0011
1  1329	147D  E8 FAD1			     call printWORD
1  1330	1480  E8 F9B0			     call pause
1  1331	1483				   ??0011:
1  1332					 ; -----------------------------
1  1333	1483  FF 27			     JMP WORD PTR [BX]
   1334
   1335						  HEAD	  83h,'SC',314Q,SCL		      ;	SCL
1  1336	      =ARRAY:1485		 LINK$=$
1  1337	1485  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1338							 ; 6 - признак immediate. 5- слово не описано smudge
1  1339	1486  53 43			     DB	 'SC'
1  1340	1488  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  1341	1489  1467r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1342	      =ARRAY:1485		 LINK=LINK$
1  1343	148B				 SCL LABEL FAR	; CFA
1  1344	148B  148Dr			     DW	 $+2
   1345					; SCREEN CLEAR
   1346						  ;MOV	 CX, 2048     ;	Загрузка счетчика
   1347						  ;MOV	 AH, 15
   1348						  ;INT	 10h	       ; Установка текущей страницы
   1349	148D  BA 1855				  mov	dx, 1855h      ;  DH,DL	= строка, колонка (считая от 0)
   1350	1490  2B C9				  sub	cx, cx
   1351						  ;MOV	 AH, 2	      ;	Курсор в исходное положение
   1352						  ;INT	 10h
   1353	1492  B7 00				  mov	bh, 0	    ; атрибут
   1354					 ; 09H писать символ/атрибут в текущей позиции курсора
   1355	1494  B8 0600			CLEAR:	  MOV	AX, 0600H    ; число пустых строк, вдвигаемых снизу (0=очистить	все окно)
   1356	1497  CD 10				  INT	10h
   1357						  NEXT
1  1358	1499  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1359	149A  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1360					 ; ------ call debugger	--------
1  1361	149C  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1362	14A0  74 06			     jz	??0012
1  1363	14A2  E8 FAAC			     call printWORD
1  1364	14A5  E8 F98B			     call pause
1  1365	14A8				   ??0012:
1  1366					 ; -----------------------------
1  1367	14A8  FF 27			     JMP WORD PTR [BX]
   1368
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 25
forth.asm



   1369						  HEAD	  83h,'FI',330Q,FIX		      ;	FIX
1  1370	      =ARRAY:14AA		 LINK$=$
1  1371	14AA  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1372							 ; 6 - признак immediate. 5- слово не описано smudge
1  1373	14AB  46 49			     DB	 'FI'
1  1374	14AD  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  1375	14AE  1485r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1376	      =ARRAY:14AA		 LINK=LINK$
1  1377	14B0				 FIX LABEL FAR	; CFA
1  1378	14B0  14B2r			     DW	 $+2
   1379					; Позиционирование курсора: COL	ROW FIX
   1380	14B2  B4 0F				  MOV	AH, 0Fh
   1381	14B4  CD 10				  INT	10h	 ; Запись текущего номера страницы в BX
   1382	14B6  5A				  POP	DX
   1383	14B7  8A F2				  MOV	DH, DL	 ; строка
   1384	14B9  58				  POP	AX
   1385
   1386	14BA  8A D0				  MOV	DL, AL	 ; столбец
   1387	14BC  B4 02				  MOV	AH, 2	 ; уст.	позицию	курсора. установка
   1388								 ; на строку 25	делает курсор невидимым.
   1389	14BE  CD 10				  INT	10h	 ; Фиксация положения курсора
   1390						  NEXT
1  1391	14C0  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1392	14C1  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1393					 ; ------ call debugger	--------
1  1394	14C3  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1395	14C7  74 06			     jz	??0013
1  1396	14C9  E8 FA85			     call printWORD
1  1397	14CC  E8 F964			     call pause
1  1398	14CF				   ??0013:
1  1399					 ; -----------------------------
1  1400	14CF  FF 27			     JMP WORD PTR [BX]
   1401
   1402						  HEAD	  84h,'DSP',314Q,DSPL		      ;	DSPL
1  1403	      =ARRAY:14D1		 LINK$=$
1  1404	14D1  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1405							 ; 6 - признак immediate. 5- слово не описано smudge
1  1406	14D2  44 53 50			     DB	 'DSP'
1  1407	14D5  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  1408	14D6  14AAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1409	      =ARRAY:14D1		 LINK=LINK$
1  1410	14D8				 DSPL LABEL FAR	 ; CFA
1  1411	14D8  14DAr			     DW	 $+2
   1412					; LOAD GRAFBUFFER (b adr DSPL)
   1413					 ; записывает байт в графическую память
   1414	14DA  5B				  POP	BX  ; адрес
   1415	14DB  58				  POP	AX  ; байт
   1416	14DC  06				  PUSH	ES  ; сохранение регистра сегмента
   1417	14DD  B9 B000				  MOV	CX, 0B000H ; GRAFBUF
   1418	14E0  8E C1				  MOV	ES, CX
   1419	14E2  26: 88 07				  MOV	BYTE PTR ES:[BX], AL
   1420	14E5  07				  POP	ES
   1421						  NEXT
1  1422	14E6  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1423	14E7  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1424					 ; ------ call debugger	--------
1  1425	14E9  80 7D 42 00		     cmp byte ptr [di+102Q], 0
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 26
forth.asm



1  1426	14ED  74 06			     jz	??0014
1  1427	14EF  E8 FA5F			     call printWORD
1  1428	14F2  E8 F93E			     call pause
1  1429	14F5				   ??0014:
1  1430					 ; -----------------------------
1  1431	14F5  FF 27			     JMP WORD PTR [BX]
   1432
   1433					;	  ** Терминал **
   1434
   1435						  HEAD	  83h,'KE',331Q,KEY		      ;	KEY
1  1436	      =ARRAY:14F7		 LINK$=$
1  1437	14F7  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  1438							 ; 6 - признак immediate. 5- слово не описано smudge
1  1439	14F8  4B 45			     DB	 'KE'
1  1440	14FA  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  1441	14FB  14D1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1442	      =ARRAY:14F7		 LINK=LINK$
1  1443	14FD				 KEY LABEL FAR	; CFA
1  1444	14FD  14FFr			     DW	 $+2
   1445					     ; читать (ожидать)	следующую нажатую клавишу
   1446					     ; выход: AL = ASCII символ	(если AL=0, AH содержит	расширенный код	ASCII )
   1447					     ; AH = сканкод  или расширенный код ASCII
   1448	14FF  2A E4				  SUB	AH, AH
   1449	1501  CD 16				  INT	16h
   1450	1503  2A E4				  SUB	AH, AH
   1451	1505  50				  PUSH	AX
   1452						  NEXT
1  1453	1506  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1454	1507  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1455					 ; ------ call debugger	--------
1  1456	1509  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1457	150D  74 06			     jz	??0015
1  1458	150F  E8 FA3F			     call printWORD
1  1459	1512  E8 F91E			     call pause
1  1460	1515				   ??0015:
1  1461					 ; -----------------------------
1  1462	1515  FF 27			     JMP WORD PTR [BX]
   1463
   1464						  HEAD	  86h,'EXPEC',324Q,EXPE		      ;	EXPECT
1  1465	      =ARRAY:1517		 LINK$=$
1  1466	1517  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  1467							 ; 6 - признак immediate. 5- слово не описано smudge
1  1468	1518  45 58 50 45 43		     DB	 'EXPEC'
1  1469	151D  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  1470	151E  14F7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1471	      =ARRAY:1517		 LINK=LINK$
1  1472	1520				 EXPE LABEL FAR	 ; CFA
1  1473	1520  1522r			     DW	 $+2
   1474					     ; adr count ->
   1475	1522  B4 0A				  MOV	AH, 0AH		     ;	ввод строки в буфер
   1476	1524  59				  POP	CX		     ; Число символов
   1477	1525  5B				  POP	BX		     ; Адрес буфера SS
   1478	1526  88 0F				  MOV	BYTE PTR [BX],	CL   ; Засылка ожидаемого числа
   1479	1528  8B D3				  MOV	DX, BX
   1480	152A  CD 21				  INT	21h
   1481
   1482	152C  8A 47 01				  MOV	AL, BYTE PTR [BX+1]  ; фактически введено символов
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 27
forth.asm



   1483	152F  2A E4				  SUB	AH, AH		     ;
   1484	1531  03 D8				  ADD	BX, AX		     ; адрес конца строки
   1485	1533  C7 47 02 0000			  MOV	WORD PTR [BX+2],0    ; +2, т.к.	в начале строки	мах длина
   1486									     ; и число введенных символов
   1487						  NEXT
1  1488	1538  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1489	1539  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1490					 ; ------ call debugger	--------
1  1491	153B  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1492	153F  74 06			     jz	??0016
1  1493	1541  E8 FA0D			     call printWORD
1  1494	1544  E8 F8EC			     call pause
1  1495	1547				   ??0016:
1  1496					 ; -----------------------------
1  1497	1547  FF 27			     JMP WORD PTR [BX]
   1498
   1499						  HEAD	  85h,'?TER',244Q,?TER$		      ;	?TER$
1  1500	      =ARRAY:1549		 LINK$=$
1  1501	1549  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  1502							 ; 6 - признак immediate. 5- слово не описано smudge
1  1503	154A  3F 54 45 52		     DB	 '?TER'
1  1504	154E  A4			     DB	 244Q	; последний символ слова + 128 (7 бит =	1).
1  1505	154F  1517r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1506	      =ARRAY:1549		 LINK=LINK$
1  1507	1551				 ?TER$ LABEL FAR  ; CFA
1  1508	1551  1553r			     DW	 $+2
   1509	1553  06				  PUSH	ES
   1510	1554  2B C9				  SUB	CX, CX
   1511	1556  8E C1				  MOV	ES, CX
   1512	1558  26: 80 0E	0417 20			  OR	BYTE PTR ES:[417H],  40Q
   1513	155E  B4 01			TER:	  MOV	AH, 1	 ; проверить готовность	символа	(и показать его, если так)
   1514								 ; выход: ZF = 1 если символ не	готов.
   1515								 ; ZF =	0 если символ готов.
   1516								 ; AX =	как для	подфункции 00H (но символ здесь	не
   1517								 ; удаляется из	очереди).
   1518	1560  CD 16				  INT	16h
   1519	1562  74 FA				  JZ	TER
   1520	1564  2A E4				  SUB	AH, AH	 ; читать (ожидать) следующую нажатую клавишу
   1521	1566  CD 16				  INT	16h
   1522	1568  26: 80 26	0417 DF			  AND	BYTE PTR ES:[417H],337Q	 ; Сброс 'NUM LOCK'
   1523	156E  07				  POP	ES		; Восстановление ES
   1524	156F  50				  PUSH	AX		; Запись символа
   1525						  NEXT
1  1526	1570  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1527	1571  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1528					 ; ------ call debugger	--------
1  1529	1573  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1530	1577  74 06			     jz	??0017
1  1531	1579  E8 F9D5			     call printWORD
1  1532	157C  E8 F8B4			     call pause
1  1533	157F				   ??0017:
1  1534					 ; -----------------------------
1  1535	157F  FF 27			     JMP WORD PTR [BX]
   1536
   1537					; ** Ввод/Вывод	**
   1538
   1539						  HEAD	  84h,'POR',324Q,PORT		      ;	PORT
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 28
forth.asm



1  1540	      =ARRAY:1581		 LINK$=$
1  1541	1581  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1542							 ; 6 - признак immediate. 5- слово не описано smudge
1  1543	1582  50 4F 52			     DB	 'POR'
1  1544	1585  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  1545	1586  1549r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1546	      =ARRAY:1581		 LINK=LINK$
1  1547	1588				 PORT LABEL FAR	 ; CFA
1  1548	1588  158Ar			     DW	 $+2
   1549	158A  5A				  POP	DX
   1550	158B  58				  POP	AX
   1551	158C  EE				  OUT	DX, AL
   1552						  NEXT
1  1553	158D  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1554	158E  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1555					 ; ------ call debugger	--------
1  1556	1590  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1557	1594  74 06			     jz	??0018
1  1558	1596  E8 F9B8			     call printWORD
1  1559	1599  E8 F897			     call pause
1  1560	159C				   ??0018:
1  1561					 ; -----------------------------
1  1562	159C  FF 27			     JMP WORD PTR [BX]
   1563
   1564						  HEAD	  84h,'REA',304Q,READ		      ;	READ
1  1565	      =ARRAY:159E		 LINK$=$
1  1566	159E  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1567							 ; 6 - признак immediate. 5- слово не описано smudge
1  1568	159F  52 45 41			     DB	 'REA'
1  1569	15A2  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  1570	15A3  1581r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1571	      =ARRAY:159E		 LINK=LINK$
1  1572	15A5				 READ LABEL FAR	 ; CFA
1  1573	15A5  15A7r			     DW	 $+2
   1574	15A7  5A				  POP	DX
   1575	15A8  EC				  IN	AL, DX
   1576	15A9  2A E4				  SUB	AH, AH
   1577	15AB  50				  PUSH	AX
   1578						  NEXT
1  1579	15AC  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1580	15AD  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1581					 ; ------ call debugger	--------
1  1582	15AF  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1583	15B3  74 06			     jz	??0019
1  1584	15B5  E8 F999			     call printWORD
1  1585	15B8  E8 F878			     call pause
1  1586	15BB				   ??0019:
1  1587					 ; -----------------------------
1  1588	15BB  FF 27			     JMP WORD PTR [BX]
   1589
   1590					;	  ** Арифметика	**
   1591
   1592						  HEAD	  82h,'1',253Q,ONEP		      ;	1+
1  1593	      =ARRAY:15BD		 LINK$=$
1  1594	15BD  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1595							 ; 6 - признак immediate. 5- слово не описано smudge
1  1596	15BE  31			     DB	 '1'
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 29
forth.asm



1  1597	15BF  AB			     DB	 253Q	; последний символ слова + 128 (7 бит =	1).
1  1598	15C0  159Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1599	      =ARRAY:15BD		 LINK=LINK$
1  1600	15C2				 ONEP LABEL FAR	 ; CFA
1  1601	15C2  15C4r			     DW	 $+2
   1602	15C4  58				  POP	AX
   1603	15C5  40				  INC	AX
   1604	15C6  50				  PUSH	AX
   1605						  NEXT
1  1606	15C7  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1607	15C8  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1608					 ; ------ call debugger	--------
1  1609	15CA  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1610	15CE  74 06			     jz	??001A
1  1611	15D0  E8 F97E			     call printWORD
1  1612	15D3  E8 F85D			     call pause
1  1613	15D6				   ??001A:
1  1614					 ; -----------------------------
1  1615	15D6  FF 27			     JMP WORD PTR [BX]
   1616
   1617						  HEAD	  82h,'2',253Q,TWOP		      ;	2+
1  1618	      =ARRAY:15D8		 LINK$=$
1  1619	15D8  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1620							 ; 6 - признак immediate. 5- слово не описано smudge
1  1621	15D9  32			     DB	 '2'
1  1622	15DA  AB			     DB	 253Q	; последний символ слова + 128 (7 бит =	1).
1  1623	15DB  15BDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1624	      =ARRAY:15D8		 LINK=LINK$
1  1625	15DD				 TWOP LABEL FAR	 ; CFA
1  1626	15DD  15DFr			     DW	 $+2
   1627	15DF  58				  POP	AX
   1628	15E0  05 0002				  ADD	AX, 2
   1629	15E3  50				  PUSH	AX
   1630						  NEXT
1  1631	15E4  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1632	15E5  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1633					 ; ------ call debugger	--------
1  1634	15E7  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1635	15EB  74 06			     jz	??001B
1  1636	15ED  E8 F961			     call printWORD
1  1637	15F0  E8 F840			     call pause
1  1638	15F3				   ??001B:
1  1639					 ; -----------------------------
1  1640	15F3  FF 27			     JMP WORD PTR [BX]
   1641
   1642						  HEAD	  82h,'1',255Q,ONEM		      ;	1-
1  1643	      =ARRAY:15F5		 LINK$=$
1  1644	15F5  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1645							 ; 6 - признак immediate. 5- слово не описано smudge
1  1646	15F6  31			     DB	 '1'
1  1647	15F7  AD			     DB	 255Q	; последний символ слова + 128 (7 бит =	1).
1  1648	15F8  15D8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1649	      =ARRAY:15F5		 LINK=LINK$
1  1650	15FA				 ONEM LABEL FAR	 ; CFA
1  1651	15FA  15FCr			     DW	 $+2
   1652	15FC  58				  POP	AX
   1653	15FD  48				  DEC	AX
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 30
forth.asm



   1654	15FE  50				  PUSH	AX
   1655						  NEXT
1  1656	15FF  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1657	1600  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1658					 ; ------ call debugger	--------
1  1659	1602  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1660	1606  74 06			     jz	??001C
1  1661	1608  E8 F946			     call printWORD
1  1662	160B  E8 F825			     call pause
1  1663	160E				   ??001C:
1  1664					 ; -----------------------------
1  1665	160E  FF 27			     JMP WORD PTR [BX]
   1666
   1667						  HEAD	  82h,'2',252Q,MUL2		      ;	2*
1  1668	      =ARRAY:1610		 LINK$=$
1  1669	1610  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1670							 ; 6 - признак immediate. 5- слово не описано smudge
1  1671	1611  32			     DB	 '2'
1  1672	1612  AA			     DB	 252Q	; последний символ слова + 128 (7 бит =	1).
1  1673	1613  15F5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1674	      =ARRAY:1610		 LINK=LINK$
1  1675	1615				 MUL2 LABEL FAR	 ; CFA
1  1676	1615  1617r			     DW	 $+2
   1677	1617  58				  POP	AX
   1678	1618  D1 E0				  SAL	AX,  1
   1679	161A  50				  PUSH	AX
   1680						  NEXT
1  1681	161B  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1682	161C  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1683					 ; ------ call debugger	--------
1  1684	161E  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1685	1622  74 06			     jz	??001D
1  1686	1624  E8 F92A			     call printWORD
1  1687	1627  E8 F809			     call pause
1  1688	162A				   ??001D:
1  1689					 ; -----------------------------
1  1690	162A  FF 27			     JMP WORD PTR [BX]
   1691
   1692						  HEAD	  82h,'2',257Q,DIV2		      ;	2/
1  1693	      =ARRAY:162C		 LINK$=$
1  1694	162C  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1695							 ; 6 - признак immediate. 5- слово не описано smudge
1  1696	162D  32			     DB	 '2'
1  1697	162E  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  1698	162F  1610r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1699	      =ARRAY:162C		 LINK=LINK$
1  1700	1631				 DIV2 LABEL FAR	 ; CFA
1  1701	1631  1633r			     DW	 $+2
   1702	1633  58				  POP	AX
   1703	1634  D1 F8				  SAR	AX, 1
   1704	1636  50				  PUSH	AX
   1705						  NEXT
1  1706	1637  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1707	1638  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1708					 ; ------ call debugger	--------
1  1709	163A  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1710	163E  74 06			     jz	??001E
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 31
forth.asm



1  1711	1640  E8 F90E			     call printWORD
1  1712	1643  E8 F7ED			     call pause
1  1713	1646				   ??001E:
1  1714					 ; -----------------------------
1  1715	1646  FF 27			     JMP WORD PTR [BX]
   1716
   1717						  HEAD	  82h, 'U', 252Q,USTAR		      ;	U*
1  1718	      =ARRAY:1648		 LINK$=$
1  1719	1648  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1720							 ; 6 - признак immediate. 5- слово не описано smudge
1  1721	1649  55			     DB	 'U'
1  1722	164A  AA			     DB	 252Q	; последний символ слова + 128 (7 бит =	1).
1  1723	164B  162Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1724	      =ARRAY:1648		 LINK=LINK$
1  1725	164D				 USTAR LABEL FAR  ; CFA
1  1726	164D  164Fr			     DW	 $+2
   1727					 ; u1  u2  ---	ud
   1728	164F  58				  POP	AX
   1729	1650  59				  POP	CX
   1730	1651  F7 E1				  MUL	CX
   1731	1653  50				  PUSH	AX
   1732	1654  52				  PUSH	DX
   1733						  NEXT
1  1734	1655  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1735	1656  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1736					 ; ------ call debugger	--------
1  1737	1658  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1738	165C  74 06			     jz	??001F
1  1739	165E  E8 F8F0			     call printWORD
1  1740	1661  E8 F7CF			     call pause
1  1741	1664				   ??001F:
1  1742					 ; -----------------------------
1  1743	1664  FF 27			     JMP WORD PTR [BX]
   1744
   1745						  HEAD	  82h,'U',257Q,USLAS		      ;	U/
1  1746	      =ARRAY:1666		 LINK$=$
1  1747	1666  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1748							 ; 6 - признак immediate. 5- слово не описано smudge
1  1749	1667  55			     DB	 'U'
1  1750	1668  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  1751	1669  1648r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1752	      =ARRAY:1666		 LINK=LINK$
1  1753	166B				 USLAS LABEL FAR  ; CFA
1  1754	166B  166Dr			     DW	 $+2
   1755					 ; ud u1 --- u2	u3
   1756	166D  59				  POP	CX	    ; Делитель
   1757	166E  5A				  POP	DX
   1758	166F  58				  POP	AX
   1759	1670  F7 F1				  DIV	CX
   1760	1672  52				  PUSH	DX	    ; Остаток
   1761	1673  50				  PUSH	AX	    ; Засылка  результата
   1762						  NEXT
1  1763	1674  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1764	1675  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1765					 ; ------ call debugger	--------
1  1766	1677  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1767	167B  74 06			     jz	??0020
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 32
forth.asm



1  1768	167D  E8 F8D1			     call printWORD
1  1769	1680  E8 F7B0			     call pause
1  1770	1683				   ??0020:
1  1771					 ; -----------------------------
1  1772	1683  FF 27			     JMP WORD PTR [BX]
   1773
   1774						  HEAD	  82h,'M',252Q,MSTAR		      ;	M*
1  1775	      =ARRAY:1685		 LINK$=$
1  1776	1685  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1777							 ; 6 - признак immediate. 5- слово не описано smudge
1  1778	1686  4D			     DB	 'M'
1  1779	1687  AA			     DB	 252Q	; последний символ слова + 128 (7 бит =	1).
1  1780	1688  1666r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1781	      =ARRAY:1685		 LINK=LINK$
1  1782	168A				 MSTAR LABEL FAR  ; CFA
1  1783	168A  168Cr			     DW	 $+2
   1784	168C  58				  POP	AX
   1785	168D  59				  POP	CX
   1786	168E  F7 E9				  IMUL	CX
   1787	1690  50				  PUSH	AX
   1788	1691  52				  PUSH	DX
   1789						  NEXT
1  1790	1692  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1791	1693  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1792					 ; ------ call debugger	--------
1  1793	1695  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1794	1699  74 06			     jz	??0021
1  1795	169B  E8 F8B3			     call printWORD
1  1796	169E  E8 F792			     call pause
1  1797	16A1				   ??0021:
1  1798					 ; -----------------------------
1  1799	16A1  FF 27			     JMP WORD PTR [BX]
   1800
   1801						  HEAD	   86h,'DMINU',323Q,DMINU	      ;	DMINUS
1  1802	      =ARRAY:16A3		 LINK$=$
1  1803	16A3  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  1804							 ; 6 - признак immediate. 5- слово не описано smudge
1  1805	16A4  44 4D 49 4E 55		     DB	 'DMINU'
1  1806	16A9  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  1807	16AA  1685r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1808	      =ARRAY:16A3		 LINK=LINK$
1  1809	16AC				 DMINU LABEL FAR  ; CFA
1  1810	16AC  16AEr			     DW	 $+2
   1811					; Изменение знака числа	двойной	длины
   1812	16AE  58				  POP  AX
   1813	16AF  F7 D8			DMIN:	  NEG  AX
   1814	16B1  59				  POP  CX
   1815	16B2  F7 D9				  NEG  CX
   1816	16B4  1D 0000				  SBB  AX, 0	   ; sub with borrow
   1817	16B7  51				  PUSH CX
   1818	16B8  50				  PUSH AX
   1819	16B9				G$:	  NEXT
1  1820	16B9  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1821	16BA  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1822					 ; ------ call debugger	--------
1  1823	16BC  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1824	16C0  74 06			     jz	??0022
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 33
forth.asm



1  1825	16C2  E8 F88C			     call printWORD
1  1826	16C5  E8 F76B			     call pause
1  1827	16C8				   ??0022:
1  1828					 ; -----------------------------
1  1829	16C8  FF 27			     JMP WORD PTR [BX]
   1830
   1831						 HEAD	  84h,'DAB',323Q,DABS		      ;	DABS
1  1832	      =ARRAY:16CA		 LINK$=$
1  1833	16CA  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  1834							 ; 6 - признак immediate. 5- слово не описано smudge
1  1835	16CB  44 41 42			     DB	 'DAB'
1  1836	16CE  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  1837	16CF  16A3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1838	      =ARRAY:16CA		 LINK=LINK$
1  1839	16D1				 DABS LABEL FAR	 ; CFA
1  1840	16D1  16D3r			     DW	 $+2
   1841	16D3  58				 POP   AX
   1842	16D4  3D 0000				 CMP   AX, 0
   1843	16D7  78 D6				 JS    DMIN
   1844	16D9  50				 PUSH  AX
   1845						 NEXT
1  1846	16DA  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1847	16DB  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1848					 ; ------ call debugger	--------
1  1849	16DD  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1850	16E1  74 06			     jz	??0023
1  1851	16E3  E8 F86B			     call printWORD
1  1852	16E6  E8 F74A			     call pause
1  1853	16E9				   ??0023:
1  1854					 ; -----------------------------
1  1855	16E9  FF 27			     JMP WORD PTR [BX]
   1856
   1857						 HEAD	  82h,'M',257Q,MSLAS		      ;	M/
1  1858	      =ARRAY:16EB		 LINK$=$
1  1859	16EB  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1860							 ; 6 - признак immediate. 5- слово не описано smudge
1  1861	16EC  4D			     DB	 'M'
1  1862	16ED  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  1863	16EE  16CAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1864	      =ARRAY:16EB		 LINK=LINK$
1  1865	16F0				 MSLAS LABEL FAR  ; CFA
1  1866	16F0  16F2r			     DW	 $+2
   1867	16F2  59				 POP   CX	   ; Делимое
   1868	16F3  5A				 POP   DX
   1869	16F4  58				 POP   AX
   1870	16F5  F7 F9				 IDIV  CX
   1871	16F7  52				 PUSH  DX
   1872	16F8  50				 PUSH  AX
   1873						 NEXT
1  1874	16F9  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1875	16FA  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1876					 ; ------ call debugger	--------
1  1877	16FC  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1878	1700  74 06			     jz	??0024
1  1879	1702  E8 F84C			     call printWORD
1  1880	1705  E8 F72B			     call pause
1  1881	1708				   ??0024:
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 34
forth.asm



1  1882					 ; -----------------------------
1  1883	1708  FF 27			     JMP WORD PTR [BX]
   1884
   1885						 HEAD	  81h,,253Q,PLUS		      ;	+
1  1886	      =ARRAY:170A		 LINK$=$
1  1887	170A  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  1888							 ; 6 - признак immediate. 5- слово не описано smudge
1  1889	170B  AB			     DB	 253Q	; последний символ слова + 128 (7 бит =	1).
1  1890	170C  16EBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1891	      =ARRAY:170A		 LINK=LINK$
1  1892	170E				 PLUS LABEL FAR	 ; CFA
1  1893	170E  1710r			     DW	 $+2
   1894	1710  58				 POP  AX
   1895	1711  59				 POP  CX
   1896	1712  03 C1				 ADD  AX, CX
   1897	1714  50				 PUSH AX
   1898						 NEXT
1  1899	1715  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1900	1716  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1901					 ; ------ call debugger	--------
1  1902	1718  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1903	171C  74 06			     jz	??0025
1  1904	171E  E8 F830			     call printWORD
1  1905	1721  E8 F70F			     call pause
1  1906	1724				   ??0025:
1  1907					 ; -----------------------------
1  1908	1724  FF 27			     JMP WORD PTR [BX]
   1909
   1910						 HEAD	  81h,,255Q,SUBB		       ; -
1  1911	      =ARRAY:1726		 LINK$=$
1  1912	1726  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  1913							 ; 6 - признак immediate. 5- слово не описано smudge
1  1914	1727  AD			     DB	 255Q	; последний символ слова + 128 (7 бит =	1).
1  1915	1728  170Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1916	      =ARRAY:1726		 LINK=LINK$
1  1917	172A				 SUBB LABEL FAR	 ; CFA
1  1918	172A  172Cr			     DW	 $+2
   1919					 ; n1 n2 -> n1-n2
   1920	172C  59				 POP  CX
   1921	172D  58				 POP  AX
   1922	172E  2B C1				 SUB  AX, CX
   1923	1730  50				 PUSH AX
   1924						 NEXT
1  1925	1731  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1926	1732  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1927					 ; ------ call debugger	--------
1  1928	1734  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1929	1738  74 06			     jz	??0026
1  1930	173A  E8 F814			     call printWORD
1  1931	173D  E8 F6F3			     call pause
1  1932	1740				   ??0026:
1  1933					 ; -----------------------------
1  1934	1740  FF 27			     JMP WORD PTR [BX]
   1935
   1936						 HEAD	  82h,'D',253Q,DPLUS		      ;	D+
1  1937	      =ARRAY:1742		 LINK$=$
1  1938	1742  82			     DB	 82h  ;	NFA 7 бит равен	1.
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 35
forth.asm



1  1939							 ; 6 - признак immediate. 5- слово не описано smudge
1  1940	1743  44			     DB	 'D'
1  1941	1744  AB			     DB	 253Q	; последний символ слова + 128 (7 бит =	1).
1  1942	1745  1726r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1943	      =ARRAY:1742		 LINK=LINK$
1  1944	1747				 DPLUS LABEL FAR  ; CFA
1  1945	1747  1749r			     DW	 $+2
   1946	1749  58				 POP  AX
   1947	174A  59				 POP  CX
   1948	174B  8B DC				 MOV  BX, SP
   1949	174D  36: 01 4F	02			 ADD  SS:[BX+2],  CX
   1950	1751  36: 11 07				 ADC  SS:[BX],	  AX
   1951						 NEXT
1  1952	1754  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1953	1755  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1954					 ; ------ call debugger	--------
1  1955	1757  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1956	175B  74 06			     jz	??0027
1  1957	175D  E8 F7F1			     call printWORD
1  1958	1760  E8 F6D0			     call pause
1  1959	1763				   ??0027:
1  1960					 ; -----------------------------
1  1961	1763  FF 27			     JMP WORD PTR [BX]
   1962
   1963						 HEAD	  82h,'M',253Q,MPLUS		      ;	M+
1  1964	      =ARRAY:1765		 LINK$=$
1  1965	1765  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  1966							 ; 6 - признак immediate. 5- слово не описано smudge
1  1967	1766  4D			     DB	 'M'
1  1968	1767  AB			     DB	 253Q	; последний символ слова + 128 (7 бит =	1).
1  1969	1768  1742r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  1970	      =ARRAY:1765		 LINK=LINK$
1  1971	176A				 MPLUS LABEL FAR  ; CFA
1  1972	176A  176Cr			     DW	 $+2
   1973	176C  59				 POP  CX
   1974	176D  8B DC				 MOV  BX, SP
   1975	176F  36: 01 4F	02			 ADD  SS:[BX+2],  CX
   1976	1773  36: 83 17	00			 ADC  word ptr SS:[BX],	   0
   1977						 NEXT
1  1978	1777  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  1979	1778  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  1980					 ; ------ call debugger	--------
1  1981	177A  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  1982	177E  74 06			     jz	??0028
1  1983	1780  E8 F7CE			     call printWORD
1  1984	1783  E8 F6AD			     call pause
1  1985	1786				   ??0028:
1  1986					 ; -----------------------------
1  1987	1786  FF 27			     JMP WORD PTR [BX]
   1988
   1989						 HEAD	  85h,'MINU',323Q,MINUS		      ;	MINUS
1  1990	      =ARRAY:1788		 LINK$=$
1  1991	1788  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  1992							 ; 6 - признак immediate. 5- слово не описано smudge
1  1993	1789  4D 49 4E 55		     DB	 'MINU'
1  1994	178D  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  1995	178E  1765r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 36
forth.asm



1  1996	      =ARRAY:1788		 LINK=LINK$
1  1997	1790				 MINUS LABEL FAR  ; CFA
1  1998	1790  1792r			     DW	 $+2
   1999	1792  58				 POP  AX
   2000	1793  F7 D8				 NEG  AX
   2001	1795  50				 PUSH AX
   2002						 NEXT
1  2003	1796  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2004	1797  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2005					 ; ------ call debugger	--------
1  2006	1799  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2007	179D  74 06			     jz	??0029
1  2008	179F  E8 F7AF			     call printWORD
1  2009	17A2  E8 F68E			     call pause
1  2010	17A5				   ??0029:
1  2011					 ; -----------------------------
1  2012	17A5  FF 27			     JMP WORD PTR [BX]
   2013
   2014						 HEAD	  84h,'SWA',302Q,SWAB		      ;	SWAB
1  2015	      =ARRAY:17A7		 LINK$=$
1  2016	17A7  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2017							 ; 6 - признак immediate. 5- слово не описано smudge
1  2018	17A8  53 57 41			     DB	 'SWA'
1  2019	17AB  C2			     DB	 302Q	; последний символ слова + 128 (7 бит =	1).
1  2020	17AC  1788r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2021	      =ARRAY:17A7		 LINK=LINK$
1  2022	17AE				 SWAB LABEL FAR	 ; CFA
1  2023	17AE  17B0r			     DW	 $+2
   2024					     ; обмен байтами слова в стеке
   2025	17B0  58				 POP  AX
   2026	17B1  86 C4				 XCHG AL, AH
   2027	17B3  50				 PUSH AX
   2028						 NEXT
1  2029	17B4  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2030	17B5  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2031					 ; ------ call debugger	--------
1  2032	17B7  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2033	17BB  74 06			     jz	??002A
1  2034	17BD  E8 F791			     call printWORD
1  2035	17C0  E8 F670			     call pause
1  2036	17C3				   ??002A:
1  2037					 ; -----------------------------
1  2038	17C3  FF 27			     JMP WORD PTR [BX]
   2039
   2040						 HEAD	  83h,'AB',323Q,$ABS		       ; ABS
1  2041	      =ARRAY:17C5		 LINK$=$
1  2042	17C5  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2043							 ; 6 - признак immediate. 5- слово не описано smudge
1  2044	17C6  41 42			     DB	 'AB'
1  2045	17C8  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  2046	17C9  17A7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2047	      =ARRAY:17C5		 LINK=LINK$
1  2048	17CB				 $ABS LABEL FAR	 ; CFA
1  2049	17CB  17CDr			     DW	 $+2
   2050	17CD  58				 POP  AX
   2051	17CE  3D 0000				 CMP  AX, 0
   2052	17D1  79 02				 JNS  AB
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 37
forth.asm



   2053	17D3  F7 D8				 NEG  AX
   2054	17D5  50			AB:	 PUSH AX
   2055						 NEXT
1  2056	17D6  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2057	17D7  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2058					 ; ------ call debugger	--------
1  2059	17D9  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2060	17DD  74 06			     jz	??002B
1  2061	17DF  E8 F76F			     call printWORD
1  2062	17E2  E8 F64E			     call pause
1  2063	17E5				   ??002B:
1  2064					 ; -----------------------------
1  2065	17E5  FF 27			     JMP WORD PTR [BX]
   2066
   2067						 HEAD	  83h,'AN',304Q,$AND		      ;	AND
1  2068	      =ARRAY:17E7		 LINK$=$
1  2069	17E7  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2070							 ; 6 - признак immediate. 5- слово не описано smudge
1  2071	17E8  41 4E			     DB	 'AN'
1  2072	17EA  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  2073	17EB  17C5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2074	      =ARRAY:17E7		 LINK=LINK$
1  2075	17ED				 $AND LABEL FAR	 ; CFA
1  2076	17ED  17EFr			     DW	 $+2
   2077	17EF  58				 POP  AX
   2078	17F0  59				 POP  CX
   2079	17F1  23 C1				 AND  AX,  CX
   2080	17F3  50			ENDA:	 PUSH AX
   2081						 NEXT
1  2082	17F4  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2083	17F5  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2084					 ; ------ call debugger	--------
1  2085	17F7  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2086	17FB  74 06			     jz	??002C
1  2087	17FD  E8 F751			     call printWORD
1  2088	1800  E8 F630			     call pause
1  2089	1803				   ??002C:
1  2090					 ; -----------------------------
1  2091	1803  FF 27			     JMP WORD PTR [BX]
   2092
   2093						 HEAD	  82h,'O',322Q,$OR		      ;	OR
1  2094	      =ARRAY:1805		 LINK$=$
1  2095	1805  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2096							 ; 6 - признак immediate. 5- слово не описано smudge
1  2097	1806  4F			     DB	 'O'
1  2098	1807  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  2099	1808  17E7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2100	      =ARRAY:1805		 LINK=LINK$
1  2101	180A				 $OR LABEL FAR	; CFA
1  2102	180A  180Cr			     DW	 $+2
   2103	180C  58				 POP  AX
   2104	180D  59				 POP  CX
   2105	180E  0B C1				 OR   AX, CX
   2106	1810  EB E1				 JMP  ENDA
   2107
   2108						 HEAD	  83h,'XO',322Q,$XOR		      ;	XOR
1  2109	      =ARRAY:1812		 LINK$=$
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 38
forth.asm



1  2110	1812  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2111							 ; 6 - признак immediate. 5- слово не описано smudge
1  2112	1813  58 4F			     DB	 'XO'
1  2113	1815  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  2114	1816  1805r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2115	      =ARRAY:1812		 LINK=LINK$
1  2116	1818				 $XOR LABEL FAR	 ; CFA
1  2117	1818  181Ar			     DW	 $+2
   2118	181A  58				 POP  AX
   2119	181B  59				 POP  CX
   2120	181C  33 C1				 XOR  AX, CX
   2121	181E  EB D3				 JMP  ENDA
   2122
   2123						 HEAD	  84h,'S-#',304Q,STOD		      ;	S->D ; sds S->
1  2124	      =ARRAY:1820		 LINK$=$
1  2125	1820  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2126							 ; 6 - признак immediate. 5- слово не описано smudge
1  2127	1821  53 2D 23			     DB	 'S-#'
1  2128	1824  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  2129	1825  1812r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2130	      =ARRAY:1820		 LINK=LINK$
1  2131	1827				 STOD LABEL FAR	 ; CFA
1  2132	1827  1829r			     DW	 $+2
   2133	1829  58				 POP  AX
   2134	182A  50				 PUSH AX
   2135	182B  8B CA				 MOV  CX, DX	       ; Сохранение содержимого	DX
   2136	182D  99				 CWD		       ; sign bit AX to	DX
   2137	182E  52				 PUSH  DX
   2138	182F  8B D1				 MOV  DX, CX	       ; Восстановление	DX
   2139						 NEXT
1  2140	1831  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2141	1832  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2142					 ; ------ call debugger	--------
1  2143	1834  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2144	1838  74 06			     jz	??002D
1  2145	183A  E8 F714			     call printWORD
1  2146	183D  E8 F5F3			     call pause
1  2147	1840				   ??002D:
1  2148					 ; -----------------------------
1  2149	1840  FF 27			     JMP WORD PTR [BX]
   2150
   2151						 HEAD	  83h,'MI',316Q,MIN		      ;	MIN
1  2152	      =ARRAY:1842		 LINK$=$
1  2153	1842  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2154							 ; 6 - признак immediate. 5- слово не описано smudge
1  2155	1843  4D 49			     DB	 'MI'
1  2156	1845  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  2157	1846  1820r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2158	      =ARRAY:1842		 LINK=LINK$
1  2159	1848				 MIN LABEL FAR	; CFA
1  2160	1848  184Ar			     DW	 $+2
   2161	184A  58				 POP  AX
   2162	184B  59				 POP  CX
   2163	184C  3B C8				 CMP  CX,  AX
   2164	184E  7C 12				 JL  DEEP	     ;
   2165	1850  50			TOP:	 PUSH AX
   2166						 NEXT
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 39
forth.asm



1  2167	1851  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2168	1852  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2169					 ; ------ call debugger	--------
1  2170	1854  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2171	1858  74 06			     jz	??002E
1  2172	185A  E8 F6F4			     call printWORD
1  2173	185D  E8 F5D3			     call pause
1  2174	1860				   ??002E:
1  2175					 ; -----------------------------
1  2176	1860  FF 27			     JMP WORD PTR [BX]
   2177	1862  51			DEEP:	 PUSH CX
   2178						 NEXT
1  2179	1863  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2180	1864  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2181					 ; ------ call debugger	--------
1  2182	1866  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2183	186A  74 06			     jz	??002F
1  2184	186C  E8 F6E2			     call printWORD
1  2185	186F  E8 F5C1			     call pause
1  2186	1872				   ??002F:
1  2187					 ; -----------------------------
1  2188	1872  FF 27			     JMP WORD PTR [BX]
   2189
   2190						 HEAD	  83h,'MA',330Q,MAX		      ;	MAX
1  2191	      =ARRAY:1874		 LINK$=$
1  2192	1874  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2193							 ; 6 - признак immediate. 5- слово не описано smudge
1  2194	1875  4D 41			     DB	 'MA'
1  2195	1877  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  2196	1878  1842r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2197	      =ARRAY:1874		 LINK=LINK$
1  2198	187A				 MAX LABEL FAR	; CFA
1  2199	187A  187Cr			     DW	 $+2
   2200	187C  58				 POP  AX
   2201	187D  59				 POP  CX
   2202	187E  3B C8				 CMP  CX, AX
   2203	1880  7D E0				 JGE  DEEP
   2204	1882  EB CC				 JMP  TOP
   2205
   2206						 HEAD	  83h,'SP',300Q,SPAT		      ;	SP@
1  2207	      =ARRAY:1884		 LINK$=$
1  2208	1884  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2209							 ; 6 - признак immediate. 5- слово не описано smudge
1  2210	1885  53 50			     DB	 'SP'
1  2211	1887  C0			     DB	 300Q	; последний символ слова + 128 (7 бит =	1).
1  2212	1888  1874r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2213	      =ARRAY:1884		 LINK=LINK$
1  2214	188A				 SPAT LABEL FAR	 ; CFA
1  2215	188A  188Cr			     DW	 $+2
   2216					     ; значение	текущего указателя регистра SP в стек
   2217	188C  8B C4				 MOV  AX, SP
   2218	188E  E9 FF62				 JMP  ENDA
   2219
   2220						 HEAD	  83h,'SP',241Q,SPSTO		      ;	SP!
1  2221	      =ARRAY:1891		 LINK$=$
1  2222	1891  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2223							 ; 6 - признак immediate. 5- слово не описано smudge
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 40
forth.asm



1  2224	1892  53 50			     DB	 'SP'
1  2225	1894  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  2226	1895  1884r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2227	      =ARRAY:1891		 LINK=LINK$
1  2228	1897				 SPSTO LABEL FAR  ; CFA
1  2229	1897  1899r			     DW	 $+2
   2230	1899  8B 65 06				 MOV  SP, [DI+6]			     ; 80h
   2231						 NEXT
1  2232	189C  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2233	189D  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2234					 ; ------ call debugger	--------
1  2235	189F  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2236	18A3  74 06			     jz	??0030
1  2237	18A5  E8 F6A9			     call printWORD
1  2238	18A8  E8 F588			     call pause
1  2239	18AB				   ??0030:
1  2240					 ; -----------------------------
1  2241	18AB  FF 27			     JMP WORD PTR [BX]
   2242
   2243						 HEAD	  83h,'RP',241Q,RPSTO		      ;	RP!
1  2244	      =ARRAY:18AD		 LINK$=$
1  2245	18AD  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2246							 ; 6 - признак immediate. 5- слово не описано smudge
1  2247	18AE  52 50			     DB	 'RP'
1  2248	18B0  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  2249	18B1  1891r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2250	      =ARRAY:18AD		 LINK=LINK$
1  2251	18B3				 RPSTO LABEL FAR  ; CFA
1  2252	18B3  18B5r			     DW	 $+2
   2253	18B5  8B 2E 0DA2r			 MOV  BP, $RS				     ; ccch
   2254						 NEXT
1  2255	18B9  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2256	18BA  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2257					 ; ------ call debugger	--------
1  2258	18BC  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2259	18C0  74 06			     jz	??0031
1  2260	18C2  E8 F68C			     call printWORD
1  2261	18C5  E8 F56B			     call pause
1  2262	18C8				   ??0031:
1  2263					 ; -----------------------------
1  2264	18C8  FF 27			     JMP WORD PTR [BX]
   2265
   2266						 HEAD	  82h,';',323Q,SEMI		      ;	;S
1  2267	      =ARRAY:18CA		 LINK$=$
1  2268	18CA  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2269							 ; 6 - признак immediate. 5- слово не описано smudge
1  2270	18CB  3B			     DB	 ';'
1  2271	18CC  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  2272	18CD  18ADr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2273	      =ARRAY:18CA		 LINK=LINK$
1  2274	18CF				 SEMI LABEL FAR	 ; CFA
1  2275	18CF  18D1r			     DW	 $+2
   2276					     ; переход на слово	по адресу в стеке возврата СЛОЖНО
   2277					     ; слово,которым заканчивается слова на форте
   2278	18D1  8B 76 00				 MOV  SI, [BP] ; в RS хранится адрес следующего	слова,
   2279							     ; до перехода на исполнение слова,	которое	завершается
   2280	18D4  83 C5 02				 ADD  BP, 2 ; удаляем из RS
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 41
forth.asm



   2281						 NEXT ;	 возврат на предыдущее слово
1  2282	18D7  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2283	18D8  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2284					 ; ------ call debugger	--------
1  2285	18DA  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2286	18DE  74 06			     jz	??0032
1  2287	18E0  E8 F66E			     call printWORD
1  2288	18E3  E8 F54D			     call pause
1  2289	18E6				   ??0032:
1  2290					 ; -----------------------------
1  2291	18E6  FF 27			     JMP WORD PTR [BX]
   2292
   2293					;	 ** Стек возвратов **
   2294
   2295						 HEAD	  85h, 'LEAV',305Q,LEAV		       ; LEAVE
1  2296	      =ARRAY:18E8		 LINK$=$
1  2297	18E8  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2298							 ; 6 - признак immediate. 5- слово не описано smudge
1  2299	18E9  4C 45 41 56		     DB	 'LEAV'
1  2300	18ED  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  2301	18EE  18CAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2302	      =ARRAY:18E8		 LINK=LINK$
1  2303	18F0				 LEAV LABEL FAR	 ; CFA
1  2304	18F0  18F2r			     DW	 $+2
   2305					     ; надо смотреть дальше с хранением	адресов
   2306					     ; приравнивает значения индекса и предела
   2307	18F2  8B 46 00				     MOV  AX, [BP]
   2308	18F5  89 46 02				 MOV  [BP+2], AX
   2309						 NEXT
1  2310	18F8  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2311	18F9  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2312					 ; ------ call debugger	--------
1  2313	18FB  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2314	18FF  74 06			     jz	??0033
1  2315	1901  E8 F64D			     call printWORD
1  2316	1904  E8 F52C			     call pause
1  2317	1907				   ??0033:
1  2318					 ; -----------------------------
1  2319	1907  FF 27			     JMP WORD PTR [BX]
   2320
   2321						 HEAD	  82h, 62,322Q,TOR		      ;	>R sds
1  2322	      =ARRAY:1909		 LINK$=$
1  2323	1909  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2324							 ; 6 - признак immediate. 5- слово не описано smudge
1  2325	190A  3E			     DB	 62
1  2326	190B  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  2327	190C  18E8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2328	      =ARRAY:1909		 LINK=LINK$
1  2329	190E				 TOR LABEL FAR	; CFA
1  2330	190E  1910r			     DW	 $+2
   2331					     ; пишем в стек возвратов
   2332					     ; слово из	стека данных
   2333	1910  83 ED 02				 SUB  BP, 2 ; заняли ячейку
   2334	1913  8F 46 00				 POP  [BP]   ; записали	значение
   2335						 NEXT
1  2336	1916  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2337	1917  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 42
forth.asm



1  2338					 ; ------ call debugger	--------
1  2339	1919  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2340	191D  74 06			     jz	??0034
1  2341	191F  E8 F62F			     call printWORD
1  2342	1922  E8 F50E			     call pause
1  2343	1925				   ??0034:
1  2344					 ; -----------------------------
1  2345	1925  FF 27			     JMP WORD PTR [BX]
   2346
   2347						     HEAD     82h, 'R',276Q,FROMR		   ; R>
1  2348	      =ARRAY:1927		 LINK$=$
1  2349	1927  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2350							 ; 6 - признак immediate. 5- слово не описано smudge
1  2351	1928  52			     DB	 'R'
1  2352	1929  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1  2353	192A  1909r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2354	      =ARRAY:1927		 LINK=LINK$
1  2355	192C				 FROMR LABEL FAR  ; CFA
1  2356	192C  192Er			     DW	 $+2
   2357					     ; в стек данных слово по адресу из	стека возвратов
   2358	192E  FF 76 00				     PUSH [BP] ; в стек	записали
   2359	1931  83 C5 02				 ADD  BP, 2 ; убрали
   2360						 NEXT
1  2361	1934  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2362	1935  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2363					 ; ------ call debugger	--------
1  2364	1937  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2365	193B  74 06			     jz	??0035
1  2366	193D  E8 F611			     call printWORD
1  2367	1940  E8 F4F0			     call pause
1  2368	1943				   ??0035:
1  2369					 ; -----------------------------
1  2370	1943  FF 27			     JMP WORD PTR [BX]
   2371
   2372						 HEAD	  81h,,311Q,I			      ;	I R R@
1  2373	      =ARRAY:1945		 LINK$=$
1  2374	1945  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2375							 ; 6 - признак immediate. 5- слово не описано smudge
1  2376	1946  C9			     DB	 311Q	; последний символ слова + 128 (7 бит =	1).
1  2377	1947  1927r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2378	      =ARRAY:1945		 LINK=LINK$
1  2379	1949				 I LABEL FAR  ;	CFA
1  2380	1949  194Br			     DW	 $+2
   2381					     ; Копирует	верхнее	число из стека возвратов
   2382					     ; и записывая в стек параметров
   2383	194B  FF 76 00		       RR$:	 PUSH [BP]
   2384	194E			       Z$:	 NEXT
1  2385	194E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2386	194F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2387					 ; ------ call debugger	--------
1  2388	1951  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2389	1955  74 06			     jz	??0036
1  2390	1957  E8 F5F7			     call printWORD
1  2391	195A  E8 F4D6			     call pause
1  2392	195D				   ??0036:
1  2393					 ; -----------------------------
1  2394	195D  FF 27			     JMP WORD PTR [BX]
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 43
forth.asm



   2395
   2396						 HEAD	  81h,,322Q,R			      ;	R
1  2397	      =ARRAY:195F		 LINK$=$
1  2398	195F  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2399							 ; 6 - признак immediate. 5- слово не описано smudge
1  2400	1960  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  2401	1961  1945r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2402	      =ARRAY:195F		 LINK=LINK$
1  2403	1963				 R LABEL FAR  ;	CFA
1  2404	1963  1965r			     DW	 $+2
   2405	1965  EB E4				 JMP  RR$
   2406
   2407						 HEAD	  82h,'I',247Q,SRP		      ;	I'
1  2408	      =ARRAY:1967		 LINK$=$
1  2409	1967  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2410							 ; 6 - признак immediate. 5- слово не описано smudge
1  2411	1968  49			     DB	 'I'
1  2412	1969  A7			     DB	 247Q	; последний символ слова + 128 (7 бит =	1).
1  2413	196A  195Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2414	      =ARRAY:1967		 LINK=LINK$
1  2415	196C				 SRP LABEL FAR	; CFA
1  2416	196C  196Er			     DW	 $+2
   2417					     ; Копирует	второе сверху число из стека возвратов
   2418					     ; и записывает его	в стек параметров
   2419	196E  FF 76 02				 PUSH [BP+2]
   2420	1971  EB DB				 JMP  Z$
   2421
   2422					     HEAD     81h,,'J'+80h,J			; J
1  2423	      =ARRAY:1973		 LINK$=$
1  2424	1973  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2425							 ; 6 - признак immediate. 5- слово не описано smudge
1  2426	1974  CA			     DB	 'J'+80h   ; последний символ слова + 128 (7 бит = 1).
1  2427	1975  1967r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2428	      =ARRAY:1973		 LINK=LINK$
1  2429	1977				 J LABEL FAR  ;	CFA
1  2430	1977  1979r			     DW	 $+2
   2431					     ; Копирует	третье сверху число из стека возвратов
   2432					     ; и записывает его	в стек параметров
   2433	1979  FF 76 04				 PUSH [BP+4]
   2434	197C  EB D0				 JMP  Z$
   2435
   2436					     HEAD     82h,'J',247Q,JT			 ; J'
1  2437	      =ARRAY:197E		 LINK$=$
1  2438	197E  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2439							 ; 6 - признак immediate. 5- слово не описано smudge
1  2440	197F  4A			     DB	 'J'
1  2441	1980  A7			     DB	 247Q	; последний символ слова + 128 (7 бит =	1).
1  2442	1981  1973r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2443	      =ARRAY:197E		 LINK=LINK$
1  2444	1983				 JT LABEL FAR  ; CFA
1  2445	1983  1985r			     DW	 $+2
   2446					     ; Копирует	четвертое сверху число из стека	возвратов
   2447					     ; и записывает его	в стек параметров
   2448	1985  FF 76 06				 PUSH [BP+6]
   2449	1988  EB C4				 JMP  Z$
   2450
   2451					     HEAD     81h,,'K'+80h,K			; K
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 44
forth.asm



1  2452	      =ARRAY:198A		 LINK$=$
1  2453	198A  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  2454							 ; 6 - признак immediate. 5- слово не описано smudge
1  2455	198B  CB			     DB	 'K'+80h   ; последний символ слова + 128 (7 бит = 1).
1  2456	198C  197Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2457	      =ARRAY:198A		 LINK=LINK$
1  2458	198E				 K LABEL FAR  ;	CFA
1  2459	198E  1990r			     DW	 $+2
   2460					     ; Копирует	пятое сверху число из стека возвратов
   2461					     ; и записывает его	в стек параметров
   2462	1990  FF 76 08				 PUSH [BP+8]
   2463	1993  EB B9				 JMP  Z$
   2464
   2465					     HEAD     82h,'K',247Q,KT			 ; K'
1  2466	      =ARRAY:1995		 LINK$=$
1  2467	1995  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2468							 ; 6 - признак immediate. 5- слово не описано smudge
1  2469	1996  4B			     DB	 'K'
1  2470	1997  A7			     DB	 247Q	; последний символ слова + 128 (7 бит =	1).
1  2471	1998  198Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2472	      =ARRAY:1995		 LINK=LINK$
1  2473	199A				 KT LABEL FAR  ; CFA
1  2474	199A  199Cr			     DW	 $+2
   2475					     ; Копирует	шестое сверху число из стека возвратов
   2476					     ; и записывает его	в стек параметров
   2477	199C  FF 76 0A				 PUSH [BP+10]
   2478	199F  EB AD				 JMP  Z$
   2479
   2480						 HEAD	  83h,'LE',326Q,LEV		      ;	LEV
1  2481	      =ARRAY:19A1		 LINK$=$
1  2482	19A1  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2483							 ; 6 - признак immediate. 5- слово не описано smudge
1  2484	19A2  4C 45			     DB	 'LE'
1  2485	19A4  D6			     DB	 326Q	; последний символ слова + 128 (7 бит =	1).
1  2486	19A5  1995r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2487	      =ARRAY:19A1		 LINK=LINK$
1  2488	19A7				 LEV LABEL FAR	; CFA
1  2489	19A7  19A9r			     DW	 $+2
   2490					     ; эквивалент R> DROP :) только быстрее
   2491					     ; для выхода из interpret
   2492	19A9  83 C5 02				 ADD  BP, 2
   2493						 NEXT
1  2494	19AC  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2495	19AD  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2496					 ; ------ call debugger	--------
1  2497	19AF  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2498	19B3  74 06			     jz	??0037
1  2499	19B5  E8 F599			     call printWORD
1  2500	19B8  E8 F478			     call pause
1  2501	19BB				   ??0037:
1  2502					 ; -----------------------------
1  2503	19BB  FF 27			     JMP WORD PTR [BX]
   2504
   2505						 ;** Операции со стеком	параметров **
   2506
   2507						 HEAD	  84h,'PIC',313Q,PICK		      ;	PICK
1  2508	      =ARRAY:19BD		 LINK$=$
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 45
forth.asm



1  2509	19BD  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2510							 ; 6 - признак immediate. 5- слово не описано smudge
1  2511	19BE  50 49 43			     DB	 'PIC'
1  2512	19C1  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  2513	19C2  19A1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2514	      =ARRAY:19BD		 LINK=LINK$
1  2515	19C4				 PICK LABEL FAR	 ; CFA
1  2516	19C4  19C6r			     DW	 $+2
   2517	19C6  5B				 POP  BX
   2518	19C7  83 FB 00				 CMP  BX,  0
   2519	19CA  7E 08				 JLE  $GO
   2520	19CC  4B				 DEC  BX
   2521	19CD  D1 E3				 SAL  BX, 1
   2522	19CF  03 DC				 ADD  BX, SP
   2523	19D1  36: FF 37				 PUSH SS:[BX]
   2524	19D4				$GO:	 NEXT
1  2525	19D4  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2526	19D5  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2527					 ; ------ call debugger	--------
1  2528	19D7  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2529	19DB  74 06			     jz	??0038
1  2530	19DD  E8 F571			     call printWORD
1  2531	19E0  E8 F450			     call pause
1  2532	19E3				   ??0038:
1  2533					 ; -----------------------------
1  2534	19E3  FF 27			     JMP WORD PTR [BX]
   2535
   2536						 HEAD	  84h,'OVE',322Q,OVER		      ;	OVER
1  2537	      =ARRAY:19E5		 LINK$=$
1  2538	19E5  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2539							 ; 6 - признак immediate. 5- слово не описано smudge
1  2540	19E6  4F 56 45			     DB	 'OVE'
1  2541	19E9  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  2542	19EA  19BDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2543	      =ARRAY:19E5		 LINK=LINK$
1  2544	19EC				 OVER LABEL FAR	 ; CFA
1  2545	19EC  19EEr			     DW	 $+2
   2546	19EE  8B DC				 MOV  BX, SP
   2547	19F0  36: FF 77	02			     PUSH SS:[BX+2]
   2548						 NEXT
1  2549	19F4  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2550	19F5  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2551					 ; ------ call debugger	--------
1  2552	19F7  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2553	19FB  74 06			     jz	??0039
1  2554	19FD  E8 F551			     call printWORD
1  2555	1A00  E8 F430			     call pause
1  2556	1A03				   ??0039:
1  2557					 ; -----------------------------
1  2558	1A03  FF 27			     JMP WORD PTR [BX]
   2559
   2560						 HEAD	  84h,'SWA',320Q,SWAP		      ;	SWAP
1  2561	      =ARRAY:1A05		 LINK$=$
1  2562	1A05  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2563							 ; 6 - признак immediate. 5- слово не описано smudge
1  2564	1A06  53 57 41			     DB	 'SWA'
1  2565	1A09  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 46
forth.asm



1  2566	1A0A  19E5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2567	      =ARRAY:1A05		 LINK=LINK$
1  2568	1A0C				 SWAP LABEL FAR	 ; CFA
1  2569	1A0C  1A0Er			     DW	 $+2
   2570	1A0E  59				 POP  CX
   2571	1A0F  58				 POP  AX
   2572	1A10  51				 PUSH CX
   2573	1A11  50				 PUSH AX
   2574						 NEXT
1  2575	1A12  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2576	1A13  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2577					 ; ------ call debugger	--------
1  2578	1A15  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2579	1A19  74 06			     jz	??003A
1  2580	1A1B  E8 F533			     call printWORD
1  2581	1A1E  E8 F412			     call pause
1  2582	1A21				   ??003A:
1  2583					 ; -----------------------------
1  2584	1A21  FF 27			     JMP WORD PTR [BX]
   2585
   2586						 HEAD	  85h,'2SWA',320Q,DSWAP		      ;	2SWAP
1  2587	      =ARRAY:1A23		 LINK$=$
1  2588	1A23  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2589							 ; 6 - признак immediate. 5- слово не описано smudge
1  2590	1A24  32 53 57 41		     DB	 '2SWA'
1  2591	1A28  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2592	1A29  1A05r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2593	      =ARRAY:1A23		 LINK=LINK$
1  2594	1A2B				 DSWAP LABEL FAR  ; CFA
1  2595	1A2B  1A2Dr			     DW	 $+2
   2596	1A2D  58				 POP  AX
   2597	1A2E  59				 POP  CX
   2598	1A2F  8B DC				 MOV  BX,  SP
   2599	1A31  36: 8B 57	02			 MOV  DX,WORD PTR SS:[BX+2]
   2600	1A35  52				 PUSH DX
   2601	1A36  36: 8B 17				 MOV  DX,WORD PTR SS:[BX]
   2602	1A39  52				 PUSH DX
   2603	1A3A  36: 89 07				 MOV  WORD  PTR	SS:[BX],AX
   2604	1A3D  36: 89 4F	02			 MOV  WORD  PTR	SS:[BX+2],CX
   2605						 NEXT
1  2606	1A41  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2607	1A42  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2608					 ; ------ call debugger	--------
1  2609	1A44  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2610	1A48  74 06			     jz	??003B
1  2611	1A4A  E8 F504			     call printWORD
1  2612	1A4D  E8 F3E3			     call pause
1  2613	1A50				   ??003B:
1  2614					 ; -----------------------------
1  2615	1A50  FF 27			     JMP WORD PTR [BX]
   2616
   2617						 HEAD	  83h,'DU',320Q,DUBL		      ;	DUP
1  2618	      =ARRAY:1A52		 LINK$=$
1  2619	1A52  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2620							 ; 6 - признак immediate. 5- слово не описано smudge
1  2621	1A53  44 55			     DB	 'DU'
1  2622	1A55  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 47
forth.asm



1  2623	1A56  1A23r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2624	      =ARRAY:1A52		 LINK=LINK$
1  2625	1A58				 DUBL LABEL FAR	 ; CFA
1  2626	1A58  1A5Ar			     DW	 $+2
   2627	1A5A  58				 POP  AX
   2628	1A5B  50			DU:	 PUSH AX
   2629	1A5C  50			C$:	 PUSH AX
   2630						 NEXT
1  2631	1A5D  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2632	1A5E  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2633					 ; ------ call debugger	--------
1  2634	1A60  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2635	1A64  74 06			     jz	??003C
1  2636	1A66  E8 F4E8			     call printWORD
1  2637	1A69  E8 F3C7			     call pause
1  2638	1A6C				   ??003C:
1  2639					 ; -----------------------------
1  2640	1A6C  FF 27			     JMP WORD PTR [BX]
   2641
   2642						 HEAD	  84h,'-DU',320Q,DDUP		      ;	-DUP
1  2643	      =ARRAY:1A6E		 LINK$=$
1  2644	1A6E  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2645							 ; 6 - признак immediate. 5- слово не описано smudge
1  2646	1A6F  2D 44 55			     DB	 '-DU'
1  2647	1A72  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2648	1A73  1A52r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2649	      =ARRAY:1A6E		 LINK=LINK$
1  2650	1A75				 DDUP LABEL FAR	 ; CFA
1  2651	1A75  1A77r			     DW	 $+2
   2652					     ; DUP если	в стеке	не 0
   2653	1A77  58				 POP  AX
   2654	1A78  3D 0000				 CMP  AX,  0
   2655	1A7B  75 DE				 JNE  DU
   2656	1A7D  EB DD				 JMP  C$
   2657
   2658						 HEAD	  84h,'2DU',320Q,DUP2		      ;	2DUP
1  2659	      =ARRAY:1A7F		 LINK$=$
1  2660	1A7F  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2661							 ; 6 - признак immediate. 5- слово не описано smudge
1  2662	1A80  32 44 55			     DB	 '2DU'
1  2663	1A83  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2664	1A84  1A6Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2665	      =ARRAY:1A7F		 LINK=LINK$
1  2666	1A86				 DUP2 LABEL FAR	 ; CFA
1  2667	1A86  1A88r			     DW	 $+2
   2668	1A88  58				 POP  AX
   2669	1A89  59				 POP  CX
   2670	1A8A  51				 PUSH CX
   2671	1A8B  50				 PUSH AX
   2672	1A8C  51				 PUSH CX
   2673	1A8D  50				 PUSH AX
   2674						 NEXT
1  2675	1A8E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2676	1A8F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2677					 ; ------ call debugger	--------
1  2678	1A91  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2679	1A95  74 06			     jz	??003D
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 48
forth.asm



1  2680	1A97  E8 F4B7			     call printWORD
1  2681	1A9A  E8 F396			     call pause
1  2682	1A9D				   ??003D:
1  2683					 ; -----------------------------
1  2684	1A9D  FF 27			     JMP WORD PTR [BX]
   2685
   2686						 HEAD	  83h,'RO',324Q,ROT		      ;	ROT
1  2687	      =ARRAY:1A9F		 LINK$=$
1  2688	1A9F  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2689							 ; 6 - признак immediate. 5- слово не описано smudge
1  2690	1AA0  52 4F			     DB	 'RO'
1  2691	1AA2  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  2692	1AA3  1A7Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2693	      =ARRAY:1A9F		 LINK=LINK$
1  2694	1AA5				 ROT LABEL FAR	; CFA
1  2695	1AA5  1AA7r			     DW	 $+2
   2696	1AA7  58				 POP  AX
   2697	1AA8  59				 POP  CX
   2698	1AA9  5B				 POP  BX
   2699	1AAA  51				 PUSH CX
   2700	1AAB  50				 PUSH AX
   2701	1AAC  53				 PUSH BX
   2702						 NEXT
1  2703	1AAD  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2704	1AAE  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2705					 ; ------ call debugger	--------
1  2706	1AB0  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2707	1AB4  74 06			     jz	??003E
1  2708	1AB6  E8 F498			     call printWORD
1  2709	1AB9  E8 F377			     call pause
1  2710	1ABC				   ??003E:
1  2711					 ; -----------------------------
1  2712	1ABC  FF 27			     JMP WORD PTR [BX]
   2713
   2714						 HEAD	  84h,'-RO',324Q,MROT			; -ROT
1  2715	      =ARRAY:1ABE		 LINK$=$
1  2716	1ABE  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2717							 ; 6 - признак immediate. 5- слово не описано smudge
1  2718	1ABF  2D 52 4F			     DB	 '-RO'
1  2719	1AC2  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  2720	1AC3  1A9Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2721	      =ARRAY:1ABE		 LINK=LINK$
1  2722	1AC5				 MROT LABEL FAR	 ; CFA
1  2723	1AC5  1AC7r			     DW	 $+2
   2724	1AC7  58				 POP  AX
   2725	1AC8  59				 POP  CX
   2726	1AC9  5B				 POP  BX
   2727	1ACA  50				 PUSH AX
   2728	1ACB  53				 PUSH BX
   2729	1ACC  51				 PUSH CX
   2730						 NEXT
1  2731	1ACD  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2732	1ACE  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2733					 ; ------ call debugger	--------
1  2734	1AD0  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2735	1AD4  74 06			     jz	??003F
1  2736	1AD6  E8 F478			     call printWORD
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 49
forth.asm



1  2737	1AD9  E8 F357			     call pause
1  2738	1ADC				   ??003F:
1  2739					 ; -----------------------------
1  2740	1ADC  FF 27			     JMP WORD PTR [BX]
   2741
   2742						 HEAD	  85h,'4DRO',320Q,QDROP		      ;	4DROP
1  2743	      =ARRAY:1ADE		 LINK$=$
1  2744	1ADE  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2745							 ; 6 - признак immediate. 5- слово не описано smudge
1  2746	1ADF  34 44 52 4F		     DB	 '4DRO'
1  2747	1AE3  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2748	1AE4  1ABEr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2749	      =ARRAY:1ADE		 LINK=LINK$
1  2750	1AE6				 QDROP LABEL FAR  ; CFA
1  2751	1AE6  1AE8r			     DW	 $+2
   2752	1AE8  83 C4 06				 ADD  SP, 6
   2753						 NEXT
1  2754	1AEB  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2755	1AEC  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2756					 ; ------ call debugger	--------
1  2757	1AEE  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2758	1AF2  74 06			     jz	??0040
1  2759	1AF4  E8 F45A			     call printWORD
1  2760	1AF7  E8 F339			     call pause
1  2761	1AFA				   ??0040:
1  2762					 ; -----------------------------
1  2763	1AFA  FF 27			     JMP WORD PTR [BX]
   2764
   2765						 HEAD	  85h,'2DRO',320Q,DDROP		      ;	2DROP
1  2766	      =ARRAY:1AFC		 LINK$=$
1  2767	1AFC  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2768							 ; 6 - признак immediate. 5- слово не описано smudge
1  2769	1AFD  32 44 52 4F		     DB	 '2DRO'
1  2770	1B01  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  2771	1B02  1ADEr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2772	      =ARRAY:1AFC		 LINK=LINK$
1  2773	1B04				 DDROP LABEL FAR  ; CFA
1  2774	1B04  1B06r			     DW	 $+2
   2775	1B06  83 C4 04			DRO:	 ADD  SP, 4
   2776						 NEXT
1  2777	1B09  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2778	1B0A  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2779					 ; ------ call debugger	--------
1  2780	1B0C  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2781	1B10  74 06			     jz	??0041
1  2782	1B12  E8 F43C			     call printWORD
1  2783	1B15  E8 F31B			     call pause
1  2784	1B18				   ??0041:
1  2785					 ; -----------------------------
1  2786	1B18  FF 27			     JMP WORD PTR [BX]
   2787
   2788						 HEAD	  84h,'DRO',320Q,DROP		      ;	DROP
1  2789	      =ARRAY:1B1A		 LINK$=$
1  2790	1B1A  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2791							 ; 6 - признак immediate. 5- слово не описано smudge
1  2792	1B1B  44 52 4F			     DB	 'DRO'
1  2793	1B1E  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 50
forth.asm



1  2794	1B1F  1AFCr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2795	      =ARRAY:1B1A		 LINK=LINK$
1  2796	1B21				 DROP LABEL FAR	 ; CFA
1  2797	1B21  1B23r			     DW	 $+2
   2798	1B23  83 C4 02			DRP:	 ADD  SP, 2
   2799						 NEXT
1  2800	1B26  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2801	1B27  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2802					 ; ------ call debugger	--------
1  2803	1B29  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2804	1B2D  74 06			     jz	??0042
1  2805	1B2F  E8 F41F			     call printWORD
1  2806	1B32  E8 F2FE			     call pause
1  2807	1B35				   ??0042:
1  2808					 ; -----------------------------
1  2809	1B35  FF 27			     JMP WORD PTR [BX]
   2810
   2811						 HEAD	  83h,'NI','P'+80h,NIP		      ;	NIP
1  2812	      =ARRAY:1B37		 LINK$=$
1  2813	1B37  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  2814							 ; 6 - признак immediate. 5- слово не описано smudge
1  2815	1B38  4E 49			     DB	 'NI'
1  2816	1B3A  D0			     DB	 'P'+80h   ; последний символ слова + 128 (7 бит = 1).
1  2817	1B3B  1B1Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2818	      =ARRAY:1B37		 LINK=LINK$
1  2819	1B3D				 NIP LABEL FAR	; CFA
1  2820	1B3D  1B3Fr			     DW	 $+2
   2821	1B3F  5B				 POP  BX
   2822	1B40  58				 POP  AX
   2823	1B41  53				 PUSH BX
   2824						 NEXT
1  2825	1B42  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2826	1B43  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2827					 ; ------ call debugger	--------
1  2828	1B45  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2829	1B49  74 06			     jz	??0043
1  2830	1B4B  E8 F403			     call printWORD
1  2831	1B4E  E8 F2E2			     call pause
1  2832	1B51				   ??0043:
1  2833					 ; -----------------------------
1  2834	1B51  FF 27			     JMP WORD PTR [BX]
   2835
   2836					;	 ** Работа с памятью **
   2837
   2838						 HEAD	  85h,'CMOV',305Q,CMOV		     ; CMOVE
1  2839	      =ARRAY:1B53		 LINK$=$
1  2840	1B53  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2841							 ; 6 - признак immediate. 5- слово не описано smudge
1  2842	1B54  43 4D 4F 56		     DB	 'CMOV'
1  2843	1B58  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  2844	1B59  1B37r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2845	      =ARRAY:1B53		 LINK=LINK$
1  2846	1B5B				 CMOV LABEL FAR	 ; CFA
1  2847	1B5B  1B5Dr			     DW	 $+2
   2848					     ; src dst cnt -> перенос области памяти
   2849	1B5D  59				 POP  CX	 ; Счетчик
   2850	1B5E  83 F9 00				 CMP  CX,  0
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 51
forth.asm



   2851	1B61  7E A3				 JLE  DRO	 ; выход, c сбросом двух параметров в стеке
   2852	1B63  8B C7				 MOV  AX,  DI	  ; Сохранение содержимого DI,SI
   2853	1B65  8B DE				 MOV  BX,  SI
   2854	1B67  5F				 POP  DI	  ; Куда
   2855	1B68  5E				 POP  SI	  ; Откуда
   2856	1B69  F3> A4			REP	 MOVS  BYTE PTR	ES:[DI], BYTE PTR DS:[SI]
   2857	1B6B  8B F8				 MOV  DI, AX	  ; Восстановление DI,SI
   2858	1B6D  8B F3				 MOV  SI, BX
   2859						 NEXT
1  2860	1B6F  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2861	1B70  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2862					 ; ------ call debugger	--------
1  2863	1B72  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2864	1B76  74 06			     jz	??0044
1  2865	1B78  E8 F3D6			     call printWORD
1  2866	1B7B  E8 F2B5			     call pause
1  2867	1B7E				   ??0044:
1  2868					 ; -----------------------------
1  2869	1B7E  FF 27			     JMP WORD PTR [BX]
   2870
   2871						 HEAD	  84h,'FIL',314Q,FILL		      ;	FILL
1  2872	      =ARRAY:1B80		 LINK$=$
1  2873	1B80  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2874							 ; 6 - признак immediate. 5- слово не описано smudge
1  2875	1B81  46 49 4C			     DB	 'FIL'
1  2876	1B84  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  2877	1B85  1B53r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2878	      =ARRAY:1B80		 LINK=LINK$
1  2879	1B87				 FILL LABEL FAR	 ; CFA
1  2880	1B87  1B89r			     DW	 $+2
   2881					 ; addr	cnt chr	-> заполнение области памяти
   2882	1B89  58				 POP  AX      ;	Символ
   2883	1B8A  59			FLL:	 POP  CX      ;	Счетчик	символов
   2884	1B8B  83 F9 00				 CMP  CX, 0
   2885	1B8E  7E 93				 JLE  DRP     ;
   2886	1B90  5B				 POP  BX
   2887	1B91  88 07			$REPE:	 MOV  BYTE PTR [BX],  AL
   2888	1B93  43				 INC  BX
   2889	1B94  E2 FB				 LOOP $REPE
   2890						 NEXT
1  2891	1B96  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2892	1B97  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2893					 ; ------ call debugger	--------
1  2894	1B99  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2895	1B9D  74 06			     jz	??0045
1  2896	1B9F  E8 F3AF			     call printWORD
1  2897	1BA2  E8 F28E			     call pause
1  2898	1BA5				   ??0045:
1  2899					 ; -----------------------------
1  2900	1BA5  FF 27			     JMP WORD PTR [BX]
   2901
   2902						 HEAD	  85h,'ERAS',305Q,ERASE		      ;	ERASE
1  2903	      =ARRAY:1BA7		 LINK$=$
1  2904	1BA7  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  2905							 ; 6 - признак immediate. 5- слово не описано smudge
1  2906	1BA8  45 52 41 53		     DB	 'ERAS'
1  2907	1BAC  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 52
forth.asm



1  2908	1BAD  1B80r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2909	      =ARRAY:1BA7		 LINK=LINK$
1  2910	1BAF				 ERASE LABEL FAR  ; CFA
1  2911	1BAF  1BB1r			     DW	 $+2
   2912					     ; заполнение нулем
   2913	1BB1  2B C0				 SUB  AX, AX
   2914	1BB3  EB D5				 JMP  FLL
   2915
   2916						 HEAD	  86h,'BLANK',323Q,BLANK	      ;	BLANKS
1  2917	      =ARRAY:1BB5		 LINK$=$
1  2918	1BB5  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  2919							 ; 6 - признак immediate. 5- слово не описано smudge
1  2920	1BB6  42 4C 41 4E 4B		     DB	 'BLANK'
1  2921	1BBB  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  2922	1BBC  1BA7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2923	      =ARRAY:1BB5		 LINK=LINK$
1  2924	1BBE				 BLANK LABEL FAR  ; CFA
1  2925	1BBE  1BC0r			     DW	 $+2
   2926					     ; заполнение  пробелом
   2927	1BC0  B8 0020				 MOV  AX, 32
   2928	1BC3  EB C5				 JMP  FLL
   2929
   2930						 HEAD	  84h,'HOL',304Q,HOLD		      ;	HOLD
1  2931	      =ARRAY:1BC5		 LINK$=$
1  2932	1BC5  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  2933							 ; 6 - признак immediate. 5- слово не описано smudge
1  2934	1BC6  48 4F 4C			     DB	 'HOL'
1  2935	1BC9  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  2936	1BCA  1BB5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2937	      =ARRAY:1BC5		 LINK=LINK$
1  2938	1BCC				 HOLD LABEL FAR	 ; CFA
1  2939	1BCC  1BCEr			     DW	 $+2
   2940					     ; Вводит в	текущую	ячейку выходного буфера	символ,
   2941					     ; код которого в стеке. Должен использоваться между <# и #>
   2942					     ; уменьшает на 1 значение указателя HLD.
   2943	1BCE  FF 4D 38				 DEC  WORD PTR	[DI+70Q]
   2944	1BD1  58				 POP  AX
   2945	1BD2  8B 5D 38				 MOV  BX,  [DI+70Q]
   2946	1BD5  88 07				 MOV  BYTE PTR [BX], AL
   2947						 NEXT
1  2948	1BD7  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2949	1BD8  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2950					 ; ------ call debugger	--------
1  2951	1BDA  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2952	1BDE  74 06			     jz	??0046
1  2953	1BE0  E8 F36E			     call printWORD
1  2954	1BE3  E8 F24D			     call pause
1  2955	1BE6				   ??0046:
1  2956					 ; -----------------------------
1  2957	1BE6  FF 27			     JMP WORD PTR [BX]
   2958
   2959						 HEAD	  82h,'+',241Q,PSTOR		      ;	+!
1  2960	      =ARRAY:1BE8		 LINK$=$
1  2961	1BE8  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2962							 ; 6 - признак immediate. 5- слово не описано smudge
1  2963	1BE9  2B			     DB	 '+'
1  2964	1BEA  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 53
forth.asm



1  2965	1BEB  1BC5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2966	      =ARRAY:1BE8		 LINK=LINK$
1  2967	1BED				 PSTOR LABEL FAR  ; CFA
1  2968	1BED  1BEFr			     DW	 $+2
   2969	1BEF  5B				 POP  BX
   2970	1BF0  59				 POP  CX
   2971	1BF1  01 0F				 ADD  [BX], CX
   2972						 NEXT
1  2973	1BF3  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2974	1BF4  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  2975					 ; ------ call debugger	--------
1  2976	1BF6  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  2977	1BFA  74 06			     jz	??0047
1  2978	1BFC  E8 F352			     call printWORD
1  2979	1BFF  E8 F231			     call pause
1  2980	1C02				   ??0047:
1  2981					 ; -----------------------------
1  2982	1C02  FF 27			     JMP WORD PTR [BX]
   2983
   2984						 HEAD	  82h,'-',241Q,MSTOR		      ;	+!
1  2985	      =ARRAY:1C04		 LINK$=$
1  2986	1C04  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  2987							 ; 6 - признак immediate. 5- слово не описано smudge
1  2988	1C05  2D			     DB	 '-'
1  2989	1C06  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  2990	1C07  1BE8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  2991	      =ARRAY:1C04		 LINK=LINK$
1  2992	1C09				 MSTOR LABEL FAR  ; CFA
1  2993	1C09  1C0Br			     DW	 $+2
   2994	1C0B  5B				 POP  BX
   2995	1C0C  59				 POP  CX
   2996	1C0D  29 0F				 SUB  [BX], CX
   2997						 NEXT
1  2998	1C0F  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  2999	1C10  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3000					 ; ------ call debugger	--------
1  3001	1C12  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3002	1C16  74 06			     jz	??0048
1  3003	1C18  E8 F336			     call printWORD
1  3004	1C1B  E8 F215			     call pause
1  3005	1C1E				   ??0048:
1  3006					 ; -----------------------------
1  3007	1C1E  FF 27			     JMP WORD PTR [BX]
   3008
   3009						 HEAD	  84h,'TOG',314Q,TOGL		      ;	TOGGLE
1  3010	      =ARRAY:1C20		 LINK$=$
1  3011	1C20  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3012							 ; 6 - признак immediate. 5- слово не описано smudge
1  3013	1C21  54 4F 47			     DB	 'TOG'
1  3014	1C24  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3015	1C25  1C04r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3016	      =ARRAY:1C20		 LINK=LINK$
1  3017	1C27				 TOGL LABEL FAR	 ; CFA
1  3018	1C27  1C29r			     DW	 $+2
   3019					; адр-байта маска -> XOR в байт	памяти
   3020	1C29  59				 POP  CX	 ; Маска
   3021	1C2A  5B				 POP  BX
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 54
forth.asm



   3022	1C2B  30 0F				 XOR  BYTE PTR [BX],CL
   3023						 NEXT
1  3024	1C2D  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3025	1C2E  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3026					 ; ------ call debugger	--------
1  3027	1C30  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3028	1C34  74 06			     jz	??0049
1  3029	1C36  E8 F318			     call printWORD
1  3030	1C39  E8 F1F7			     call pause
1  3031	1C3C				   ??0049:
1  3032					 ; -----------------------------
1  3033	1C3C  FF 27			     JMP WORD PTR [BX]
   3034
   3035						 HEAD	  81h,,300Q,AT			      ;	@
1  3036	      =ARRAY:1C3E		 LINK$=$
1  3037	1C3E  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3038							 ; 6 - признак immediate. 5- слово не описано smudge
1  3039	1C3F  C0			     DB	 300Q	; последний символ слова + 128 (7 бит =	1).
1  3040	1C40  1C20r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3041	      =ARRAY:1C3E		 LINK=LINK$
1  3042	1C42				 AT LABEL FAR  ; CFA
1  3043	1C42  1C44r			     DW	 $+2
   3044					     ; addr -> n
   3045	1C44  5B				 POP  BX
   3046	1C45  FF 37				 PUSH [BX]
   3047						 NEXT
1  3048	1C47  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3049	1C48  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3050					 ; ------ call debugger	--------
1  3051	1C4A  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3052	1C4E  74 06			     jz	??004A
1  3053	1C50  E8 F2FE			     call printWORD
1  3054	1C53  E8 F1DD			     call pause
1  3055	1C56				   ??004A:
1  3056					 ; -----------------------------
1  3057	1C56  FF 27			     JMP WORD PTR [BX]
   3058
   3059						 HEAD	  82h,'A',300Q,AAT		      ;	a@
1  3060	      =ARRAY:1C58		 LINK$=$
1  3061	1C58  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3062							 ; 6 - признак immediate. 5- слово не описано smudge
1  3063	1C59  41			     DB	 'A'
1  3064	1C5A  C0			     DB	 300Q	; последний символ слова + 128 (7 бит =	1).
1  3065	1C5B  1C3Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3066	      =ARRAY:1C58		 LINK=LINK$
1  3067	1C5D				 AAT LABEL FAR	; CFA
1  3068	1C5D  1C5Fr			     DW	 $+2
   3069					     ; ( Offset	Segment	--> Value )
   3070	1C5F  58				 pop  ax
   3071	1C60  5B				 pop  bx
   3072	1C61  06				 push es
   3073	1C62  8E C0				 mov  es, ax
   3074	1C64  26: 8B 07				 mov  ax, es:[bx]
   3075	1C67  07				 pop  es
   3076	1C68  50				 push ax
   3077						 NEXT
1  3078	1C69  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 55
forth.asm



1  3079	1C6A  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3080					 ; ------ call debugger	--------
1  3081	1C6C  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3082	1C70  74 06			     jz	??004B
1  3083	1C72  E8 F2DC			     call printWORD
1  3084	1C75  E8 F1BB			     call pause
1  3085	1C78				   ??004B:
1  3086					 ; -----------------------------
1  3087	1C78  FF 27			     JMP WORD PTR [BX]
   3088
   3089						 HEAD	  82h,'C',300Q,CAT		      ;	c@
1  3090	      =ARRAY:1C7A		 LINK$=$
1  3091	1C7A  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3092							 ; 6 - признак immediate. 5- слово не описано smudge
1  3093	1C7B  43			     DB	 'C'
1  3094	1C7C  C0			     DB	 300Q	; последний символ слова + 128 (7 бит =	1).
1  3095	1C7D  1C58r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3096	      =ARRAY:1C7A		 LINK=LINK$
1  3097	1C7F				 CAT LABEL FAR	; CFA
1  3098	1C7F  1C81r			     DW	 $+2
   3099					     ; Извлекает байт информации из ячейки,
   3100					     ; адрес которой находится в стеке
   3101	1C81  5B				 POP  BX
   3102	1C82  8A 07				 MOV  AL, BYTE PTR [BX]
   3103	1C84  2A E4				 SUB  AH, AH
   3104	1C86  50				 PUSH AX
   3105						 NEXT
1  3106	1C87  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3107	1C88  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3108					 ; ------ call debugger	--------
1  3109	1C8A  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3110	1C8E  74 06			     jz	??004C
1  3111	1C90  E8 F2BE			     call printWORD
1  3112	1C93  E8 F19D			     call pause
1  3113	1C96				   ??004C:
1  3114					 ; -----------------------------
1  3115	1C96  FF 27			     JMP WORD PTR [BX]
   3116
   3117						 HEAD	  81h,,241Q,STORE		      ;	!
1  3118	      =ARRAY:1C98		 LINK$=$
1  3119	1C98  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3120							 ; 6 - признак immediate. 5- слово не описано smudge
1  3121	1C99  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  3122	1C9A  1C7Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3123	      =ARRAY:1C98		 LINK=LINK$
1  3124	1C9C				 STORE LABEL FAR  ; CFA
1  3125	1C9C  1C9Er			     DW	 $+2
   3126					     ; n addr ->
   3127	1C9E  5B				 POP  BX
   3128	1C9F  58				 POP  AX
   3129	1CA0  89 07				 MOV  [BX],   AX
   3130						 NEXT
1  3131	1CA2  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3132	1CA3  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3133					 ; ------ call debugger	--------
1  3134	1CA5  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3135	1CA9  74 06			     jz	??004D
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 56
forth.asm



1  3136	1CAB  E8 F2A3			     call printWORD
1  3137	1CAE  E8 F182			     call pause
1  3138	1CB1				   ??004D:
1  3139					 ; -----------------------------
1  3140	1CB1  FF 27			     JMP WORD PTR [BX]
   3141
   3142						 HEAD	  82h,'C',241Q,CSTOR		     ; C!
1  3143	      =ARRAY:1CB3		 LINK$=$
1  3144	1CB3  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3145							 ; 6 - признак immediate. 5- слово не описано smudge
1  3146	1CB4  43			     DB	 'C'
1  3147	1CB5  A1			     DB	 241Q	; последний символ слова + 128 (7 бит =	1).
1  3148	1CB6  1C98r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3149	      =ARRAY:1CB3		 LINK=LINK$
1  3150	1CB8				 CSTOR LABEL FAR  ; CFA
1  3151	1CB8  1CBAr			     DW	 $+2
   3152	1CBA  5B				 POP  BX
   3153	1CBB  58				 POP  AX
   3154	1CBC  88 07				 MOV  BYTE PTR [BX],  AL
   3155						 NEXT
1  3156	1CBE  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3157	1CBF  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3158					 ; ------ call debugger	--------
1  3159	1CC1  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3160	1CC5  74 06			     jz	??004E
1  3161	1CC7  E8 F287			     call printWORD
1  3162	1CCA  E8 F166			     call pause
1  3163	1CCD				   ??004E:
1  3164					 ; -----------------------------
1  3165	1CCD  FF 27			     JMP WORD PTR [BX]
   3166
   3167						 HEAD	  83h,'NF','A'+80h,NFA		     ; NFA
1  3168	      =ARRAY:1CCF		 LINK$=$
1  3169	1CCF  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3170							 ; 6 - признак immediate. 5- слово не описано smudge
1  3171	1CD0  4E 46			     DB	 'NF'
1  3172	1CD2  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  3173	1CD3  1CB3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3174	      =ARRAY:1CCF		 LINK=LINK$
1  3175	1CD5				 NFA LABEL FAR	; CFA
1  3176	1CD5  1CD7r			     DW	 $+2
   3177					 ; pfa -> nfa
   3178	1CD7  5B				 POP  BX
   3179	1CD8  83 EB 05				 SUB  BX, 5
   3180	1CDB  B9 FFFF				 MOV  CX, -1
   3181
   3182	1CDE  E9 00A0				 JMP  TRV
   3183
   3184						 HEAD	  83h,'LF','A'+80h,LFA		     ; LFA
1  3185	      =ARRAY:1CE1		 LINK$=$
1  3186	1CE1  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3187							 ; 6 - признак immediate. 5- слово не описано smudge
1  3188	1CE2  4C 46			     DB	 'LF'
1  3189	1CE4  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  3190	1CE5  1CCFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3191	      =ARRAY:1CE1		 LINK=LINK$
1  3192	1CE7				 LFA LABEL FAR	; CFA
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 57
forth.asm



1  3193	1CE7  1CE9r			     DW	 $+2
   3194	1CE9  58				 POP  AX
   3195	1CEA  2D 0004				 SUB  AX, 4
   3196	1CED  50				 PUSH AX
   3197						 NEXT
1  3198	1CEE  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3199	1CEF  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3200					 ; ------ call debugger	--------
1  3201	1CF1  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3202	1CF5  74 06			     jz	??004F
1  3203	1CF7  E8 F257			     call printWORD
1  3204	1CFA  E8 F136			     call pause
1  3205	1CFD				   ??004F:
1  3206					 ; -----------------------------
1  3207	1CFD  FF 27			     JMP WORD PTR [BX]
   3208
   3209						 HEAD	  83h,'CF','A'+80h,CFA		     ; CFA
1  3210	      =ARRAY:1CFF		 LINK$=$
1  3211	1CFF  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3212							 ; 6 - признак immediate. 5- слово не описано smudge
1  3213	1D00  43 46			     DB	 'CF'
1  3214	1D02  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  3215	1D03  1CE1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3216	      =ARRAY:1CFF		 LINK=LINK$
1  3217	1D05				 CFA LABEL FAR	; CFA
1  3218	1D05  1D07r			     DW	 $+2
   3219					 ; PFA -> CFA
   3220	1D07  58				 POP  AX
   3221	1D08  2D 0002				 SUB  AX, 2
   3222	1D0B  50				 PUSH AX
   3223						 NEXT
1  3224	1D0C  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3225	1D0D  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3226					 ; ------ call debugger	--------
1  3227	1D0F  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3228	1D13  74 06			     jz	??0050
1  3229	1D15  E8 F239			     call printWORD
1  3230	1D18  E8 F118			     call pause
1  3231	1D1B				   ??0050:
1  3232					 ; -----------------------------
1  3233	1D1B  FF 27			     JMP WORD PTR [BX]
   3234
   3235						 HEAD	  84h,'!CS',320Q,SCSP		      ;	!CSP
1  3236	      =ARRAY:1D1D		 LINK$=$
1  3237	1D1D  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3238							 ; 6 - признак immediate. 5- слово не описано smudge
1  3239	1D1E  21 43 53			     DB	 '!CS'
1  3240	1D21  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  3241	1D22  1CFFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3242	      =ARRAY:1D1D		 LINK=LINK$
1  3243	1D24				 SCSP LABEL FAR	 ; CFA
1  3244	1D24  1D26r			     DW	 $+2
   3245					 ; контролируют	сохранение указателя стека параметров
   3246					 ; в процессе интерпретации слова
   3247	1D26  89 65 34				 MOV  WORD PTR [DI]+64Q,SP
   3248						 NEXT
1  3249	1D29  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 58
forth.asm



1  3250	1D2A  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3251					 ; ------ call debugger	--------
1  3252	1D2C  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3253	1D30  74 06			     jz	??0051
1  3254	1D32  E8 F21C			     call printWORD
1  3255	1D35  E8 F0FB			     call pause
1  3256	1D38				   ??0051:
1  3257					 ; -----------------------------
1  3258	1D38  FF 27			     JMP WORD PTR [BX]
   3259
   3260						 HEAD	  84h,'HER',305Q,HERE		      ;	HERE
1  3261	      =ARRAY:1D3A		 LINK$=$
1  3262	1D3A  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3263							 ; 6 - признак immediate. 5- слово не описано smudge
1  3264	1D3B  48 45 52			     DB	 'HER'
1  3265	1D3E  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3266	1D3F  1D1Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3267	      =ARRAY:1D3A		 LINK=LINK$
1  3268	1D41				 HERE LABEL FAR	 ; CFA
1  3269	1D41  1D43r			     DW	 $+2
   3270	1D43  FF 75 12				 PUSH [DI+22Q]
   3271						 NEXT
1  3272	1D46  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3273	1D47  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3274					 ; ------ call debugger	--------
1  3275	1D49  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3276	1D4D  74 06			     jz	??0052
1  3277	1D4F  E8 F1FF			     call printWORD
1  3278	1D52  E8 F0DE			     call pause
1  3279	1D55				   ??0052:
1  3280					 ; -----------------------------
1  3281	1D55  FF 27			     JMP WORD PTR [BX]
   3282
   3283						 HEAD	  85h,'ALLO',324Q,ALLOT		      ;	ALLOT
1  3284	      =ARRAY:1D57		 LINK$=$
1  3285	1D57  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3286							 ; 6 - признак immediate. 5- слово не описано smudge
1  3287	1D58  41 4C 4C 4F		     DB	 'ALLO'
1  3288	1D5C  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3289	1D5D  1D3Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3290	      =ARRAY:1D57		 LINK=LINK$
1  3291	1D5F				 ALLOT LABEL FAR  ; CFA
1  3292	1D5F  1D61r			     DW	 $+2
   3293	1D61  5B				 POP  BX
   3294	1D62  01 5D 12				 ADD  [DI+22Q],BX	 ;
   3295						 NEXT
1  3296	1D65  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3297	1D66  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3298					 ; ------ call debugger	--------
1  3299	1D68  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3300	1D6C  74 06			     jz	??0053
1  3301	1D6E  E8 F1E0			     call printWORD
1  3302	1D71  E8 F0BF			     call pause
1  3303	1D74				   ??0053:
1  3304					 ; -----------------------------
1  3305	1D74  FF 27			     JMP WORD PTR [BX]
   3306
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 59
forth.asm



   3307						 HEAD	  84h,'TRA',326Q,TRAV		      ;	TRAVERSE
1  3308	      =ARRAY:1D76		 LINK$=$
1  3309	1D76  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3310							 ; 6 - признак immediate. 5- слово не описано smudge
1  3311	1D77  54 52 41			     DB	 'TRA'
1  3312	1D7A  D6			     DB	 326Q	; последний символ слова + 128 (7 бит =	1).
1  3313	1D7B  1D57r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3314	      =ARRAY:1D76		 LINK=LINK$
1  3315	1D7D				 TRAV LABEL FAR	 ; CFA
1  3316	1D7D  1D7Fr			     DW	 $+2
   3317						 ; Движение вперед/назад вдоль имени переменной	длины
   3318	1D7F  59				 POP  CX     ; DELTA
   3319	1D80  5B				 POP  BX     ; адрес строки
   3320	1D81  03 D9			 TRV:	 ADD  BX, CX
   3321	1D83  80 3F 00				 CMP  BYTE PTR [BX],  0
   3322	1D86  79 F9				 JNS  TRV    ; JUMP IF POSITIVE
   3323	1D88  53				 PUSH BX
   3324						 NEXT
1  3325	1D89  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3326	1D8A  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3327					 ; ------ call debugger	--------
1  3328	1D8C  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3329	1D90  74 06			     jz	??0054
1  3330	1D92  E8 F1BC			     call printWORD
1  3331	1D95  E8 F09B			     call pause
1  3332	1D98				   ??0054:
1  3333					 ; -----------------------------
1  3334	1D98  FF 27			     JMP WORD PTR [BX]
   3335
   3336						 HEAD	  301Q,,333Q,LBRAC		       ; [
1  3337	      =ARRAY:1D9A		 LINK$=$
1  3338	1D9A  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  3339							 ; 6 - признак immediate. 5- слово не описано smudge
1  3340	1D9B  DB			     DB	 333Q	; последний символ слова + 128 (7 бит =	1).
1  3341	1D9C  1D76r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3342	      =ARRAY:1D9A		 LINK=LINK$
1  3343	1D9E				 LBRAC LABEL FAR  ; CFA
1  3344	1D9E  1DA0r			     DW	 $+2
   3345						 ; Прекращение компил.,	начало исполн. (обнуление STATE)
   3346	1DA0  C7 45 2C 0000			 MOV  WORD PTR [DI+54Q],0
   3347						 NEXT
1  3348	1DA5  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3349	1DA6  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3350					 ; ------ call debugger	--------
1  3351	1DA8  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3352	1DAC  74 06			     jz	??0055
1  3353	1DAE  E8 F1A0			     call printWORD
1  3354	1DB1  E8 F07F			     call pause
1  3355	1DB4				   ??0055:
1  3356					 ; -----------------------------
1  3357	1DB4  FF 27			     JMP WORD PTR [BX]
   3358
   3359						 HEAD	  301Q,,335Q,RBRAC		       ; ]
1  3360	      =ARRAY:1DB6		 LINK$=$
1  3361	1DB6  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  3362							 ; 6 - признак immediate. 5- слово не описано smudge
1  3363	1DB7  DD			     DB	 335Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 60
forth.asm



1  3364	1DB8  1D9Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3365	      =ARRAY:1DB6		 LINK=LINK$
1  3366	1DBA				 RBRAC LABEL FAR  ; CFA
1  3367	1DBA  1DBCr			     DW	 $+2
   3368	1DBC  C7 45 2C 00C0			 MOV  WORD PTR [DI+54Q],300Q   ; Начало	компиляции
   3369						 NEXT
1  3370	1DC1  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3371	1DC2  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3372					 ; ------ call debugger	--------
1  3373	1DC4  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3374	1DC8  74 06			     jz	??0056
1  3375	1DCA  E8 F184			     call printWORD
1  3376	1DCD  E8 F063			     call pause
1  3377	1DD0				   ??0056:
1  3378					 ; -----------------------------
1  3379	1DD0  FF 27			     JMP WORD PTR [BX]
   3380
   3381						 HEAD	  83h,'HE',330Q,$HEX		      ;	HEX
1  3382	      =ARRAY:1DD2		 LINK$=$
1  3383	1DD2  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3384							 ; 6 - признак immediate. 5- слово не описано smudge
1  3385	1DD3  48 45			     DB	 'HE'
1  3386	1DD5  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  3387	1DD6  1DB6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3388	      =ARRAY:1DD2		 LINK=LINK$
1  3389	1DD8				 $HEX LABEL FAR	 ; CFA
1  3390	1DD8  1DDAr			     DW	 $+2
   3391	1DDA  C7 45 2E 0010			 MOV  WORD PTR [DI+56Q],16
   3392						 NEXT
1  3393	1DDF  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3394	1DE0  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3395					 ; ------ call debugger	--------
1  3396	1DE2  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3397	1DE6  74 06			     jz	??0057
1  3398	1DE8  E8 F166			     call printWORD
1  3399	1DEB  E8 F045			     call pause
1  3400	1DEE				   ??0057:
1  3401					 ; -----------------------------
1  3402	1DEE  FF 27			     JMP WORD PTR [BX]
   3403
   3404						 HEAD	  87h,'DECIMA',314Q,DECIMA	       ; DECIMAL
1  3405	      =ARRAY:1DF0		 LINK$=$
1  3406	1DF0  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  3407							 ; 6 - признак immediate. 5- слово не описано smudge
1  3408	1DF1  44 45 43 49 4D 41		     DB	 'DECIMA'
1  3409	1DF7  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3410	1DF8  1DD2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3411	      =ARRAY:1DF0		 LINK=LINK$
1  3412	1DFA				 DECIMA	LABEL FAR  ; CFA
1  3413	1DFA  1DFCr			     DW	 $+2
   3414	1DFC  C7 45 2E 000A			 MOV  WORD PTR [DI+56Q],10
   3415						 NEXT
1  3416	1E01  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3417	1E02  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3418					 ; ------ call debugger	--------
1  3419	1E04  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3420	1E08  74 06			     jz	??0058
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 61
forth.asm



1  3421	1E0A  E8 F144			     call printWORD
1  3422	1E0D  E8 F023			     call pause
1  3423	1E10				   ??0058:
1  3424					 ; -----------------------------
1  3425	1E10  FF 27			     JMP WORD PTR [BX]
   3426
   3427						 HEAD	  85h,'OCTA',314Q,OCTAL		      ;	OCTAL
1  3428	      =ARRAY:1E12		 LINK$=$
1  3429	1E12  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3430							 ; 6 - признак immediate. 5- слово не описано smudge
1  3431	1E13  4F 43 54 41		     DB	 'OCTA'
1  3432	1E17  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3433	1E18  1DF0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3434	      =ARRAY:1E12		 LINK=LINK$
1  3435	1E1A				 OCTAL LABEL FAR  ; CFA
1  3436	1E1A  1E1Cr			     DW	 $+2
   3437	1E1C  C7 45 2E 0008			 MOV  WORD PTR [DI+56Q],  8
   3438	1E21				Y$:	 NEXT
1  3439	1E21  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3440	1E22  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3441					 ; ------ call debugger	--------
1  3442	1E24  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3443	1E28  74 06			     jz	??0059
1  3444	1E2A  E8 F124			     call printWORD
1  3445	1E2D  E8 F003			     call pause
1  3446	1E30				   ??0059:
1  3447					 ; -----------------------------
1  3448	1E30  FF 27			     JMP WORD PTR [BX]
   3449
   3450						 HEAD	  86h,'LATES',324Q,LATES	      ;	LATEST
1  3451	      =ARRAY:1E32		 LINK$=$
1  3452	1E32  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  3453							 ; 6 - признак immediate. 5- слово не описано smudge
1  3454	1E33  4C 41 54 45 53		     DB	 'LATES'
1  3455	1E38  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  3456	1E39  1E12r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3457	      =ARRAY:1E32		 LINK=LINK$
1  3458	1E3B				 LATES LABEL FAR  ; CFA
1  3459	1E3B  1E3Dr			     DW	 $+2
   3460					     ; в стек данных NFA  последнего определенного слова
   3461					     ; в current словаре
   3462	1E3D  8B 5D 2A				 MOV  BX, [DI+52Q]
   3463	1E40  FF 37				 PUSH [BX]
   3464						 NEXT
1  3465	1E42  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3466	1E43  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3467					 ; ------ call debugger	--------
1  3468	1E45  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3469	1E49  74 06			     jz	??005A
1  3470	1E4B  E8 F103			     call printWORD
1  3471	1E4E  E8 EFE2			     call pause
1  3472	1E51				   ??005A:
1  3473					 ; -----------------------------
1  3474	1E51  FF 27			     JMP WORD PTR [BX]
   3475
   3476						 HEAD	  86h,'-TRAI',314Q,DTRAI	      ;	-TRAIL
1  3477	      =ARRAY:1E53		 LINK$=$
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 62
forth.asm



1  3478	1E53  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  3479							 ; 6 - признак immediate. 5- слово не описано smudge
1  3480	1E54  2D 54 52 41 49		     DB	 '-TRAI'
1  3481	1E59  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3482	1E5A  1E32r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3483	      =ARRAY:1E53		 LINK=LINK$
1  3484	1E5C				 DTRAI LABEL FAR  ; CFA
1  3485	1E5C  1E5Er			     DW	 $+2
   3486					 ; адр n1 --> адр n2 Убирает пробелы в конце строки
   3487	1E5E  59				 POP  CX
   3488	1E5F  5B				 POP  BX
   3489	1E60  53				 PUSH BX
   3490	1E61  03 D9				 ADD  BX, CX
   3491	1E63  4B			COMPA:	 DEC  BX
   3492	1E64  80 3F 20				 CMP  BYTE PTR [BX],  32  ; BLANK ?
   3493	1E67  75 02				 JNE  NO
   3494	1E69  E2 F8				 LOOP COMPA
   3495	1E6B  51			NO:	 PUSH CX
   3496						 NEXT
1  3497	1E6C  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3498	1E6D  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3499					 ; ------ call debugger	--------
1  3500	1E6F  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3501	1E73  74 06			     jz	??005B
1  3502	1E75  E8 F0D9			     call printWORD
1  3503	1E78  E8 EFB8			     call pause
1  3504	1E7B				   ??005B:
1  3505					 ; -----------------------------
1  3506	1E7B  FF 27			     JMP WORD PTR [BX]
   3507
   3508						 HEAD	  85h,'UPPE',322Q,UPPER		      ;	UPPER
1  3509	      =ARRAY:1E7D		 LINK$=$
1  3510	1E7D  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3511							 ; 6 - признак immediate. 5- слово не описано smudge
1  3512	1E7E  55 50 50 45		     DB	 'UPPE'
1  3513	1E82  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  3514	1E83  1E53r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3515	      =ARRAY:1E7D		 LINK=LINK$
1  3516	1E85				 UPPER LABEL FAR  ; CFA
1  3517	1E85  1E87r			     DW	 $+2
   3518	1E87  59				 POP  CX		 ; число символов
   3519	1E88  5B				 POP  BX		 ; строка
   3520	1E89  80 3F 61			$COMP:	 CMP  BYTE PTR [BX],  61h ; a
   3521	1E8C  7C 08				 JL   OFLIM
   3522	1E8E  80 3F 7A				 CMP  BYTE PTR [BX],  7Ah ; z
   3523	1E91  7F 03				 JG   OFLIM
   3524	1E93  83 27 DF				 AND  WORD PTR [BX], 177737Q ; FFDF
   3525	1E96  43			OFLIM:	 INC  BX
   3526	1E97  E2 F0				 LOOP $COMP
   3527						 NEXT
1  3528	1E99  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3529	1E9A  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3530					 ; ------ call debugger	--------
1  3531	1E9C  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3532	1EA0  74 06			     jz	??005C
1  3533	1EA2  E8 F0AC			     call printWORD
1  3534	1EA5  E8 EF8B			     call pause
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 63
forth.asm



1  3535	1EA8				   ??005C:
1  3536					 ; -----------------------------
1  3537	1EA8  FF 27			     JMP WORD PTR [BX]
   3538
   3539						 HEAD	  213Q,'DEFINITION',323Q,DEFIN	    ; DEFINITIONS
1  3540	      =ARRAY:1EAA		 LINK$=$
1  3541	1EAA  8B			     DB	 213Q  ; NFA 7 бит равен 1.
1  3542							 ; 6 - признак immediate. 5- слово не описано smudge
1  3543	1EAB  44 45 46 49 4E 49	54+	     DB	 'DEFINITION'
   3544	      49 4F 4E
1  3545	1EB5  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  3546	1EB6  1E7Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3547	      =ARRAY:1EAA		 LINK=LINK$
1  3548	1EB8				 DEFIN LABEL FAR  ; CFA
1  3549	1EB8  1EBAr			     DW	 $+2
   3550					 ; Контекстный словарь становится текущим, все последующие
   3551					 ; описания связаны с этим словарем
   3552	1EBA  8B 45 28				 MOV  AX, [DI+50Q]	 ; context
   3553	1EBD  89 45 2A				 MOV  [DI+52Q],AX	 ; current
   3554						 NEXT
1  3555	1EC0  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3556	1EC1  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3557					 ; ------ call debugger	--------
1  3558	1EC3  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3559	1EC7  74 06			     jz	??005D
1  3560	1EC9  E8 F085			     call printWORD
1  3561	1ECC  E8 EF64			     call pause
1  3562	1ECF				   ??005D:
1  3563					 ; -----------------------------
1  3564	1ECF  FF 27			     JMP WORD PTR [BX]
   3565
   3566						 HEAD	  84h,'+BU',306Q,PBUF		      ;	+BUF
1  3567	      =ARRAY:1ED1		 LINK$=$
1  3568	1ED1  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3569							 ; 6 - признак immediate. 5- слово не описано smudge
1  3570	1ED2  2B 42 55			     DB	 '+BU'
1  3571	1ED5  C6			     DB	 306Q	; последний символ слова + 128 (7 бит =	1).
1  3572	1ED6  1EAAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3573	      =ARRAY:1ED1		 LINK=LINK$
1  3574	1ED8				 PBUF LABEL FAR	 ; CFA
1  3575	1ED8  1EDAr			     DW	 $+2
   3576					 ;
   3577	1EDA  8B DC				 MOV  BX, SP	     ;
   3578	1EDC  36: 81 07	0404			 ADD  SS:[BX],1028   ; адрес следующего	буфера
   3579	1EE1  36: 8B 07				 MOV  AX, SS:[BX]
   3580	1EE4  39 45 18				 CMP  [DI+30Q],AX    ; LIMIT
   3581	1EE7  75 06				 JNE  PB	     ; уперлись	в адрес	лимита,	значит буфер - последний
   3582	1EE9  8B 4D 16				 MOV  CX, [DI+26Q]   ; FIRST
   3583	1EEC  36: 89 0F				 MOV  SS:[BX],CX     ; переходим на первый буфер
   3584	1EEF  36: FF 37			PB:	 PUSH SS:[BX]	     ; полученный адрес	буфера в стек
   3585	1EF2  8B 4D 3C				 MOV  CX, [DI+74Q]   ; prev
   3586	1EF5  36: 29 4F	FE			 SUB  SS:[BX-2],CX   ; стек растет вниз. BX-2 сейчас  вершина стека
   3587								     ; если 0, значит адрес совпадает с	адресом	prev
   3588						 NEXT
1  3589	1EF9  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3590	1EFA  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3591					 ; ------ call debugger	--------
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 64
forth.asm



1  3592	1EFC  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3593	1F00  74 06			     jz	??005E
1  3594	1F02  E8 F04C			     call printWORD
1  3595	1F05  E8 EF2B			     call pause
1  3596	1F08				   ??005E:
1  3597					 ; -----------------------------
1  3598	1F08  FF 27			     JMP WORD PTR [BX]
   3599
   3600						 HEAD	  86h,'UPDAT',305Q,UPDAT	      ;	UPDATE
1  3601	      =ARRAY:1F0A		 LINK$=$
1  3602	1F0A  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  3603							 ; 6 - признак immediate. 5- слово не описано smudge
1  3604	1F0B  55 50 44 41 54		     DB	 'UPDAT'
1  3605	1F10  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3606	1F11  1ED1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3607	      =ARRAY:1F0A		 LINK=LINK$
1  3608	1F13				 UPDAT LABEL FAR  ; CFA
1  3609	1F13  1F15r			     DW	 $+2
   3610	1F15  8B 5D 3C				 MOV  BX, [DI+74Q]   ; prev buffer
   3611	1F18  0B DB				 OR BX,	BX	     ; если 0, буфер пустой
   3612	1F1A  74 04				 jz $upd
   3613	1F1C  81 0F 8000			 OR  WORD PTR [BX],   100000Q  ; ставим	бит
   3614	1F20				 $upd:	 NEXT
1  3615	1F20  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3616	1F21  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3617					 ; ------ call debugger	--------
1  3618	1F23  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3619	1F27  74 06			     jz	??005F
1  3620	1F29  E8 F025			     call printWORD
1  3621	1F2C  E8 EF04			     call pause
1  3622	1F2F				   ??005F:
1  3623					 ; -----------------------------
1  3624	1F2F  FF 27			     JMP WORD PTR [BX]
   3625
   3626						 HEAD	  81h,,330Q,X			      ;	X
1  3627	      =ARRAY:1F31		 LINK$=$
1  3628	1F31  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3629							 ; 6 - признак immediate. 5- слово не описано smudge
1  3630	1F32  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  3631	1F33  1F0Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3632	      =ARRAY:1F31		 LINK=LINK$
1  3633	1F35				 X LABEL FAR  ;	CFA
1  3634	1F35  1F37r			     DW	 $+2
   3635					 ; сброс бита сохранения буфера
   3636	1F37  5B				 POP  BX
   3637	1F38  81 27 7FFF			 AND WORD PTR [BX],   77777Q   ;
   3638	1F3C  FF 37				 PUSH [BX]
   3639						 NEXT
1  3640	1F3E  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3641	1F3F  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3642					 ; ------ call debugger	--------
1  3643	1F41  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3644	1F45  74 06			     jz	??0060
1  3645	1F47  E8 F007			     call printWORD
1  3646	1F4A  E8 EEE6			     call pause
1  3647	1F4D				   ??0060:
1  3648					 ; -----------------------------
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 65
forth.asm



1  3649	1F4D  FF 27			     JMP WORD PTR [BX]
   3650
   3651					;	 ** Управляющие	слова **
   3652
   3653						 HEAD	  301Q,,272Q,COLON,$COL		       ; :
1  3654	      =ARRAY:1F4F		 LINK$=$
1  3655	1F4F  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  3656							 ; 6 - признак immediate. 5- слово не описано smudge
1  3657	1F50  BA			     DB	 272Q	; последний символ слова + 128 (7 бит =	1).
1  3658	1F51  1F31r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3659	      =ARRAY:1F4F		 LINK=LINK$
1  3660	1F53				 COLON LABEL FAR  ; CFA
1  3661	1F53  1F67r			     DW	$COL
   3662					     ; слово для создания новых	слов из	Форта
   3663	1F55  22A0r 1D24r 215Cr	  +		 DW QEXEC,SCSP,CURR,AT,CONT,STORE,CREAT
   3664	      1C42r 214Er 1C9Cr	  +
   3665	      2653r
   3666	1F63  1DBAr 232Ar			 DW RBRAC,PSCOD	; после	этого слова SI указывает на следующий код,
   3667								; адрес, которого попадет в CFA	создаваемого слова
   3668	1F67				$COL	 LABEL	 FAR ; код для исполнения слов на форте	из этого исходника
   3669							     ; функция интерпретатора
   3670	1F67  83 C5 FE				 ADD  BP, -2 ; резервируем место в стеке возвратов
   3671	1F6A  83 C3 02				 ADD  BX, 2  ; BX указывает на CFA здесь это $COL
   3672							     ; BX+2 будет указывать на адрес QEXEC
   3673	1F6D  89 76 00				 MOV  [BP], SI ; сохраняем текущий указатель IP
   3674	1F70  8B F3				 MOV  SI, BX ; исполняем слово QEXEC
   3675						 NEXT
1  3676	1F72  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3677	1F73  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3678					 ; ------ call debugger	--------
1  3679	1F75  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3680	1F79  74 06			     jz	??0061
1  3681	1F7B  E8 EFD3			     call printWORD
1  3682	1F7E  E8 EEB2			     call pause
1  3683	1F81				   ??0061:
1  3684					 ; -----------------------------
1  3685	1F81  FF 27			     JMP WORD PTR [BX]
   3686
   3687						 HEAD	  301Q,,273Q,SMI,$COL		       ; ;
1  3688	      =ARRAY:1F83		 LINK$=$
1  3689	1F83  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  3690							 ; 6 - признак immediate. 5- слово не описано smudge
1  3691	1F84  BB			     DB	 273Q	; последний символ слова + 128 (7 бит =	1).
1  3692	1F85  1F4Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3693	      =ARRAY:1F83		 LINK=LINK$
1  3694	1F87				 SMI LABEL FAR	; CFA
1  3695	1F87  1F67r			     DW	$COL
   3696					     ; слово для завершения новых слов из Форта
   3697	1F89  22C9r 22FDr 18CFr	  +		 DW QCSP,COMP,SEMI,SMUG,LBRAC,SEMI
   3698	      2316r 1D9Er 18CFr
   3699
   3700						 HEAD	  88h,'CONSTAN',324Q,CON,$COL	      ;	CONSTANT
1  3701	      =ARRAY:1F95		 LINK$=$
1  3702	1F95  88			     DB	 88h  ;	NFA 7 бит равен	1.
1  3703							 ; 6 - признак immediate. 5- слово не описано smudge
1  3704	1F96  43 4F 4E 53 54 41	4E	     DB	 'CONSTAN'
1  3705	1F9D  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 66
forth.asm



1  3706	1F9E  1F83r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3707	      =ARRAY:1F95		 LINK=LINK$
1  3708	1FA0				 CON LABEL FAR	; CFA
1  3709	1FA0  1F67r			     DW	$COL
   3710	1FA2  2653r 2316r 2229r	  +		 DW CREAT,SMUG,COMMA,PSCOD		      ;
   3711	      232Ar
   3712	1FAA				$CON	 LABEL	 FAR
   3713	1FAA  83 C3 02				 ADD  BX, 2 ; аналогично переменной
   3714	1FAD  FF 37				 PUSH [BX]  ; вместо адреса пишем значение по этому адресу PFA
   3715						 NEXT
1  3716	1FAF  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3717	1FB0  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3718					 ; ------ call debugger	--------
1  3719	1FB2  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3720	1FB6  74 06			     jz	??0062
1  3721	1FB8  E8 EF96			     call printWORD
1  3722	1FBB  E8 EE75			     call pause
1  3723	1FBE				   ??0062:
1  3724					 ; -----------------------------
1  3725	1FBE  FF 27			     JMP WORD PTR [BX]
   3726
   3727						 HEAD	  88h, 'VARIABL',305Q,VAR,$COL	      ;	VARIABLE
1  3728	      =ARRAY:1FC0		 LINK$=$
1  3729	1FC0  88			     DB	 88h  ;	NFA 7 бит равен	1.
1  3730							 ; 6 - признак immediate. 5- слово не описано smudge
1  3731	1FC1  56 41 52 49 41 42	4C	     DB	 'VARIABL'
1  3732	1FC8  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  3733	1FC9  1F95r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3734	      =ARRAY:1FC0		 LINK=LINK$
1  3735	1FCB				 VAR LABEL FAR	; CFA
1  3736	1FCB  1F67r			     DW	$COL
   3737	1FCD  1FA0r 232Ar			 DW CON,PSCOD
   3738	1FD1				$VAR	 LABEL	 FAR
   3739	1FD1  83 C3 02				 ADD  BX, 2  ; BX указывает на CFA ($COL)
   3740							     ; BX+2 пропускает поле CFA
   3741	1FD4  53				 PUSH BX     ; в BX находится адрес переменной PFA ($VAR)
   3742						 NEXT
1  3743	1FD5  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3744	1FD6  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3745					 ; ------ call debugger	--------
1  3746	1FD8  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3747	1FDC  74 06			     jz	??0063
1  3748	1FDE  E8 EF70			     call printWORD
1  3749	1FE1  E8 EE4F			     call pause
1  3750	1FE4				   ??0063:
1  3751					 ; -----------------------------
1  3752	1FE4  FF 27			     JMP WORD PTR [BX]
   3753
   3754						 HEAD	  84h,'USE',322Q,USER, $COL	      ;	USER
1  3755	      =ARRAY:1FE6		 LINK$=$
1  3756	1FE6  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  3757							 ; 6 - признак immediate. 5- слово не описано smudge
1  3758	1FE7  55 53 45			     DB	 'USE'
1  3759	1FEA  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  3760	1FEB  1FC0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3761	      =ARRAY:1FE6		 LINK=LINK$
1  3762	1FED				 USER LABEL FAR	 ; CFA
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 67
forth.asm



1  3763	1FED  1F67r			     DW	$COL
   3764	1FEF  1FA0r 232Ar			 DW CON,PSCOD
   3765	1FF3				$USE	 LABEL	 FAR
   3766	1FF3  83 C3 02				 ADD  BX, 2
   3767	1FF6  8B 07				 MOV  AX, [BX] ; берем смещение	из PFA
   3768	1FF8  03 C7				 ADD  AX, DI  ;	вычисляем смещение
   3769	1FFA  50				 PUSH AX ; полученный адрес в стек
   3770						 NEXT
1  3771	1FFB  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3772	1FFC  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3773					 ; ------ call debugger	--------
1  3774	1FFE  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3775	2002  74 06			     jz	??0064
1  3776	2004  E8 EF4A			     call printWORD
1  3777	2007  E8 EE29			     call pause
1  3778	200A				   ??0064:
1  3779					 ; -----------------------------
1  3780	200A  FF 27			     JMP WORD PTR [BX]
   3781
   3782						 HEAD	  85h,'DOES',276Q,DOES,$COL	      ;	DOES>
1  3783	      =ARRAY:200C		 LINK$=$
1  3784	200C  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3785							 ; 6 - признак immediate. 5- слово не описано smudge
1  3786	200D  44 4F 45 53		     DB	 'DOES'
1  3787	2011  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1  3788	2012  1FE6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3789	      =ARRAY:200C		 LINK=LINK$
1  3790	2014				 DOES LABEL FAR	 ; CFA
1  3791	2014  1F67r			     DW	$COL
   3792					 ; запись в PFA	адреса кода, который следует за	DOES>.
   3793					 ; В CFA пишется адрес кода, следующего	за PSCOD, т.е. $DOE
   3794					 ; при исполнении в стек помещается адрес PFA+2
   3795					 ;  управление передается по адресу PFA
   3796	2016  192Cr 1E3Br 225Cr	  +		 DW  FROMR,LATES,PFA,STORE,PSCOD
   3797	      1C9Cr 232Ar
   3798	2020				$DOE	 LABEL	 FAR   ; здесь используется только в FORTH
   3799	2020  83 ED 02				 SUB  BP,  2   ; резервируем место в RS
   3800	2023  89 76 00				 MOV  [BP], SI ; сохраняем SI адрес следующего слова
   3801	2026  83 C3 02				 ADD  BX, 2    ; BX+2 это PFA исполняемого слова (FORTH)
   3802	2029  8B 37				 MOV  SI, [BX] ; там лежит адрес слова DOVOC
   3803	202B  83 C3 02				 ADD  BX, 2    ; адрес параметра PFA+2 для DOVOC (120201Q)
   3804	202E  53				 PUSH BX       ; в стек
   3805						 NEXT	       ; исполняется слово DOVOC (по адресу PFA)
1  3806	202F  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  3807	2030  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  3808					 ; ------ call debugger	--------
1  3809	2032  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  3810	2036  74 06			     jz	??0065
1  3811	2038  E8 EF16			     call printWORD
1  3812	203B  E8 EDF5			     call pause
1  3813	203E				   ??0065:
1  3814					 ; -----------------------------
1  3815	203E  FF 27			     JMP WORD PTR [BX]
   3816
   3817						 HEAD	  83h,'BY','E'+80h,BYE			; BYE
1  3818	      =ARRAY:2040		 LINK$=$
1  3819	2040  83			     DB	 83h  ;	NFA 7 бит равен	1.
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 68
forth.asm



1  3820							 ; 6 - признак immediate. 5- слово не описано smudge
1  3821	2041  42 59			     DB	 'BY'
1  3822	2043  C5			     DB	 'E'+80h   ; последний символ слова + 128 (7 бит = 1).
1  3823	2044  200Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3824	      =ARRAY:2040		 LINK=LINK$
1  3825	2046				 BYE LABEL FAR	; CFA
1  3826	2046  2048r			     DW	 $+2
   3827	2048  B4 4C				 mov ah, 4ch
   3828	204A  CD 21				 int 21h
   3829
   3830					;	 ** Константы **
   3831
   3832						 HEAD	  81h,,260Q,ZERO,$CON		      ;	0
1  3833	      =ARRAY:204C		 LINK$=$
1  3834	204C  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3835							 ; 6 - признак immediate. 5- слово не описано smudge
1  3836	204D  B0			     DB	 260Q	; последний символ слова + 128 (7 бит =	1).
1  3837	204E  2040r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3838	      =ARRAY:204C		 LINK=LINK$
1  3839	2050				 ZERO LABEL FAR	 ; CFA
1  3840	2050  1FAAr			     DW	$CON
   3841	2052  0000				 DW 0
   3842
   3843						 HEAD	  81h,,261Q,ONE,$CON		      ;	1
1  3844	      =ARRAY:2054		 LINK$=$
1  3845	2054  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3846							 ; 6 - признак immediate. 5- слово не описано smudge
1  3847	2055  B1			     DB	 261Q	; последний символ слова + 128 (7 бит =	1).
1  3848	2056  204Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3849	      =ARRAY:2054		 LINK=LINK$
1  3850	2058				 ONE LABEL FAR	; CFA
1  3851	2058  1FAAr			     DW	$CON
   3852	205A  0001				 DW 1
   3853
   3854						 HEAD	  81h,,262Q,TWO,$CON		      ;	2
1  3855	      =ARRAY:205C		 LINK$=$
1  3856	205C  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3857							 ; 6 - признак immediate. 5- слово не описано smudge
1  3858	205D  B2			     DB	 262Q	; последний символ слова + 128 (7 бит =	1).
1  3859	205E  2054r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3860	      =ARRAY:205C		 LINK=LINK$
1  3861	2060				 TWO LABEL FAR	; CFA
1  3862	2060  1FAAr			     DW	$CON
   3863	2062  0002				 DW 2
   3864
   3865						 HEAD	  81h,,263Q,THREE,$CON		      ;	3
1  3866	      =ARRAY:2064		 LINK$=$
1  3867	2064  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3868							 ; 6 - признак immediate. 5- слово не описано smudge
1  3869	2065  B3			     DB	 263Q	; последний символ слова + 128 (7 бит =	1).
1  3870	2066  205Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3871	      =ARRAY:2064		 LINK=LINK$
1  3872	2068				 THREE LABEL FAR  ; CFA
1  3873	2068  1FAAr			     DW	$CON
   3874	206A  0003				 DW 3
   3875
   3876						 HEAD	  81h,,270Q,EIGHT, $CON		      ;	8
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 69
forth.asm



1  3877	      =ARRAY:206C		 LINK$=$
1  3878	206C  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  3879							 ; 6 - признак immediate. 5- слово не описано smudge
1  3880	206D  B8			     DB	 270Q	; последний символ слова + 128 (7 бит =	1).
1  3881	206E  2064r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3882	      =ARRAY:206C		 LINK=LINK$
1  3883	2070				 EIGHT LABEL FAR  ; CFA
1  3884	2070  1FAAr			     DW	$CON
   3885	2072  0008				 DW 8
   3886
   3887						 HEAD	  82h,'B',314Q,BLAN,$CON	      ;	BL
1  3888	      =ARRAY:2074		 LINK$=$
1  3889	2074  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3890							 ; 6 - признак immediate. 5- слово не описано smudge
1  3891	2075  42			     DB	 'B'
1  3892	2076  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3893	2077  206Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3894	      =ARRAY:2074		 LINK=LINK$
1  3895	2079				 BLAN LABEL FAR	 ; CFA
1  3896	2079  1FAAr			     DW	$CON
   3897	207B  0020				 DW 32
   3898
   3899						 HEAD	  82h,'C',314Q,$CL,$CON		      ;	C/L
1  3900	      =ARRAY:207D		 LINK$=$
1  3901	207D  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3902							 ; 6 - признак immediate. 5- слово не описано smudge
1  3903	207E  43			     DB	 'C'
1  3904	207F  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  3905	2080  2074r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3906	      =ARRAY:207D		 LINK=LINK$
1  3907	2082				 $CL LABEL FAR	; CFA
1  3908	2082  1FAAr			     DW	$CON
   3909	2084  0040				 DW 64	 ;CHAR#	PER LINE
   3910
   3911						 HEAD	  82h,'1',313Q,BBUF,$CON	      ;	BBUF
1  3912	      =ARRAY:2086		 LINK$=$
1  3913	2086  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3914							 ; 6 - признак immediate. 5- слово не описано smudge
1  3915	2087  31			     DB	 '1'
1  3916	2088  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  3917	2089  207Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3918	      =ARRAY:2086		 LINK=LINK$
1  3919	208B				 BBUF LABEL FAR	 ; CFA
1  3920	208B  1FAAr			     DW	$CON
   3921	208D  0400				 DW 1024 ; длина буфера
   3922
   3923						 ;** USER-переменные **
   3924
   3925						 HEAD	  82h,'S',260Q,SZERO,$USE	      ;	SO
1  3926	      =ARRAY:208F		 LINK$=$
1  3927	208F  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3928							 ; 6 - признак immediate. 5- слово не описано smudge
1  3929	2090  53			     DB	 'S'
1  3930	2091  B0			     DB	 260Q	; последний символ слова + 128 (7 бит =	1).
1  3931	2092  2086r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3932	      =ARRAY:208F		 LINK=LINK$
1  3933	2094				 SZERO LABEL FAR  ; CFA
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 70
forth.asm



1  3934	2094  1FF3r			     DW	$USE
   3935	2096  0006				 DW 6 ;	Указатель начала стека параметров
   3936
   3937						 HEAD	  82h,'R',260Q,RZERO,$USE	      ;	RO
1  3938	      =ARRAY:2098		 LINK$=$
1  3939	2098  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  3940							 ; 6 - признак immediate. 5- слово не описано smudge
1  3941	2099  52			     DB	 'R'
1  3942	209A  B0			     DB	 260Q	; последний символ слова + 128 (7 бит =	1).
1  3943	209B  208Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3944	      =ARRAY:2098		 LINK=LINK$
1  3945	209D				 RZERO LABEL FAR  ; CFA
1  3946	209D  1FF3r			     DW	$USE
   3947	209F  0008				 DW 8  ; Указатель начала стека	возврата
   3948
   3949						 HEAD	  83h, 'TI',302Q,TIB,$USE	      ;	TIB
1  3950	      =ARRAY:20A1		 LINK$=$
1  3951	20A1  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  3952							 ; 6 - признак immediate. 5- слово не описано smudge
1  3953	20A2  54 49			     DB	 'TI'
1  3954	20A4  C2			     DB	 302Q	; последний символ слова + 128 (7 бит =	1).
1  3955	20A5  2098r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3956	      =ARRAY:20A1		 LINK=LINK$
1  3957	20A7				 TIB LABEL FAR	; CFA
1  3958	20A7  1FF3r			     DW	$USE
   3959	20A9  000A				 DW 12Q	 ;Входной буфер	терминала 10
   3960
   3961						 HEAD	  85h,'WIDT',310Q,$WIDTH,$USE	      ;	WIDTH
1  3962	      =ARRAY:20AB		 LINK$=$
1  3963	20AB  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3964							 ; 6 - признак immediate. 5- слово не описано smudge
1  3965	20AC  57 49 44 54		     DB	 'WIDT'
1  3966	20B0  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1  3967	20B1  20A1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3968	      =ARRAY:20AB		 LINK=LINK$
1  3969	20B3				 $WIDTH	LABEL FAR  ; CFA
1  3970	20B3  1FF3r			     DW	$USE
   3971	20B5  000C				 DW 14Q	; Определяет максимальную длину	имени в	словаре
   3972
   3973						 HEAD	  87h,'WARNIN',307Q,$WARN,$USE	      ;	WARNING
1  3974	      =ARRAY:20B7		 LINK$=$
1  3975	20B7  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  3976							 ; 6 - признак immediate. 5- слово не описано smudge
1  3977	20B8  57 41 52 4E 49 4E		     DB	 'WARNIN'
1  3978	20BE  C7			     DB	 307Q	; последний символ слова + 128 (7 бит =	1).
1  3979	20BF  20ABr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3980	      =ARRAY:20B7		 LINK=LINK$
1  3981	20C1				 $WARN LABEL FAR  ; CFA
1  3982	20C1  1FF3r			     DW	$USE
   3983	20C3  000E				 DW 16Q	 ;  при	0 только код ошибки выводится
   3984
   3985						 HEAD	  85h,'FENC',305Q,FENCE,$USE	      ;	FENCE
1  3986	      =ARRAY:20C5		 LINK$=$
1  3987	20C5  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  3988							 ; 6 - признак immediate. 5- слово не описано smudge
1  3989	20C6  46 45 4E 43		     DB	 'FENC'
1  3990	20CA  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 71
forth.asm



1  3991	20CB  20B7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  3992	      =ARRAY:20C5		 LINK=LINK$
1  3993	20CD				 FENCE LABEL FAR  ; CFA
1  3994	20CD  1FF3r			     DW	$USE
   3995	20CF  0010				 DW 20Q	; FENCE	указывает верхний край базового	словаря
   3996						 ; FENCE  (ограда) служит  для	защиты	базового словаря
   3997						 ; от стирания с помощью оператора FORGET,  указывает адрес,
   3998						 ; предшествующий первой  свободной  ячейке  в словаре сразу
   3999						 ; после загрузки системы Форт,	т.е. при этом FENCE @ равно HERE-2
   4000
   4001						 HEAD	  82h,'D',320Q,$DP,$USE		      ;	DP
1  4002	      =ARRAY:20D1		 LINK$=$
1  4003	20D1  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4004							 ; 6 - признак immediate. 5- слово не описано smudge
1  4005	20D2  44			     DB	 'D'
1  4006	20D3  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  4007	20D4  20C5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4008	      =ARRAY:20D1		 LINK=LINK$
1  4009	20D6				 $DP LABEL FAR	; CFA
1  4010	20D6  1FF3r			     DW	$USE
   4011	20D8  0012				 DW 22Q	; указывает на первую свободную	ячейку словаря (DP @ = HERE)
   4012
   4013						 HEAD	  84h,'VOC',314Q,VOCL,$USE	      ;	VOCL
1  4014	      =ARRAY:20DA		 LINK$=$
1  4015	20DA  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4016							 ; 6 - признак immediate. 5- слово не описано smudge
1  4017	20DB  56 4F 43			     DB	 'VOC'
1  4018	20DE  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  4019	20DF  20D1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4020	      =ARRAY:20DA		 LINK=LINK$
1  4021	20E1				 VOCL LABEL FAR	 ; CFA
1  4022	20E1  1FF3r			     DW	$USE
   4023						 ; хранится адрес XVOC
   4024	20E3  0014				 DW 24Q	; переменная  связи контекстных	словарей.
   4025
   4026						 HEAD	  85h,'FIRS',324Q,FIRST,$USE	      ;	FIRST
1  4027	      =ARRAY:20E5		 LINK$=$
1  4028	20E5  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4029							 ; 6 - признак immediate. 5- слово не описано smudge
1  4030	20E6  46 49 52 53		     DB	 'FIRS'
1  4031	20EA  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4032	20EB  20DAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4033	      =ARRAY:20E5		 LINK=LINK$
1  4034	20ED				 FIRST LABEL FAR  ; CFA
1  4035	20ED  1FF3r			     DW	$USE
   4036	20EF  0016				 DW 26Q	; адрес	первого	байта экранных буферов
   4037
   4038						 HEAD	  85h,'LIMI',324Q,LIMIT,$USE	      ;	LIMIT
1  4039	      =ARRAY:20F1		 LINK$=$
1  4040	20F1  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4041							 ; 6 - признак immediate. 5- слово не описано smudge
1  4042	20F2  4C 49 4D 49		     DB	 'LIMI'
1  4043	20F6  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4044	20F7  20E5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4045	      =ARRAY:20F1		 LINK=LINK$
1  4046	20F9				 LIMIT LABEL FAR  ; CFA
1  4047	20F9  1FF3r			     DW	$USE
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 72
forth.asm



   4048	20FB  0018				 DW 30Q	; указатель конца экранных буферов и некоторые другие
   4049
   4050						 HEAD	  83h,'AT',322Q,ATR,$USE	      ;	ATR
1  4051	      =ARRAY:20FD		 LINK$=$
1  4052	20FD  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4053							 ; 6 - признак immediate. 5- слово не описано smudge
1  4054	20FE  41 54			     DB	 'AT'
1  4055	2100  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4056	2101  20F1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4057	      =ARRAY:20FD		 LINK=LINK$
1  4058	2103				 ATR LABEL FAR	; CFA
1  4059	2103  1FF3r			     DW	$USE
   4060	2105  001A				 DW 32Q		 ;Атрибут
   4061
   4062						 HEAD	  82h,'P',307Q,PG,$USE		      ;	PG
1  4063	      =ARRAY:2107		 LINK$=$
1  4064	2107  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4065							 ; 6 - признак immediate. 5- слово не описано smudge
1  4066	2108  50			     DB	 'P'
1  4067	2109  C7			     DB	 307Q	; последний символ слова + 128 (7 бит =	1).
1  4068	210A  20FDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4069	      =ARRAY:2107		 LINK=LINK$
1  4070	210C				 PG LABEL FAR  ; CFA
1  4071	210C  1FF3r			     DW	$USE
   4072	210E  001C				 DW 34Q		 ; Текущая страница
   4073
   4074						 HEAD	  83h,'BL',313Q,BLK,$USE	      ;	BLK
1  4075	      =ARRAY:2110		 LINK$=$
1  4076	2110  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4077							 ; 6 - признак immediate. 5- слово не описано smudge
1  4078	2111  42 4C			     DB	 'BL'
1  4079	2113  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  4080	2114  2107r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4081	      =ARRAY:2110		 LINK=LINK$
1  4082	2116				 BLK LABEL FAR	; CFA
1  4083	2116  1FF3r			     DW	$USE
   4084	2118  001E				 DW 36Q	; 0  для  входного  буфера  и  номеру экрана
   4085							; в противном  случае
   4086
   4087						 HEAD	  82h,'I',316Q,$IN,$USE		      ;	IN
1  4088	      =ARRAY:211A		 LINK$=$
1  4089	211A  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4090							 ; 6 - признак immediate. 5- слово не описано smudge
1  4091	211B  49			     DB	 'I'
1  4092	211C  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  4093	211D  2110r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4094	      =ARRAY:211A		 LINK=LINK$
1  4095	211F				 $IN LABEL FAR	; CFA
1  4096	211F  1FF3r			     DW	$USE
   4097	2121  0020				 DW 40Q	; внутренний   указатель   входного   буфера
   4098
   4099						 HEAD	  83h,'PN',324Q,PNT,$USE	      ;	PNT
1  4100	      =ARRAY:2123		 LINK$=$
1  4101	2123  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4102							 ; 6 - признак immediate. 5- слово не описано smudge
1  4103	2124  50 4E			     DB	 'PN'
1  4104	2126  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 73
forth.asm



1  4105	2127  211Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4106	      =ARRAY:2123		 LINK=LINK$
1  4107	2129				 PNT LABEL FAR	; CFA
1  4108	2129  1FF3r			     DW	$USE
   4109	212B  0022				 DW 42Q		 ;Флаг-печати
   4110
   4111						 HEAD	  83h,'SC',322Q,SCR,$USE	      ;	SCR
1  4112	      =ARRAY:212D		 LINK$=$
1  4113	212D  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4114							 ; 6 - признак immediate. 5- слово не описано smudge
1  4115	212E  53 43			     DB	 'SC'
1  4116	2130  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4117	2131  2123r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4118	      =ARRAY:212D		 LINK=LINK$
1  4119	2133				 SCR LABEL FAR	; CFA
1  4120	2133  1FF3r			     DW	$USE
   4121	2135  0024				 DW 44Q	; для хранения текущего	значения номера	экрана
   4122							 ; только в list
   4123
   4124						 HEAD	  86h,'OFFSE',324Q,OFSET,$USE	     ; OFFSET
1  4125	      =ARRAY:2137		 LINK$=$
1  4126	2137  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  4127							 ; 6 - признак immediate. 5- слово не описано smudge
1  4128	2138  4F 46 46 53 45		     DB	 'OFFSE'
1  4129	213D  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4130	213E  212Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4131	      =ARRAY:2137		 LINK=LINK$
1  4132	2140				 OFSET LABEL FAR  ; CFA
1  4133	2140  1FF3r			     DW	$USE
   4134	2142  0026				 DW 46Q	; Диагностические сообщения обычно размещаются
   4135						     ; на экранах 4 и 5. Если это не так, задачу можно решить,
   4136						     ; поменяв значение	OFFSET или исправив число, стоящее
   4137						     ; перед OFFSET в описании MESSAGE
   4138
   4139						 HEAD	  87h,'CONTEX',324Q,CONT,$USE	      ;	CONTEXT
1  4140	      =ARRAY:2144		 LINK$=$
1  4141	2144  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  4142							 ; 6 - признак immediate. 5- слово не описано smudge
1  4143	2145  43 4F 4E 54 45 58		     DB	 'CONTEX'
1  4144	214B  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4145	214C  2137r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4146	      =ARRAY:2144		 LINK=LINK$
1  4147	214E				 CONT LABEL FAR	 ; CFA
1  4148	214E  1FF3r			     DW	$USE
   4149					 ; Пребывание в	том  или ином  словаре	контролируется системной переменной
   4150					 ; CONTEXT,  в которой хранится	 ссылка	 на  адрес  последнего	слова,
   4151					 ; описанного  в  данном (контекстном) словаре.
   4152	2150  0028				 DW 50Q	; Указатель, с какого словаря следует начинать просмотр
   4153							; при интерпретации
   4154
   4155						 HEAD	 87h, 'CURREN',324Q,CURR,$USE	     ; CURRENT
1  4156	      =ARRAY:2152		 LINK$=$
1  4157	2152  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  4158							 ; 6 - признак immediate. 5- слово не описано smudge
1  4159	2153  43 55 52 52 45 4E		     DB	 'CURREN'
1  4160	2159  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4161	215A  2144r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 74
forth.asm



1  4162	      =ARRAY:2152		 LINK=LINK$
1  4163	215C				 CURR LABEL FAR	 ; CFA
1  4164	215C  1FF3r			     DW	$USE
   4165	215E  002A				 DW 52Q	 ; хранящая ссылку в слове Словаря на последнее	слово,
   4166							 ; описанное в текущем Словаре.	очевидно, что
   4167							 ; текущий Словарь может не совпадать с	контекстным
   4168							 ; это же адрес	latest
   4169
   4170						 HEAD	  85h,'STAT',305Q,STATE,$USE	      ;	STATE
1  4171	      =ARRAY:2160		 LINK$=$
1  4172	2160  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4173							 ; 6 - признак immediate. 5- слово не описано smudge
1  4174	2161  53 54 41 54		     DB	 'STAT'
1  4175	2165  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4176	2166  2152r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4177	      =ARRAY:2160		 LINK=LINK$
1  4178	2168				 STATE LABEL FAR  ; CFA
1  4179	2168  1FF3r			     DW	$USE
   4180	216A  002C				 DW 54Q	 ; 0=> Исполнение
   4181
   4182						 HEAD	  84h,'BAS',305Q,BASE,$USE	      ;	BASE
1  4183	      =ARRAY:216C		 LINK$=$
1  4184	216C  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4185							 ; 6 - признак immediate. 5- слово не описано smudge
1  4186	216D  42 41 53			     DB	 'BAS'
1  4187	2170  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4188	2171  2160r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4189	      =ARRAY:216C		 LINK=LINK$
1  4190	2173				 BASE LABEL FAR	 ; CFA
1  4191	2173  1FF3r			     DW	$USE
   4192	2175  002E				 DW 56Q	 ; система исчисления
   4193
   4194						 HEAD	  83h,'DP',314Q,DPL,$USE	      ;	DPL
1  4195	      =ARRAY:2177		 LINK$=$
1  4196	2177  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4197							 ; 6 - признак immediate. 5- слово не описано smudge
1  4198	2178  44 50			     DB	 'DP'
1  4199	217A  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  4200	217B  216Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4201	      =ARRAY:2177		 LINK=LINK$
1  4202	217D				 DPL LABEL FAR	; CFA
1  4203	217D  1FF3r			     DW	$USE
   4204	217F  0030				 DW 60Q	; DPL определяет положение десятичной запятой (во входном
   4205							; представлении	это точка), для	чисел одинарной	длины DPL=-1.
   4206
   4207						 HEAD	  83h,'CS',320Q,CSP,$USE	      ;	CSP
1  4208	      =ARRAY:2181		 LINK$=$
1  4209	2181  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4210							 ; 6 - признак immediate. 5- слово не описано smudge
1  4211	2182  43 53			     DB	 'CS'
1  4212	2184  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  4213	2185  2177r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4214	      =ARRAY:2181		 LINK=LINK$
1  4215	2187				 CSP LABEL FAR	; CFA
1  4216	2187  1FF3r			     DW	$USE
   4217	2189  0034				 DW 64Q
   4218
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 75
forth.asm



   4219						 HEAD	  82h,'R',243Q,RNUM,$USE	      ;	R#
1  4220	      =ARRAY:218B		 LINK$=$
1  4221	218B  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4222							 ; 6 - признак immediate. 5- слово не описано smudge
1  4223	218C  52			     DB	 'R'
1  4224	218D  A3			     DB	 243Q	; последний символ слова + 128 (7 бит =	1).
1  4225	218E  2181r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4226	      =ARRAY:218B		 LINK=LINK$
1  4227	2190				 RNUM LABEL FAR	 ; CFA
1  4228	2190  1FF3r			     DW	$USE
   4229	2192  0036				 DW 66Q	; указатель  положения	курсора	 на  экране
   4230
   4231						 HEAD	  83h,'HL',304Q,HLD,$USE	      ;	HLD
1  4232	      =ARRAY:2194		 LINK$=$
1  4233	2194  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4234							 ; 6 - признак immediate. 5- слово не описано smudge
1  4235	2195  48 4C			     DB	 'HL'
1  4236	2197  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4237	2198  218Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4238	      =ARRAY:2194		 LINK=LINK$
1  4239	219A				 HLD LABEL FAR	; CFA
1  4240	219A  1FF3r			     DW	$USE
   4241	219C  0038				 DW 70Q	; которая является указателем позиции
   4242							; в выходном буфере (обычно PAD)
   4243
   4244						 HEAD	  83h,'US',305Q,USE,$USE	      ;	USE
1  4245	      =ARRAY:219E		 LINK$=$
1  4246	219E  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4247							 ; 6 - признак immediate. 5- слово не описано smudge
1  4248	219F  55 53			     DB	 'US'
1  4249	21A1  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4250	21A2  2194r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4251	      =ARRAY:219E		 LINK=LINK$
1  4252	21A4				 USE LABEL FAR	; CFA
1  4253	21A4  1FF3r			     DW	$USE
   4254	21A6  003A				 DW 72Q	;
   4255						 ; A variable containing the address of	the block buffer to use	next,
   4256						 ; as the least	recently written.
   4257
   4258						 HEAD	  84h,'PRE',326Q,PREV,$USE	      ;	PREV
1  4259	      =ARRAY:21A8		 LINK$=$
1  4260	21A8  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4261							 ; 6 - признак immediate. 5- слово не описано smudge
1  4262	21A9  50 52 45			     DB	 'PRE'
1  4263	21AC  D6			     DB	 326Q	; последний символ слова + 128 (7 бит =	1).
1  4264	21AD  219Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4265	      =ARRAY:21A8		 LINK=LINK$
1  4266	21AF				 PREV LABEL FAR	 ; CFA
1  4267	21AF  1FF3r			     DW	$USE
   4268	21B1  003C				 DW 74Q	; адрес	экранного блока
   4269						 ; A variable containing the address of	the disc buffer	most recently
   4270						 ; referenced. The UPDATE command marks	this buffer to be later	written
   4271						 ; to disc.
   4272
   4273						 HEAD	  83h,'$E',330Q,$EX,$USE	      ;	EXP
1  4274	      =ARRAY:21B3		 LINK$=$
1  4275	21B3  83			     DB	 83h  ;	NFA 7 бит равен	1.
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 76
forth.asm



1  4276							 ; 6 - признак immediate. 5- слово не описано smudge
1  4277	21B4  24 45			     DB	 '$E'
1  4278	21B6  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  4279	21B7  21A8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4280	      =ARRAY:21B3		 LINK=LINK$
1  4281	21B9				 $EX LABEL FAR	; CFA
1  4282	21B9  1FF3r			     DW	$USE
   4283	21BB  003E				 DW 76Q	 ; целочисленное значение  порядка  числа,
   4284							 ; который  следует  за	признаком Е
   4285
   4286						 HEAD	  83h,'ER',302Q,ERB,$USE	      ;	ERB
1  4287	      =ARRAY:21BD		 LINK$=$
1  4288	21BD  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4289							 ; 6 - признак immediate. 5- слово не описано smudge
1  4290	21BE  45 52			     DB	 'ER'
1  4291	21C0  C2			     DB	 302Q	; последний символ слова + 128 (7 бит =	1).
1  4292	21C1  21B3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4293	      =ARRAY:21BD		 LINK=LINK$
1  4294	21C3				 ERB LABEL FAR	; CFA
1  4295	21C3  1FF3r			     DW	$USE
   4296	21C5  0040				 DW 100Q ; 64d 40h
   4297						 ; Если	ERB=0,	ERROR  работает	 обычным  образом,  в противном	случае
   4298						 ; переменная ERB обнуляется,  а уход из  программы  в	Форт  через  QUIT
   4299						 ; блокируется.
   4300
   4301						 HEAD	  83h,'DE','B'+80h,DEB,$USE		 ; DEB
1  4302	      =ARRAY:21C7		 LINK$=$
1  4303	21C7  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4304							 ; 6 - признак immediate. 5- слово не описано smudge
1  4305	21C8  44 45			     DB	 'DE'
1  4306	21CA  C2			     DB	 'B'+80h   ; последний символ слова + 128 (7 бит = 1).
1  4307	21CB  21BDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4308	      =ARRAY:21C7		 LINK=LINK$
1  4309	21CD				 DEB LABEL FAR	; CFA
1  4310	21CD  1FF3r			     DW	$USE
   4311	21CF  0042				 DW 102Q  ; признак отладки  66d
   4312
   4313						 HEAD	  89h,'LASTRAND','X'+80h,LASTRANDX,$USE	 ; LASTRANDX
1  4314	      =ARRAY:21D1		 LINK$=$
1  4315	21D1  89			     DB	 89h  ;	NFA 7 бит равен	1.
1  4316							 ; 6 - признак immediate. 5- слово не описано smudge
1  4317	21D2  4C 41 53 54 52 41	4E+	     DB	 'LASTRAND'
   4318	      44
1  4319	21DA  D8			     DB	 'X'+80h   ; последний символ слова + 128 (7 бит = 1).
1  4320	21DB  21C7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4321	      =ARRAY:21D1		 LINK=LINK$
1  4322	21DD				 LASTRANDX LABEL FAR  ;	CFA
1  4323	21DD  1FF3r			     DW	$USE
   4324	21DF  0044				 DW 104Q  ;
   4325
   4326						 HEAD	  82h,'X','A'+80h,XA,$USE	       ; XA
1  4327	      =ARRAY:21E1		 LINK$=$
1  4328	21E1  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4329							 ; 6 - признак immediate. 5- слово не описано smudge
1  4330	21E2  58			     DB	 'X'
1  4331	21E3  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  4332	21E4  21D1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 77
forth.asm



1  4333	      =ARRAY:21E1		 LINK=LINK$
1  4334	21E6				 XA LABEL FAR  ; CFA
1  4335	21E6  1FF3r			     DW	$USE
   4336	21E8  0046				 DW 106Q  ;
   4337
   4338						 HEAD	  82h,'X','C'+80h,XC,$USE	       ; XC
1  4339	      =ARRAY:21EA		 LINK$=$
1  4340	21EA  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4341							 ; 6 - признак immediate. 5- слово не описано smudge
1  4342	21EB  58			     DB	 'X'
1  4343	21EC  C3			     DB	 'C'+80h   ; последний символ слова + 128 (7 бит = 1).
1  4344	21ED  21E1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4345	      =ARRAY:21EA		 LINK=LINK$
1  4346	21EF				 XC LABEL FAR  ; CFA
1  4347	21EF  1FF3r			     DW	$USE
   4348	21F1  0048				 DW 110Q  ;
   4349
   4350						 HEAD	  82h,'X','M'+80h,XM,$USE	       ; XM
1  4351	      =ARRAY:21F3		 LINK$=$
1  4352	21F3  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4353							 ; 6 - признак immediate. 5- слово не описано smudge
1  4354	21F4  58			     DB	 'X'
1  4355	21F5  CD			     DB	 'M'+80h   ; последний символ слова + 128 (7 бит = 1).
1  4356	21F6  21EAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4357	      =ARRAY:21F3		 LINK=LINK$
1  4358	21F8				 XM LABEL FAR  ; CFA
1  4359	21F8  1FF3r			     DW	$USE
   4360	21FA  004A				 DW 112Q  ;
   4361
   4362					     ;** Слова высокого	уровня **
   4363
   4364						 HEAD	  85h,'?TER',315Q,?TERM,$COL	      ;	?TERM
1  4365	      =ARRAY:21FC		 LINK$=$
1  4366	21FC  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4367							 ; 6 - признак immediate. 5- слово не описано smudge
1  4368	21FD  3F 54 45 52		     DB	 '?TER'
1  4369	2201  CD			     DB	 315Q	; последний символ слова + 128 (7 бит =	1).
1  4370	2202  21F3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4371	      =ARRAY:21FC		 LINK=LINK$
1  4372	2204				 ?TERM LABEL FAR  ; CFA
1  4373	2204  1F67r			     DW	$COL
   4374					 ; вывод в стек	кода символа из	буфера клавиатуры без ожидания нажатия
   4375	2206  1551r 0FD3r 00FF	  +		 DW ?TER$,LIT,377Q,$AND,SEMI
   4376	      17EDr 18CFr
   4377
   4378						 HEAD	  82h,'C',322Q,CR,$COL		      ;	CR
1  4379	      =ARRAY:2210		 LINK$=$
1  4380	2210  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4381							 ; 6 - признак immediate. 5- слово не описано smudge
1  4382	2211  43			     DB	 'C'
1  4383	2212  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4384	2213  21FCr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4385	      =ARRAY:2210		 LINK=LINK$
1  4386	2215				 CR LABEL FAR  ; CFA
1  4387	2215  1F67r			     DW	$COL
   4388					 ; вывод символов 0D 0A
   4389	2217  0FD3r 000D 13ECr	  +		 DW LIT,15Q,EMIT,LIT,12Q,EMIT,SEMI
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 78
forth.asm



   4390	      0FD3r 000A 13ECr	  +
   4391	      18CFr
   4392
   4393						 HEAD	  81h,,254Q,COMMA,$COL		      ;	,
1  4394	      =ARRAY:2225		 LINK$=$
1  4395	2225  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  4396							 ; 6 - признак immediate. 5- слово не описано smudge
1  4397	2226  AC			     DB	 254Q	; последний символ слова + 128 (7 бит =	1).
1  4398	2227  2210r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4399	      =ARRAY:2225		 LINK=LINK$
1  4400	2229				 COMMA LABEL FAR  ; CFA
1  4401	2229  1F67r			     DW	$COL
   4402					 ; в  свободную	ячейку словаря помещяем	число из стека и
   4403					 ;  занимаем эту ячейку	(смещаем указатель here)
   4404	222B  1D41r 1C9Cr 2060r	  +		 DW HERE,STORE,TWO,ALLOT,SEMI
   4405	      1D5Fr 18CFr
   4406
   4407						 HEAD	  82h,'C',254Q,CCOM,$COL	      ;	C,
1  4408	      =ARRAY:2235		 LINK$=$
1  4409	2235  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  4410							 ; 6 - признак immediate. 5- слово не описано smudge
1  4411	2236  43			     DB	 'C'
1  4412	2237  AC			     DB	 254Q	; последний символ слова + 128 (7 бит =	1).
1  4413	2238  2225r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4414	      =ARRAY:2235		 LINK=LINK$
1  4415	223A				 CCOM LABEL FAR	 ; CFA
1  4416	223A  1F67r			     DW	$COL
   4417	223C  1D41r 1CB8r 2058r	  +		 DW HERE,CSTOR,ONE,ALLOT,SEMI
   4418	      1D5Fr 18CFr
   4419
   4420						 HEAD	   85h,'SPAC',305Q,SPACE,$COL	      ;	SPACE
1  4421	      =ARRAY:2246		 LINK$=$
1  4422	2246  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4423							 ; 6 - признак immediate. 5- слово не описано smudge
1  4424	2247  53 50 41 43		     DB	 'SPAC'
1  4425	224B  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4426	224C  2235r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4427	      =ARRAY:2246		 LINK=LINK$
1  4428	224E				 SPACE LABEL FAR  ; CFA
1  4429	224E  1F67r			     DW	$COL
   4430	2250  2079r 13ECr 18CFr			 DW BLAN,EMIT,SEMI
   4431
   4432						  HEAD	  83h,'PF','A'+80h,PFA,$COL	      ;	PFA
1  4433	      =ARRAY:2256		 LINK$=$
1  4434	2256  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4435							 ; 6 - признак immediate. 5- слово не описано smudge
1  4436	2257  50 46			     DB	 'PF'
1  4437	2259  C1			     DB	 'A'+80h   ; последний символ слова + 128 (7 бит = 1).
1  4438	225A  2246r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4439	      =ARRAY:2256		 LINK=LINK$
1  4440	225C				 PFA LABEL FAR	; CFA
1  4441	225C  1F67r			     DW	$COL
   4442					 ; NFA -> PFA
   4443	225E  2058r 1D7Dr 0FD3r	  +		  DW  ONE,TRAV,LIT,5,PLUS,SEMI
   4444	      0005 170Er 18CFr
   4445
   4446						  HEAD	  83h,'?E',322Q,QERR,$COL	      ;	?ER
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 79
forth.asm



1  4447	      =ARRAY:226A		 LINK$=$
1  4448	226A  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4449							 ; 6 - признак immediate. 5- слово не описано smudge
1  4450	226B  3F 45			     DB	 '?E'
1  4451	226D  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4452	226E  2256r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4453	      =ARRAY:226A		 LINK=LINK$
1  4454	2270				 QERR LABEL FAR	 ; CFA
1  4455	2270  1F67r			     DW	$COL
   4456					 ; f errorcode -> если f=0, то без ошибок
   4457	2272  1A0Cr 101Ar 0006	  +		  DW  SWAP,ZBRAN,TTT-$,ERROR,SEMI
   4458	      260Er 18CFr
   4459	227C  1B21r 18CFr		TTT:	  DW  DROP,SEMI
   4460
   4461						  HEAD	  85h,'?COM',320Q,QCOMP,$COL	      ;	?COMP
1  4462	      =ARRAY:2280		 LINK$=$
1  4463	2280  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4464							 ; 6 - признак immediate. 5- слово не описано smudge
1  4465	2281  3F 43 4F 4D		     DB	 '?COM'
1  4466	2285  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  4467	2286  226Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4468	      =ARRAY:2280		 LINK=LINK$
1  4469	2288				 QCOMP LABEL FAR  ; CFA
1  4470	2288  1F67r			     DW	$COL
   4471					     ; проверка	режима работы. система в режиме	компиляции?
   4472	228A  2168r 1C42r 1164r	  +		  DW  STATE,AT,ZEQU,LIT,21Q,QERR,SEMI	     ; 17
   4473	      0FD3r 0011 2270r	  +
   4474	      18CFr
   4475
   4476						  HEAD	  85h,'?EXE',303Q,QEXEC,$COL	      ;	?EXEC
1  4477	      =ARRAY:2298		 LINK$=$
1  4478	2298  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4479							 ; 6 - признак immediate. 5- слово не описано smudge
1  4480	2299  3F 45 58 45		     DB	 '?EXE'
1  4481	229D  C3			     DB	 303Q	; последний символ слова + 128 (7 бит =	1).
1  4482	229E  2280r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4483	      =ARRAY:2298		 LINK=LINK$
1  4484	22A0				 QEXEC LABEL FAR  ; CFA
1  4485	22A0  1F67r			     DW	$COL
   4486					     ; проверка	режима исполнения    0=> Исполнение
   4487	22A2  2168r 1C42r 0FD3r	  +		  DW  STATE,AT,LIT,22Q,QERR,SEMI	     ; 18
   4488	      0012 2270r 18CFr
   4489
   4490						  HEAD	  85h,'?PAI',322Q,QPAIR,$COL	      ;	?PAIR
1  4491	      =ARRAY:22AE		 LINK$=$
1  4492	22AE  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4493							 ; 6 - признак immediate. 5- слово не описано smudge
1  4494	22AF  3F 50 41 49		     DB	 '?PAI'
1  4495	22B3  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4496	22B4  2298r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4497	      =ARRAY:22AE		 LINK=LINK$
1  4498	22B6				 QPAIR LABEL FAR  ; CFA
1  4499	22B6  1F67r			     DW	$COL
   4500	22B8  172Ar 0FD3r 0013	  +		  DW  SUBB,LIT,23Q,QERR,SEMI
   4501	      2270r 18CFr
   4502
   4503						  HEAD	  84h,'?CS',320Q,QCSP,$COL	      ;	?CSP
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 80
forth.asm



1  4504	      =ARRAY:22C2		 LINK$=$
1  4505	22C2  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4506							 ; 6 - признак immediate. 5- слово не описано smudge
1  4507	22C3  3F 43 53			     DB	 '?CS'
1  4508	22C6  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  4509	22C7  22AEr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4510	      =ARRAY:22C2		 LINK=LINK$
1  4511	22C9				 QCSP LABEL FAR	 ; CFA
1  4512	22C9  1F67r			     DW	$COL
   4513					     ; контролируют сохранение указателя
   4514					     ; стека параметров	в процессе интерпретации слова
   4515					     ; текущее и сохраненное значение стека должны быть	равны
   4516	22CB  188Ar 2187r 1C42r	  +		  DW  SPAT,CSP,AT,SUBB,LIT,24Q,QERR,SEMI
   4517	      172Ar 0FD3r 0014	  +
   4518	      2270r 18CFr
   4519
   4520						  HEAD	  85h,'?LOA',304Q,QLOAD,$COL	      ;	?LOAD
1  4521	      =ARRAY:22DB		 LINK$=$
1  4522	22DB  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4523							 ; 6 - признак immediate. 5- слово не описано smudge
1  4524	22DC  3F 4C 4F 41		     DB	 '?LOA'
1  4525	22E0  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4526	22E1  22C2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4527	      =ARRAY:22DB		 LINK=LINK$
1  4528	22E3				 QLOAD LABEL FAR  ; CFA
1  4529	22E3  1F67r			     DW	$COL
   4530					     ; ошибка, если не вовремя загрузки
   4531	22E5  2116r 1C42r 1164r	  +		  DW  BLK,AT,ZEQU,LIT,26Q,QERR,SEMI	 ; 22
   4532	      0FD3r 0016 2270r	  +
   4533	      18CFr
   4534
   4535						  HEAD	  87h,'COMPIL',305Q,COMP,$COL	      ;	COMPILE
1  4536	      =ARRAY:22F3		 LINK$=$
1  4537	22F3  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  4538							 ; 6 - признак immediate. 5- слово не описано smudge
1  4539	22F4  43 4F 4D 50 49 4C		     DB	 'COMPIL'
1  4540	22FA  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4541	22FB  22DBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4542	      =ARRAY:22F3		 LINK=LINK$
1  4543	22FD				 COMP LABEL FAR	 ; CFA
1  4544	22FD  1F67r			     DW	$COL
   4545					 ; Компиляция исполнительного адреса, следующего за оператором
   4546	22FF  2288r 1949r 192Cr	  +		  DW  QCOMP,I,FROMR,TWOP,TOR,AT,COMMA,SEMI
   4547	      15DDr 190Er 1C42r	  +
   4548	      2229r 18CFr
   4549
   4550						  HEAD	  84h,'SMU',307Q,SMUG,$COL	      ;	SMUDGE
1  4551	      =ARRAY:230F		 LINK$=$
1  4552	230F  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4553							 ; 6 - признак immediate. 5- слово не описано smudge
1  4554	2310  53 4D 55			     DB	 'SMU'
1  4555	2313  C7			     DB	 307Q	; последний символ слова + 128 (7 бит =	1).
1  4556	2314  22F3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4557	      =ARRAY:230F		 LINK=LINK$
1  4558	2316				 SMUG LABEL FAR	 ; CFA
1  4559	2316  1F67r			     DW	$COL
   4560					     ; сбрасывает 5-й бит первого байта	 описания  и  тем  самым
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 81
forth.asm



   4561					     ; делает	данное	 слово	полноправным  членом  текущего	словаря
   4562	2318  1E3Br 2079r 1C27r	  +		  DW  LATES,BLAN,TOGL,SEMI
   4563	      18CFr
   4564
   4565						  HEAD	  87h,'(;CODE',251Q,PSCOD,$COL	      ;	(;CODE)
1  4566	      =ARRAY:2320		 LINK$=$
1  4567	2320  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  4568							 ; 6 - признак immediate. 5- слово не описано smudge
1  4569	2321  28 3B 43 4F 44 45		     DB	 '(;CODE'
1  4570	2327  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1  4571	2328  230Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4572	      =ARRAY:2320		 LINK=LINK$
1  4573	232A				 PSCOD LABEL FAR  ; CFA
1  4574	232A  1F67r			     DW	$COL
   4575					 ; адрес из стека возвратов (там находится адрес начала	кода на	ассемблере)
   4576					 ; пишем в CFA последнего определяемого	слова
   4577					 ; таким образом в CFA будет свой код интерпретатора на	ассемблере
   4578	232C  192Cr 1E3Br 225Cr	  +		  DW  FROMR,LATES,PFA,CFA,STORE,SEMI
   4579	      1D05r 1C9Cr 18CFr
   4580
   4581						  HEAD	  87h,'#BUILD',323Q,BUILD,$COL	      ;	<BUILDS	;
1  4582	      =ARRAY:2338		 LINK$=$
1  4583	2338  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  4584							 ; 6 - признак immediate. 5- слово не описано smudge
1  4585	2339  23 42 55 49 4C 44		     DB	 '#BUILD'
1  4586	233F  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  4587	2340  2320r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4588	      =ARRAY:2338		 LINK=LINK$
1  4589	2342				 BUILD LABEL FAR  ; CFA
1  4590	2342  1F67r			     DW	$COL
   4591					 ; формирует в словаре описание	константы равной 0 с именем XXX
   4592					 ; в поле PFA находится	0, который потом заменится адресом кода,
   4593					 ; следующего за словом	DOES
   4594					 ; в CFA будет помещен адрес кода $DOE
   4595	2344  2050r 1FA0r 18CFr			  DW  ZERO,CON,SEMI
   4596
   4597						  HEAD	  85h,'COUN',324Q,COUNT,$COL	      ;	COUNT
1  4598	      =ARRAY:234A		 LINK$=$
1  4599	234A  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4600							 ; 6 - признак immediate. 5- слово не описано smudge
1  4601	234B  43 4F 55 4E		     DB	 'COUN'
1  4602	234F  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4603	2350  2338r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4604	      =ARRAY:234A		 LINK=LINK$
1  4605	2352				 COUNT LABEL FAR  ; CFA
1  4606	2352  1F67r			     DW	$COL
   4607					 ; addr1 --- addr2 n
   4608					 ; адрес HERE+1	(это адрес первого байта слова)
   4609					 ; и число символов в  слове  (HERE  C@)
   4610	2354  1A58r				  DW  DUBL	     ; addr1 addr1
   4611	2356  15C2r 1A0Cr			  DW  ONEP,SWAP	     ; addr1+1 addr1
   4612	235A  1C7Fr 18CFr			  DW  CAT,SEMI	     ; addr1+1 u8[addr1]
   4613
   4614						  HEAD	  84h,'TYP',305Q,$TYPE,$COL	      ;	TYPE
1  4615	      =ARRAY:235E		 LINK$=$
1  4616	235E  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4617							 ; 6 - признак immediate. 5- слово не описано smudge
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 82
forth.asm



1  4618	235F  54 59 50			     DB	 'TYP'
1  4619	2362  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4620	2363  234Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4621	      =ARRAY:235E		 LINK=LINK$
1  4622	2365				 $TYPE LABEL FAR  ; CFA
1  4623	2365  1F67r			     DW	$COL
   4624					 ; адр count ->	вывод строки на	экран
   4625	2367  1A75r 101Ar 001C	  +		  DW  DDUP,ZBRAN,TC1-$,ZERO,XDO
   4626	      2050r 105Br
   4627	2371  1A58r 1949r 170Er	  +	 TC0:	  DW  DUBL,I,PLUS,CAT,LIT,177Q,$AND
   4628	      1C7Fr 0FD3r 007F	  +
   4629	      17EDr
   4630	237F  2058r 13B1r 1084r	  +		  DW  ONE,EMI$,XLOOP,TC0-$
   4631	      FFEC
   4632	2387  1B21r 18CFr		 TC1:	  DW  DROP,SEMI
   4633
   4634						  HEAD	  84h,'(."',251Q,PDOTQ,$COL	      ;	(.")
1  4635	      =ARRAY:238B		 LINK$=$
1  4636	238B  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4637							 ; 6 - признак immediate. 5- слово не описано smudge
1  4638	238C  28 2E 22			     DB	 '(."'
1  4639	238F  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1  4640	2390  235Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4641	      =ARRAY:238B		 LINK=LINK$
1  4642	2392				 PDOTQ LABEL FAR  ; CFA
1  4643	2392  1F67r			     DW	$COL
   4644	2394  1949r				  DW  I	     ; при исполнении следующее	число -
   4645							     ; число символов сохраняется в RS
   4646	2396  2352r 1A58r 15C2r			  DW COUNT,DUBL,ONEP
   4647	239C  192Cr 170Er 190Er	  +		  DW  FROMR,PLUS,TOR,$TYPE,SEMI
   4648	      2365r 18CFr
   4649
   4650						  HEAD	  302Q,'.',242Q,DOTQ,$COL	       ; ."
1  4651	      =ARRAY:23A6		 LINK$=$
1  4652	23A6  C2			     DB	 302Q  ; NFA 7 бит равен 1.
1  4653							 ; 6 - признак immediate. 5- слово не описано smudge
1  4654	23A7  2E			     DB	 '.'
1  4655	23A8  A2			     DB	 242Q	; последний символ слова + 128 (7 бит =	1).
1  4656	23A9  238Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4657	      =ARRAY:23A6		 LINK=LINK$
1  4658	23AB				 DOTQ LABEL FAR	 ; CFA
1  4659	23AB  1F67r			     DW	$COL
   4660	23AD  0FD3r 0022 2168r	  +		  DW  LIT,34,STATE,AT,ZBRAN,XT-$
   4661	      1C42r 101Ar 0012
   4662	23B9  22FDr 2392r 242Cr	  +		  DW  COMP,PDOTQ,$WORD,HERE,CAT,ONEP
   4663	      1D41r 1C7Fr 15C2r
   4664	23C5  1D5Fr 18CFr			  DW  ALLOT, SEMI
   4665	23C9  242Cr 1D41r 2352r	  +	XT:	  DW  $WORD,HERE,COUNT,$TYPE,SEMI
   4666	      2365r 18CFr
   4667
   4668						  HEAD	  85h,'QUER',331Q,QUERY,$COL	      ;	QUERY
1  4669	      =ARRAY:23D3		 LINK$=$
1  4670	23D3  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4671							 ; 6 - признак immediate. 5- слово не описано smudge
1  4672	23D4  51 55 45 52		     DB	 'QUER'
1  4673	23D8  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  4674	23D9  23A6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 83
forth.asm



1  4675	      =ARRAY:23D3		 LINK=LINK$
1  4676	23DB				 QUERY LABEL FAR  ; CFA
1  4677	23DB  1F67r			     DW	$COL
   4678					 ; входной буфер,  адрес которого хранится в системной переменной
   4679					 ; по имени TIB	(Terminal Input	Buffer).  Ввод	в  этот	 буфер
   4680					 ; осуществляется оператором QUERY
   4681	23DD  20A7r 1C42r 1D05r	  +		  DW  TIB,AT,CFA,LIT,120Q,EXPE
   4682	      0FD3r 0050 1520r
   4683	23E9  2050r 211Fr 1C9Cr	  +		  DW  ZERO,$IN,STORE,CR,SEMI
   4684	      2215r 18CFr
   4685
   4686						  HEAD	  301Q,,200Q,NULL,$COL		       ; NULL
1  4687	      =ARRAY:23F3		 LINK$=$
1  4688	23F3  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  4689							 ; 6 - признак immediate. 5- слово не описано smudge
1  4690	23F4  80			     DB	 200Q	; последний символ слова + 128 (7 бит =	1).
1  4691	23F5  23D3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4692	      =ARRAY:23F3		 LINK=LINK$
1  4693	23F7				 NULL LABEL FAR	 ; CFA
1  4694	23F7  1F67r			     DW	$COL
   4695					 ; немедленного	исполнения. исполняется, если встретился 0 в коде
   4696					 ; прерывает бесконечное испольнение INTERPRET
   4697	23F9  2116r 1C42r 101Ar	  +		  DW  BLK,AT,ZBRAN,NUL-$	 ; если	пультовый режим
   4698	      0010
   4699	2401  2058r 2116r 1BEDr	  +		  DW  ONE,BLK,PSTOR,ZERO,$IN,STORE,QEXEC
   4700	      2050r 211Fr 1C9Cr	  +
   4701	      22A0r
   4702	240F  19A7r 18CFr		 NUL:	  DW  LEV,SEMI
   4703
   4704						  HEAD	  83h,'PA',304Q,PAD,$COL	      ;	PAD
1  4705	      =ARRAY:2413		 LINK$=$
1  4706	2413  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4707							 ; 6 - признак immediate. 5- слово не описано smudge
1  4708	2414  50 41			     DB	 'PA'
1  4709	2416  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4710	2417  23F3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4711	      =ARRAY:2413		 LINK=LINK$
1  4712	2419				 PAD LABEL FAR	; CFA
1  4713	2419  1F67r			     DW	$COL
   4714					     ; Многие операции	 выдачи	  результатов	и   сообщений	на   экран
   4715					     ; производятся   через   специальный   буфер,   адрес   которого  смещен
   4716					     ; относительно HERE.  В базовом словаре имеется  оператор	PAD,  который
   4717					     ; выдает в	стек адрес КОНЦА этого буфера:
   4718	241B  1D41r 0FD3r 0044	  +		  DW  HERE,LIT,104Q,PLUS,SEMI
   4719	      170Er 18CFr
   4720
   4721						  HEAD	  84h,'WOR',304Q,$WORD,$COL	      ;	WORD
1  4722	      =ARRAY:2425		 LINK$=$
1  4723	2425  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  4724							 ; 6 - признак immediate. 5- слово не описано smudge
1  4725	2426  57 4F 52			     DB	 'WOR'
1  4726	2429  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4727	242A  2413r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4728	      =ARRAY:2425		 LINK=LINK$
1  4729	242C				 $WORD LABEL FAR  ; CFA
1  4730	242C  1F67r			     DW	$COL
   4731					     ; разделитель -> число_символов строка по адресу here
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 84
forth.asm



   4732	242E  2116r 1C42r 1A75r	  +		  DW  BLK,AT,DDUP,ZBRAN,WD1-$; ввод с клавиатуры
   4733	      101Ar 0008
   4734	2438  2939r 103Fr 0006			  DW  BLOCK,BRAN,WD2-$	     ; адрес буфера из переменной BLK
   4735	243E  20A7r 1C42r		WD1:	  DW  TIB,AT		     ; адрес входного терминала
   4736	2442  211Fr 1C42r 170Er	  +	WD2:	  DW  $IN,AT,PLUS,SWAP,ENCL,HERE,BLAN,BLANK,$IN
   4737	      1A0Cr 126Ar 1D41r	  +
   4738	      2079r 1BBEr 211Fr
   4739	2454  1BEDr 190Er 1949r	  +		  DW  PSTOR,TOR,I,HERE,CSTOR
   4740	      1D41r 1CB8r
   4741	245E  1D41r 15C2r 192Cr	  +		  DW  HERE,ONEP,FROMR,CMOV,SEMI
   4742	      1B5Br 18CFr
   4743
   4744						  HEAD	  88h,'(NUMBER',251Q,PNUMB,$COL	      ;	(NUMBER)
1  4745	      =ARRAY:2468		 LINK$=$
1  4746	2468  88			     DB	 88h  ;	NFA 7 бит равен	1.
1  4747							 ; 6 - признак immediate. 5- слово не описано smudge
1  4748	2469  28 4E 55 4D 42 45	52	     DB	 '(NUMBER'
1  4749	2470  A9			     DB	 251Q	; последний символ слова + 128 (7 бит =	1).
1  4750	2471  2425r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4751	      =ARRAY:2468		 LINK=LINK$
1  4752	2473				 PNUMB LABEL FAR  ; CFA
1  4753	2473  1F67r			     DW	$COL
   4754	2475  15C2r 190Er 1949r	  +	BN:	  DW  ONEP,TOR,I,CAT,BASE,AT,DIGIT,ZBRAN,MMO-$
   4755	      1C7Fr 2173r 1C42r	  +
   4756	      1142r 101Ar 002C
   4757	2487  1A0Cr 2173r 1C42r	  +		  DW  SWAP,BASE,AT,USTAR,DROP,ROT,BASE,AT,USTAR
   4758	      164Dr 1B21r 1AA5r	  +
   4759	      2173r 1C42r 164Dr
   4760	2499  1747r 217Dr 1C42r	  +		  DW  DPLUS,DPL,AT,ONEP,ZBRAN,BN1-$,ONE,DPL,PSTOR
   4761	      15C2r 101Ar 0008	  +
   4762	      2058r 217Dr 1BEDr
   4763	24AB  192Cr 103Fr FFC6		BN1:	  DW  FROMR,BRAN,BN-$
   4764	24B1  192Cr 18CFr		MMO:	  DW  FROMR,SEMI
   4765
   4766						  HEAD	  85h,'-FIN',304Q,DFIND,$COL	      ;	-FIND
1  4767	      =ARRAY:24B5		 LINK$=$
1  4768	24B5  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4769							 ; 6 - признак immediate. 5- слово не описано smudge
1  4770	24B6  2D 46 49 4E		     DB	 '-FIN'
1  4771	24BA  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  4772	24BB  2468r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4773	      =ARRAY:24B5		 LINK=LINK$
1  4774	24BD				 DFIND LABEL FAR  ; CFA
1  4775	24BD  1F67r			     DW	$COL
   4776					     ; Поиск слова в словаре, которое следует следующим	в тексте программы
   4777	24BF  2079r 242Cr 1D41r	  +		  DW  BLAN,$WORD,HERE,COUNT,UPPER,HERE
   4778	      2352r 1E85r 1D41r
   4779	24CB  214Er 1C42r 1C42r			  DW  CONT,AT,AT ; поиска в контекстном	словаре
   4780	24D1  10D3r 1A75r 1164r	  +		  DW  PFIND,DDUP,ZEQU,ZBRAN,FIN-$,HERE,LATES,PFIND
   4781	      101Ar 0008 1D41r	  +
   4782	      1E3Br 10D3r
   4783	24E1  18CFr			FIN:	  DW  SEMI
   4784
   4785						  HEAD	  86h,'NUMBE',322Q,NUMB,$COL	      ;	NUMBER
1  4786	      =ARRAY:24E3		 LINK$=$
1  4787	24E3  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  4788							 ; 6 - признак immediate. 5- слово не описано smudge
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 85
forth.asm



1  4789	24E4  4E 55 4D 42 45		     DB	 'NUMBE'
1  4790	24E9  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4791	24EA  24B5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4792	      =ARRAY:24E3		 LINK=LINK$
1  4793	24EC				 NUMB LABEL FAR	 ; CFA
1  4794	24EC  1F67r			     DW	$COL
   4795	24EE  2050r 21B9r 1C9Cr	  +		  DW  ZERO,$EX,STORE,BASE,AT,ZERO,ROT
   4796	      2173r 1C42r 2050r	  +
   4797	      1AA5r
   4798	24FC  15C2r 1A58r 1C7Fr	  +		  DW  ONEP,DUBL,CAT,DUBL,LIT,53Q,EQUAL
   4799	      1A58r 0FD3r 002B	  +
   4800	      11D9r
   4801	250A  101Ar 000A 1DFAr	  +		  DW  ZBRAN,NH1-$,DECIMA,DROP,BRAN,NH4-$
   4802	      1B21r 103Fr 002E
   4803	2516  1A58r 0FD3r 002D	  +	NH1:	  DW  DUBL,LIT,55Q,EQUAL,ZBRAN,NH2-$,DROP,DECIMA
   4804	      11D9r 101Ar 0012	  +
   4805	      1B21r 1DFAr
   4806	2526  1A0Cr 1B21r 2058r	  +		  DW  SWAP,DROP,ONE,SWAP,BRAN,NH4-$
   4807	      1A0Cr 103Fr 0012
   4808	2532  0FD3r 0027 11D9r	  +	NH2:	  DW  LIT,47Q,EQUAL,ZBRAN,NH3-$,OCTAL,ONEP
   4809	      101Ar 0006 1E1Ar	  +
   4810	      15C2r
   4811	2540  15FAr			NH3:	  DW  ONEM
   4812	2542  0FD3r FFFF 217Dr	  +	NH4:	  DW  LIT,-1,DPL,STORE,ZERO,ZERO,ROT,PNUMB,DUBL
   4813	      1C9Cr 2050r 2050r	  +
   4814	      1AA5r 2473r 1A58r
   4815	2554  1C7Fr 2079r 172Ar	  +		  DW  CAT,BLAN,SUBB,ZBRAN,NH6-$
   4816	      101Ar 0088
   4817	255E  1A58r 1C7Fr 0FD3r	  +		  DW  DUBL,CAT,LIT,56Q,EQUAL,ZBRAN,EXP-$
   4818	      002E 11D9r 101Ar	  +
   4819	      0016
   4820	256C  2050r 217Dr 1C9Cr	  +		  DW  ZERO,DPL,STORE,PNUMB,DUBL,CAT,BLAN,SUBB,ZBRAN,NH6-$
   4821	      2473r 1A58r 1C7Fr	  +
   4822	      2079r 172Ar 101Ar	  +
   4823	      0066
   4824	2580  217Dr 1C42r 1A0Cr	  +	EXP:	  DW  DPL,AT,SWAP,DUBL,CAT,LIT
   4825	      1A58r 1C7Fr 0FD3r
   4826	258C  0045 11D9r 101Ar	  +		  DW  105Q,EQUAL,ZBRAN,ER1-$,ONEP,DUBL,CAT
   4827	      0068 15C2r 1A58r	  +
   4828	      1C7Fr
   4829	259A  0FD3r 002D 11D9r	  +		  DW  LIT,55Q,EQUAL,ZBRAN,NEMI-$,ONE,BRAN,NH0-$
   4830	      101Ar 0008 2058r	  +
   4831	      103Fr 0014
   4832	25AA  1A58r 1C7Fr 0FD3r	  +	NEMI:	  DW  DUBL,CAT,LIT,53Q,SUBB,ZBRAN,PLU-$,ONEM
   4833	      002B 172Ar 101Ar	  +
   4834	      0004 15FAr
   4835	25BA  2050r			PLU:	  DW  ZERO
   4836	25BC  1A0Cr 2050r 2050r	  +	NH0:	  DW  SWAP,ZERO,ZERO,ROT,PNUMB,CAT,BLAN,EQUAL,ZBRAN,ER-$
   4837	      1AA5r 2473r 1C7Fr	  +
   4838	      2079r 11D9r 101Ar	  +
   4839	      0028
   4840	25D0  1B21r 1A0Cr 101Ar	  +		  DW  DROP,SWAP,ZBRAN,NH5-$,MINUS
   4841	      0004 1790r
   4842	25DA  21B9r 1C9Cr 217Dr	  +	NH5:	  DW  $EX,STORE,DPL,STORE,ZERO
   4843	      1C9Cr 2050r
   4844	25E4  1B21r 1AA5r 101Ar	  +	NH6:	  DW  DROP,ROT,ZBRAN,NH7-$,DMINU
   4845	      0004 16ACr
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 86
forth.asm



   4846	25EE  1AA5r 2173r 1C9Cr	  +	NH7:	  DW  ROT,BASE,STORE,SEMI
   4847	      18CFr
   4848	25F6  1B04r 1B21r		ER:	  DW  DDROP,DROP
   4849	25FA  1B04r 1B04r 1B21r	  +	ER1:	  DW  DDROP,DDROP,DROP,ZERO,ERROR,SEMI
   4850	      2050r 260Er 18CFr
   4851
   4852						  HEAD	  85h,'ERRO',322Q,ERROR,$COL	      ;	ERROR
1  4853	      =ARRAY:2606		 LINK$=$
1  4854	2606  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  4855							 ; 6 - признак immediate. 5- слово не описано smudge
1  4856	2607  45 52 52 4F		     DB	 'ERRO'
1  4857	260B  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  4858	260C  24E3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4859	      =ARRAY:2606		 LINK=LINK$
1  4860	260E				 ERROR LABEL FAR  ; CFA
1  4861	260E  1F67r			     DW	$COL
   4862	2610  1D41r 2352r 2365r	  +		  DW  HERE,COUNT,$TYPE,PDOTQ
   4863	      2392r
   4864	2618  03 20 3F 20			  DB  3	, ' ? '
   4865	261C  21C3r 1C42r 101Ar	  +		  DW  ERB,AT,ZBRAN,XER-$
   4866	      000C
   4867	2624  2050r 21C3r 1C9Cr	  +		  DW  ZERO,ERB,STORE,DROP,SEMI
   4868	      1B21r 18CFr
   4869	262E  29B3r 1897r 27C1r		XER:	  DW  MESS,SPSTO,QUIT
   4870
   4871						  HEAD	  83h,'ID',256Q,IDDOT,$COL	      ;	ID.
1  4872	      =ARRAY:2634		 LINK$=$
1  4873	2634  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  4874							 ; 6 - признак immediate. 5- слово не описано smudge
1  4875	2635  49 44			     DB	 'ID'
1  4876	2637  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  4877	2638  2606r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4878	      =ARRAY:2634		 LINK=LINK$
1  4879	263A				 IDDOT LABEL FAR  ; CFA
1  4880	263A  1F67r			     DW	$COL
   4881					     ; печатает	  имя	слова
   4882	263C  2352r 0FD3r 001F	  +		  DW  COUNT,LIT,37Q,$AND,$TYPE,SPACE,SEMI
   4883	      17EDr 2365r 224Er	  +
   4884	      18CFr
   4885
   4886						  HEAD	  86h,'CREAT',305Q,CREAT,$COL	      ;	CREATE
1  4887	      =ARRAY:264A		 LINK$=$
1  4888	264A  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  4889							 ; 6 - признак immediate. 5- слово не описано smudge
1  4890	264B  43 52 45 41 54		     DB	 'CREAT'
1  4891	2650  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  4892	2651  2634r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4893	      =ARRAY:264A		 LINK=LINK$
1  4894	2653				 CREAT LABEL FAR  ; CFA
1  4895	2653  1F67r			     DW	$COL
   4896					     ; - --> адр XXX (I, C)
   4897					     ; формирование новых слов - описателей.
   4898					     ; (CREATE XXX DOES>) XXX исполняется на этапе компиляции,
   4899					     ; текст программы,	следующий за DOES>, адрес которого
   4900					     ; помещается в PFA	- на этапе исполнения.
   4901	2655  24BDr 101Ar 0010	  +		  DW  DFIND,ZBRAN,CRE-$,DROP,TWOP,NFA,IDDOT
   4902	      1B21r 15DDr 1CD5r	  +
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 87
forth.asm



   4903	      263Ar
   4904	2663  0FD3r 0004 29B3r			  DW  LIT,4,MESS	     ; сообщение о повторном определении слова
   4905	2669  1D41r 1A58r 1C7Fr	  +	CRE:	  DW  HERE,DUBL,CAT,$WIDTH,AT,MIN,ONEP,ALLOT ; here указывает на число символов	слова
   4906	      20B3r 1C42r 1848r	  +
   4907	      15C2r 1D5Fr
   4908										     ; сдвигаем	here на	длину слова + сам байт длины
   4909	2679  1A58r 0FD3r 00A0	  +		  DW  DUBL,LIT,240Q,TOGL,HERE,ONEM   ; выключаем из поиска
   4910	      1C27r 1D41r 15FAr
   4911										 ; 240Q	= 10100000
   4912	2685  0FD3r 0080 1C27r	  +		  DW  LIT,200Q,TOGL,LATES,COMMA,CURR,AT,STORE ;	в последней букве слова	включаем 7  +
   4913	      1E3Br 2229r 215Cr	  +  бит
   4914	      1C42r 1C9Cr
   4915										 ; ссылка на пред слово	и сохраняем ссылку на вновь
   4916										 ; созданное слово
   4917	2695  1D41r 15DDr 2229r	  +		  DW  HERE,TWOP,COMMA,SEMI	 ; в CFA пишем адрес PFA
   4918	      18CFr
   4919						  HEAD	  311Q,'[COMPILE',335Q,BCOM,$COL       ; [COMPILE]
1  4920	      =ARRAY:269D		 LINK$=$
1  4921	269D  C9			     DB	 311Q  ; NFA 7 бит равен 1.
1  4922							 ; 6 - признак immediate. 5- слово не описано smudge
1  4923	269E  5B 43 4F 4D 50 49	4C+	     DB	 '[COMPILE'
   4924	      45
1  4925	26A6  DD			     DB	 335Q	; последний символ слова + 128 (7 бит =	1).
1  4926	26A7  264Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4927	      =ARRAY:269D		 LINK=LINK$
1  4928	26A9				 BCOM LABEL FAR	 ; CFA
1  4929	26A9  1F67r			     DW	$COL
   4930					     ; Используется в описании типа двоеточия и	служит для
   4931						     ; компиляции слова	немедленного действия XXX, как если бы оно
   4932					     ; не было таким. Слово XXX	будет исполнено	тогда, когда будет
   4933					     ; исполнено слово,	в котором использована комбинация [COMPILE] XXX
   4934					     ; кладет в	словарь	CFA компилируемого слова
   4935	26AB  24BDr 1164r 2050r	  +		  DW  DFIND,ZEQU,ZERO,QERR,DROP,COMMA,SEMI
   4936	      2270r 1B21r 2229r	  +
   4937	      18CFr
   4938
   4939						 HEAD	 307Q,'LITERA',314Q,LITER,$COL	      ;	LITERAL
1  4940	      =ARRAY:26B9		 LINK$=$
1  4941	26B9  C7			     DB	 307Q  ; NFA 7 бит равен 1.
1  4942							 ; 6 - признак immediate. 5- слово не описано smudge
1  4943	26BA  4C 49 54 45 52 41		     DB	 'LITERA'
1  4944	26C0  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  4945	26C1  269Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4946	      =ARRAY:26B9		 LINK=LINK$
1  4947	26C3				 LITER LABEL FAR  ; CFA
1  4948	26C3  1F67r			     DW	$COL
   4949					 ; компилирует число в словарь
   4950	26C5  2168r 1C42r 101Ar	  +		 DW  STATE,AT,ZBRAN,LIL-$	; в режиме исполнения ничего не	делает
   4951	      0008
   4952	26CD  22FDr 0FD3r 2229r			 DW  COMP,LIT,COMMA
   4953	26D3  18CFr			 LIL:	 DW  SEMI
   4954
   4955						  HEAD	  310Q,'DLITERA',314Q,DLITE,$COL       ; DLITERAL
1  4956	      =ARRAY:26D5		 LINK$=$
1  4957	26D5  C8			     DB	 310Q  ; NFA 7 бит равен 1.
1  4958							 ; 6 - признак immediate. 5- слово не описано smudge
1  4959	26D6  44 4C 49 54 45 52	41	     DB	 'DLITERA'
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 88
forth.asm



1  4960	26DD  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  4961	26DE  26B9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4962	      =ARRAY:26D5		 LINK=LINK$
1  4963	26E0				 DLITE LABEL FAR  ; CFA
1  4964	26E0  1F67r			     DW	$COL
   4965					 ; компилирует в словарь двойное число
   4966	26E2  2168r 1C42r 101Ar	  +		  DW  STATE,AT,ZBRAN,DLI-$
   4967	      0008
   4968	26EA  1A0Cr 26C3r 26C3r			 DW  SWAP,LITER,LITER
   4969	26F0  18CFr			DLI:	  DW  SEMI
   4970
   4971						  HEAD	  86h,'?STAC',313Q,QSTAC,$COL	      ;	?STACK
1  4972	      =ARRAY:26F2		 LINK$=$
1  4973	26F2  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  4974							 ; 6 - признак immediate. 5- слово не описано smudge
1  4975	26F3  3F 53 54 41 43		     DB	 '?STAC'
1  4976	26F8  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  4977	26F9  26D5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4978	      =ARRAY:26F2		 LINK=LINK$
1  4979	26FB				 QSTAC LABEL FAR  ; CFA
1  4980	26FB  1F67r			     DW	$COL
   4981					 ; -> f	, true если значение указателя стека в пределах	допусков
   4982	26FD  2094r 1C42r 1D05r	  +		  DW  SZERO,AT,CFA,SPAT,ULESS,ONE,QERR
   4983	      188Ar 11F7r 2058r	  +
   4984	      2270r
   4985	270B  0FD3r FF80 188Ar	  +		  DW  LIT,-200Q,SPAT,ULESS,TWO
   4986	      11F7r 2060r
   4987	2715  2270r 18CFr			  DW  QERR, SEMI
   4988
   4989						  HEAD	  211Q,'INTERPRE',324Q,INTER,$COL      ; INTERPRET
1  4990	      =ARRAY:2719		 LINK$=$
1  4991	2719  89			     DB	 211Q  ; NFA 7 бит равен 1.
1  4992							 ; 6 - признак immediate. 5- слово не описано smudge
1  4993	271A  49 4E 54 45 52 50	52+	     DB	 'INTERPRE'
   4994	      45
1  4995	2722  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  4996	2723  26F2r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  4997	      =ARRAY:2719		 LINK=LINK$
1  4998	2725				 INTER LABEL FAR  ; CFA
1  4999	2725  1F67r			     DW	$COL
   5000	2727  24BDr 101Ar 0018		IT1:	  DW  DFIND,ZBRAN,IT3-$	; переход если не найдено
   5001	272D  2168r 1C42r 1205r	  +		  DW  STATE,AT,LESS, ZBRAN,IT2-$ ; выполнить
   5002	      101Ar 0008
   5003	2737  2229r 103Fr 0020			  DW  COMMA,BRAN,IT5-$
   5004	273D  0FC8r 103Fr 001A		IT2:	  DW  EXEC,BRAN,IT5-$
   5005	2743  1D41r 24ECr 217Dr	  +	IT3:	  DW  HERE,NUMB,DPL,AT,ONEP,ZBRAN,IT4-$
   5006	      1C42r 15C2r 101Ar	  +
   5007	      0008
   5008	2751  26E0r 103Fr 0006			  DW  DLITE,BRAN,IT5-$
   5009	2757  1B21r 26C3r		IT4:	  DW  DROP,LITER
   5010	275B  26FBr 103Fr FFC8		IT5:	  DW  QSTAC,BRAN,IT1-$
   5011
   5012						  HEAD	  211Q,'IMMEDIAT',305Q,IMMED,$COL      ; IMMEDIATE
1  5013	      =ARRAY:2761		 LINK$=$
1  5014	2761  89			     DB	 211Q  ; NFA 7 бит равен 1.
1  5015							 ; 6 - признак immediate. 5- слово не описано smudge
1  5016	2762  49 4D 4D 45 44 49	41+	     DB	 'IMMEDIAT'
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 89
forth.asm



   5017	      54
1  5018	276A  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  5019	276B  2719r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5020	      =ARRAY:2761		 LINK=LINK$
1  5021	276D				 IMMED LABEL FAR  ; CFA
1  5022	276D  1F67r			     DW	$COL
   5023					 ; отмечает последнее слово признаком
   5024	276F  1E3Br 2082r 1C27r	  +		  DW  LATES,$CL,TOGL,SEMI	 ; cl -	6 бит
   5025	      18CFr
   5026
   5027						 HEAD	 212Q,'VOCABULAR',331Q,VOCAB,$COL     ;	VOCABULARY
1  5028	      =ARRAY:2777		 LINK$=$
1  5029	2777  8A			     DB	 212Q  ; NFA 7 бит равен 1.
1  5030							 ; 6 - признак immediate. 5- слово не описано smudge
1  5031	2778  56 4F 43 41 42 55	4C+	     DB	 'VOCABULAR'
   5032	      41 52
1  5033	2781  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  5034	2782  2761r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5035	      =ARRAY:2777		 LINK=LINK$
1  5036	2784				 VOCAB LABEL FAR  ; CFA
1  5037	2784  1F67r			     DW	$COL
   5038					 ; создание нового словаря
   5039	2786  2342r 0FD3r A081	  +		 DW  BUILD,LIT,120201Q,COMMA ;
   5040	      2229r
   5041	278E  215Cr 1C42r 1D05r	  +		 DW  CURR,AT,CFA,COMMA
   5042	      2229r
   5043	2796  1D41r 20E1r 1C42r	  +		 DW  HERE,VOCL,AT,COMMA,VOCL,STORE,DOES
   5044	      2229r 20E1r 1C9Cr	  +
   5045	      2014r
   5046	27A4				 DOVOC	 LABEL	  FAR
   5047	27A4  15DDr 214Er 1C9Cr	  +		 DW  TWOP,CONT,STORE,SEMI ; этот код будет в PFA нового	словаря
   5048	      18CFr
   5049									  ; в CFA словаря попадет код $DOE, который
   5050									  ; передает управлению	коду по	адресу PFA
   5051									  ; в стек кладет адрес	PFA+2
   5052
   5053
   5054						  HEAD	  301Q,,250Q,PAREN,$COL		       ; (
1  5055	      =ARRAY:27AC		 LINK$=$
1  5056	27AC  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  5057							 ; 6 - признак immediate. 5- слово не описано smudge
1  5058	27AD  A8			     DB	 250Q	; последний символ слова + 128 (7 бит =	1).
1  5059	27AE  2777r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5060	      =ARRAY:27AC		 LINK=LINK$
1  5061	27B0				 PAREN LABEL FAR  ; CFA
1  5062	27B0  1F67r			     DW	$COL
   5063					     ; пропуск до следующей )
   5064	27B2  0FD3r 0029 242Cr	  +		  DW  LIT,29h,$WORD,SEMI
   5065	      18CFr
   5066
   5067						  HEAD	  84h,'QUI',324Q,QUIT,$COL	      ;	QUIT
1  5068	      =ARRAY:27BA		 LINK$=$
1  5069	27BA  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5070							 ; 6 - признак immediate. 5- слово не описано smudge
1  5071	27BB  51 55 49			     DB	 'QUI'
1  5072	27BE  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  5073	27BF  27ACr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 90
forth.asm



1  5074	      =ARRAY:27BA		 LINK=LINK$
1  5075	27C1				 QUIT LABEL FAR	 ; CFA
1  5076	27C1  1F67r			     DW	$COL
   5077					 ; Очищает оба стека и возвращает управление терминалу.
   5078					 ; Не выдается никаких сообщений
   5079	27C3  2050r 2116r 1C9Cr	  +		  DW  ZERO,BLK,STORE,LBRAC
   5080	      1D9Er
   5081	27CB  18B3r 2215r 23DBr	  +	QUI:	  DW  RPSTO,CR,QUERY,INTER,STATE,AT
   5082	      2725r 2168r 1C42r
   5083	27D7  1164r 101Ar FFF0	  +		  DW  ZEQU,ZBRAN,QUI-$,PDOTQ
   5084	      2392r
   5085	27DF  03 20 4F 4B			  DB  3,' OK'
   5086	27E3  103Fr FFE6			  DW  BRAN,QUI-$
   5087
   5088						  HEAD	  85h,'ABOR',324Q,ABORT,$COL	      ;	ABORT
1  5089	      =ARRAY:27E7		 LINK$=$
1  5090	27E7  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5091							 ; 6 - признак immediate. 5- слово не описано smudge
1  5092	27E8  41 42 4F 52		     DB	 'ABOR'
1  5093	27EC  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  5094	27ED  27BAr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5095	      =ARRAY:27E7		 LINK=LINK$
1  5096	27EF				 ABORT LABEL FAR  ; CFA
1  5097	27EF  1F67r			     DW	$COL
   5098					 ; Прерывает исполнение, делает	словарь	Форт контекстным,
   5099					 ; выполняет QUIT. Распечатывает версию	интерпретатора
   5100	27F1  1897r 1DFAr 2215r	  +		  DW  SPSTO,DECIMA,CR,PDOTQ
   5101	      2392r
   5102	27F9  11 46 4F 52 54 48	2D+		  DB  17,'FORTH-PC IS HERE '
   5103	      50 43 20 49 53 20	48+
   5104	      45 52 45 20
   5105	280B  2F97r 1EB8r 27C1r			  DW  FORTH,DEFIN,QUIT
   5106
   5107						  HEAD	  82h,'S',256Q,SPOT,$COL	      ;	S.
1  5108	      =ARRAY:2811		 LINK$=$
1  5109	2811  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5110							 ; 6 - признак immediate. 5- слово не описано smudge
1  5111	2812  53			     DB	 'S'
1  5112	2813  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  5113	2814  27E7r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5114	      =ARRAY:2811		 LINK=LINK$
1  5115	2816				 SPOT LABEL FAR	 ; CFA
1  5116	2816  1F67r			     DW	$COL
   5117					 ; печать верхнего значения со стека без его изменения
   5118	2818  1A58r 2C91r 18CFr			  DW  DUBL,UDOT,SEMI
   5119
   5120						  HEAD	  81h,,252Q,STAR,$COL		      ;	*
1  5121	      =ARRAY:281E		 LINK$=$
1  5122	281E  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  5123							 ; 6 - признак immediate. 5- слово не описано smudge
1  5124	281F  AA			     DB	 252Q	; последний символ слова + 128 (7 бит =	1).
1  5125	2820  2811r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5126	      =ARRAY:281E		 LINK=LINK$
1  5127	2822				 STAR LABEL FAR	 ; CFA
1  5128	2822  1F67r			     DW	$COL
   5129	2824  168Ar 1B21r 18CFr			  DW  MSTAR,DROP,SEMI
   5130
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 91
forth.asm



   5131						  HEAD	  84h,'/MO',304Q,SLMOD,$COL	      ;	/MOD
1  5132	      =ARRAY:282A		 LINK$=$
1  5133	282A  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5134							 ; 6 - признак immediate. 5- слово не описано smudge
1  5135	282B  2F 4D 4F			     DB	 '/MO'
1  5136	282E  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  5137	282F  281Er			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5138	      =ARRAY:282A		 LINK=LINK$
1  5139	2831				 SLMOD LABEL FAR  ; CFA
1  5140	2831  1F67r			     DW	$COL
   5141					 ; n1 n2 --- rem quot
   5142	2833  190Er 1827r 192Cr	  +		  DW  TOR,STOD,FROMR,MSLAS,SEMI
   5143	      16F0r 18CFr
   5144
   5145						  HEAD	  81h,,257Q,SLASH,$COL		      ;	/
1  5146	      =ARRAY:283D		 LINK$=$
1  5147	283D  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  5148							 ; 6 - признак immediate. 5- слово не описано smudge
1  5149	283E  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  5150	283F  282Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5151	      =ARRAY:283D		 LINK=LINK$
1  5152	2841				 SLASH LABEL FAR  ; CFA
1  5153	2841  1F67r			     DW	$COL
   5154	2843  2831r 1A0Cr 1B21r	  +		  DW  SLMOD,SWAP,DROP,SEMI
   5155	      18CFr
   5156
   5157						  HEAD	  83h,'MO',304Q,$MOD,$COL	      ;	MOD
1  5158	      =ARRAY:284B		 LINK$=$
1  5159	284B  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  5160							 ; 6 - признак immediate. 5- слово не описано smudge
1  5161	284C  4D 4F			     DB	 'MO'
1  5162	284E  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  5163	284F  283Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5164	      =ARRAY:284B		 LINK=LINK$
1  5165	2851				 $MOD LABEL FAR	 ; CFA
1  5166	2851  1F67r			     DW	$COL
   5167	2853  2831r 1B21r 18CFr			  DW  SLMOD,DROP,SEMI
   5168
   5169						  HEAD	  85h,'*/MO',304Q,SSMOD,$COL	      ;. */MOD
1  5170	      =ARRAY:2859		 LINK$=$
1  5171	2859  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5172							 ; 6 - признак immediate. 5- слово не описано smudge
1  5173	285A  2A 2F 4D 4F		     DB	 '*/MO'
1  5174	285E  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  5175	285F  284Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5176	      =ARRAY:2859		 LINK=LINK$
1  5177	2861				 SSMOD LABEL FAR  ; CFA
1  5178	2861  1F67r			     DW	$COL
   5179					 ; u1 u2 u3 -->	u-rem u-result
   5180					 ; u1*u2/u3 - остаток и	частное, u1 u2 - 32-разрядное число
   5181
   5182	2863  190Er 168Ar 192Cr	  +		  DW  TOR,MSTAR,FROMR,MSLAS,SEMI
   5183	      16F0r 18CFr
   5184
   5185						  HEAD	  82h,'*',257Q,SSLA,$COL	      ;	*/
1  5186	      =ARRAY:286D		 LINK$=$
1  5187	286D  82			     DB	 82h  ;	NFA 7 бит равен	1.
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 92
forth.asm



1  5188							 ; 6 - признак immediate. 5- слово не описано smudge
1  5189	286E  2A			     DB	 '*'
1  5190	286F  AF			     DB	 257Q	; последний символ слова + 128 (7 бит =	1).
1  5191	2870  2859r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5192	      =ARRAY:286D		 LINK=LINK$
1  5193	2872				 SSLA LABEL FAR	 ; CFA
1  5194	2872  1F67r			     DW	$COL
   5195	2874  2861r 1A0Cr 1B21r	  +		  DW  SSMOD,SWAP,DROP,SEMI
   5196	      18CFr
   5197
   5198						  HEAD	  85h,'M/MO',304Q,MSMOD,$COL	      ;	M/MOD
1  5199	      =ARRAY:287C		 LINK$=$
1  5200	287C  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5201							 ; 6 - признак immediate. 5- слово не описано smudge
1  5202	287D  4D 2F 4D 4F		     DB	 'M/MO'
1  5203	2881  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  5204	2882  286Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5205	      =ARRAY:287C		 LINK=LINK$
1  5206	2884				 MSMOD LABEL FAR  ; CFA
1  5207	2884  1F67r			     DW	$COL
   5208	2886  190Er 2050r 1949r	  +		  DW  TOR,ZERO,I,USLAS,FROMR,SWAP,TOR,USLAS
   5209	      166Br 192Cr 1A0Cr	  +
   5210	      190Er 166Br
   5211	2896  192Cr 18CFr		$MO:	  DW  FROMR,SEMI
   5212
   5213						  HEAD	  215Q,'EMPTY-BUFFER',323Q,MTBUF,$COL  ;EMPTY-BUFFERS
1  5214	      =ARRAY:289A		 LINK$=$
1  5215	289A  8D			     DB	 215Q  ; NFA 7 бит равен 1.
1  5216							 ; 6 - признак immediate. 5- слово не описано smudge
1  5217	289B  45 4D 50 54 59 2D	42+	     DB	 'EMPTY-BUFFER'
   5218	      55 46 46 45 52
1  5219	28A7  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  5220	28A8  287Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5221	      =ARRAY:289A		 LINK=LINK$
1  5222	28AA				 MTBUF LABEL FAR  ; CFA
1  5223	28AA  1F67r			     DW	$COL
   5224	28AC  20EDr 1C42r 0FD3r	  +		  DW  FIRST,AT,LIT,0C12h,ERASE,SEMI   ;	3084 было
   5225	      0C12 1BAFr 18CFr
   5226
   5227						  HEAD	  85h,'FLUS',310Q,FLUSH,$COL	      ;	FLUSH
1  5228	      =ARRAY:28B8		 LINK$=$
1  5229	28B8  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5230							 ; 6 - признак immediate. 5- слово не описано smudge
1  5231	28B9  46 4C 55 53		     DB	 'FLUS'
1  5232	28BD  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1  5233	28BE  289Ar			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5234	      =ARRAY:28B8		 LINK=LINK$
1  5235	28C0				 FLUSH LABEL FAR  ; CFA
1  5236	28C0  1F67r			     DW	$COL
   5237					 ; запись буферов на диск
   5238	28C2  20F9r 1C42r 20EDr	  +		  DW  LIMIT,AT,FIRST,AT,XDO
   5239	      1C42r 105Br
   5240	28CC  1949r 1C42r 11B9r	  +	FLU:	  DW  I,AT,ZLESS,ZBRAN,FL1-$
   5241	      101Ar 000E
   5242	28D6  1949r 15DDr 1949r	  +		  DW  I,TWOP,I,X,ZERO, RW
   5243	      1F35r 2050r 2EF5r
   5244	28E2  0FD3r 0404 10B2r	  +	FL1:	  DW  LIT,1028,XPLOO,FLU-$,MTBUF,SEMI
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 93
forth.asm



   5245	      FFE4 28AAr 18CFr
   5246
   5247						  HEAD	  86h,'BUFFE',322Q,BUFFE,$COL	      ;	BUFFER
1  5248	      =ARRAY:28EE		 LINK$=$
1  5249	28EE  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  5250							 ; 6 - признак immediate. 5- слово не описано smudge
1  5251	28EF  42 55 46 46 45		     DB	 'BUFFE'
1  5252	28F4  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  5253	28F5  28B8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5254	      =ARRAY:28EE		 LINK=LINK$
1  5255	28F7				 BUFFE LABEL FAR  ; CFA
1  5256	28F7  1F67r			     DW	$COL
   5257					 ; u --> адр  Резервирует блок в памяти, приписывает ему
   5258					 ; номер u, но никакого	чтения с носителя не производится
   5259	28F9  21A4r 1C42r 190Er	  +		  DW  USE,AT,TOR,I	 ; адрес буфера	в стеках
   5260	      1949r
   5261	2901  1ED8r 101Ar FFFC		BR1:	  DW  PBUF,ZBRAN,BR1-$	 ; ищем	свободный буфер
   5262	2907  21A4r 1C9Cr			 DW USE,STORE		 ; полученный адрес сохранить в	USE
   5263	290B  1949r 1C42r 11B9r	  +		  DW  I,AT,ZLESS,ZBRAN,BR2-$ ; если buffer изменен,
   5264	      101Ar 000E
   5265	2915  1949r 15DDr 1949r	  +		  DW  I,TWOP,I,X,ZERO, RW    ; то запись его на	диск
   5266	      1F35r 2050r 2EF5r
   5267	2921  1949r 1C9Cr 1949r	  +	BR2:	  DW  I,STORE,I,PREV,STORE   ; номер буфера записать и адрес сохранить в PREV
   5268	      21AFr 1C9Cr
   5269	292B  192Cr 15DDr 18CFr			 DW FROMR,TWOP,SEMI	     ; возвращаемое значение
   5270
   5271						  HEAD	  85h,'BLOC',313Q,BLOCK,$COL	      ;	BLOCK
1  5272	      =ARRAY:2931		 LINK$=$
1  5273	2931  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5274							 ; 6 - признак immediate. 5- слово не описано smudge
1  5275	2932  42 4C 4F 43		     DB	 'BLOC'
1  5276	2936  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
1  5277	2937  28EEr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5278	      =ARRAY:2931		 LINK=LINK$
1  5279	2939				 BLOCK LABEL FAR  ; CFA
1  5280	2939  1F67r			     DW	$COL
   5281					 ;   u --> адр	Записывает в стек адрес	первого	байта в	блоке с
   5282					 ;   номером u.	Если блок не находится в памяти, он переносится	с носителя
   5283	293B  2140r 1C42r 170Er	  +		  DW  OFSET,AT,PLUS,TOR
   5284	      190Er
   5285	2943  21AFr 1C42r 1A58r	  +		  DW  PREV,AT,DUBL,X,I,SUBB,ZBRAN,BLC-$
   5286	      1F35r 1949r 172Ar	  +
   5287	      101Ar 002E
   5288	2953  1ED8r 1164r 101Ar	  +	BLO:	  DW  PBUF,ZEQU,ZBRAN,BCK-$
   5289	      0012
   5290	295B  1B21r 1949r 28F7r	  +		  DW  DROP,I,BUFFE,DUBL,I,ONE,RW,CFA
   5291	      1A58r 1949r 2058r	  +
   5292	      2EF5r 1D05r
   5293	296B  1A58r 1F35r 1949r	  +	BCK:	  DW  DUBL,X,I,SUBB,ZEQU
   5294	      172Ar 1164r
   5295	2975  101Ar FFDC 1A58r	  +		  DW  ZBRAN,BLO-$,DUBL,PREV,STORE
   5296	      21AFr 1C9Cr
   5297	297F  192Cr 1B21r 15DDr	  +	BLC:	  DW  FROMR,DROP,TWOP,SEMI
   5298	      18CFr
   5299
   5300						  HEAD	  85h,'.LIN',305Q,DLINE,$COL	      ;	.LINE
1  5301	      =ARRAY:2987		 LINK$=$
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 94
forth.asm



1  5302	2987  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5303							 ; 6 - признак immediate. 5- слово не описано smudge
1  5304	2988  2E 4C 49 4E		     DB	 '.LIN'
1  5305	298C  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  5306	298D  2931r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5307	      =ARRAY:2987		 LINK=LINK$
1  5308	298F				 DLINE LABEL FAR  ; CFA
1  5309	298F  1F67r			     DW	$COL
   5310					 ; строка номер_экрана -- печать строки	из экрана
   5311	2991  190Er 2082r 208Br	  +		  DW  TOR,$CL,BBUF,SSMOD ; строка*64/1024
   5312	      2861r
   5313	2999  192Cr 170Er 2939r			  DW  FROMR,PLUS,BLOCK	 ; номер_экрана	+ частное
   5314	299F  170Er				  DW  PLUS	     ; остаток+	адрес_блока (нужная строка)
   5315	29A1  2082r 1E5Cr 2365r	  +		  DW  $CL,DTRAI,$TYPE,SEMI ; 64	- число	пробелов (число	символов в строке)
   5316	      18CFr
   5317
   5318						  HEAD	  87h,'MESSAG',305Q,MESS,$COL	      ;	MESSAGE
1  5319	      =ARRAY:29A9		 LINK$=$
1  5320	29A9  87			     DB	 87h  ;	NFA 7 бит равен	1.
1  5321							 ; 6 - признак immediate. 5- слово не описано smudge
1  5322	29AA  4D 45 53 53 41 47		     DB	 'MESSAG'
1  5323	29B0  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  5324	29B1  2987r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5325	      =ARRAY:29A9		 LINK=LINK$
1  5326	29B3				 MESS LABEL FAR	 ; CFA
1  5327	29B3  1F67r			     DW	$COL
   5328	29B5  211Fr 1C42r 2190r	  +		  DW  $IN,AT,RNUM,STORE	; сохранить значение $in
   5329	      1C9Cr
   5330	29BD  20C1r 1C42r 101Ar	  +		  DW  $WARN,AT,ZBRAN,MS1-$ ; нужен ли текст сообщения
   5331	      0016
   5332	29C5  1A75r 101Ar 000E			  DW  DDUP,ZBRAN,MES-$
   5333	29CB  0FD3r 0004 2140r	  +		  DW  LIT,4,OFSET,AT,SUBB,DLINE	; текстовые сообщения на 4 экране
   5334	      1C42r 172Ar 298Fr
   5335	29D7  18CFr			MES:	  DW  SEMI
   5336	29D9  2392r			MS1:	  DW  PDOTQ
   5337	29DB  06 4D 53 47 20 23	20		  DB  6,'MSG # '
   5338	29E2  2C78r 18CFr			  DW $DOT,SEMI
   5339
   5340						  HEAD	  84h,'LOA',304Q,LOA,$COL	     ; LOAD
1  5341	      =ARRAY:29E6		 LINK$=$
1  5342	29E6  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5343							 ; 6 - признак immediate. 5- слово не описано smudge
1  5344	29E7  4C 4F 41			     DB	 'LOA'
1  5345	29EA  C4			     DB	 304Q	; последний символ слова + 128 (7 бит =	1).
1  5346	29EB  29A9r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5347	      =ARRAY:29E6		 LINK=LINK$
1  5348	29ED				 LOA LABEL FAR	; CFA
1  5349	29ED  1F67r			     DW	$COL
   5350					 ; n ->	номер экрана
   5351	29EF  2116r 1C42r 211Fr	  +		  DW  BLK,AT,$IN,AT,ZERO,$IN,STORE,ROT,BLK
   5352	      1C42r 2050r 211Fr	  +
   5353	      1C9Cr 1AA5r 2116r
   5354	2A01  1C9Cr 2725r 211Fr	  +		  DW  STORE,INTER,$IN,STORE,BLK,STORE,SEMI
   5355	      1C9Cr 2116r 1C9Cr	  +
   5356	      18CFr
   5357
   5358						  HEAD	  303Q,'--',276Q,ARROW,$COL	       ; -->
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 95
forth.asm



1  5359	      =ARRAY:2A0F		 LINK$=$
1  5360	2A0F  C3			     DB	 303Q  ; NFA 7 бит равен 1.
1  5361							 ; 6 - признак immediate. 5- слово не описано smudge
1  5362	2A10  2D 2D			     DB	 '--'
1  5363	2A12  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1  5364	2A13  29E6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5365	      =ARRAY:2A0F		 LINK=LINK$
1  5366	2A15				 ARROW LABEL FAR  ; CFA
1  5367	2A15  1F67r			     DW	$COL
   5368					 ; згрузка следующего экрана
   5369	2A17  22E3r 2050r 211Fr	  +		  DW  QLOAD,ZERO,$IN,STORE,ONE
   5370	      1C9Cr 2058r
   5371	2A21  2116r 1BEDr 18CFr			  DW  BLK,PSTOR,SEMI
   5372
   5373						  HEAD	  301Q,,247Q,TICK,$COL		       ; '
1  5374	      =ARRAY:2A27		 LINK$=$
1  5375	2A27  C1			     DB	 301Q  ; NFA 7 бит равен 1.
1  5376							 ; 6 - признак immediate. 5- слово не описано smudge
1  5377	2A28  A7			     DB	 247Q	; последний символ слова + 128 (7 бит =	1).
1  5378	2A29  2A0Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5379	      =ARRAY:2A27		 LINK=LINK$
1  5380	2A2B				 TICK LABEL FAR	 ; CFA
1  5381	2A2B  1F67r			     DW	$COL
   5382					 ; Ищет	слово XXX в словаре и записывает в стек	его PFA
   5383	2A2D  24BDr 1164r 2050r	  +		  DW  DFIND,ZEQU,ZERO,QERR,DROP,TWOP,LITER,SEMI
   5384	      2270r 1B21r 15DDr	  +
   5385	      26C3r 18CFr
   5386
   5387						  HEAD	  86h,'FORGE',324Q,FORGE,$COL	      ;	FORGET
1  5388	      =ARRAY:2A3D		 LINK$=$
1  5389	2A3D  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  5390							 ; 6 - признак immediate. 5- слово не описано smudge
1  5391	2A3E  46 4F 52 47 45		     DB	 'FORGE'
1  5392	2A43  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  5393	2A44  2A27r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5394	      =ARRAY:2A3D		 LINK=LINK$
1  5395	2A46				 FORGE LABEL FAR  ; CFA
1  5396	2A46  1F67r			     DW	$COL
   5397	2A48  215Cr 1C42r 214Er	  +		  DW  CURR,AT,CONT,AT,SUBB,LIT,30Q,QERR	    ; 24 ошибка	не описана
   5398	      1C42r 172Ar 0FD3r	  +
   5399	      0018 2270r
   5400											     ; ошибка если CURRENT = CONTEXT
   5401	2A58  2A2Br 1A58r 20CDr	  +		  DW  TICK,DUBL,FENCE,AT,ULESS,LIT,25Q,QERR  ; 21 слово	защищено
   5402	      1C42r 11F7r 0FD3r	  +
   5403	      0015 2270r
   5404	2A68  1A58r 1CD5r 20D6r	  +		  DW  DUBL,NFA,$DP,STORE		    ; словарь свободен до указаного слова
   5405	      1C9Cr
   5406	2A70  1CE7r 1C42r 214Er	  +		  DW  LFA,AT,CONT,AT,STORE,SEMI		    ; в	переменную context пишем адрес
   5407	      1C42r 1C9Cr 18CFr
   5408										     ; значение	LFA забываемого	слова
   5409
   5410						  HEAD	  84h,'BAC',313Q,BACK,$COL	      ;	BACK
1  5411	      =ARRAY:2A7C		 LINK$=$
1  5412	2A7C  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5413							 ; 6 - признак immediate. 5- слово не описано smudge
1  5414	2A7D  42 41 43			     DB	 'BAC'
1  5415	2A80  CB			     DB	 313Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 96
forth.asm



1  5416	2A81  2A3Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5417	      =ARRAY:2A7C		 LINK=LINK$
1  5418	2A83				 BACK LABEL FAR	 ; CFA
1  5419	2A83  1F67r			     DW	$COL
   5420					 ; HERE	- , ; (компилирует в описание слова адрес возврата)
   5421	2A85  1D41r 172Ar 2229r	  +		  DW  HERE,SUBB,COMMA,SEMI
   5422	      18CFr
   5423
   5424						  HEAD	  305Q,'BEGI',316Q,BEGIN,$COL	       ; BEGIN
1  5425	      =ARRAY:2A8D		 LINK$=$
1  5426	2A8D  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  5427							 ; 6 - признак immediate. 5- слово не описано smudge
1  5428	2A8E  42 45 47 49		     DB	 'BEGI'
1  5429	2A92  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  5430	2A93  2A7Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5431	      =ARRAY:2A8D		 LINK=LINK$
1  5432	2A95				 BEGIN LABEL FAR  ; CFA
1  5433	2A95  1F67r			     DW	$COL
   5434					 ; BEGIN ... UNTIL
   5435					 ; BEGIN ... AGAIN
   5436					 ; BEGIN ... WHILE ... REPEAT
   5437	2A97  2288r 1D41r 2058r	  +		  DW  QCOMP,HERE,ONE,SEMI
   5438	      18CFr
   5439
   5440						  HEAD	  302Q,'D',317Q,$DO,$COL	       ; DO
1  5441	      =ARRAY:2A9F		 LINK$=$
1  5442	2A9F  C2			     DB	 302Q  ; NFA 7 бит равен 1.
1  5443							 ; 6 - признак immediate. 5- слово не описано smudge
1  5444	2AA0  44			     DB	 'D'
1  5445	2AA1  CF			     DB	 317Q	; последний символ слова + 128 (7 бит =	1).
1  5446	2AA2  2A8Dr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5447	      =ARRAY:2A9F		 LINK=LINK$
1  5448	2AA4				 $DO LABEL FAR	; CFA
1  5449	2AA4  1F67r			     DW	$COL
   5450	2AA6  22FDr 105Br 1D41r	  +		  DW  COMP,XDO,HERE,THREE,SEMI
   5451	      2068r 18CFr
   5452
   5453						  HEAD	  304Q,'LOO',320Q,LOO,$COL	      ;	LOOP
1  5454	      =ARRAY:2AB0		 LINK$=$
1  5455	2AB0  C4			     DB	 304Q  ; NFA 7 бит равен 1.
1  5456							 ; 6 - признак immediate. 5- слово не описано smudge
1  5457	2AB1  4C 4F 4F			     DB	 'LOO'
1  5458	2AB4  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  5459	2AB5  2A9Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5460	      =ARRAY:2AB0		 LINK=LINK$
1  5461	2AB7				 LOO LABEL FAR	; CFA
1  5462	2AB7  1F67r			     DW	$COL
   5463	2AB9  2068r 22B6r 22FDr	  +		  DW  THREE,QPAIR,COMP,XLOOP,BACK,SEMI
   5464	      1084r 2A83r 18CFr
   5465
   5466						  HEAD	  305Q,'+LOO',320Q,PLOOP,$COL	       ; +LOOP
1  5467	      =ARRAY:2AC5		 LINK$=$
1  5468	2AC5  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  5469							 ; 6 - признак immediate. 5- слово не описано smudge
1  5470	2AC6  2B 4C 4F 4F		     DB	 '+LOO'
1  5471	2ACA  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  5472	2ACB  2AB0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 97
forth.asm



1  5473	      =ARRAY:2AC5		 LINK=LINK$
1  5474	2ACD				 PLOOP LABEL FAR  ; CFA
1  5475	2ACD  1F67r			     DW	$COL
   5476	2ACF  2068r 22B6r 22FDr	  +		  DW  THREE,QPAIR,COMP,XPLOO,BACK,SEMI
   5477	      10B2r 2A83r 18CFr
   5478
   5479						  HEAD	  305Q,'UNTI',314Q,UNTIL,$COL	       ; UNTIL
1  5480	      =ARRAY:2ADB		 LINK$=$
1  5481	2ADB  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  5482							 ; 6 - признак immediate. 5- слово не описано smudge
1  5483	2ADC  55 4E 54 49		     DB	 'UNTI'
1  5484	2AE0  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  5485	2AE1  2AC5r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5486	      =ARRAY:2ADB		 LINK=LINK$
1  5487	2AE3				 UNTIL LABEL FAR  ; CFA
1  5488	2AE3  1F67r			     DW	$COL
   5489	2AE5  2058r 22B6r 22FDr	  +		  DW  ONE,QPAIR,COMP,ZBRAN,BACK,SEMI
   5490	      101Ar 2A83r 18CFr
   5491
   5492						 HEAD	 305Q,'AGAI','N'+80h,AGAIN,$COL	       ; AGAIN sds
1  5493	      =ARRAY:2AF1		 LINK$=$
1  5494	2AF1  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  5495							 ; 6 - признак immediate. 5- слово не описано smudge
1  5496	2AF2  41 47 41 49		     DB	 'AGAI'
1  5497	2AF6  CE			     DB	 'N'+80h   ; последний символ слова + 128 (7 бит = 1).
1  5498	2AF7  2ADBr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5499	      =ARRAY:2AF1		 LINK=LINK$
1  5500	2AF9				 AGAIN LABEL FAR  ; CFA
1  5501	2AF9  1F67r			     DW	$COL
   5502	2AFB  2058r 22B6r 22FDr	  +		 DW  ONE,QPAIR,COMP,BRAN,BACK,SEMI
   5503	      103Fr 2A83r 18CFr
   5504
   5505						  HEAD	  305Q,'WHIL',305Q,$WHILE,$COL	       ; WHILE
1  5506	      =ARRAY:2B07		 LINK$=$
1  5507	2B07  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  5508							 ; 6 - признак immediate. 5- слово не описано smudge
1  5509	2B08  57 48 49 4C		     DB	 'WHIL'
1  5510	2B0C  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  5511	2B0D  2AF1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5512	      =ARRAY:2B07		 LINK=LINK$
1  5513	2B0F				 $WHILE	LABEL FAR  ; CFA
1  5514	2B0F  1F67r			     DW	$COL
   5515	2B11  2B37r 18CFr			  DW  $IF,SEMI
   5516
   5517						  HEAD	  306Q,'REPEA',324Q,REPEA,$COL	      ;	REPEAT
1  5518	      =ARRAY:2B15		 LINK$=$
1  5519	2B15  C6			     DB	 306Q  ; NFA 7 бит равен 1.
1  5520							 ; 6 - признак immediate. 5- слово не описано smudge
1  5521	2B16  52 45 50 45 41		     DB	 'REPEA'
1  5522	2B1B  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  5523	2B1C  2B07r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5524	      =ARRAY:2B15		 LINK=LINK$
1  5525	2B1E				 REPEA LABEL FAR  ; CFA
1  5526	2B1E  1F67r			     DW	$COL
   5527	2B20  1AA5r 2058r 22B6r	  +		  DW  ROT,ONE,QPAIR,ROT,COMP,BRAN,BACK
   5528	      1AA5r 22FDr 103Fr	  +
   5529	      2A83r
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 98
forth.asm



   5530	2B2E  2B6Fr 18CFr			  DW  THEN,SEMI
   5531
   5532						  HEAD	  302Q,'I',306Q,$IF,$COL	       ; IF
1  5533	      =ARRAY:2B32		 LINK$=$
1  5534	2B32  C2			     DB	 302Q  ; NFA 7 бит равен 1.
1  5535							 ; 6 - признак immediate. 5- слово не описано smudge
1  5536	2B33  49			     DB	 'I'
1  5537	2B34  C6			     DB	 306Q	; последний символ слова + 128 (7 бит =	1).
1  5538	2B35  2B15r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5539	      =ARRAY:2B32		 LINK=LINK$
1  5540	2B37				 $IF LABEL FAR	; CFA
1  5541	2B37  1F67r			     DW	$COL
   5542	2B39  22FDr 101Ar 1D41r	  +		  DW  COMP,ZBRAN,HERE,ZERO,COMMA,TWO,SEMI
   5543	      2050r 2229r 2060r	  +
   5544	      18CFr
   5545
   5546						  HEAD	  304Q,'ELS',305Q,$ELSE,$COL	       ; ELSE
1  5547	      =ARRAY:2B47		 LINK$=$
1  5548	2B47  C4			     DB	 304Q  ; NFA 7 бит равен 1.
1  5549							 ; 6 - признак immediate. 5- слово не описано smudge
1  5550	2B48  45 4C 53			     DB	 'ELS'
1  5551	2B4B  C5			     DB	 305Q	; последний символ слова + 128 (7 бит =	1).
1  5552	2B4C  2B32r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5553	      =ARRAY:2B47		 LINK=LINK$
1  5554	2B4E				 $ELSE LABEL FAR  ; CFA
1  5555	2B4E  1F67r			     DW	$COL
   5556	2B50  2060r 22B6r 22FDr			  DW  TWO,QPAIR,COMP
   5557	2B56  103Fr 1D41r 2050r	  +		  DW  BRAN,HERE,ZERO,COMMA   ; если исполнение пришло к	этому BRAN
   5558	      2229r
   5559									     ; значит была выполнена ветка TRUE	и
   5560									     ; надо перепрыгнуть ветку FALSE (безусловно)
   5561	2B5E  1A0Cr 2060r 2B6Fr	  +		  DW  SWAP,TWO,THEN,TWO,SEMI ; адреса переходов	меняем местами,	т.к.
   5562	      2060r 18CFr
   5563									     ; по условию FALSE	должен выполниться
   5564									     ; код после слова ELSE, воспользуемся
   5565									     ; для этого словом	THEN
   5566
   5567						  HEAD	  304Q,'THE',316Q,THEN,$COL	       ; THEN
1  5568	      =ARRAY:2B68		 LINK$=$
1  5569	2B68  C4			     DB	 304Q  ; NFA 7 бит равен 1.
1  5570							 ; 6 - признак immediate. 5- слово не описано smudge
1  5571	2B69  54 48 45			     DB	 'THE'
1  5572	2B6C  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  5573	2B6D  2B47r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5574	      =ARRAY:2B68		 LINK=LINK$
1  5575	2B6F				 THEN LABEL FAR	 ; CFA
1  5576	2B6F  1F67r			     DW	$COL
   5577	2B71  2288r 2060r 22B6r	  +		  DW  QCOMP,TWO,QPAIR,HERE,OVER,SUBB,SWAP,STORE,SEMI
   5578	      1D41r 19ECr 172Ar	  +
   5579	      1A0Cr 1C9Cr 18CFr
   5580					 ; if -	step	  cond if true else false then
   5581					     ; DICT:  ?BRANCH 0
   5582					     ; STACK:  adr_if
   5583					 ; else	- step получается слишком много	кода...	Вроде разобрался! :)
   5584					     ; ?BRANCH 0     BRANCH 0
   5585					     ;	adr_else adr_if
   5586					 ; then	- step
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 99
forth.asm



   5587					     ;1	DICT:  ?BRANCH 0
   5588					     ;1	STACK:	adr_if
   5589					     ;2	STACK:	adr_if adr_then
   5590					     ;3	STACK:	adr_if adr_then	 adr_if
   5591					     ;4	STACK:	adr_if (adr_if-adr_then)
   5592					     ;4	STACK:	(adr_if-adr_then) adr_if
   5593					     ;5	DICT:  ?BRANCH [adr_if]=(adr_if-adr_then)
   5594					     ;5	STACK:
   5595
   5596						  HEAD	  86h,'SPACE',323Q,SPACS,$COL	      ;	SPACES
1  5597	      =ARRAY:2B83		 LINK$=$
1  5598	2B83  86			     DB	 86h  ;	NFA 7 бит равен	1.
1  5599							 ; 6 - признак immediate. 5- слово не описано smudge
1  5600	2B84  53 50 41 43 45		     DB	 'SPACE'
1  5601	2B89  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  5602	2B8A  2B68r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5603	      =ARRAY:2B83		 LINK=LINK$
1  5604	2B8C				 SPACS LABEL FAR  ; CFA
1  5605	2B8C  1F67r			     DW	$COL
   5606	2B8E  2050r 187Ar 1A75r	  +		  DW  ZERO,MAX,DDUP,ZBRAN,SP1-$,ZERO,XDO
   5607	      101Ar 000C 2050r	  +
   5608	      105Br
   5609	2B9C  224Er 1084r FFFC		SPA:	  DW  SPACE,XLOOP,SPA-$
   5610	2BA2  18CFr			SP1:	  DW  SEMI
   5611
   5612						  HEAD	  82h,'#',243Q,BDIGS,$COL	      ;	<# ; sds replace
1  5613	      =ARRAY:2BA4		 LINK$=$
1  5614	2BA4  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5615							 ; 6 - признак immediate. 5- слово не описано smudge
1  5616	2BA5  23			     DB	 '#'
1  5617	2BA6  A3			     DB	 243Q	; последний символ слова + 128 (7 бит =	1).
1  5618	2BA7  2B83r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5619	      =ARRAY:2BA4		 LINK=LINK$
1  5620	2BA9				 BDIGS LABEL FAR  ; CFA
1  5621	2BA9  1F67r			     DW	$COL
   5622					 ; Начинает процесс преобразования числа в последовательность кодов ASCII.
   5623					 ; Исходное число в стеке должно быть двойной длины без	знака
   5624	2BAB  2419r 219Ar 1C9Cr	  +		  DW  PAD,HLD,STORE,SEMI
   5625	      18CFr
   5626
   5627						  HEAD	  82h,'#',276Q,EDIGS,$COL	      ;	#>
1  5628	      =ARRAY:2BB3		 LINK$=$
1  5629	2BB3  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5630							 ; 6 - признак immediate. 5- слово не описано smudge
1  5631	2BB4  23			     DB	 '#'
1  5632	2BB5  BE			     DB	 276Q	; последний символ слова + 128 (7 бит =	1).
1  5633	2BB6  2BA4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5634	      =ARRAY:2BB3		 LINK=LINK$
1  5635	2BB8				 EDIGS LABEL FAR  ; CFA
1  5636	2BB8  1F67r			     DW	$COL
   5637					 ; Завершает преобразование числа. В стеке остается число
   5638					 ; полученных символов и адрес,	как это	требуется для
   5639					 ; оператора TYPE
   5640	2BBA  1B04r 219Ar 1C42r	  +		  DW  DDROP,HLD,AT,PAD,OVER,SUBB,SEMI
   5641	      2419r 19ECr 172Ar	  +
   5642	      18CFr
   5643
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 100
forth.asm



   5644						  HEAD	  84h,'SIG',316Q,SIGN,$COL	      ;	SIGN
1  5645	      =ARRAY:2BC8		 LINK$=$
1  5646	2BC8  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5647							 ; 6 - признак immediate. 5- слово не описано smudge
1  5648	2BC9  53 49 47			     DB	 'SIG'
1  5649	2BCC  CE			     DB	 316Q	; последний символ слова + 128 (7 бит =	1).
1  5650	2BCD  2BB3r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5651	      =ARRAY:2BC8		 LINK=LINK$
1  5652	2BCF				 SIGN LABEL FAR	 ; CFA
1  5653	2BCF  1F67r			     DW	$COL
   5654					 ; Вводит знак "минус" в выходной буфер
   5655	2BD1  1AA5r 11B9r 101Ar	  +		  DW  ROT,ZLESS,ZBRAN,SIG-$,LIT,55Q,HOLD
   5656	      0008 0FD3r 002D	  +
   5657	      1BCCr
   5658	2BDF  18CFr			SIG:	  DW  SEMI
   5659
   5660						  HEAD	  81h,,243Q,DIG,$COL		      ;	#
1  5661	      =ARRAY:2BE1		 LINK$=$
1  5662	2BE1  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  5663							 ; 6 - признак immediate. 5- слово не описано smudge
1  5664	2BE2  A3			     DB	 243Q	; последний символ слова + 128 (7 бит =	1).
1  5665	2BE3  2BC8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5666	      =ARRAY:2BE1		 LINK=LINK$
1  5667	2BE5				 DIG LABEL FAR	; CFA
1  5668	2BE5  1F67r			     DW	$COL
   5669					 ; Преобразует одну цифру и записывает ее в выходной буфер (PAD),
   5670					 ; выдает цифру	всегда,	если преобразовывать нечего, записывается 0
   5671	2BE7  2173r 1C42r 2884r	  +		  DW  BASE,AT,MSMOD,ROT,LIT,11Q,OVER,LESS
   5672	      1AA5r 0FD3r 0009	  +
   5673	      19ECr 1205r
   5674	2BF7  101Ar 0008 0FD3r	  +		  DW  ZBRAN,DIGI-$,LIT,7,PLUS
   5675	      0007 170Er
   5676	2C01  0FD3r 0030 170Er	  +	DIGI:	  DW  LIT,60Q,PLUS,HOLD,SEMI
   5677	      1BCCr 18CFr
   5678
   5679						  HEAD	  82h,'#',323Q,DIGS,$COL	      ;	#S
1  5680	      =ARRAY:2C0B		 LINK$=$
1  5681	2C0B  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5682							 ; 6 - признак immediate. 5- слово не описано smudge
1  5683	2C0C  23			     DB	 '#'
1  5684	2C0D  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  5685	2C0E  2BE1r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5686	      =ARRAY:2C0B		 LINK=LINK$
1  5687	2C10				 DIGS LABEL FAR	 ; CFA
1  5688	2C10  1F67r			     DW	$COL
   5689					 ; Преобразует число до	тех пор, пока не будет получен 0.
   5690					 ; Одна	цифра выдается в любом случае (0)
   5691	2C12  2BE5r 1A86r 180Ar	  +	DIS:	  DW  DIG,DUP2,$OR,ZEQU,ZBRAN,DIS-$,SEMI
   5692	      1164r 101Ar FFF6	  +
   5693	      18CFr
   5694
   5695						  HEAD	  83h,'D.',322Q,DDOTR,$COL	      ;	D.R
1  5696	      =ARRAY:2C20		 LINK$=$
1  5697	2C20  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  5698							 ; 6 - признак immediate. 5- слово не описано smudge
1  5699	2C21  44 2E			     DB	 'D.'
1  5700	2C23  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 101
forth.asm



1  5701	2C24  2C0Br			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5702	      =ARRAY:2C20		 LINK=LINK$
1  5703	2C26				 DDOTR LABEL FAR  ; CFA
1  5704	2C26  1F67r			     DW	$COL
   5705					 ; s width -> печать двойного числа со знаком с	выравниваем вправо
   5706	2C28  190Er 1A0Cr 19ECr	  +		  DW  TOR,SWAP,OVER,DABS,BDIGS,DIGS,SIGN,EDIGS
   5707	      16D1r 2BA9r 2C10r	  +
   5708	      2BCFr 2BB8r
   5709	2C38  192Cr 19ECr 172Ar	  +		  DW  FROMR,OVER,SUBB,SPACS,$TYPE,SEMI
   5710	      2B8Cr 2365r 18CFr
   5711
   5712						  HEAD	  82h,'.',322Q,DOTR,$COL	      ;	.R
1  5713	      =ARRAY:2C44		 LINK$=$
1  5714	2C44  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5715							 ; 6 - признак immediate. 5- слово не описано smudge
1  5716	2C45  2E			     DB	 '.'
1  5717	2C46  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  5718	2C47  2C20r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5719	      =ARRAY:2C44		 LINK=LINK$
1  5720	2C49				 DOTR LABEL FAR	 ; CFA
1  5721	2C49  1F67r			     DW	$COL
   5722					 ; s width -> печать числа со знаком с выравниваем вправо
   5723	2C4B  190Er 1827r 192Cr	  +		  DW  TOR,STOD,FROMR,DDOTR,SEMI
   5724	      2C26r 18CFr
   5725
   5726						  HEAD	  83h,'U.',322Q,UDOTR,$COL	      ;	U.R
1  5727	      =ARRAY:2C55		 LINK$=$
1  5728	2C55  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  5729							 ; 6 - признак immediate. 5- слово не описано smudge
1  5730	2C56  55 2E			     DB	 'U.'
1  5731	2C58  D2			     DB	 322Q	; последний символ слова + 128 (7 бит =	1).
1  5732	2C59  2C44r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5733	      =ARRAY:2C55		 LINK=LINK$
1  5734	2C5B				 UDOTR LABEL FAR  ; CFA
1  5735	2C5B  1F67r			     DW	$COL
   5736					 ; u width -> печать числа без знака с выравниваем вправо
   5737	2C5D  2050r 1A0Cr 2C26r	  +		  DW  ZERO,SWAP,DDOTR,SEMI
   5738	      18CFr
   5739
   5740						  HEAD	  82h,'D',256Q,DDOT,$COL	      ;	D.
1  5741	      =ARRAY:2C65		 LINK$=$
1  5742	2C65  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5743							 ; 6 - признак immediate. 5- слово не описано smudge
1  5744	2C66  44			     DB	 'D'
1  5745	2C67  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  5746	2C68  2C55r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5747	      =ARRAY:2C65		 LINK=LINK$
1  5748	2C6A				 DDOT LABEL FAR	 ; CFA
1  5749	2C6A  1F67r			     DW	$COL
   5750					 ; печать двойных чисел
   5751	2C6C  2050r 2C26r 224Er	  +		  DW  ZERO,DDOTR,SPACE,SEMI
   5752	      18CFr
   5753
   5754						  HEAD	  81h,,256Q,$DOT,$COL		      ;	.
1  5755	      =ARRAY:2C74		 LINK$=$
1  5756	2C74  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  5757							 ; 6 - признак immediate. 5- слово не описано smudge
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 102
forth.asm



1  5758	2C75  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  5759	2C76  2C65r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5760	      =ARRAY:2C74		 LINK=LINK$
1  5761	2C78				 $DOT LABEL FAR	 ; CFA
1  5762	2C78  1F67r			     DW	$COL
   5763	2C7A  1827r 2C6Ar 18CFr			  DW  STOD,DDOT,SEMI
   5764
   5765						  HEAD	  81h,,277Q,QUEST,$COL		      ;	?
1  5766	      =ARRAY:2C80		 LINK$=$
1  5767	2C80  81			     DB	 81h  ;	NFA 7 бит равен	1.
1  5768							 ; 6 - признак immediate. 5- слово не описано smudge
1  5769	2C81  BF			     DB	 277Q	; последний символ слова + 128 (7 бит =	1).
1  5770	2C82  2C74r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5771	      =ARRAY:2C80		 LINK=LINK$
1  5772	2C84				 QUEST LABEL FAR  ; CFA
1  5773	2C84  1F67r			     DW	$COL
   5774					 ; печать содержимого по адресу	в стеке
   5775	2C86  1C42r 2C78r 18CFr			  DW  AT,$DOT,SEMI
   5776
   5777						  HEAD	  82h,'U',256Q,UDOT,$COL	      ;	U.
1  5778	      =ARRAY:2C8C		 LINK$=$
1  5779	2C8C  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5780							 ; 6 - признак immediate. 5- слово не описано smudge
1  5781	2C8D  55			     DB	 'U'
1  5782	2C8E  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  5783	2C8F  2C80r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5784	      =ARRAY:2C8C		 LINK=LINK$
1  5785	2C91				 UDOT LABEL FAR	 ; CFA
1  5786	2C91  1F67r			     DW	$COL
   5787					 ; печать числа	без знака
   5788	2C93  2050r 2C6Ar 18CFr			  DW  ZERO,DDOT,SEMI
   5789
   5790					 ;	   ** Вспомогательные процедуры	**
   5791
   5792						  HEAD	  84h,'LIS',324Q,$LIST,$COL	      ;	LIST
1  5793	      =ARRAY:2C99		 LINK$=$
1  5794	2C99  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5795							 ; 6 - признак immediate. 5- слово не описано smudge
1  5796	2C9A  4C 49 53			     DB	 'LIS'
1  5797	2C9D  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  5798	2C9E  2C8Cr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5799	      =ARRAY:2C99		 LINK=LINK$
1  5800	2CA0				 $LIST LABEL FAR  ; CFA
1  5801	2CA0  1F67r			     DW	$COL
   5802					 ; n ->	вывод содержимого экрана
   5803	2CA2  1DFAr 2215r 1A58r	  +		  DW  DECIMA,CR,DUBL,SCR,STORE,PDOTQ
   5804	      2133r 1C9Cr 2392r
   5805	2CAE  03 53 23 20			  DB  3,'S# '
   5806	2CB2  2C78r				  DW  $DOT
   5807	2CB4  0FD3r 0010 2050r	  +		  DW  LIT,20Q,ZERO,XDO
   5808	      105Br
   5809	2CBC  2215r 1949r 2068r	  +	LSTI:	  DW  CR,I,THREE,DOTR,SPACE
   5810	      2C49r 224Er
   5811	2CC6  1949r 2133r 1C42r	  +		  DW  I,SCR,AT,DLINE
   5812	      298Fr
   5813	2CCE  1084r FFEC 2215r	  +		  DW XLOOP,LSTI-$,CR,SEMI
   5814	      18CFr
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 103
forth.asm



   5815
   5816						  HEAD	  85h,'INDE',330Q,INDEX,$COL	      ;	INDEX
1  5817	      =ARRAY:2CD6		 LINK$=$
1  5818	2CD6  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5819							 ; 6 - признак immediate. 5- слово не описано smudge
1  5820	2CD7  49 4E 44 45		     DB	 'INDE'
1  5821	2CDB  D8			     DB	 330Q	; последний символ слова + 128 (7 бит =	1).
1  5822	2CDC  2C99r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5823	      =ARRAY:2CD6		 LINK=LINK$
1  5824	2CDE				 INDEX LABEL FAR  ; CFA
1  5825	2CDE  1F67r			     DW	$COL
   5826					 ; n1 n2 -> выводит первую строку экранов с n1 по n2
   5827	2CE0  15C2r 1A0Cr 105Br			  DW  ONEP,SWAP,XDO
   5828	2CE6  2215r 1949r 2068r	  +	INDX:	  DW  CR,I,THREE,DOTR,SPACE,ZERO,I,DLINE
   5829	      2C49r 224Er 2050r	  +
   5830	      1949r 298Fr
   5831	2CF6  1084r FFEE 18CFr			  DW  XLOOP,INDX-$,SEMI
   5832
   5833						  HEAD	  84h,'TRI',317Q,TRIO,$COL	      ;	TRIO
1  5834	      =ARRAY:2CFC		 LINK$=$
1  5835	2CFC  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5836							 ; 6 - признак immediate. 5- слово не описано smudge
1  5837	2CFD  54 52 49			     DB	 'TRI'
1  5838	2D00  CF			     DB	 317Q	; последний символ слова + 128 (7 бит =	1).
1  5839	2D01  2CD6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5840	      =ARRAY:2CFC		 LINK=LINK$
1  5841	2D03				 TRIO LABEL FAR	 ; CFA
1  5842	2D03  1F67r			     DW	$COL
   5843					 ; При документировании	текстов	программ оказывается удобным размещать
   5844					 ; тексты экранов по три на странице
   5845	2D05  0FD3r 000C 13ECr			  DW  LIT,14Q,EMIT
   5846	2D0B  2068r 19ECr 170Er	  +		  DW  THREE,OVER,PLUS,SWAP,XDO
   5847	      1A0Cr 105Br
   5848	2D15  1949r 2CA0r 1084r	  +	TRI:	  DW  I,$LIST,XLOOP,TRI-$,SEMI
   5849	      FFFA 18CFr
   5850
   5851						  HEAD	  85h,'VLIS',324Q,VLIST,$COL	      ;	VLIST
1  5852	      =ARRAY:2D1F		 LINK$=$
1  5853	2D1F  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5854							 ; 6 - признак immediate. 5- слово не описано smudge
1  5855	2D20  56 4C 49 53		     DB	 'VLIS'
1  5856	2D24  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  5857	2D25  2CFCr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5858	      =ARRAY:2D1F		 LINK=LINK$
1  5859	2D27				 VLIST LABEL FAR  ; CFA
1  5860	2D27  1F67r			     DW	$COL
   5861					 ; список слов в контекстном словаре
   5862	2D29  214Er 1C42r 1C42r			  DW  CONT,AT,AT
   5863	2D2F  2215r 2068r 2050r	  +	VL0:	  DW  CR,THREE,ZERO,XDO
   5864	      105Br
   5865	2D37  1A58r 263Ar 0FD3r	  +	VL1:	  DW  DUBL,IDDOT,LIT,15Q,OVER,CAT,LIT,37Q,$AND,SUBB
   5866	      000D 19ECr 1C7Fr	  +
   5867	      0FD3r 001F 17EDr	  +
   5868	      172Ar
   5869	2D4B  2B8Cr 225Cr 1A58r	  +		  DW  SPACS,PFA,DUBL,LIT,6,UDOTR,SPACE,LIT,41Q
   5870	      0FD3r 0006 2C5Br	  +
   5871	      224Er 0FD3r 0021
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 104
forth.asm



   5872	2D5D  13ECr 224Er 1CE7r	  +		  DW  EMIT,SPACE,   LFA,AT,DUBL,ZEQU,ZBRAN,VL2-$
   5873	      1C42r 1A58r 1164r	  +
   5874	      101Ar 0004
   5875	2D6D  18F0r				  DW  LEAV ; добавил паузу
   5876	2D6F  1084r FFC6 14FDr	  +	VL2:	  DW  XLOOP,VL1-$, KEY,	DROP
   5877	      1B21r
   5878	2D77  1A75r 1164r 101Ar	  +		  DW  DDUP,ZEQU,ZBRAN,VL0-$,SEMI
   5879	      FFB2 18CFr
   5880
   5881						  HEAD	  83h,'LC',314Q,LCL,$COL	      ;	LCL
1  5882	      =ARRAY:2D81		 LINK$=$
1  5883	2D81  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  5884							 ; 6 - признак immediate. 5- слово не описано smudge
1  5885	2D82  4C 43			     DB	 'LC'
1  5886	2D84  CC			     DB	 314Q	; последний символ слова + 128 (7 бит =	1).
1  5887	2D85  2D1Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5888	      =ARRAY:2D81		 LINK=LINK$
1  5889	2D87				 LCL LABEL FAR	; CFA
1  5890	2D87  1F67r			     DW	$COL
   5891					 ; очистка командной строки
   5892	2D89  2050r 2050r 14B0r	  +		  DW  ZERO,ZERO,FIX,$CL,SPACS,RC,SEMI
   5893	      2082r 2B8Cr 142Br	  +
   5894	      18CFr
   5895
   5896						  HEAD	  82h,'H',324Q,HT,$COL		      ;	HT HOME?
1  5897	      =ARRAY:2D97		 LINK$=$
1  5898	2D97  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5899							 ; 6 - признак immediate. 5- слово не описано smudge
1  5900	2D98  48			     DB	 'H'
1  5901	2D99  D4			     DB	 324Q	; последний символ слова + 128 (7 бит =	1).
1  5902	2D9A  2D81r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5903	      =ARRAY:2D97		 LINK=LINK$
1  5904	2D9C				 HT LABEL FAR  ; CFA
1  5905	2D9C  1F67r			     DW	$COL
   5906					 ; курсор в начало экрана
   5907	2D9E  2050r 2050r 14B0r	  +		  DW  ZERO,ZERO,FIX,SEMI
   5908	      18CFr
   5909
   5910						  HEAD	  84h,'COP',331Q,COPY,$COL	      ;	COPY
1  5911	      =ARRAY:2DA6		 LINK$=$
1  5912	2DA6  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5913							 ; 6 - признак immediate. 5- слово не описано smudge
1  5914	2DA7  43 4F 50			     DB	 'COP'
1  5915	2DAA  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  5916	2DAB  2D97r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5917	      =ARRAY:2DA6		 LINK=LINK$
1  5918	2DAD				 COPY LABEL FAR	 ; CFA
1  5919	2DAD  1F67r			     DW	$COL
   5920					 ; копия экрана
   5921	2DAF  1A0Cr 2939r 1D05r	  +		  DW  SWAP,BLOCK,CFA,STORE,UPDAT,FLUSH,SEMI
   5922	      1C9Cr 1F13r 28C0r	  +
   5923	      18CFr
   5924
   5925						  HEAD	  82h,'T',331Q,TY$$,$COL	      ;	TY
1  5926	      =ARRAY:2DBD		 LINK$=$
1  5927	2DBD  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  5928							 ; 6 - признак immediate. 5- слово не описано smudge
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 105
forth.asm



1  5929	2DBE  54			     DB	 'T'
1  5930	2DBF  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  5931	2DC0  2DA6r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5932	      =ARRAY:2DBD		 LINK=LINK$
1  5933	2DC2				 TY$$ LABEL FAR	 ; CFA
1  5934	2DC2  1F67r			     DW	$COL
   5935					 ; adr n ->  дамп памяти
   5936	2DC4  2050r 105Br			  DW  ZERO,XDO
   5937	2DC8  1949r 2070r 2851r	  +	TY4:	  DW  I,EIGHT,$MOD,ZEQU,ZBRAN,TY5-$
   5938	      1164r 101Ar 000C
   5939	2DD4  2215r 1A58r 0FD3r	  +		  DW  CR,DUBL,LIT,7,UDOTR
   5940	      0007 2C5Br
   5941	2DDE  1A58r 1C42r 0FD3r	  +	TY5:	  DW  DUBL,AT,LIT,7,UDOTR,TWOP,XLOOP,TY4-$,SEMI
   5942	      0007 2C5Br 15DDr	  +
   5943	      1084r FFDC 18CFr
   5944
   5945						  HEAD	  85h,'DEPT',310Q,DEPTH,$COL	      ;	DEPTH
1  5946	      =ARRAY:2DF0		 LINK$=$
1  5947	2DF0  85			     DB	 85h  ;	NFA 7 бит равен	1.
1  5948							 ; 6 - признак immediate. 5- слово не описано smudge
1  5949	2DF1  44 45 50 54		     DB	 'DEPT'
1  5950	2DF5  C8			     DB	 310Q	; последний символ слова + 128 (7 бит =	1).
1  5951	2DF6  2DBDr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5952	      =ARRAY:2DF0		 LINK=LINK$
1  5953	2DF8				 DEPTH LABEL FAR  ; CFA
1  5954	2DF8  1F67r			     DW	$COL
   5955					 ; число элементов в стеке
   5956	2DFA  2094r 1C42r 188Ar	  +		  DW  SZERO,AT,SPAT,TWOP,SUBB,DIV2,SEMI
   5957	      15DDr 172Ar 1631r	  +
   5958	      18CFr
   5959
   5960						  HEAD	  84h,'DUM',320Q,DUMP,$COL	      ;	DUMP
1  5961	      =ARRAY:2E08		 LINK$=$
1  5962	2E08  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5963							 ; 6 - признак immediate. 5- слово не описано smudge
1  5964	2E09  44 55 4D			     DB	 'DUM'
1  5965	2E0C  D0			     DB	 320Q	; последний символ слова + 128 (7 бит =	1).
1  5966	2E0D  2DF0r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5967	      =ARRAY:2E08		 LINK=LINK$
1  5968	2E0F				 DUMP LABEL FAR	 ; CFA
1  5969	2E0F  1F67r			     DW	$COL
   5970					 ; адр u --> - Отображает u байт памяти	начиная	с адр
   5971	2E11  2050r 105Br			  DW  ZERO,XDO
   5972	2E15  1A58r 0FD3r 0007	  +	DMP:	  DW  DUBL,LIT,7,UDOTR,SPACE,EIGHT,ZERO,XDO
   5973	      2C5Br 224Er 2070r	  +
   5974	      2050r 105Br
   5975	2E25  1A58r 1949r 170Er	  +	DP1:	  DW  DUBL,I,PLUS,CAT,LIT,5,DOTR,XLOOP,DP1-$
   5976	      1C7Fr 0FD3r 0005	  +
   5977	      2C49r 1084r FFF0
   5978	2E37  0FD3r 0004 2B8Cr	  +		  DW  LIT,4,SPACS,EIGHT,ZERO,XDO
   5979	      2070r 2050r 105Br
   5980	2E43  1A58r 1949r 170Er	  +	DP2:	  DW  DUBL,I,PLUS,CAT,LIT,177Q,$AND,DUBL,BLAN
   5981	      1C7Fr 0FD3r 007F	  +
   5982	      17EDr 1A58r 2079r
   5983	2E55  1205r 101Ar 0008	  +		  DW  LESS,ZBRAN,DP3-$,DROP,LIT,56Q
   5984	      1B21r 0FD3r 002E
   5985	2E61  13ECr 1084r FFDE	  +	DP3:	  DW  EMIT,XLOOP,DP2-$,CR,EIGHT,PLUS,EIGHT
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 106
forth.asm



   5986	      2215r 2070r 170Er	  +
   5987	      2070r
   5988	2E6F  10B2r FFA4 1B21r	  +		  DW  XPLOO,DMP-$,DROP,SEMI
   5989	      18CFr
   5990
   5991						  HEAD	  84h,'SWA',323Q,SWAS,$COL	      ;	SWAS
1  5992	      =ARRAY:2E77		 LINK$=$
1  5993	2E77  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  5994							 ; 6 - признак immediate. 5- слово не описано smudge
1  5995	2E78  53 57 41			     DB	 'SWA'
1  5996	2E7B  D3			     DB	 323Q	; последний символ слова + 128 (7 бит =	1).
1  5997	2E7C  2E08r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  5998	      =ARRAY:2E77		 LINK=LINK$
1  5999	2E7E				 SWAS LABEL FAR	 ; CFA
1  6000	2E7E  1F67r			     DW	$COL
   6001					     ; перемены	 мест экранов М	и N
   6002	2E80  190Er 2939r 1D05r	  +		  DW  TOR,BLOCK,CFA,DUBL,AT,I,BLOCK,CFA,STORE,UPDAT
   6003	      1A58r 1C42r 1949r	  +
   6004	      2939r 1D05r 1C9Cr	  +
   6005	      1F13r
   6006	2E94  192Cr 0FD3r 8000	  +		  DW  FROMR,LIT,100000Q,$OR,SWAP,STORE,FLUSH,SEMI
   6007	      180Ar 1A0Cr 1C9Cr	  +
   6008	      28C0r 18CFr
   6009
   6010						  HEAD	  83h,'ST',331Q,STY,$COL	      ;	STY
1  6011	      =ARRAY:2EA4		 LINK$=$
1  6012	2EA4  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  6013							 ; 6 - признак immediate. 5- слово не описано smudge
1  6014	2EA5  53 54			     DB	 'ST'
1  6015	2EA7  D9			     DB	 331Q	; последний символ слова + 128 (7 бит =	1).
1  6016	2EA8  2E77r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6017	      =ARRAY:2EA4		 LINK=LINK$
1  6018	2EAA				 STY LABEL FAR	; CFA
1  6019	2EAA  1F67r			     DW	$COL
   6020					     ; печать стека
   6021	2EAC  2DF8r 1A75r 101Ar	  +		  DW  DEPTH,DDUP,ZBRAN,STY3-$,ZERO,XDO
   6022	      0024 2050r 105Br
   6023	2EB8  1949r 2070r 2851r	  +	STY1:	  DW  I,EIGHT,$MOD,ZEQU,ZBRAN,STY2-$,CR
   6024	      1164r 101Ar 0004	  +
   6025	      2215r
   6026	2EC6  1949r 15C2r 19C4r	  +	STY2:	  DW  I,ONEP,PICK,LIT,7,UDOTR,XLOOP,STY1-$
   6027	      0FD3r 0007 2C5Br	  +
   6028	      1084r FFE4
   6029	2ED6  18CFr			STY3:	  DW  SEMI
   6030
   6031						  HEAD	  82h,'O',256Q,ODOT,$COL	      ;	O.
1  6032	      =ARRAY:2ED8		 LINK$=$
1  6033	2ED8  82			     DB	 82h  ;	NFA 7 бит равен	1.
1  6034							 ; 6 - признак immediate. 5- слово не описано smudge
1  6035	2ED9  4F			     DB	 'O'
1  6036	2EDA  AE			     DB	 256Q	; последний символ слова + 128 (7 бит =	1).
1  6037	2EDB  2EA4r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6038	      =ARRAY:2ED8		 LINK=LINK$
1  6039	2EDD				 ODOT LABEL FAR	 ; CFA
1  6040	2EDD  1F67r			     DW	$COL
   6041					     ; тоже что	и S. в octal системе
   6042	2EDF  2173r 1C42r 19ECr	  +		  DW  BASE,AT,OVER,OCTAL,UDOT,BASE,STORE,SEMI
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 107
forth.asm



   6043	      1E1Ar 2C91r 2173r	  +
   6044	      1C9Cr 18CFr
   6045
   6046						  HEAD	  83h,'R/',327Q,RW		      ;	R/W
1  6047	      =ARRAY:2EEF		 LINK$=$
1  6048	2EEF  83			     DB	 83h  ;	NFA 7 бит равен	1.
1  6049							 ; 6 - признак immediate. 5- слово не описано smudge
1  6050	2EF0  52 2F			     DB	 'R/'
1  6051	2EF2  D7			     DB	 327Q	; последний символ слова + 128 (7 бит =	1).
1  6052	2EF3  2ED8r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6053	      =ARRAY:2EEF		 LINK=LINK$
1  6054	2EF5				 RW LABEL FAR  ; CFA
1  6055	2EF5  2EF7r			     DW	 $+2
   6056					; Открытие файла
   6057	2EF7  BA 2FAEr				  MOV	DX, OFFSET file
   6058						  ;MOV	 AH, 0FH      ;	open file
   6059	2EFA  B4 3D				  MOV	AH, 3dh
   6060	2EFC  B0 02				  mov	al, 2
   6061	2EFE  CD 21				  INT	21H
   6062						  ;CMP	 AL, 0FFH
   6063						  ;JE	 ERR0
   6064	2F00  72 5F				  jc ERR0
   6065	2F02  A3 2FACr				  mov	 handle, ax
   6066	2F05  5B				  POP	BX  ; R/W - флаг
   6067	2F06  58				  POP	AX  ; Номер блока
   6068	2F07  5A				  POP	DX  ; Адрес буфера
   6069	2F08  48				  DEC	AX
   6070	2F09  B1 0A				  MOV	CL, 10 ; 3 было
   6071	2F0B  D3 E0				  SAL	AX, CL	; (BLOCK#-1)*8 ; теперь	на 1024	байт
   6072						  ;MOV	 RANDREC,AX
   6073						  ;MOV	 RANDREC+2,0
   6074	2F0D  53				  push	 bx
   6075	2F0E  52				  push	 dx
   6076	2F0F  8B D0				  mov	 dx, ax
   6077	2F11  B9 0000				  mov	 cx, 0
   6078	2F14  B8 4200				  mov	 ax, 4200h
   6079	2F17  8B 1E 2FACr			  mov bx, handle
   6080	2F1B  CD 21				  int 21h
   6081	2F1D  72 42				  jc ERR0
   6082	2F1F  5A				  pop	 dx
   6083	2F20  5B				  pop	 bx
   6084	2F21  83 FB 00				  CMP	BX, 0 ;	режим
   6085	2F24  75 0F				  JNE	RED
   6086					; WRITE
   6087						  ;MOV	 BX, DX
   6088						  ;MOV	 CX, 8	    ; Номер записи
   6089	2F26				WR:	  ;MOV	 DX, BX
   6090						  ;MOV	 AH,1AH	    ; Запись адреса буфера (Set	disk transfer address)
   6091						  ;INT	 21H
   6092						  ;MOV	 DX,OFFSET FCB
   6093						  ;MOV	 AH, 22H    ; Запись RECORD (Random write)
   6094						  ;INT	 21H
   6095	2F26  B4 40				  MOV	AH, 40H
   6096	2F28  B9 0400				  MOV	CX, 1024
   6097	2F2B  8B 1E 2FACr			  mov	 bx, handle
   6098	2F2F  CD 21				  INT	21H
   6099						  ;CMP	 AL, 0
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 108
forth.asm



   6100						  ;JNE	 ERR1
   6101	2F31  72 33				  jc err1
   6102						  ;INC	 RANDREC    ; Коррекция	адреса буфера
   6103						  ;ADD	 BX, 80H
   6104						  ;LOOP	 WR
   6105	2F33  EB 11				  JMP  OUT1
   6106
   6107	2F35				 RED:	  ;MOV	 CX, 8
   6108						  ;MOV	 BX, DX
   6109					 ;RD:	  ;MOV	 DX, BX	      ;	адрес буфера
   6110						  ;MOV	 AH, 1AH     ; Запись адреса буфера
   6111	2F35  B4 3F				  MOV	AH, 3fH
   6112	2F37  B9 0400				  MOV	CX, 1024
   6113	2F3A  8B 1E 2FACr			  mov	 bx, handle
   6114	2F3E  CD 21				  INT	21H
   6115	2F40  72 2E				  jc ERR3
   6116	2F42  3B C1				  cmp ax,cx
   6117	2F44  75 2A				  jne err3
   6118						  ;MOV	 DX, OFFSET  FCB
   6119						  ;MOV	 AH, 21H      ;	Random read
   6120						  ;INT	 21H
   6121						  ;CMP	 AL, 0
   6122						  ;JNE	 ERR3
   6123						  ;INC	 RANDREC     ; Коррекция адреса
   6124						  ;ADD	 BX, 80H
   6125						 ; LOOP	  RD
   6126
   6127	2F46				OUT1:	  ;MOV	 DX, OFFSET  FCB  ; Закрытие файла
   6128	2F46  8B 1E 2FACr			  mov bx, handle
   6129						  ;MOV	 AH, 10H
   6130	2F4A  B4 3E				  mov ah, 3eh
   6131	2F4C  CD 21				  INT	21H
   6132						  ;CMP	 AL, 0
   6133						  ;JNE	 ERR2
   6134	2F4E  72 1B				  jc ERR2
   6135	2F50				EXIT:	  NEXT
1  6136	2F50  AD			     LODSW	     ; DS:[SI] -> AX ; SI = SI + 2
1  6137	2F51  8B D8			     MOV  BX, AX     ; BX равен	CFA  следующего	слова
1  6138					 ; ------ call debugger	--------
1  6139	2F53  80 7D 42 00		     cmp byte ptr [di+102Q], 0
1  6140	2F57  74 06			     jz	??0066
1  6141	2F59  E8 DFF5			     call printWORD
1  6142	2F5C  E8 DED4			     call pause
1  6143	2F5F				   ??0066:
1  6144					 ; -----------------------------
1  6145	2F5F  FF 27			     JMP WORD PTR [BX]
   6146	2F61  BA 2FDFr			ERR0:	  MOV	DX, OFFSET  ERMES0
   6147	2F64  EB 0D				  JMP	DONE
   6148	2F66  BA 2FF0r			ERR1:	  MOV	DX, OFFSET  ERMES1
   6149	2F69  EB 08				  JMP	DONE
   6150	2F6B  BA 3001r			ERR2:	  MOV	DX, OFFSET  ERMES2
   6151	2F6E  EB 03				  JMP	DONE
   6152	2F70  BA 3012r			ERR3:	  MOV	DX, OFFSET  ERMES3
   6153	2F73  B4 09			DONE:	  MOV	AH, 9H ; вывод сообщения
   6154	2F75  CD 21				  INT	21H
   6155	2F77  EB D7				  JMP	EXIT
   6156
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 109
forth.asm



   6157						  HEAD	  305Q,';COD','E'+80h,SEMIC,$COL	  ; ;CODE
1  6158	      =ARRAY:2F79		 LINK$=$
1  6159	2F79  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  6160							 ; 6 - признак immediate. 5- слово не описано smudge
1  6161	2F7A  3B 43 4F 44		     DB	 ';COD'
1  6162	2F7E  C5			     DB	 'E'+80h   ; последний символ слова + 128 (7 бит = 1).
1  6163	2F7F  2EEFr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6164	      =ARRAY:2F79		 LINK=LINK$
1  6165	2F81				 SEMIC LABEL FAR  ; CFA
1  6166	2F81  1F67r			     DW	$COL
   6167					 ; для определения в форт программе слов на ассемблере
   6168	2F83  22C9r 22FDr 232Ar	  +		  DW  QCSP,COMP,PSCOD,LBRAC,SMUG,SEMI
   6169	      1D9Er 2316r 18CFr
   6170
   6171						  HEAD	  305Q,'FORT','H'+80h,FORTH,$DOE	  ; FORTH
1  6172	      =ARRAY:2F8F		 LINK$=$
1  6173	2F8F  C5			     DB	 305Q  ; NFA 7 бит равен 1.
1  6174							 ; 6 - признак immediate. 5- слово не описано smudge
1  6175	2F90  46 4F 52 54		     DB	 'FORT'
1  6176	2F94  C8			     DB	 'H'+80h   ; последний символ слова + 128 (7 бит = 1).
1  6177	2F95  2F79r			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6178	      =ARRAY:2F8F		 LINK=LINK$
1  6179	2F97				 FORTH LABEL FAR  ; CFA
1  6180	2F97  2020r			     DW	$DOE
   6181					 ; Делает словарь Форт контекстным.
   6182					 ; см. FORTH DIMENSION
   6183	2F99  27A4r				 DW  DOVOC   ; PFA
   6184	2F9B  A081				 DW 120201Q  ; = A0 81 мнимый заголовок	слова для связи	словарей
   6185	2F9D  2FA1r				 DW TASK-7   ; PFA+4 NFA(TASK) последнее слово в этом словаре
   6186	2F9F				 XVOC	 LABEL	 FAR ; VOC-LINK
   6187	2F9F  0000				 DW  0	     ; ссылка на предыдущий словарь
   6188							     ; для чего	так и не нашел.	похоже,	здесь не используется
   6189					 ; VOC-LINK ---	addr U
   6190					 ;    A	user variable containing the address of	a field	in the definition
   6191					 ;    of the most recently created vocabulary. All vocabulary names are
   6192					 ;    linked by	these fields to	allow control for FORGETting thru multiple
   6193					 ;    vocabularies.
   6194
   6195						  HEAD	  84h,'TAS','K'+80h,TASK,$COL		 ; TASK
1  6196	      =ARRAY:2FA1		 LINK$=$
1  6197	2FA1  84			     DB	 84h  ;	NFA 7 бит равен	1.
1  6198							 ; 6 - признак immediate. 5- слово не описано smudge
1  6199	2FA2  54 41 53			     DB	 'TAS'
1  6200	2FA5  CB			     DB	 'K'+80h   ; последний символ слова + 128 (7 бит = 1).
1  6201	2FA6  2F8Fr			     DW	 LINK	 ; LFA предыдущее слово	(адрес первого символа имени)
1  6202	      =ARRAY:2FA1		 LINK=LINK$
1  6203	2FA8				 TASK LABEL FAR	 ; CFA
1  6204	2FA8  1F67r			     DW	$COL
   6205					     ; пустое определение. последнее слово в словаре FORTH
   6206	2FAA  18CFr				  DW  SEMI
   6207
   6208	2FAC  0000			handle	 dw 0
   6209	2FAE  66 6F 72 74 68 2E	64+	file	 db "forth.dat", 0
   6210	      61 74 00
   6211					; FCB not used now
   6212	2FB8				FCB	  LABEL	WORD
   6213	2FB8  00			DRIVE	  DB	0
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 110
forth.asm



   6214	2FB9  46 4F 52 54 48 20	20+	FN	  DB	'FORTH	 '
   6215	      20
   6216	2FC1  44 41 54			EXT	  DB	'DAT'
   6217	2FC4  0000			CURBLK	  DW	0	   ; Относительное начало файла
   6218	2FC6  0080			RECSIZE	  DW	80H	   ; размер логичю записи
   6219	2FC8  1388 0000			FILESIZE  DW	5000,0	   ; размер файла
   6220	2FCC  0000 0000			DATE	  DW	0,0
   6221	2FD0  00 00 00 00 00 00	00+		  DB	0,0,0,0,0, 0,0,0,0,0 ; REZERV
   6222	      00 00 00
   6223	2FDA  00			CURREC	  DB	0	    ; запись с текущего	блока
   6224	2FDB  0000 0000			RANDREC	  DW	0,0	    ; номер записи
   6225
   6226	2FDF  45 52 52 20 4F 50	45+	ERMES0	  DB	'ERR OPENING FILE$'
   6227	      4E 49 4E 47 20 46	49+
   6228	      4C 45 24
   6229	2FF0  45 52 52 20 57 52	49+	ERMES1	  DB	'ERR WRITING FILE$'
   6230	      54 49 4E 47 20 46	49+
   6231	      4C 45 24
   6232	3001  45 52 52 20 43 4C	4F+	ERMES2	  DB	'ERR CLOSING FILE$'
   6233	      53 49 4E 47 20 46	49+
   6234	      4C 45 24
   6235	3012  45 52 52 20 52 45	41+	ERMES3	  DB	'ERR READING FILE$'
   6236	      44 49 4E 47 20 46	49+
   6237	      4C 45 24
   6238
   6239
   6240	3023  3E80*(0000)		XDP	DW  16000 DUP(0)	   ; DICTIONARY
   6241
   6242	0000				STCK   SEGMENT STACK		  ; Стек параметров
   6243	0000  40*(????)				DW  64 DUP (?)
   6244	0080				XS0	LABEL	WORD
   6245	0080  0000 0000				DW  0,0	  ; STACK
   6246	0084				STCK   ENDS
   6247
   6248	AD23				ARRAY	   ENDS
   6249					END	   $INI
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 111
Symbol Table




Symbol Name			  Type	 Value

$ABS				  Far	 ARRAY:17CB
$AND				  Far	 ARRAY:17ED
$BUF				  Word	 ARRAY:0DB0
$CL				  Far	 ARRAY:2082
$COL				  Far	 ARRAY:1F67
$COMP				  Near	 ARRAY:1E89
$CON				  Far	 ARRAY:1FAA
$DATE				  Word	 ARRAY:0004
$DO				  Far	 ARRAY:2AA4
$DOE				  Far	 ARRAY:2020
$DOT				  Far	 ARRAY:2C78
$DP				  Far	 ARRAY:20D6
$ELSE				  Far	 ARRAY:2B4E
$EM				  Near	 ARRAY:13CC
$EMIT				  Far	 ARRAY:13EE
$EVEN				  Far	 ARRAY:1242
$EX				  Far	 ARRAY:21B9
$GO				  Near	 ARRAY:19D4
$HEX				  Far	 ARRAY:1DD8
$IF				  Far	 ARRAY:2B37
$IN				  Far	 ARRAY:211F
$INI				  Far	 ARRAY:0DB4
$LESS				  Near	 ARRAY:10BF
$LIST				  Far	 ARRAY:2CA0
$LOOP				  Near	 ARRAY:110B
$MO				  Near	 ARRAY:2896
$MOD				  Far	 ARRAY:2851
$OR				  Far	 ARRAY:180A
$PAGE				  Far	 ARRAY:12B8
$REPE				  Near	 ARRAY:1B91
$RS				  Word	 ARRAY:0DA2
$SIG				  Near	 ARRAY:10F9
$STI				  Word	 ARRAY:0D9C
$STK				  Word	 ARRAY:0DA0
$TIME				  Word	 ARRAY:0000
$TYPE				  Far	 ARRAY:2365
$UPD				  Near	 ARRAY:1F20
$US				  Word	 ARRAY:0D9E
$USE				  Far	 ARRAY:1FF3
$VAR				  Far	 ARRAY:1FD1
$WARN				  Far	 ARRAY:20C1
$WHILE				  Far	 ARRAY:2B0F
$WIDTH				  Far	 ARRAY:20B3
$WORD				  Far	 ARRAY:242C
$XOR				  Far	 ARRAY:1818
??0000				  Near	 ARRAY:0E23
??0001				  Near	 ARRAY:0FE6
??0002				  Near	 ARRAY:100E
??0003				  Near	 ARRAY:1034
??0004				  Near	 ARRAY:1052
??0005				  Near	 ARRAY:1079
??0006				  Near	 ARRAY:10A6
??0007				  Near	 ARRAY:117E
??0008				  Near	 ARRAY:125C
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 112
Symbol Table



??0009				  Near	 ARRAY:12A8
??000A				  Near	 ARRAY:12CE
??000B				  Near	 ARRAY:12FF
??000C				  Near	 ARRAY:1345
??000D				  Near	 ARRAY:138A
??000E				  Near	 ARRAY:13A9
??000F				  Near	 ARRAY:13E3
??0010				  Near	 ARRAY:1465
??0011				  Near	 ARRAY:1483
??0012				  Near	 ARRAY:14A8
??0013				  Near	 ARRAY:14CF
??0014				  Near	 ARRAY:14F5
??0015				  Near	 ARRAY:1515
??0016				  Near	 ARRAY:1547
??0017				  Near	 ARRAY:157F
??0018				  Near	 ARRAY:159C
??0019				  Near	 ARRAY:15BB
??001A				  Near	 ARRAY:15D6
??001B				  Near	 ARRAY:15F3
??001C				  Near	 ARRAY:160E
??001D				  Near	 ARRAY:162A
??001E				  Near	 ARRAY:1646
??001F				  Near	 ARRAY:1664
??0020				  Near	 ARRAY:1683
??0021				  Near	 ARRAY:16A1
??0022				  Near	 ARRAY:16C8
??0023				  Near	 ARRAY:16E9
??0024				  Near	 ARRAY:1708
??0025				  Near	 ARRAY:1724
??0026				  Near	 ARRAY:1740
??0027				  Near	 ARRAY:1763
??0028				  Near	 ARRAY:1786
??0029				  Near	 ARRAY:17A5
??002A				  Near	 ARRAY:17C3
??002B				  Near	 ARRAY:17E5
??002C				  Near	 ARRAY:1803
??002D				  Near	 ARRAY:1840
??002E				  Near	 ARRAY:1860
??002F				  Near	 ARRAY:1872
??0030				  Near	 ARRAY:18AB
??0031				  Near	 ARRAY:18C8
??0032				  Near	 ARRAY:18E6
??0033				  Near	 ARRAY:1907
??0034				  Near	 ARRAY:1925
??0035				  Near	 ARRAY:1943
??0036				  Near	 ARRAY:195D
??0037				  Near	 ARRAY:19BB
??0038				  Near	 ARRAY:19E3
??0039				  Near	 ARRAY:1A03
??003A				  Near	 ARRAY:1A21
??003B				  Near	 ARRAY:1A50
??003C				  Near	 ARRAY:1A6C
??003D				  Near	 ARRAY:1A9D
??003E				  Near	 ARRAY:1ABC
??003F				  Near	 ARRAY:1ADC
??0040				  Near	 ARRAY:1AFA
??0041				  Near	 ARRAY:1B18
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 113
Symbol Table



??0042				  Near	 ARRAY:1B35
??0043				  Near	 ARRAY:1B51
??0044				  Near	 ARRAY:1B7E
??0045				  Near	 ARRAY:1BA5
??0046				  Near	 ARRAY:1BE6
??0047				  Near	 ARRAY:1C02
??0048				  Near	 ARRAY:1C1E
??0049				  Near	 ARRAY:1C3C
??004A				  Near	 ARRAY:1C56
??004B				  Near	 ARRAY:1C78
??004C				  Near	 ARRAY:1C96
??004D				  Near	 ARRAY:1CB1
??004E				  Near	 ARRAY:1CCD
??004F				  Near	 ARRAY:1CFD
??0050				  Near	 ARRAY:1D1B
??0051				  Near	 ARRAY:1D38
??0052				  Near	 ARRAY:1D55
??0053				  Near	 ARRAY:1D74
??0054				  Near	 ARRAY:1D98
??0055				  Near	 ARRAY:1DB4
??0056				  Near	 ARRAY:1DD0
??0057				  Near	 ARRAY:1DEE
??0058				  Near	 ARRAY:1E10
??0059				  Near	 ARRAY:1E30
??005A				  Near	 ARRAY:1E51
??005B				  Near	 ARRAY:1E7B
??005C				  Near	 ARRAY:1EA8
??005D				  Near	 ARRAY:1ECF
??005E				  Near	 ARRAY:1F08
??005F				  Near	 ARRAY:1F2F
??0060				  Near	 ARRAY:1F4D
??0061				  Near	 ARRAY:1F81
??0062				  Near	 ARRAY:1FBE
??0063				  Near	 ARRAY:1FE4
??0064				  Near	 ARRAY:200A
??0065				  Near	 ARRAY:203E
??0066				  Near	 ARRAY:2F5F
??DATE				  Text	 "05/14/20"
??FILENAME			  Text	 "forth	  "
??TIME				  Text	 "14:48:46"
??VERSION			  Number 030A
?TER$				  Far	 ARRAY:1551
?TERM				  Far	 ARRAY:2204
@32BIT				  Text	 0
@@1				  Near	 ARRAY:0F28
@@2				  Near	 ARRAY:0F40
@@ASCII				  Byte	 ARRAY:0E9E
@@ASCII				  Byte	 ARRAY:0EEB
@@ASCII				  Byte	 ARRAY:0F1F
@@CAPTION			  Byte	 ARRAY:0EE5
@@CAPTION			  Byte	 ARRAY:0F16
@@CAPTION			  Byte	 ARRAY:0E91
@@CR				  Byte	 ARRAY:0FB6
@@L				  Near	 ARRAY:0EB1
@@R				  Near	 ARRAY:0EDD
@@R				  Near	 ARRAY:0F0E
@@R				  Near	 ARRAY:0EC2
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 114
Symbol Table



@CODE				  Text	 _TEXT
@CODESIZE			  Text	 0
@CPU				  Text	 0101H
@CURSEG				  Text	 ARRAY
@D				  Near	 ARRAY:0E6F
@DATA				  Text	 DGROUP
@DATASIZE			  Text	 0
@E				  Near	 ARRAY:0E5C
@FILENAME			  Text	 FORTH
@INTERFACE			  Text	 00H
@MODEL				  Text	 2
@R				  Near	 ARRAY:0E74
@RS				  Near	 ARRAY:0E65
@S				  Near	 ARRAY:0E6A
@STACK				  Text	 DGROUP
@START				  Near	 ARRAY:0E33
@V				  Near	 ARRAY:0E60
@WORDSIZE			  Text	 2
A				  Near	 ARRAY:1270
AA				  Near	 ARRAY:1284
AAA1				  Near	 ARRAY:1274
AAT				  Far	 ARRAY:1C5D
AB				  Near	 ARRAY:17D5
ABORT				  Far	 ARRAY:27EF
AGAIN				  Far	 ARRAY:2AF9
ALLOT				  Far	 ARRAY:1D5F
ARROW				  Far	 ARRAY:2A15
ASCII				  Byte	 ARRAY:0F91
AT				  Far	 ARRAY:1C42
ATR				  Far	 ARRAY:2103
BACK				  Far	 ARRAY:2A83
BASE				  Far	 ARRAY:2173
BBUF				  Far	 ARRAY:208B
BCK				  Near	 ARRAY:296B
BCOM				  Far	 ARRAY:26A9
BDIGS				  Far	 ARRAY:2BA9
BEGIN				  Far	 ARRAY:2A95
BLAN				  Far	 ARRAY:2079
BLANK				  Far	 ARRAY:1BBE
BLANKBUFFER			  Near	 ARRAY:0F49
BLC				  Near	 ARRAY:297F
BLK				  Far	 ARRAY:2116
BLO				  Near	 ARRAY:2953
BLOCK				  Far	 ARRAY:2939
BN				  Near	 ARRAY:2475
BN1				  Near	 ARRAY:24AB
BR1				  Near	 ARRAY:2901
BR2				  Near	 ARRAY:2921
BRAN				  Far	 ARRAY:103F
BUFFE				  Far	 ARRAY:28F7
BUILD				  Far	 ARRAY:2342
BYE				  Far	 ARRAY:2046
C$				  Near	 ARRAY:1A5C
CAT				  Far	 ARRAY:1C7F
CCOM				  Far	 ARRAY:223A
CFA				  Far	 ARRAY:1D05
CLEAR				  Near	 ARRAY:1494
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 115
Symbol Table



CMOV				  Far	 ARRAY:1B5B
CNT				  Near	 ARRAY:1041
COLON				  Far	 ARRAY:1F53
COMMA				  Far	 ARRAY:2229
COMP				  Far	 ARRAY:22FD
COMPA				  Near	 ARRAY:1E63
CON				  Far	 ARRAY:1FA0
CONT				  Far	 ARRAY:214E
COPY				  Far	 ARRAY:2DAD
COUNT				  Far	 ARRAY:2352
CR				  Far	 ARRAY:2215
CRE				  Near	 ARRAY:2669
CREAT				  Far	 ARRAY:2653
CSP				  Far	 ARRAY:2187
CSTOR				  Far	 ARRAY:1CB8
CURBLK				  Word	 ARRAY:2FC4
CURR				  Far	 ARRAY:215C
CURREC				  Byte	 ARRAY:2FDA
DABS				  Far	 ARRAY:16D1
DATE				  Word	 ARRAY:2FCC
DDOT				  Far	 ARRAY:2C6A
DDOTR				  Far	 ARRAY:2C26
DDROP				  Far	 ARRAY:1B04
DDUP				  Far	 ARRAY:1A75
DEB				  Far	 ARRAY:21CD
DEBUG				  Number 0001
DECIMA				  Far	 ARRAY:1DFA
DEEP				  Near	 ARRAY:1862
DEFIN				  Far	 ARRAY:1EB8
DEPTH				  Far	 ARRAY:2DF8
DFIND				  Far	 ARRAY:24BD
DIG				  Far	 ARRAY:2BE5
DIGI				  Near	 ARRAY:2C01
DIGIT				  Far	 ARRAY:1142
DIGS				  Far	 ARRAY:2C10
DIS				  Near	 ARRAY:2C12
DIV2				  Far	 ARRAY:1631
DLI				  Near	 ARRAY:26F0
DLINE				  Far	 ARRAY:298F
DLITE				  Far	 ARRAY:26E0
DMIN				  Near	 ARRAY:16AF
DMINU				  Far	 ARRAY:16AC
DMP				  Near	 ARRAY:2E15
DOES				  Far	 ARRAY:2014
DONE				  Near	 ARRAY:2F73
DOTQ				  Far	 ARRAY:23AB
DOTR				  Far	 ARRAY:2C49
DOVOC				  Far	 ARRAY:27A4
DP1				  Near	 ARRAY:2E25
DP2				  Near	 ARRAY:2E43
DP3				  Near	 ARRAY:2E61
DPL				  Far	 ARRAY:217D
DPLUS				  Far	 ARRAY:1747
DRIVE				  Byte	 ARRAY:2FB8
DRO				  Near	 ARRAY:1B06
DROP				  Far	 ARRAY:1B21
DRP				  Near	 ARRAY:1B23
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 116
Symbol Table



DSKBUF				  Word	 ARRAY:0006
DSPL				  Far	 ARRAY:14D8
DSWAP				  Far	 ARRAY:1A2B
DTRAI				  Far	 ARRAY:1E5C
DU				  Near	 ARRAY:1A5B
DUBL				  Far	 ARRAY:1A58
DUMP				  Far	 ARRAY:2E0F
DUP2				  Far	 ARRAY:1A86
EDIGS				  Far	 ARRAY:2BB8
EIGHT				  Far	 ARRAY:2070
EMI$				  Far	 ARRAY:13B1
EMIT				  Far	 ARRAY:13EC
ENCL				  Far	 ARRAY:126A
ENDA				  Near	 ARRAY:17F3
ENDBUF				  Word	 ARRAY:0C12
ENT				  Near	 ARRAY:0DBE
ENT$				  Near	 ARRAY:13EF
EQGR				  Far	 ARRAY:1231
EQLES				  Far	 ARRAY:1214
EQUAL				  Far	 ARRAY:11D9
EQW				  Near	 ARRAY:1290
ER				  Near	 ARRAY:25F6
ER1				  Near	 ARRAY:25FA
ERASE				  Far	 ARRAY:1BAF
ERB				  Far	 ARRAY:21C3
ERMES0				  Byte	 ARRAY:2FDF
ERMES1				  Byte	 ARRAY:2FF0
ERMES2				  Byte	 ARRAY:3001
ERMES3				  Byte	 ARRAY:3012
ERMES4				  Byte	 ARRAY:1416
ERR0				  Near	 ARRAY:2F61
ERR1				  Near	 ARRAY:2F66
ERR2				  Near	 ARRAY:2F6B
ERR3				  Near	 ARRAY:2F70
ERR4				  Near	 ARRAY:1405
ERROR				  Far	 ARRAY:260E
EXEC				  Far	 ARRAY:0FC8
EXIT				  Near	 ARRAY:2F50
EXP				  Near	 ARRAY:2580
EXPE				  Far	 ARRAY:1520
EXT				  Byte	 ARRAY:2FC1
FAIL				  Near	 ARRAY:1135
FALSE				  Near	 ARRAY:116C
FALSE1				  Near	 ARRAY:124A
FAST				  Near	 ARRAY:10E7
FCB				  Word	 ARRAY:2FB8
FENCE				  Far	 ARRAY:20CD
FILE				  Byte	 ARRAY:2FAE
FILESIZE			  Word	 ARRAY:2FC8
FILL				  Far	 ARRAY:1B87
FIN				  Near	 ARRAY:24E1
FIRST				  Far	 ARRAY:20ED
FIX				  Far	 ARRAY:14B0
FL1				  Near	 ARRAY:28E2
FLL				  Near	 ARRAY:1B8A
FLU				  Near	 ARRAY:28CC
FLUSH				  Far	 ARRAY:28C0
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 117
Symbol Table



FN				  Byte	 ARRAY:2FB9
FORGE				  Far	 ARRAY:2A46
FORTH				  Far	 ARRAY:2F97
FROMR				  Far	 ARRAY:192C
G$				  Near	 ARRAY:16B9
GO$				  Near	 ARRAY:0E25
GREAT				  Far	 ARRAY:1222
HANDLE				  Word	 ARRAY:2FAC
HERE				  Far	 ARRAY:1D41
HLD				  Far	 ARRAY:219A
HOLD				  Far	 ARRAY:1BCC
HT				  Far	 ARRAY:2D9C
I				  Far	 ARRAY:1949
IDDOT				  Far	 ARRAY:263A
IL				  Far	 ARRAY:1437
IMMED				  Far	 ARRAY:276D
INDEX				  Far	 ARRAY:2CDE
INDX				  Near	 ARRAY:2CE6
INIT				  Far	 ARRAY:0DBC
INTER				  Far	 ARRAY:2725
IT1				  Near	 ARRAY:2727
IT2				  Near	 ARRAY:273D
IT3				  Near	 ARRAY:2743
IT4				  Near	 ARRAY:2757
IT5				  Near	 ARRAY:275B
J				  Far	 ARRAY:1977
JT				  Far	 ARRAY:1983
K				  Far	 ARRAY:198E
KEY				  Far	 ARRAY:14FD
KT				  Far	 ARRAY:199A
LASTRANDX			  Far	 ARRAY:21DD
LATES				  Far	 ARRAY:1E3B
LBRAC				  Far	 ARRAY:1D9E
LCL				  Far	 ARRAY:2D87
LEAV				  Far	 ARRAY:18F0
LESS				  Far	 ARRAY:1205
LEV				  Far	 ARRAY:19A7
LFA				  Far	 ARRAY:1CE7
LIL				  Near	 ARRAY:26D3
LIMIT				  Far	 ARRAY:20F9
LINK				  Number ARRAY:2FA1
LINK$				  Number ARRAY:2FA1
LIT				  Far	 ARRAY:0FD3
LITER				  Far	 ARRAY:26C3
LOA				  Far	 ARRAY:29ED
LOO				  Far	 ARRAY:2AB7
LOP				  Near	 ARRAY:1089
LSTI				  Near	 ARRAY:2CBC
LV				  Near	 ARRAY:1091
M09				  Near	 ARRAY:1158
MATCH				  Near	 ARRAY:10F1
MAX				  Far	 ARRAY:187A
MES				  Near	 ARRAY:29D7
MESS				  Far	 ARRAY:29B3
MIN				  Far	 ARRAY:1848
MINUS				  Far	 ARRAY:1790
MM				  Near	 ARRAY:0F72
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 118
Symbol Table



MMM1				  Near	 ARRAY:0F7D
MMO				  Near	 ARRAY:24B1
MODA				  Far	 ARRAY:1393
MPLUS				  Far	 ARRAY:176A
MROT				  Far	 ARRAY:1AC5
MS1				  Near	 ARRAY:29D9
MSLAS				  Far	 ARRAY:16F0
MSMOD				  Far	 ARRAY:2884
MSTAR				  Far	 ARRAY:168A
MSTOR				  Far	 ARRAY:1C09
MTBUF				  Far	 ARRAY:28AA
MUL2				  Far	 ARRAY:1615
NEMI				  Near	 ARRAY:25AA
NEQ				  Far	 ARRAY:11E8
NFA				  Far	 ARRAY:1CD5
NH0				  Near	 ARRAY:25BC
NH1				  Near	 ARRAY:2516
NH2				  Near	 ARRAY:2532
NH3				  Near	 ARRAY:2540
NH4				  Near	 ARRAY:2542
NH5				  Near	 ARRAY:25DA
NH6				  Near	 ARRAY:25E4
NH7				  Near	 ARRAY:25EE
NIP				  Far	 ARRAY:1B3D
NO				  Near	 ARRAY:1E6B
NOTEQ				  Near	 ARRAY:1277
NUL				  Near	 ARRAY:240F
NULL				  Far	 ARRAY:23F7
NUMB				  Far	 ARRAY:24EC
NZEQ				  Far	 ARRAY:118B
OCTAL				  Far	 ARRAY:1E1A
ODOT				  Far	 ARRAY:2EDD
OFLIM				  Near	 ARRAY:1E96
OFSET				  Far	 ARRAY:2140
OK				  Near	 ARRAY:13D4
ONE				  Far	 ARRAY:2058
ONEM				  Far	 ARRAY:15FA
ONEP				  Far	 ARRAY:15C2
OUT1				  Near	 ARRAY:2F46
OUTCR				  Near	 ARRAY:0FAE
OUTTEXT				  Near	 ARRAY:0FB9
OVER				  Far	 ARRAY:19EC
PAD				  Far	 ARRAY:2419
PAREN				  Far	 ARRAY:27B0
PAUSE				  Near	 ARRAY:0E33
PB				  Near	 ARRAY:1EEF
PBUF				  Far	 ARRAY:1ED8
PDOTQ				  Far	 ARRAY:2392
PFA				  Far	 ARRAY:225C
PFIND				  Far	 ARRAY:10D3
PG				  Far	 ARRAY:210C
PICK				  Far	 ARRAY:19C4
PIX				  Far	 ARRAY:136C
PIX12				  Far	 ARRAY:1309
PIX13				  Far	 ARRAY:12D8
PIXPTR12			  Near	 ARRAY:1347
PLOOP				  Far	 ARRAY:2ACD
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 119
Symbol Table



PLU				  Near	 ARRAY:25BA
PLUS				  Far	 ARRAY:170E
PNT				  Far	 ARRAY:2129
PNUMB				  Far	 ARRAY:2473
PORT				  Far	 ARRAY:1588
PREV				  Far	 ARRAY:21AF
PRIN				  Far	 ARRAY:1445
PRINT				  Near	 ARRAY:13F9
PRINTWORD			  Near	 ARRAY:0F51
PSCOD				  Far	 ARRAY:232A
PSTOR				  Far	 ARRAY:1BED
PUT				  Near	 ARRAY:116E
PUT1				  Near	 ARRAY:124C
QCOMP				  Far	 ARRAY:2288
QCSP				  Far	 ARRAY:22C9
QDROP				  Far	 ARRAY:1AE6
QERR				  Far	 ARRAY:2270
QEXEC				  Far	 ARRAY:22A0
QLOAD				  Far	 ARRAY:22E3
QPAIR				  Far	 ARRAY:22B6
QSTAC				  Far	 ARRAY:26FB
QUERY				  Far	 ARRAY:23DB
QUEST				  Far	 ARRAY:2C84
QUI				  Near	 ARRAY:27CB
QUIT				  Far	 ARRAY:27C1
R				  Far	 ARRAY:1963
RANDREC				  Word	 ARRAY:2FDB
RBRAC				  Far	 ARRAY:1DBA
RC				  Far	 ARRAY:142B
READ				  Far	 ARRAY:15A5
RECSIZE				  Word	 ARRAY:2FC6
RED				  Near	 ARRAY:2F35
REPEA				  Far	 ARRAY:2B1E
RNUM				  Far	 ARRAY:2190
ROT				  Far	 ARRAY:1AA5
RPSTO				  Far	 ARRAY:18B3
RR$				  Near	 ARRAY:194B
RW				  Far	 ARRAY:2EF5
RZERO				  Far	 ARRAY:209D
SCL				  Far	 ARRAY:148B
SCR				  Far	 ARRAY:2133
SCSP				  Far	 ARRAY:1D24
SEMI				  Far	 ARRAY:18CF
SEMIC				  Far	 ARRAY:2F81
SHOWRS				  Near	 ARRAY:0EC3
SHOWSTACK			  Near	 ARRAY:0EF1
SHOWSTDUMP			  Near	 ARRAY:0EA7
SHOWWD				  Near	 ARRAY:0E75
SIG				  Near	 ARRAY:2BDF
SIGN				  Far	 ARRAY:2BCF
SLASH				  Far	 ARRAY:2841
SLMOD				  Far	 ARRAY:2831
SLOW				  Near	 ARRAY:1105
SLOW1				  Near	 ARRAY:1118
SMI				  Far	 ARRAY:1F87
SMUG				  Far	 ARRAY:2316
SP1				  Near	 ARRAY:2BA2
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 120
Symbol Table



SPA				  Near	 ARRAY:2B9C
SPACE				  Far	 ARRAY:224E
SPACS				  Far	 ARRAY:2B8C
SPAT				  Far	 ARRAY:188A
SPOT				  Far	 ARRAY:2816
SPSTO				  Far	 ARRAY:1897
SRP				  Far	 ARRAY:196C
SSLA				  Far	 ARRAY:2872
SSMOD				  Far	 ARRAY:2861
STAR				  Far	 ARRAY:2822
STATE				  Far	 ARRAY:2168
STOD				  Far	 ARRAY:1827
STORE				  Far	 ARRAY:1C9C
STY				  Far	 ARRAY:2EAA
STY1				  Near	 ARRAY:2EB8
STY2				  Near	 ARRAY:2EC6
STY3				  Near	 ARRAY:2ED6
SUBB				  Far	 ARRAY:172A
SWAB				  Far	 ARRAY:17AE
SWAP				  Far	 ARRAY:1A0C
SWAS				  Far	 ARRAY:2E7E
SZERO				  Far	 ARRAY:2094
TASK				  Far	 ARRAY:2FA8
TC0				  Near	 ARRAY:2371
TC1				  Near	 ARRAY:2387
TER				  Near	 ARRAY:155E
TERMON				  Far	 ARRAY:0FF1
THEN				  Far	 ARRAY:2B6F
THREE				  Far	 ARRAY:2068
TIB				  Far	 ARRAY:20A7
TICK				  Far	 ARRAY:2A2B
TOGL				  Far	 ARRAY:1C27
TOHEX				  Near	 ARRAY:0F25
TOP				  Near	 ARRAY:1850
TOR				  Far	 ARRAY:190E
TRAV				  Far	 ARRAY:1D7D
TRI				  Near	 ARRAY:2D15
TRIO				  Far	 ARRAY:2D03
TRUE				  Near	 ARRAY:1180
TRUE1				  Near	 ARRAY:125E
TRV				  Near	 ARRAY:1D81
TTT				  Near	 ARRAY:227C
TTY				  Far	 ARRAY:146D
TWO				  Far	 ARRAY:2060
TWOP				  Far	 ARRAY:15DD
TY$$				  Far	 ARRAY:2DC2
TY4				  Near	 ARRAY:2DC8
TY5				  Near	 ARRAY:2DDE
TYPE$				  Near	 ARRAY:146F
UDOT				  Far	 ARRAY:2C91
UDOTR				  Far	 ARRAY:2C5B
ULESS				  Far	 ARRAY:11F7
UNTIL				  Far	 ARRAY:2AE3
UPDAT				  Far	 ARRAY:1F13
UPPER				  Far	 ARRAY:1E85
USE				  Far	 ARRAY:21A4
USER				  Far	 ARRAY:1FED
Turbo Assembler	 Version 3.1	    05/14/20 14:48:57	    Page 121
Symbol Table



USLAS				  Far	 ARRAY:166B
USTAR				  Far	 ARRAY:164D
VAR				  Far	 ARRAY:1FCB
VL0				  Near	 ARRAY:2D2F
VL1				  Near	 ARRAY:2D37
VL2				  Near	 ARRAY:2D6F
VLIST				  Far	 ARRAY:2D27
VOCAB				  Far	 ARRAY:2784
VOCL				  Far	 ARRAY:20E1
WD1				  Near	 ARRAY:243E
WD2				  Near	 ARRAY:2442
WR				  Near	 ARRAY:2F26
X				  Far	 ARRAY:1F35
XA				  Far	 ARRAY:21E6
XC				  Far	 ARRAY:21EF
XDO				  Far	 ARRAY:105B
XDP				  Word	 ARRAY:3023
XER				  Near	 ARRAY:262E
XLOOP				  Far	 ARRAY:1084
XM				  Far	 ARRAY:21F8
XPLOO				  Far	 ARRAY:10B2
XR0				  Word	 ARRAY:0CCC
XS0				  Word	 STCK:0080
XT				  Near	 ARRAY:23C9
XTIB				  Word	 ARRAY:0C14
XUP				  Word	 ARRAY:0CD0
XVOC				  Far	 ARRAY:2F9F
XXX				  Near	 ARRAY:0DD4
Y$				  Near	 ARRAY:1E21
Z$				  Near	 ARRAY:194E
ZBRAN				  Far	 ARRAY:101A
ZEQGR				  Far	 ARRAY:11AA
ZEQLES				  Far	 ARRAY:11C9
ZEQU				  Far	 ARRAY:1164
ZERO				  Far	 ARRAY:2050
ZGRET				  Far	 ARRAY:119A
ZLESS				  Far	 ARRAY:11B9
ZZZ				  Near	 ARRAY:12AA

Macro Name

HEAD
NEXT

Groups & Segments		  Bit Size Align  Combine Class

ARRAY				  16  AD23 Para	  none
DGROUP				  Group
  _DATA				  16  0000 Word	  Public  DATA
STCK				  16  0084 Para	  Stack
_TEXT				  16  0000 Word	  Public  CODE
